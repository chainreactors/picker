---
title: An IDOR vulnerability often hides many others
url: https://infosecwriteups.com/an-idor-vulnerability-often-hides-many-others-2893ddd0a0d7?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2023-02-02
fetch_date: 2025-10-04T05:28:48.886351
---

# An IDOR vulnerability often hides many others

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2893ddd0a0d7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fan-idor-vulnerability-often-hides-many-others-2893ddd0a0d7&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fan-idor-vulnerability-often-hides-many-others-2893ddd0a0d7&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-2893ddd0a0d7---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-2893ddd0a0d7---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# An IDOR vulnerability often hides many others

[![Rachid.A](https://miro.medium.com/v2/resize:fill:64:64/1*ozPqF_1nHwMgPECyOySdDA.png)](https://medium.com/%40zhero_?source=post_page---byline--2893ddd0a0d7---------------------------------------)

[Rachid.A](https://medium.com/%40zhero_?source=post_page---byline--2893ddd0a0d7---------------------------------------)

6 min read

·

Jan 31, 2023

--

3

Listen

Share

Press enter or click to view image in full size

![]()

Credit: Pinterest

Some errors are occasional, others result from poor design, in this case, finding a vulnerability allows you to find many others…

I recently found **10 IDOR vulnerabilities in a few hours on a single program**, let’s talk about it.

## To start, let’s remember what an IDOR vulnerability is

> Definition from **PortSwigger** :
>
> Insecure direct object references (IDOR) are a type of access control vulnerability that arises when an application uses user-supplied input to access objects directly. The term IDOR was popularized by its appearance in the OWASP 2007 Top Ten. However, it is just one example of many access control implementation mistakes that can lead to access controls being circumvented. IDOR vulnerabilities are most commonly associated with horizontal privilege escalation, but they can also arise in relation to vertical privilege escalation.

In short, exploiting this vulnerability allows us **to perform actions or access information/resources to which we are not supposed to have access**, whether it is data belonging to a user with the same privilege level as us (horizontal privilege escalation) or a user with a higher privilege level such as an administrator (vertical privilege escalation).

As indicated in the *PortSwigger* definition, **the attack vectors of an IDOR can be multiple** : the magic will happen every time the application uses the data provided by the user (the attacker in our case) to access an object **without first checking that the author of the request is indeed the owner of the requested data or that he has the appropriate privilege level**.

Press enter or click to view image in full size

![]()

Credit : dreamlab.net

The way applications retrieve the data requested by the user will differ **according to their designs but also according to the features concerned**, so the list is not exhaustive; Some will retrieve the objects requested by the user from information (*ID, GUID, username, value encoded in Base64…*) transmitted via a **URL** (PATH to a specific file for example), **parameters transmitted in the URL**, a **POST request**, or **cookies**.

## Methodology

***Preparing the ground***

When I want to test an application for IDOR attacks, I start by creating two accounts, an attacker and a victim. That way, I can try to perform actions and/or access the private information of my victim account through my attacker account **without harming the users of the platform**.

Once this is done, I log in to the victim account and **play with some private features** (such as uploading personal information) by passing my requests through my proxy. The first goal here is to analyze the HTTP requests and **see if a parameter corresponds to an ID (whatever its nature) belonging to the victim account**.

As explained above, an account can have several types of data allowing it to be “recognized” by the server when the request is received and these types of data will differ depending on the feature used : **take a notebook and note all these values**, they will be essential for the next tests.

***Now it’s time to tryhard***

After taking note of these values, we can log in to the attacker account and **test all the private features by systematically changing the ID (or the concerned value) to those previously noted belonging to the victim account**. Being consistent in testing is a plus, **divide the application into blocks** and move forward as you go to cover its entire surface without getting lost.

Press enter or click to view image in full size

![]()

Credit: Pinterest

It is essential to have a **good understanding of the application** being tested to know what the expected behaviors when sending a request, and what are, on the contrary, **the behaviors that should attract our attention** or — at least — **arouse our curiosity**. An application is not tested in one hour, the more time you spend on it, the more precise your understanding of the architecture and technologies used will be.

You have to **put yourself in the developer’s shoes** and focus on the less intuitive areas to secure or on **the latest features implemented**, don’t hesitate to follow the company on its social networks to stay informed of the news.

I like to look for endpoints by testing features from other devices or on web.archive, you can come across old, less secure **but still active** endpoints!

## My findings

As this was a **private program**, I will not reveal the name of the company and will voluntarily change some information. It was a company that allowed to upload of multimedia files (photos, videos…) on its platform.

When testing a feature allowing to saving media, I came across a **graphQL request** looking like this :

```
{
  "action":"getSaves",
  "variables":{
    "input":{
      "infoD":"eyJ0eXBlIjoidXNlcklEIiwiaWQiOiIxODI5MDUifQ=="
     }
  },
  "query":" (…) "
}
```

Some characteristics of the value of the “infoD” parameter easily allow us to guess that it is an **encoding in base64**, when I decode the value I get:

```
{"type":"userID","id":"182905"}
```

What happens if I **change the value** of the “id” parameter to the id of my victim account, **re-encode it all in base64,** and then **modify the value** of the “infoD” parameter of my request?

```
{"type":"userID","id":"182545"}
```

```
eyJ0eXBlIjoidXNlcklEIiwiaWQiOiIxODI1NDUifSA=
```

```
{
  "action":"getSaves",
  "variables":{
    "input":{
      "infoD":"eyJ0eXBlIjoidXNlcklEIiwiaWQiO...