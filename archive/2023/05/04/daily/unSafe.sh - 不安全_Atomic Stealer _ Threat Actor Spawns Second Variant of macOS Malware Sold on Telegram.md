---
title: Atomic Stealer | Threat Actor Spawns Second Variant of macOS Malware Sold on Telegram
url: https://buaq.net/go-161518.html
source: unSafe.sh - 不安全
date: 2023-05-04
fetch_date: 2025-10-04T11:38:36.133091
---

# Atomic Stealer | Threat Actor Spawns Second Variant of macOS Malware Sold on Telegram

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/7c0079d7bd1a31bff436dc5ff2a837c9.jpg)

Atomic Stealer | Threat Actor Spawns Second Variant of macOS Malware Sold on Telegram

Recent weeks have seen a number of macOS-specific infostealers appear for sale in crimeware forums,
*2023-5-3 20:37:4
Author: [www.sentinelone.com(查看原文)](/jump-161518.htm)
阅读量:41
收藏*

---

Recent weeks have seen a number of macOS-specific infostealers appear for sale in crimeware forums, including [Pureland](https://www.sentinelone.com/blog/session-cookies-keychains-ssh-keys-and-more-7-kinds-of-data-malware-steals-from-macos-users/), [MacStealer](https://www.trendmicro.com/en_us/research/23/c/mac-malware-macstealer-spreads-as-fake-p2-e-apps.html) and [Amos Atomic Stealer](https://twitter.com/phd_phuc/status/1651001139750420480?s=20). Of these, Atomic Stealer has offered by far the most complete package, promising cybercriminals a full-featured if not particularly sophisticated infostealer. Atomic can grab account passwords, browser data, [session cookies](https://www.sentinelone.com/blog/session-cookies-keychains-ssh-keys-and-more-7-kinds-of-data-malware-steals-from-macos-users/), and crypto wallets, and in the version being advertised on Telegram, threat actors can manage their campaigns through a web interface rented out from the developer for $1000 per month.

The threat actor, however, has been busy looking for other ways to target macOS users with a different version of Atomic Stealer. In this post, we take a closer look at how Atomic Stealer works and describe a previously unreported second variant. We also provide a comprehensive list of indicators to aid threat hunters and security teams defending macOS endpoints.

![](https://www.sentinelone.com/wp-content/uploads/2023/05/Threat-Actor-Spawns-Second-Variant-of-macOS-Malware-Sold-on-Telegram-2.jpg)

## How is Atomic Stealer Distributed?

Cybercriminals are currently being offered “Amos Atomic MacOS Stealer” via a dedicated Telegram channel. In the channel, which was opened on April 9th, the author offers to rent access to a web panel and provide a disk-image based installer for $1000/month.

![Atomic Stealer as advertised on Telegram](https://www.sentinelone.com/wp-content/uploads/2023/05/atomic_stealer_4.jpg)

Atomic Stealer as advertised on Telegram

Payload distribution is left up to the crimeware actor renting the package, so methods vary, but so far observed samples have been seen masquerading as installers for legitimate applications like the Tor Browser or pretending to offer users cracked versions of popular software including Photoshop CC, Notion, Microsoft Office and others.

![Atomic MacStealer masquerades as legitimate applications](https://www.sentinelone.com/wp-content/uploads/2023/05/atomic_stealer_19.jpg)

Atomic MacStealer masquerades as legitimate applications

[Malvertising](https://www.sentinelone.com/blog/7-ways-threat-actors-deliver-macos-malware-in-the-enterprise/) via Google Ads has also been noted privately among researchers as a distribution vector for Atomic Stealer.

![Some Atomic Stealer ITW URLs (Source: VirusTotal)](https://www.sentinelone.com/wp-content/uploads/2023/05/atomic_stealer_12.jpg)

Some Atomic Stealer ITW URLs (Source: VirusTotal)

The Atomic Stealer channel currently has over 300 subscribers, with some posts – possibly planted – appearing to endorse the efficacy of the malware.

![A Telegram message seems to endorse Atomic MacStealer](https://www.sentinelone.com/wp-content/uploads/2023/05/atomic_stealer_11.jpg)

A Telegram message seems to endorse Atomic MacStealer

A Google translation of the Russian text reads “*The build works, the logs go, it robs clearly. Of all the poppy stealers that I used, this one is better in terms of a grabber, and most importantly, grandmas do not steal)*”.

## Anatomy of Atomic MacOS Stealer Variant A

These fake applications are made with a [fork](https://github.com/machinebox/appify) of Appify, a legitimate script that can be found on Github for making a barebones macOS application. All Atomic infostealers currently contain the same Go-based main executable that weighs in at around 51.5MB as a Universal binary targeting both Intel and arm64 architectures.

![Anatomy of the Atomic Stealer binary (variant A)](https://www.sentinelone.com/wp-content/uploads/2023/05/atomic_stealer_8.jpg)

Anatomy of the Atomic Stealer binary (variant A)

Despite the heft, no attempt has been made to deliver a working copy of the spoofed apps. Aside from the Appify README, the Bundle contains nothing more than the Go infostealing binary, an icon file and a Info.plist.

![Anatomy of an Atomic Stealer application bundle](https://www.sentinelone.com/wp-content/uploads/2023/05/atomic_stealer_1.jpg)

Anatomy of an Atomic Stealer application bundle

The application bundles currently being distributed are all built with the default Appify bundle identifier, `Appify by Machine Box.My Go Application`, potentially a deliberate ploy by the author in the hope that detections might be considered false positives.

## Execution Behavior of Variant A

Atomic does not attempt to gain persistence, an increasing trend since Apple added [login item notifications](https://www.sentinelone.com/blog/apples-macos-ventura-7-new-security-changes-to-be-aware-of/) in macOS Ventura, relying instead on a one-hit smash and grab methodology.

Atomic Stealer uses a crude but effective means of extracting the user’s login password via [AppleScript spoofing](https://www.sentinelone.com/blog/macos-red-team-spoofing-privileged-helpers-and-others-to-gain-root/).

![](https://www.sentinelone.com/wp-content/uploads/2023/05/atomic_stealer_9.jpg)

This involves creating a dialog box with [osascript](https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/) and passing the `hidden answer` parameter to the `display dialog` command. These dialog boxes contain an ordinary text field, but the parameter displays the user’s typed characters as dots in the text field similar to a genuine authentication dialog. However, the password remains captured in plain text and can be seen in the system logs as such  – a good reason why [legitimate software](https://twitter.com/philofishal/status/1651525380774264833?s=20) developers should never use this insecure method to actually obtain user credentials.

```
display dialog "MacOS wants to access System Preferences

You entered invalid password.

Please enter your password." with title "System Preferences" with icon file "System:Library:CoreServices:CoreTypes.bundle:Contents:Resources:ToolbarAdvanced.icns" default answer "" giving up after 30 with hidden answer ¬
```

The dialog box message contains grammatical and syntactic errors, suggesting the developer’s first language is not English. The dialog box is generated using an infinite loop: Clicking the “Cancel” button simply pops the dialog box again. If the “OK” button is clicked, the malware checks to see that the user entered a valid password via `/usr/bin/dscl` utility and the `-authonly` option.

![](https://www.sentinelone.com/wp-content/uploads/2023/05/atomic_stealer_5.jpg)

The dialog box repeatedly pops until the correct password is supplied. All of this occurs via the command line utility `osascript`, so it is easily visible to defenders monitoring command line activity.

![SentinelOne console reveals Atomic Stealer command line activity](https://www.sentinelone.com/wp-content/uploads/2023/05/atomic_stealer_16.jpg)

SentinelOne console reveals Atomic Stealer command line activity

Amos Atomic is hardcoded to throw the user an error message after it has...