---
title: Web Shell Upload via Extension Blacklist Bypass — File Upload Vulnerability
url: https://infosecwriteups.com/web-shell-upload-via-extension-blacklist-bypass-file-upload-vulnerability-f98ee877aff1?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2024-12-07
fetch_date: 2025-10-06T19:38:18.137977
---

# Web Shell Upload via Extension Blacklist Bypass — File Upload Vulnerability

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff98ee877aff1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40ryangcox%2Fweb-shell-upload-via-extension-blacklist-bypass-file-upload-vulnerability-f98ee877aff1&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40ryangcox%2Fweb-shell-upload-via-extension-blacklist-bypass-file-upload-vulnerability-f98ee877aff1&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

# Web Shell Upload via Extension Blacklist Bypass — File Upload Vulnerability

[![Ryan G. Cox](https://miro.medium.com/v2/resize:fill:64:64/1*VkvYzjvK_fuZ2Js8dEFC_g.jpeg)](/%40ryangcox?source=post_page---byline--f98ee877aff1---------------------------------------)

[Ryan G. Cox](/%40ryangcox?source=post_page---byline--f98ee877aff1---------------------------------------)

5 min read

·

Dec 1, 2024

--

Listen

Share

Press enter or click to view image in full size

![]()

[The Cybersec Café](https://www.cyberseccafe.com/)

In today’s Pentesting Methodology Lab Walkthrough at the Cybersec Cafe, I’ll be approaching a File Upload Vulnerability and detailing my step-by-step methodology through to exploitation. These writeups are from controlled environment to explain my methodology in order to help you learn how to test applications yourself.

## Objective

Upload a basic PHP web shell, then use it to exfiltrate the contents of the file `/home/carlos/secret`

## What We Know

We will need to upload two different files to solve this lab.

## What is a File Upload Vulnerability?

A file upload vulnerability occurs when an application allows users to upload files without properly validating or restricting the file types and content. Attackers can exploit this flaw by uploading malicious files, such as scripts or executables, which can lead to unauthorized code execution or compromise of the server.

If you enjoy this article and want to be the first to see more like it, consider **subscribing** to my newsletter, the [Cybersec Cafe](https://www.cyberseccafe.com/), for *free*. I post content there first, and here second. Plus, you’ll get it straight to your inbox.

My goal is to deliver you value in various cybersecurity topics each week and to become your ultimate destination for expanding your expertise or for any aspiring cybersecurity professionals to break into the field.

## Methodology

Want to give the lab a try yourself and follow along? You can check it out on PortSwigger’s website [here](https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-extension-blacklist-bypass) for free.

## The Recon

We’re met with a standard blog application — one that we’ve seen many times while attacking labs in this series.

Press enter or click to view image in full size

![]()

But, what’s different this time around?

In the blog post comment section, we have the ability to upload a user avatar with our comment.

Let’s go ahead and upload an image and send a test comment to capture.

Press enter or click to view image in full size

![]()

Now, let’s go ahead and login to our test account.

We can see we’re met with a familiar email update feature, but also with an Avatar upload feature.

Let’s also submit a file to upload our avatar here to capture the request.

Press enter or click to view image in full size

![]()

Make sure the image size is small enough, otherwise the application will error out. Our goal is to capture the request and be met with a success message that the file has been uploaded.

Now, navigate to your Burp instance and find both the GET and POST request under **my-account/avatar**. Send both requests to the Repeater.

Press enter or click to view image in full size

![]()

## Testing

Now, open up your CMD line and create a file called *exploit.php*.

You can run the command `touch exploit.php` to create the file, then `nano exploit.php` to edit it. Or, use a text editor of your choice.

Add the following PHP paylod to your exploit file:

`<?php echo file_get_contents(‘/home/carlos/secret’); ?>`

This file will find the contents of our secret file and print the out using the echo command.

Press enter or click to view image in full size

![]()

Let’s try to upload it.

Press enter or click to view image in full size

![]()

Oh no… there is an error uploading the file. It loks like the application blocks uploading of PHP files.

There must be reasoning to this…

Let’s take a look at the POST request used to upload the file for clues. Specifically, the Response:

Press enter or click to view image in full size

![]()

We can see we’re communicating with an Apache server, which has some protections in place to block this filetype.

There may be something here…

## Exploitation

Upload the PHP file again, but this time, intercept the request instead of forwarding it, send it to the Repeater.

Make the following changes:

* Change the filename parameter to *.htaccess*
* Chang the Content-Type to *text/plain*
* Replace the contents of the file with the following Apache directive: *AddType application/x-httpd-php .cybersec*
* This will map an arbitrary extension (.cybersec in this case) to the executable MIME type *application/x-httpd-php*

Press enter or click to view image in full size

![]()

Go ahead and send this, and see that we’re met with a 200 response — verifying the file has been uploaded successfully.

Press enter or click to view image in full size

![]()

Now, use the back arrow in Repeater to change back to the original request for uploading your PHP exploit.

Now, change our filename to *exploit.cybersec* (or, whatever arbitrary extension you created).

Press enter or click to view image in full size

![]()

We can see the file was now uploaded successfully!

Now navigate back to your account in the GUI and refresh the page. This will trigger the retrieval of our new exploit avatar file.

Navigate over to your HTTP History under the Burp Proxy tab, and you can see the GET request used to retrieve the image:

Press enter or click to view image in full size

![]()

Inside, we can see we retrieved the secret string. Take this and submit it to solve the lab!

## What We’ve Learned

File uploads are potentially dangerous features in web applications. If proper protections are not in place to filter out malicious types, attackers can potentially compromise your users or your entire application. Use a service you trust when building web apps to handle file uploads.

—

Remember: The Cybersec Café gets articles first. Subscribe for free [here](https://www.cyberseccafe.com/).

Interested in getting into Cybersecurity? I have a course called the [Security Sip](https://securitysip.cyberseccafe.com/). The curriculum is designed to help you build skills progressively over 12 sections, 85 modules, and 155 exercises. With rapidly evolving threats and technologies widening the skill gap, it’s time to secure your future in cybersecurity. [**Available Now**](https://securitysip.cyberseccafe.com/#pricing)**!**

Oh, and if you want even more content and updates, hop over to Ryan G. Cox on [Twitter/X](https://twitter.com/ryangcox_). Can’t wait to keep sharing and lea...