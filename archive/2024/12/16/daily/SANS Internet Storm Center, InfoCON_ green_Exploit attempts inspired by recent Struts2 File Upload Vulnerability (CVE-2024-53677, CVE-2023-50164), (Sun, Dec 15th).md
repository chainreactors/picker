---
title: Exploit attempts inspired by recent Struts2 File Upload Vulnerability (CVE-2024-53677, CVE-2023-50164), (Sun, Dec 15th)
url: https://isc.sans.edu/diary/rss/31520
source: SANS Internet Storm Center, InfoCON: green
date: 2024-12-16
fetch_date: 2025-10-06T19:37:16.175576
---

# Exploit attempts inspired by recent Struts2 File Upload Vulnerability (CVE-2024-53677, CVE-2023-50164), (Sun, Dec 15th)

# [Internet Storm Center](/)

[Sign In](/login.html)
[Sign Up](/register.html)

Handler on Duty: [Johannes Ullrich](/handler_list.html#johannes-ullrich "Johannes Ullrich")

Threat Level: [green](/infocon.html)

* [previous](/diary/31514)
* [next](/diary/31524)

My next class:

|  |  |  |
| --- | --- | --- |
| [Application Security: Securing Web Apps, APIs, and Microservices](https://www.sans.org/event/dallas-2025/course/application-security-securing-web-apps-api-microservices) | Dallas | Dec 1st - Dec 6th 2025 |

# [Exploit attempts inspired by recent Struts2 File Upload Vulnerability (CVE-2024-53677, CVE-2023-50164)](/forums/diary/Exploit%2Battempts%2Binspired%2Bby%2Brecent%2BStruts2%2BFile%2BUpload%2BVulnerability%2BCVE202453677%2BCVE202350164/31520/)

**Published**: 2024-12-15. **Last Updated**: 2024-12-15 18:02:44 UTC
**by** [Johannes Ullrich](https://plus.google.com/101587262224166552564?rel=author) (Version: 1)

[0 comment(s)](/diary/Exploit%2Battempts%2Binspired%2Bby%2Brecent%2BStruts2%2BFile%2BUpload%2BVulnerability%2BCVE202453677%2BCVE202350164/31520/#comments)

![](https://isc.sans.edu/diaryimages/images/Screenshot%202024-12-15%20at%2012_51_34%E2%80%AFPM.png)Last week, Apache announced a vulnerability in Struts2 [1]. The path traversal vulnerability scored 9.5 on the CVSS scale. If exploited, the vulnerability allows file uploads into otherwise restricted directories, which may lead to remote code execution if a webshell is uploaded and exposed in the web root. I call the exploit attempts below "inspired" by this vulnerability. There are at least two vulnerabilities that could be targeted. I do not have a vulnerable system to test if the exploit will work.

Patching this vulnerability is not quite as straightforward as it should be. Apache points out:

> This change isn't backward compatible as you must rewrite your actions to start using the new Action File Upload mechanism and related interceptor. Keep using the old File Upload mechanism keeps you vulnerable to this attack.

The vulnerability, CVE-2024-53677, appears to be related to CVE-2023-50164. The older vulnerability is similar, and an incomplete patch may have led to the newer issue. PoC exploits have been released (see, for example, [2]). And we are seeing active exploit attempts for this vulnerability that match the PoC exploit code. At this point, the exploit attempts are attempting to enumerate vulnerable systems:

> POST /actionFileUpload HTTP/1.1
> Host: [honeypot IP address]:8090
> User-Agent: python-requests/2.32.3
> Accept-Encoding: gzip, deflate, zstd
> Accept: \*/\*
> Connection: keep-alive
> Content-Length: 222
> Content-Type: multipart/form-data; boundary=0abcfc26e3fa0afbd6db1ba369dfcc37
>
> --0abcfc26e3fa0afbd6db1ba369dfcc37
> Content-Disposition: form-data; name="file"; filename="exploit.jsp"
> Content-Type: application/octet-stream
>
> <% out.println("Apache Struts"); %>
> --0abcfc26e3fa0afbd6db1ba369dfcc37--

This attempt uploads a one-liner script that is supposed to return "Apache Struts". Next, the attacker attempts to find the uploaded script. The exploit attempt is very close to the original PoC. Since then, a slightly improved exploit has been uploaded to the same GitHub repository.

> GET /actionFileUpload/exploit.jsp HTTP/1.1
> Host: [honeypot IP]:8090
> User-Agent: python-requests/2.32.3
> Accept-Encoding: gzip, deflate, zstd
> Accept: \*/\*
> Connection: keep-alive

So far, the scans originate only from [169.150.226.162](/ipinfo.html?ip=169.150.226.162), an IP address that started scanning yesterday, initially for simple URLs like "/" and "/cbs" (likely another upload vulnerability).

[1] https://cwiki.apache.org/confluence/display/WW/S2-067
[2] https://github.com/TAM-K592/CVE-2024-53677-S2-067

---
Johannes B. Ullrich, Ph.D. , Dean of Research, [SANS.edu](https://sans.edu)
[Twitter](https://jbu.me/164)|

Keywords: [struts](/tag.html?tag=struts) [struts2](/tag.html?tag=struts2) [fileupload](/tag.html?tag=fileupload)

[0 comment(s)](/diary/Exploit%2Battempts%2Binspired%2Bby%2Brecent%2BStruts2%2BFile%2BUpload%2BVulnerability%2BCVE202453677%2BCVE202350164/31520/#comments)

My next class:

|  |  |  |
| --- | --- | --- |
| [Application Security: Securing Web Apps, APIs, and Microservices](https://www.sans.org/event/dallas-2025/course/application-security-securing-web-apps-api-microservices) | Dallas | Dec 1st - Dec 6th 2025 |

* [previous](/diary/31514)
* [next](/diary/31524)

### Comments

[Login here to join the discussion.](/login)

Top of page

×

![modal content]()

[Diary Archives](/diaryarchive.html)

* [![SANS.edu research journal](https://isc.sans.edu/images/researchjournal5.png)](/j/research)
* [Homepage](/index.html)
* [Diaries](/diaryarchive.html)
* [Podcasts](/podcast.html)
* [Jobs](/jobs)
* [Data](/data)
  + [TCP/UDP Port Activity](/data/port.html)
  + [Port Trends](/data/trends.html)
  + [SSH/Telnet Scanning Activity](/data/ssh.html)
  + [Weblogs](/weblogs)
  + [Domains](/data/domains.html)
  + [Threat Feeds Activity](/data/threatfeed.html)
  + [Threat Feeds Map](/data/threatmap.html)
  + [Useful InfoSec Links](/data/links.html)
  + [Presentations & Papers](/data/presentation.html)
  + [Research Papers](/data/researchpapers.html)
  + [API](/api)
* [Tools](/tools/)
  + [DShield Sensor](/howto.html)
  + [DNS Looking Glass](/tools/dnslookup)
  + [Honeypot (RPi/AWS)](/tools/honeypot)
  + [InfoSec Glossary](/tools/glossary)
* [Contact Us](/contact.html)
  + [Contact Us](/contact.html)
  + [About Us](/about.html)
  + [Handlers](/handler_list.html)* [About Us](/about.html)

[Slack Channel](/slack/index.html)

[Mastodon](https://infosec.exchange/%40sans_isc)

[Bluesky](https://bsky.app/profile/sansisc.bsky.social)

[X](https://twitter.com/sans_isc)

![](/adimg.html?id=)

© 2025 SANS™ Internet Storm Center
Developers: We have an [API](/api/) for you!   [![Creative Commons License](/images/cc.png)](https://creativecommons.org/licenses/by-nc-sa/4.0/)

* [Link To Us](/linkback.html)
* [About Us](/about.html)
* [Handlers](/handler_list.html)
* [Privacy Policy](/privacy.html)