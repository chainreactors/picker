---
title: Microsoft Reveals macOS Vulnerability that Bypasses Privacy Controls in Safari Browser
url: https://thehackernews.com/2024/10/microsoft-reveals-macos-vulnerability.html
source: The Hacker News
date: 2024-10-19
fetch_date: 2025-10-06T18:58:06.996082
---

# Microsoft Reveals macOS Vulnerability that Bypasses Privacy Controls in Safari Browser

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [Microsoft Reveals macOS Vulnerability that Bypasses Privacy Controls in Safari Browser](https://thehackernews.com/2024/10/microsoft-reveals-macos-vulnerability.html)

**Oct 18, 2024**Ravie LakshmananThreat Intelligence / Browser Security

[![macOS Vulnerability](data:image/png;base64... "macOS Vulnerability")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEghODlAyYIX3vb18PrrxaGzg0yqQhu2DZVq1FW3xwPwvX_AZFgFCDS_nc1KaVnVfmJtG7jhjO69kolMhUIVE0ZOGF8XExYUdMswiYkctt2KBc0eBN7Xph_MVWAcQzr0sMyOHflkUP_OmAGqTQ4PTF1fOZcF98ho6D6DhfnAqdpFHYPEbGFaWKrzp9RnEI9x/s790-rw-e365/safari.png)

Microsoft has disclosed details about a now-patched security flaw in Apple's Transparency, Consent, and Control (TCC) framework in macOS that has likely come under exploitation to get around a user's privacy preferences and access data.

The shortcoming, codenamed HM Surf by the tech giant, is tracked as CVE-2024-44133 (CVSS score: 5.5). It was [addressed](https://support.apple.com/en-us/121238) by Apple as part of macOS Sequoia 15 by removing the vulnerable code.

HM Surf "involves removing the TCC protection for the Safari browser directory and modifying a configuration file in the said directory to gain access to the user's data, including browsed pages, the device's camera, microphone, and location, without the user's consent," Jonathan Bar Or of the Microsoft Threat Intelligence team [said](https://www.microsoft.com/en-us/security/blog/2024/10/17/new-macos-vulnerability-hm-surf-could-lead-to-unauthorized-data-access/).

Microsoft said the new protections are limited to Apple's Safari browser, and that it's working with other major browser vendors to further explore the benefits of hardening local configuration files.

[![DFIR Retainer Services](data:image/png;base64...)](https://thehackernews.uk/cloud-insight-d)

HM Surf follows Microsoft's discovery of Apple macOS flaws like [Shrootless](https://thehackernews.com/2023/05/microsoft-details-critical-apple-macos.html), [powerdir](https://thehackernews.com/2021/10/new-shrootless-bug-could-let-attackers.html), [Achilles](https://thehackernews.com/2022/12/microsoft-details-gatekeeper-bypass.html), and [Migraine](https://thehackernews.com/2023/05/microsoft-details-critical-apple-macos.html) that could enable malicious actors to sidestep security enforcements.

While TCC is a security framework that prevents apps from accessing users' personal information without their consent, the newly discovered bug could enable attackers to bypass this requirement and gain access to location services, address book, camera, microphone, downloads directory, and others in an unauthorized manner.

The access is governed by a set of entitlements, with Apple's own apps like Safari having the ability to completely sidestep TCC using the "com.apple.private.tcc.allow" entitlement.

While this allows Safari to freely access sensitive permissions, it also incorporates a new security mechanism called [Hardened Runtime](https://thehackernews.com/2024/09/new-flaws-in-microsoft-macos-apps-could.html) that makes it challenging to execute arbitrary code in the context of the web browser.

That said, when users visit a website that requests location or camera access for the first time, Safari prompts for access via a TCC-like popup. These entitlements are stored on a per-website basis within various files located in the "~/Library/Safari" directory.

The HM Surf exploit devised by Microsoft hinges on performing the following steps -

* Changing the home directory of the current user with the [dscl](https://ss64.com/mac/dscl.html) utility, a step that does not require TCC access in macOS Sonoma
* Modifying the sensitive files (e.g., PerSitePreferences.db) within "~/Library/Safari" under the user's real home directory
* Changing the home directory back to the original directory causing Safari to use the modified files
* Launching Safari to open a web page that takes a snapshot via the device's camera and grab the location

[![CIS Build Kits](data:image/png;base64...)](https://thehackernews.uk/platform-shield-d)

The attack could be extended further to save an entire camera stream or stealthily capture audio through the Mac's microphone, Microsoft said. Third-party web browsers don't suffer from this problem as they do not have the same private entitlements as Apple applications.

Microsoft noted it observed suspicious activity associated with a known macOS adware threat named [AdLoad](https://thehackernews.com/2024/05/new-cuckoo-persistent-macos-spyware.html) likely exploiting the vulnerability, making it imperative that users take steps to apply the latest updates.

"Since we weren't able to observe the steps taken leading to the activity, we can't fully determine if the AdLoad campaign is exploiting the HM surf vulnerability itself," Bar Or said. "Attackers using a similar method to deploy a prevalent threat raises the importance of having protection against attacks using this technique."

Found this article interesting? Follow us on [Google News](https://news.google.com/publications/CAAqLQgKIidDQklTRndnTWFoTUtFWFJvWldoaFkydGxjbTVsZDNNdVkyOXRLQUFQAQ), [Twitter](https://twitter.com/thehackersnews) and [LinkedIn](https://www.linkedin.com/company/thehackernews/) to read more exclusive content we post.

SHARE
[**](#link_share)
[**](#link_share)
[**](#link_share)
**

[**Tweet](#link_share)

[**Share](#link_share)

[**Share](#link_share)

**Share

**
[**Share on Facebook](#link_share)
[**Share on Twitter](#link_share)
[**Share on Linkedin](#link_share)
[**Share on Reddit](#link_share)
[**Share on Hacker News](#link_share)
[**Share on Email](#link_share)
[**Share on WhatsApp](#link_share)
[![Facebook Messenger](data:image/png;base64...)Share on Facebook Messenger](#link_share)
[**Share on Telegram](#link_share)

SHARE **

[Apple](https://thehackernews.com/search/label/Apple)[browser security](https://thehackernews.com/search/label/browser%20security)[cybersecurity](https://thehackernews.com/search/label/cybersecurity)[...