---
title: !exploitable Episode One - Breaking IoT
url: https://blog.doyensec.com/2025/02/11/exploitable-iot.html
source: Over Security - Cybersecurity news aggregator
date: 2025-02-12
fetch_date: 2025-10-06T20:38:47.698048
---

# !exploitable Episode One - Breaking IoT

[

](https://doyensec.com/img/home-video.mp4)

[![](/public/images/doyensec-logo.svg)](/index.html)

[![](/public/images/logo.svg)](/index.html)

#### ABOUT US

We are [**security engineers**](https://doyensec.com) who break bits and tell stories.

Visit us
[doyensec.com](https://doyensec.com)

Follow us
[@doyensec](https://twitter.com/doyensec)

Engage us
info@doyensec.com

#### Blog Archive

* 2025
* 2024
* 2023
* 2022
* 2021
* 2020
* 2019
* 2018
* 2017

© 2025 [Doyensec LLC](https://doyensec.com) [![](/public/images/rss.png)](/atom.xml "RSS")

# !exploitable Episode One - Breaking IoT

11 Feb 2025 - Posted by Savio Sisco

## Introduction

For our last company retreat, the Doyensec team went on a cruise along the coasts of the Mediterranean Sea. As amazing as each stop was, us being geeks, we had to break the monotony of daily pool parties with some much-needed hacking sessions. Luca and John, our chiefs, came to the rescue with three challenges chosen to make us scratch our heads to get to a solution. The goal of each challenge was to analyze a real-world vulnerability with no known exploits and try to make one ourselves. The vulnerabilities were of three different categories: **IoT**, **web**, and **binary exploitation**; so we all chose which one we wanted to deal with, split into teams, and started working on it.

The name of this whole group activity was â**!exploitable**â. For those of you who donât know what that is (I didnât), itâs referring to an extension made by Microsoft for the WinDbg debugger. Using the `!exploitable` command, the debugger would analyze the state of the program and tell you what kind of vulnerability was there and if it looked exploitable.

![Cruise Picture](../../../public/images/costamed.png)

As you may have guessed from the title, this first post is about the IoT challenge.

## The Bug

The vulnerability we were tasked to investigate is a buffer overflow in the firmware of the Tenda AC15 router, known as [CVE-2024-2850](https://nvd.nist.gov/vuln/detail/CVE-2024-2850). The advisory also links to a [markdown file on GitHub](https://github.com/abcdefg-png/IoT-vulnerable/blob/main/Tenda/AC15/V15.03.05.18/saveParentControlInfo_urls.md) with more details and a simple proof of concept. While the repo has been taken down, [the Wayback Machine archived the page](https://web.archive.org/web/20241218073449/https%3A//github.com/abcdefg-png/IoT-vulnerable/blob/main/Tenda/AC15/V15.03.05.18/saveParentControlInfo_urls.md).

![Screenshot of the file linked in the advisory](../../../public/images/exploitable-iot-1.png)

The GitHub doc describes the vulnerability as a stack-based buffer overflow and says that the vulnerability can be triggered from the `urls` parameter of the `/goform/saveParentControlInfo` endpoint (part of the routerâs control panel API). However, right off the bat, we notice some inconsistencies in the advisory. For starters, the attached screenshots clearly show that the `urls` parameterâs contents are copied into a buffer (`v18`) which was allocated with `malloc`, therefore the overflow should happen on the **heap**, not on the stack.

The page also includes a very simple proof of concept which is meant to crash the application by simply sending a request with a large payload. However, we find another inconsistency here, as the parameter used in the PoC is simply called `u`, instead of `urls` as described in the advisory text.

```
import requests
from pwn import*

ip = "192.168.84.101"
url = "http://" + ip + "/goform/saveParentControlInfo"
payload = b"a"*1000

data = {"u": payload}
response = requests.post(url, data=data)
print(response.text)
```

These contradictions may very well be just copy-paste issues, so we didnât really think about it too much. Moreover, if you do a quick Google search, you will find out that there is no shortage of bugs on this firmware and, more broadly, on Tenda routers â so we werenât worried.

## The Setup

The first step was to get a working setup to run the vulnerable firmware. Normally, you would need to fetch the firmware, extract the binary, and emulate it using QEMU (NB: not including a million troubleshooting steps in the middle). But we were on a **ship**, with a very intermittent Internet connection, and there was no way we could have gotten everything working without StackOverflow.

Luckily, there is an amazing project called [**EMUX**](https://github.com/therealsaumil/emux/) that is built for vulnerability exploitation exercises, exactly what we needed. Simply put, EMUX runs QEMU in a Docker container. The amazing part is that it already includes many vulnerable ARM and MIPS firmwares (including the Tenda AC15 one); it also takes care of networking, patching the binary for specific hardware checks, and many tools (such as GDB with [GEF](https://github.com/hugsy/gef)) are preinstalled, which is very convenient. If you are interested in how the Tenda AC15 was emulated, you can find a blog post from the toolâs author [here](https://armx.exploitlab.net/docs/emulating-tenda-ac15.html).

![Screenshot of the file linked in the advisory](../../../public/images/exploitable-iot-2.png)

After following the simple setup steps on EMUXâs README page, we were presented with the routerâs control panel exposed on `127.0.0.1:20080` (the password is `ringzer0`).

From the name of the vulnerable endpoint, we can infer that the affected functionality has something to do with parental controls. Therefore, we log in to the control panel, click on the âParental Controlâ item on the sidebar, and try to create a new parental control rule. Here is what the form looks like from the web interface:

![Screenshot of the file linked in the advisory](../../../public/images/exploitable-iot-3.png)

And hereâs the request sent to the API, confirming our suspicion that this is where the vulnerability is triggered:

```
POST /goform/saveParentControlInfo HTTP/1.1
Host: 127.0.0.1:20080
Content-Length: 154
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Cookie: password=ce80adc6ed1ab2b7f2c85b5fdcd8babcrlscvb
Connection: keep-alive

deviceId=de:ad:be:ef:13:37&deviceName=test&enable=1&time=19:00-21:00&url_enable=1&urls=google.com&day=1,1,1,1,1,1,1&limit_type=0
```

As expected, the proof of concept from the original advisory did not work out of the box. Firstly, because apparently the affected endpoint is only accessible after authentication, and then because the `u` parameter was indeed incorrect. After we added an authentication step to the script and fixed the parameter name, we indeed got a crash. After manually âfuzzingâ the request a bit and checking the appâs behavior, we decided it was time to try and hook GDB to the server process to get more insights on the crashes.

Through EMUX, we spawned a shell in the emulated system and used `ps` to check what was running on the OS, which was actually not much (omitting some irrelevant/repeated processes for clarity):

```
  698 root       0:02 {run-init} /bin/bash ./run-init
 1518 root       0:00 {emuxinit} /bin/sh /.emux/emuxinit
 1548 root       0:58 cfmd
 1549 root       0:00 udevd
 1550 root       0:00 logserver
 1566 root       0:00 nginx: master process nginx -p /var/nginx
 1568 root       0:00 nginx: worker process
 1569 root       0:00 /usr/bin/app_data_center
 1570 root       0:16 moniter
 1573 root       0:00 telnetd
 1942 root       0:02 cfmd
 1944 root       0:23 netctrl
 1945 root       2:00 time_check
 1947 root       1:48 multiWAN
 1950 root       0:01 time_check
 1953 root       0:04 ucloud_v2 -l 4
 1959 root       0:00 business_proc -l 4
 1977 root       0:02 netctrl
 2064 root       0:09 dnrd -a 192.168.100.2 -t 3 -M 600 --cache=2000:4000 -b -R /etc/dnrd -r 3 -s 8.8.8.8
 2068 root       0:00 business_proc -l 4
 2087 root       0:01 dhttpd
 2244 root       0:01 multiWAN
 2348 root       0:03 miniupnpd -f /etc/miniupnpd.config
 4670 root       0:00 /usr/sbin/...