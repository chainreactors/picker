---
title: ETW vs Sysmon Against C2 Servers
url: https://pentestmag.com/etw-vs-sysmon-against-c2-servers/?utm_source=rss&utm_medium=rss&utm_campaign=etw-vs-sysmon-against-c2-servers
source: Pentestmag
date: 2023-02-22
fetch_date: 2025-10-04T07:47:59.005848
---

# ETW vs Sysmon Against C2 Servers

[*0*](https://pentestmag.com/cart/)

* [Home](https://pentestmag.com/)
* [Courses](https://pentestmag.com/courses/)
* [eBooks](https://pentestmag.com/magazines/)
* [Subscription](https://pentestmag.com/levels-page/)
* [Blog](https://pentestmag.com/category/news/)
* [Contact Us](https://pentestmag.com/contact-us/)
* [About Us](https://pentestmag.com/about/)
* [Shop](https://pentestmag.com/shop/)

## [![Pentestmag](https://pentestmag.com/wp-content/uploads/2023/06/PenTeswhitet.svg)![Pentestmag](https://pentestmag.com/wp-content/uploads/2023/06/PenTeswhitet.svg)](https://pentestmag.com/)

* **Products**
  + [Online Courses](https://pentestmag.com/courses/)
  + [eBooks](https://pentestmag.com/magazines/)
  + [Shop](https://pentestmag.com/shop/)
* [**Subscription**](https://pentestmag.com/levels-page/)
* [**Corporate**](https://pentestmag.com/corporate-access/)
* [**Education**](https://pentestmag.com/edu/)

* No products in the cart.
* [LOGIN / SIGN UP](#login)

Login
Login with facebook
Login
Login with google

### LOGIN

[Forgot Password](https://pentestmag.com/wp-login.php?action=lostpassword "Forgot Password")

[ ] Remember Me

* [Sign Up](https://pentestmag.com/signup/ "Create an account")

Login
Login with facebook
Login
Login with google

* [Home](https://pentestmag.com)
* [Official](https://pentestmag.com/category/official/)
* ETW vs Sysmon Against C2 Servers

# ETW vs Sysmon Against C2 Servers

Feb 21, 2023

![](https://pentestmag.com/wp-content/uploads/2023/02/image3-4.png)

*by Damon Mohammedbeger*

In this article, I want to talk about my research about ETW and Sysmon and how I can use these events for detection against C2 servers like Cobalt Strike, PoshC2, Sliver and, as always, Metasploit.

So, as a pentester and security researcher, I tried to work on the Blue-Team side (defensive approach) with my own offensive experience, etc.

In this article, I will talk about these things (which was some of my researches from two years ago about detection with a Blue-Teaming approach):

1. **My own tools created with C# for monitoring ETW/Sysmon Events (Real-time) and how can Detect Remote-Thread-Injection Attack via ETW/Sysmon Events to Detect Malware/backdoor or C2 Client Process also Detecting their Traffic!**
   1. ETW vs Sysmon against Cobalt Strike
   2. ETW vs Sysmon against PoshC2
   3. ETW vs Sysmon against Sliver
   4. ETW vs Sysmon against Metasploit &‌ talk about some bugs or problems I saw in my tools when as defender you want to use ETW or Sysmon.
2. **Using ETW VirtualMemAlloc Events for Detection**
   1. PE MZ bytes Detection via Memory Scanner tool which made by C# and this memory scanner works based on ETW VirtualMemAlloc events.

Before I begin, I want to talk about 2017, because since 2016/2017 I started to work....

Read the rest of this story with a free account.

Login
Login with facebook
Login
Login with google

Sign up with Google
Sign up with Facebook
[Sign up with email](https://pentestmag.com/signup?pid=322660)

Already have an account? [Sign in](#login)

March 1, 2023

#### Author

![](https://pentestmag.com/wp-content/uploads/2016/02/765-default-avatar-150x150.png)

Bruno Zwierz

##### Latest Articles

* [![](https://pentestmag.com/wp-content/uploads/2023/02/windows-privilege-escalation-thumbnail-150x150.webp)[Official](https://pentestmag.com/category/official/)](https://pentestmag.com/windows-privilege-escalation-the-concepts-of-hijacking-execution-flow/)February 22, 2023[Windows Privilege Escalation: The Concepts of Hijacking Execution Flow](https://pentestmag.com/windows-privilege-escalation-the-concepts-of-hijacking-execution-flow/)
* [![Building Intuition into Monitoring for OT/ICS Security](https://pentestmag.com/wp-content/plugins/vk-post-author-display/assets/images/thumbnailDummy.jpg)[Official](https://pentestmag.com/category/official/)](https://pentestmag.com/building-intuition-into-monitoring-for-ot-ics-security/)February 22, 2023[Building Intuition into Monitoring for OT/ICS Security](https://pentestmag.com/building-intuition-into-monitoring-for-ot-ics-security/)
* [![](https://pentestmag.com/wp-content/uploads/2023/02/images-1-150x150.jpeg)[Official](https://pentestmag.com/category/official/)](https://pentestmag.com/wifi-pentesting-with-airodump-ng/)February 22, 2023[WiFi Pentesting with Airodump-ng](https://pentestmag.com/wifi-pentesting-with-airodump-ng/)
* [![](https://pentestmag.com/wp-content/uploads/2023/02/image3-4-150x150.png)[Official](https://pentestmag.com/category/official/)](https://pentestmag.com/etw-vs-sysmon-against-c2-servers/)February 21, 2023[ETW vs Sysmon Against C2 Servers](https://pentestmag.com/etw-vs-sysmon-against-c2-servers/)

Subscribe

[Login](https://pentestmag.com/wp-login.php?redirect_to=https%3A%2F%2Fpentestmag.com%2Fetw-vs-sysmon-against-c2-servers%2F)

Notify of

new follow-up comments
new replies to my comments

![guest](https://secure.gravatar.com/avatar/94e56abe6bf7e2f4f4a6b8480f8f264b188040f80e30d3355f4245512e95cfc8?s=56&r=x)

Label

{}
[+]

Name\*

WebSite URL

[ ]

[ ]
I agree to the [Terms](/terms-and-conditions/) and [Privacy Policy](/privacy-policy/)

The comment form collects your name, email and content to allow us keep track of the comments placed on the website. Please read and accept our website Terms and Privacy Policy to post a comment.

Δ

![guest](https://secure.gravatar.com/avatar/71429a1233838b3b01ef586cd31ad6246334236d5b6cd0168f4d13a1eb21bb1b?s=56&r=x)

Label

{}
[+]

Name\*

WebSite URL

[ ]

[ ]
I agree to the [Terms](/terms-and-conditions/) and [Privacy Policy](/privacy-policy/)

The comment form collects your name, email and content to allow us keep track of the comments placed on the website. Please read and accept our website Terms and Privacy Policy to post a comment.

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

5 Comments

Newest

Oldest
Most Voted

Inline Feedbacks

View all comments

![Rowanl Lebsackl](https://secure.gravatar.com/avatar/0a5baf82b5d58492d43dce9cb8963beea91208a1438949cc8b932b71249afa24?s=64&r=x)

Rowanl Lebsackl

10 months ago

This article gives great insights into using ETW and Sysmon for detecting C2 servers. [Papa’s pizzeria](https://papaspizzeriagame.com)

0

Reply

![Nelson Fahey](https://secure.gravatar.com/avatar/3b7948f11e3d6d0110426d519314c6296e66d811608549a93713c468b5b11bed?s=64&r=x)

Nelson Fahey

10 months ago

This article on ETW vs Sysmon for detecting C2 servers is incredibly insightful for both security professionals and researchers. It’s great to see the offensive and defensive sides come together. Kind of like [Retro Bowl](https://retrobowl-game.io/) — strategy and execution make all the difference!

0

Reply

![io games](https://secure.gravatar.com/avatar/c3633ac2f93271f786203fc958b71ad6df059944eda6d0c332d47382fc3570ad?s=64&r=x)

[io games](https://iogamess.io/)

1 year ago

I will learn this knowledge gradually

0

Reply

![Joseph2222](https://secure.gravatar.com/avatar/89d8526d4e65cc1d9147739ec7edff51578e1492b9e91604e31212843ed47938?s=64&r=x)

Joseph2222

1 year ago

Just snagged my presentation from this service, and it’s a total win! No more last-minute stress or slides struggle. Buy presentation – <https://studyfy.com/service/buy-presentation> The design is on point, and the content? Epic. If you’re done with the presentation chaos, this is your go-to. Seriously, check it out – smooth presentations for the win!

0

Reply

![fnaf12](https://secure.gravatar.com/avatar/3e4fe318f9aa518a99f7d8cb69157d8ab014659dc4117d7d385578c68c1424a9?s=64&r=x)

fnaf12

2 years ago

I encourage you to participate in [poppy playtime](https://poppy-playtime.io/) whenever you get the chance. This is a wonderful activity for relieving tension and unwinding after a long day.

0

Reply

[Get unlimited access](https://pentestmag.com/levels-page/)

#### Join Us

[Become an Instructor](https://pentestmag.com/become-instructor/)

[Become a Reviewer](https://pente...