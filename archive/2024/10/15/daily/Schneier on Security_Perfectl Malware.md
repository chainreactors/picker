---
title: Perfectl Malware
url: https://www.schneier.com/blog/archives/2024/10/perfectl-malware.html
source: Schneier on Security
date: 2024-10-15
fetch_date: 2025-10-06T18:54:42.913532
---

# Perfectl Malware

# [Schneier on Security](https://www.schneier.com/)

Menu

* [Blog](https://www.schneier.com)
* [Newsletter](https://www.schneier.com/crypto-gram/)
* [Books](https://www.schneier.com/books/)
* [Essays](https://www.schneier.com/essays/)
* [News](https://www.schneier.com/news/)
* [Talks](https://www.schneier.com/talks/)
* [Academic](https://www.schneier.com/academic/)
* [About Me](https://www.schneier.com/blog/about/)

### Search

*Powered by [DuckDuckGo](https://duckduckgo.com/)*

Blog

Essays

Whole site

### Subscribe

[![Atom](https://www.schneier.com/wp-content/uploads/2019/10/rss-32px.png)](https://www.schneier.com/feed/atom/)[![Facebook](https://www.schneier.com/wp-content/uploads/2019/10/facebook-32px.png)](https://www.facebook.com/bruce.schneier)[![Twitter](https://www.schneier.com/wp-content/uploads/2019/10/twitter-32px.png)](https://twitter.com/schneierblog)[![Email](https://www.schneier.com/wp-content/uploads/2019/10/email-32px.png)](https://www.schneier.com/crypto-gram)

[Home](https://www.schneier.com)[Blog](https://www.schneier.com/blog/archives/)

## Perfectl Malware

Perfectl in an [impressive piece](https://arstechnica.com/security/2024/10/persistent-stealthy-linux-malware-has-infected-thousands-since-2021/) of malware:

> The malware has been circulating since at least 2021. It gets installed by exploiting more than 20,000 common misconfigurations, a capability that may make millions of machines connected to the Internet potential targets, researchers from Aqua Security said. It can also exploit CVE-2023-33246, a vulnerability with a severity rating of 10 out of 10 that was patched last year in Apache RocketMQ, a messaging and streaming platform that’s found on many Linux machines.
>
> The researchers are calling the malware Perfctl, the name of a malicious component that surreptitiously mines cryptocurrency. The unknown developers of the malware gave the process a name that combines the perf Linux monitoring tool and ctl, an abbreviation commonly used with command line tools. A signature characteristic of Perfctl is its use of process and file names that are identical or similar to those commonly found in Linux environments. The naming convention is one of the many ways the malware attempts to escape notice of infected users.
>
> Perfctl further cloaks itself using a host of other tricks. One is that it installs many of its components as rootkits, a special class of malware that hides its presence from the operating system and administrative tools. Other stealth mechanisms include:
>
> * Stopping activities that are easy to detect when a new user logs in* Using a Unix socket over TOR for external communications* Deleting its installation binary after execution and running as a background service thereafter* Manipulating the Linux process pcap\_loop through a technique known as hooking to prevent admin tools from recording the malicious traffic* Suppressing mesg errors to avoid any visible warnings during execution.
>
> The malware is designed to ensure persistence, meaning the ability to remain on the infected machine after reboots or attempts to delete core components. Two such techniques are (1) modifying the ~/.profile script, which sets up the environment during user login so the malware loads ahead of legitimate workloads expected to run on the server and (2) copying itself from memory to multiple disk locations. The hooking of pcap\_loop can also provide persistence by allowing malicious activities to continue even after primary payloads are detected and removed.
>
> Besides using the machine resources to mine cryptocurrency, Perfctl also turns the machine into a profit-making proxy that paying customers use to relay their Internet traffic. Aqua Security researchers have also observed the malware serving as a backdoor to install other families of malware.

Something this complex and impressive implies that a government is behind this. North Korea is the government we know that hacks cryptocurrency in order to fund its operations. But this feels too complex for that. I have no idea how to attribute this.

Tags: [attribution](https://www.schneier.com/tag/attribution/), [cryptocurrency](https://www.schneier.com/tag/cryptocurrency/), [hacking](https://www.schneier.com/tag/hacking/), [Linux](https://www.schneier.com/tag/linux/), [malware](https://www.schneier.com/tag/malware/)

[Posted on October 14, 2024 at 7:06 AM](https://www.schneier.com/blog/archives/2024/10/perfectl-malware.html) •
[8 Comments](https://www.schneier.com/blog/archives/2024/10/perfectl-malware.html#comments)

### Comments

321 •
[October 14, 2024 8:29 AM](https://www.schneier.com/blog/archives/2024/10/perfectl-malware.html/#comment-441113)

/Perfectl/Perfctl/

Andy •
[October 14, 2024 9:33 AM](https://www.schneier.com/blog/archives/2024/10/perfectl-malware.html/#comment-441115)

This looks like a “slow and steady” approach to continuously minting money. Are only governments capable of long-term thinking and planning though?

Who? •
[October 14, 2024 11:48 AM](https://www.schneier.com/blog/archives/2024/10/perfectl-malware.html/#comment-441119)

> *Using a Unix socket over TOR for external communications*

…I feel proud when using a Unix socket over ssh(1) to connect to a service running on the loopback interface of a remote server.

Seriously, we should develop a tool that checks for common misconfigurations, just like Perfectl does. We actually have an impressive set of tools that check for outdated/vulnerable software tools running on our systems or software projects source code repositories (see OSV scanner for a good example of the latter) but nothing, up to my [limited] knowledge, to check for mistakes in configurations.

frankie •
[October 14, 2024 1:21 PM](https://www.schneier.com/blog/archives/2024/10/perfectl-malware.html/#comment-441123)

> Using a Unix socket over TOR for external communications

This doesn’t really make sense. I guess they could open Unix-domain sockets at the client and server, and “bridge” them over Tor. But I’m wondering if they meant “Using Tor over a Unix socket” (and then Tor would still be using IP to connect outward, because Unix-domain sockets don’t work across the internet; and, by the way, Tor’s name hasn’t used all-capital letters for like 20 years, if it ever did).

Anyway, despite being described as “stealthy”, modifying ~/.profile is pretty damn lame. “git status” would show that right away on my system, because they don’t seem to have hooked git. Also, people do edit that file, and it’s fairly short by default (on Debian anyway), so it’d probably be pretty obvious.

I imagine ~/.bash\_logout or ~/.dircolors would be much less likely to be looked at. Then there’s .bashrc, would is long and dense enough that such an addition might go un-noticed. If the malware could add a file to /etc/bash\_completion.d, it could blend in with all the cruft found there, and might have a better chance of escaping “git”. Of course, one could drop a “git” wrapper script into ~/.local/bin, which will be automatically added to $PATH if it exists, to solve that problem. Hooking a well-used command such as “cat” could also effect persistence without modifying the startup files.

Steve •
[October 14, 2024 6:46 PM](https://www.schneier.com/blog/archives/2024/10/perfectl-malware.html/#comment-441131)

Is it **perfectl** or **perfctl**?

JohnB •
[October 14, 2024 9:54 PM](https://www.schneier.com/blog/archives/2024/10/perfectl-malware.html/#comment-441134)

What about this makes it too complicated for an organized criminal group?

James D •
[October 15, 2024 12:37 PM](https://www.schneier.com/blog/archives/2024/10/perfectl-malware.html/#comment-441150)

But once (or since) one of these have been found, would it not be possible to find more about the maker by following the wallets it send the mined crypto to?

James •
[October 17, 2024 7:59 AM](https://www.schneier.com/blog/archives/2024/10/perfectl-malware.html/#comment-441187)

“Using a Unix so...