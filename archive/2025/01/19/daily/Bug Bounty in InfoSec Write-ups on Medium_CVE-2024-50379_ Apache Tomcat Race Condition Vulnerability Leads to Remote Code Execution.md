---
title: CVE-2024-50379: Apache Tomcat Race Condition Vulnerability Leads to Remote Code Execution
url: https://infosecwriteups.com/cve-2024-50379-apache-tomcat-race-condition-vulnerability-leads-to-remote-code-execution-6b3291780d65?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2025-01-19
fetch_date: 2025-10-06T20:08:44.266071
---

# CVE-2024-50379: Apache Tomcat Race Condition Vulnerability Leads to Remote Code Execution

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6b3291780d65&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fcve-2024-50379-apache-tomcat-race-condition-vulnerability-leads-to-remote-code-execution-6b3291780d65&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fcve-2024-50379-apache-tomcat-race-condition-vulnerability-leads-to-remote-code-execution-6b3291780d65&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-6b3291780d65---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-6b3291780d65---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# **CVE-2024-50379: Apache Tomcat Race Condition Vulnerability Leads to Remote Code Execution**

[![Bash Overflow](https://miro.medium.com/v2/resize:fill:64:64/1*JoM8_WC11wsYSOwkJ1oqxQ.png)](https://bashoverflow.com/?source=post_page---byline--6b3291780d65---------------------------------------)

[Bash Overflow](https://bashoverflow.com/?source=post_page---byline--6b3291780d65---------------------------------------)

6 min read

·

Dec 28, 2024

--

Listen

Share

**[Write-up] CVE-2024-50379: Apache Tomcat Race Condition POC - RCE Tested on Local Lab**.

## Introduction

Apache Tomcat is an open-source web server and servlet container developed by the Apache Software Foundation (ASF). It is designed to execute Java-based web applications, providing a “pure Java” HTTP server environment for running Java Servlets, JavaServer Pages (JSP), and other Java-based web technologies.

Press enter or click to view image in full size

![CVE-2024–50379 Apache Tomcat Race Condition RCE POC | Bashoverflow | Medium]()

At its core, Tomcat serves as a bridge between Java code and web browsers, enabling developers to create dynamic and interactive web applications. Its robust architecture and active community support make it a popular choice for developers who require flexibility and scalability.

> **Disclaimer**:
> The techniques and information described in this document are intended solely for educational purposes and to enhance understanding of security vulnerabilities within a controlled **Local Lab Environment**. All activities discussed in this document were conducted in a local lab setting. Unauthorized application of these methods outside approved environments is strictly prohibited, as it is illegal, unethical, and may result in severe legal and personal consequences.
>
> The author disclaims all responsibility for any misuse of the information provided. It is the sole responsibility of the reader to ensure their actions comply with all applicable laws and ethical guidelines. The author strongly emphasizes the importance of acting responsibly and refraining from engaging in any activity that exploits vulnerabilities or compromises the safety, privacy, or integrity of systems and individuals.

## Table of Contents

1. [**Summary of the Vulnerability**](#b037)
2. [**Affected Versions**](#a6a4)
3. [**Requirements**](#8a95)
4. [**Steps to Reproduce & Proof of Concept (POC)**](#a219)
5. [**Impact**](#971b)
6. [**Mitigation**](#3676)

### **Summary of the Vulnerability**

CVE-2024-50379 is a recently disclosed vulnerability affecting Apache Tomcat, a popular open-source Java web server and servlet container. This flaw arises from a **Race Condition** within Tomcat’s file handling processes, particularly during JavaServer Pages (JSP) compilation. On case-insensitive file systems, the vulnerability enables attackers to exploit a **Time-of-Check to Time-of-Use (TOCTOU)** condition, potentially allowing malicious files to be executed as JSPs.

### Affected Versions

The following versions of Apache Tomcat are affected by this vulnerability:

* Version 9.0.0.M1 ≤ Apache Tomcat < 9.0.98
* Version 10.1.0-M1 ≤ Apache Tomcat < 10.1.34
* Version 11.0.0-M1 ≤ Apache Tomcat < 11.0.2

### **Requirements**

Below are the specific requirements and condition used to test this vulnerability in my local lab:

* Vmware Workstation 17
* Windows 10 64-bit
* Java (JDK) 11
* Apache Tomcat version 10.1.33
* Burp Suite Community Edition with Turbo Intruder Extension installed
* Specific configuration changes in Apache Tomcat (Refer to the POC section)

### **Steps to Reproduce & Proof of Concept (POC)**

1. Set up a virtual machine with Windows 10 64-bit installed

2. Install Java (JDK) and Apache Tomcat version 10.1.33, then Start your Tomcat server

Press enter or click to view image in full size

![running vulnerable apache tomcat]()

3. Install the Turbo Intruder Extension in Burp Suite. This can be done by selecting `Extension` Tab and choosing the`BApp Store`

Press enter or click to view image in full size

![burp suite extension]()

Press enter or click to view image in full size

![install turbo intruder]()

4. Update the configuration to meet the vulnerability criteria.
➟ Open `conf\web.xml`
➟ Find the `<servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>`
➟ Add the `readonly` parameter set to `false`

```
  <servlet>
        <servlet-name>default</servlet-name>
        <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>
        <init-param>
            <param-name>debug</param-name>
            <param-value>0</param-value>
        </init-param>
        <init-param>
            <param-name>listings</param-name>
            <param-value>false</param-value>
        </init-param>
        <init-param>
            <param-name>readonly</param-name>
            <param-value>false</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
```

Press enter or click to view image in full size

![edit apache tomcat conf web.xml file]()

7. Restart the server to apply the changes

8. Open a browser and navigate to`http://<your_ip>:8080/`. In my lab, I used`<http://tomcatlab.local:8080/>`

Press enter or click to view image in full size

![apache tomcat version 10.1.33]()

9. Observe the requests in Burp Suite’s history. Right-click on a request and choose **Send to Repeater**

Press enter or click to view image in full size

![burp suite send request to repeater]()

10. In Repeater, right-click and select `Extensions` → `Turbo Intruder` →`Send to turbo intruder`

Press enter or click to view image in full size

![burp suite send request to turbo intruder]()

12. Use a Turbo Intruder script and then click **Attack**

```
# Turbo Intruder (CVE-2024-50379)

def queueRequests(target, wordlists):
    engine = RequestEngine(endpoint=target.e...