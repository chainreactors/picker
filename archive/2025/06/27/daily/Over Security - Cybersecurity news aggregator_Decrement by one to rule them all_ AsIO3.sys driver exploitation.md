---
title: Decrement by one to rule them all: AsIO3.sys driver exploitation
url: https://blog.talosintelligence.com/decrement-by-one-to-rule-them-all/
source: Over Security - Cybersecurity news aggregator
date: 2025-06-27
fetch_date: 2025-10-06T22:56:49.368374
---

# Decrement by one to rule them all: AsIO3.sys driver exploitation

# Cisco Talos Blog

[ ]

* [Intelligence Center](https://talosintelligence.com/reputation)

  [ ]

  + [# Intelligence Center](https://talosintelligence.com/reputation)
  + BACK
  + [Intelligence Search](https://talosintelligence.com/reputation_center)
  + [Email & Spam Trends](https://talosintelligence.com/reputation_center/email_rep)
* [Vulnerability Research](https://talosintelligence.com/vulnerability_info)

  [ ]

  + [# Vulnerability Research](https://talosintelligence.com/vulnerability_info)
  + BACK
  + [Vulnerability Reports](https://talosintelligence.com/vulnerability_reports)
  + [Microsoft Advisories](https://talosintelligence.com/ms_advisories)
* [Incident Response](https://talosintelligence.com/incident_response)

  [ ]

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](https://talosintelligence.com/incident_response/services#reactive-services)
  + [Proactive Services](https://talosintelligence.com/incident_response/services#proactive-services)
  + [Emergency Support](https://talosintelligence.com/incident_response/contact)
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  [ ]

  # Security Resources

  + BACK

  Security Resources
  + [Open Source Security Tools](https://talosintelligence.com/software)
  + [Intelligence Categories Reference](https://talosintelligence.com/categories)
  + [Secure Endpoint Naming Reference](https://talosintelligence.com/secure-endpoint-naming)
* Media

  [ ]

  # Media

  + BACK

  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](https://talosintelligence.com/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](https://talosintelligence.com/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  [ ]

  # Company

  + BACK

  Company
  + [About Talos](https://talosintelligence.com/about)
  + [Careers](https://talosintelligence.com/careers)

# Decrement by one to rule them all: AsIO3.sys driver exploitation

By
[Marcin Noga](https://blog.talosintelligence.com/author/marcin-noga/)

Thursday, June 26, 2025 06:00

[Vulnerability Deep Dive](https://blog.talosintelligence.com/category/vulnerability-deep-dive/)
[vulnerability](https://blog.talosintelligence.com/category/vulnerability/)

## Introduction

Armoury Crate and AI Suite are applications used to manage and monitor ASUS motherboards and related components such as the processor, RAM or the increasingly popular RGB lighting. These types of applications often install drivers in the system, which are necessary for direct communication with hardware to configure settings or retrieve critical parameters such as CPU temperature, fan speeds and firmware updates.

Therefore, it is critical to ensure that drivers are well-written with security in mind and designed such that access to the driver interfaces are limited only to certain services and administrators.

![](https://blog.talosintelligence.com/content/images/2025/06/image5.png)

**Figure 1. Armoury Crate application.**

During the audit of the code and components related to the aforementioned applications, Cisco Talos discovered two critical vulnerabilities in the AsIO3.sys driver. Both vulnerabilities were discovered in the IRP\_MJ\_CREATE handler:

* [CVE-2025-1533/TALOS-2025-2144 – Asus Armoury Crate AsIO3.sys stack-based buffer overflow vulnerability](https://talosintelligence.com/vulnerability_reports/TALOS-2025-2144)
* [CVE-2025-3464/TALOS-2025-2150 – Asus Armoury Crate AsIO3.sys authorization bypass vulnerability](https://talosintelligence.com/vulnerability_reports/TALOS-2025-2150)

The first vulnerability is a stack-based buffer overflow that occurs during the process's ImagePath conversion from "Win32 Path" to "NT Namespace Path”.

The second vulnerability allowed bypassing the authorization mechanism implemented in the driver, granting access to its functionality not just to the intended service but to any user. With access to a security-critical function within this driver, I successfully developed a fully working exploit that escalates local user privileges to “NT SYSTEM”, which we describe in detail below.

Please keep in mind that I discovered this exploit before the Windows 11 24H2 update arrived. This update prevents regular users from leaking information such as loaded kernel modules and their addresses via “NtQuerySystemInformation.” This is discussed in further detail below.

## Recon phase

While looking for drivers installed alongside the Armoury Crate software, I noticed two related to ASUS in the DriverView list.

![](https://blog.talosintelligence.com/content/images/2025/06/image31.png)

**Figure 2. Screenshot presenting driver entries belonging to ASUSTek Computer Inc.**

Focusing on AsIO3.sys, I investigated whether this driver creates any devices and, most importantly, whether a regular user can communicate with such a device.

### Obtaining a handle to the Asusgio3

Using DeviceTree, we can see the following encouraging picture:

![](https://blog.talosintelligence.com/content/images/2025/06/image27.png)

**Figure 3. DeviceTree incorrectly displays that the group “everyone” has full access to the Asusgio3 device.**

The AsIO3.sys driver creates the Asusgio3 device, which nearly everyone in the system has full access to. After a quick check with a simple code that attempts to open a handle to the device, I got the error code:
 “5 == ERROR\_ACCESS\_DENIED”.

![](https://blog.talosintelligence.com/content/images/2025/06/image4.png)

**Figure 4. Part of PoC code responsible for opening a handle to the Asusgio3 device.**

This was unexpected based on the DeviceTree interface, so I re-checked the privileges to that device using Sysinternals “accesschk” and got completely opposite results.

![](https://blog.talosintelligence.com/content/images/2025/06/image25.png)

**Figure 5. Checking permissions for Asusgio3 with “accesschk”.**

Which is the truth? To find out, I reversed fragments in the AsIO3 driver responsible for handling the “IRP\_MJ\_CREATE” request.

### Analyzing “IRP\_MJ\_CREATE” handler

By loading the driver and beginning the reversing process, we see a single function handles IRP requests for three different request types.

![](https://blog.talosintelligence.com/content/images/2025/06/image22.png)

**Figure 6. Driver initialization routine where IRP request handlers are assigned to DriverObject.**

Diving into “callback\_irp\_dispatch”, I found a fragment responsible for handling the “IRP CREATE” request:

![](https://blog.talosintelligence.com/content/images/2025/06/image15.png)

**Figure 7. Part of “callback\_irp\_dispatch” function code. Functions’ names have been added by the author.**

### Authorization mechanism

Checking the “ImageHashCheck” function, we can see the following:

![](https://blog.talosintelligence.com/content/images/2025/06/image8.png)

**Figure 8. ImageHashCheck function body.**

Using the API “ZwQueryInformationProcess” with the flag “ProcessImageFileNameWin32” (lines 8 and 19), ASUS developers attempt to obtain the image path (the path to the executable file) of the current process — specifically, the process that is trying to obtain a handle to the device.

Next, in line 26, we see the translation of the path from the “Win32 File Namespace” to the “NT Namespace”. Hold tight — we will return to this line in a moment.

In lines 35-46, there is a typical SHA256 hash calculation for the current process's executable file. In line 47, the calculated hash is compared with a hardcoded hash in the driver, and if they match, the function returns “true”, allowing the process to obtain a handle to the device.

When we dump the hash from the global variable “g\_sha256Hash” (visible on line 47), it appears as follows:

```
pytho...