---
title: Palo Alto Networks 披露复杂网络钓鱼攻击链 Cascading Shadows，企业数据安全岌岌可危
url: https://www.anquanke.com/post/id/306674
source: 安全客-有思想的安全新媒体
date: 2025-04-19
fetch_date: 2025-10-06T22:05:16.888692
---

# Palo Alto Networks 披露复杂网络钓鱼攻击链 Cascading Shadows，企业数据安全岌岌可危

йҰ–йЎө

йҳ…иҜ»

* [е®үе…Ёиө„и®Ҝ](https://www.anquanke.com/news)
* [е®үе…ЁзҹҘиҜҶ](https://www.anquanke.com/knowledge)
* [е®үе…Ёе·Ҙе…·](https://www.anquanke.com/tool)

жҙ»еҠЁ

зӨҫеҢә

еӯҰйҷў

е®үе…ЁеҜјиҲӘ

еҶ…е®№зІҫйҖү

* [дё“ж Ҹ](/column/index.html)
* [зІҫйҖүдё“йўҳ](https://www.anquanke.com/subject-list)
* [е®үе…ЁKERеӯЈеҲҠ](https://www.anquanke.com/discovery)
* [360зҪ‘з»ңе®үе…Ёе‘ЁжҠҘ](https://www.anquanke.com/week-list)

# Palo Alto Networks жҠ«йңІеӨҚжқӮзҪ‘з»ңй’“йұјж”»еҮ»й“ҫ Cascading ShadowsпјҢдјҒдёҡж•°жҚ®е®үе…ЁеІҢеІҢеҸҜеҚұ

йҳ…иҜ»йҮҸ**63706**

еҸ‘еёғж—¶й—ҙ : 2025-04-18 11:24:46

**x**

##### иҜ‘ж–ҮеЈ°жҳҺ

жң¬ж–ҮжҳҜзҝ»иҜ‘ж–Үз« пјҢж–Үз« еҺҹдҪңиҖ… Tushar Subhra DuttaпјҢж–Үз« жқҘжәҗпјҡcybersecuritynews

еҺҹж–Үең°еқҖпјҡ<https://cybersecuritynews.com/threat-actors-using-cascading-shadows-attack-chain/>

иҜ‘ж–Үд»…дҫӣеҸӮиҖғпјҢе…·дҪ“еҶ…е®№иЎЁиҫҫд»ҘеҸҠеҗ«д№үеҺҹж–ҮдёәеҮҶгҖӮ

2024 е№ҙ 12 жңҲпјҢPalo Alto Networks зҡ„ Unit 42з ”з©¶дәәе‘ҳеҸ‘зҺ°дәҶдёҖеңәеӨҚжқӮзҡ„зҪ‘з»ңй’“йұјжҙ»еҠЁпјҢиҜҘжҙ»еҠЁеҲ©з”ЁдәҶдёҖжқЎиў«з§°дёә вҖңCascading ShadowsвҖқ зҡ„еӨҡеұӮж”»еҮ»й“ҫгҖӮ

иҝҷеңәжҙ»еҠЁйҖҡиҝҮдёҖзі»еҲ—зІҫеҝғи®ҫи®Ўзҡ„зўҺзүҮеҢ–йҳ¶ж®өпјҢжқҘдј ж’ӯиҜёеҰӮ Agent TeslaгҖҒRemcosRAT е’Ң XLoaderВ  зӯүжҒ¶ж„ҸиҪҜд»¶е®¶ж—ҸпјҢе…¶зӣ®зҡ„жҳҜз»•иҝҮдј з»ҹзҡ„е®үе…Ёе·Ҙе…·пјҢе№¶дҪҝеҸ–иҜҒеҲҶжһҗеҸҳеҫ—еӨҚжқӮгҖӮ

ж”»еҮ»иҖ…дҪҝз”ЁдәҶдјӘиЈ…жҲҗи®ўеҚ•еҸ‘еёғиҜ·жұӮзҡ„ж¬әйӘ—жҖ§з”өеӯҗйӮ®д»¶пјҢиҜұйӘ—еҸ—е®іиҖ…жү“ејҖжҒ¶ж„Ҹзҡ„.7z еҺӢзј©еӯҳжЎЈйҷ„д»¶гҖӮдёҖж—Ұиў«жҝҖжҙ»пјҢж„ҹжҹ“й“ҫдјҡйҖҡиҝҮ JavaScript зј–з ҒпјҲ.jseпјүж–Үд»¶гҖҒPowerShell и„ҡжң¬йҖҗжӯҘжҺЁиҝӣпјҢжңҖз»Ҳд»Ҙ.NET жҲ– AutoIt зј–иҜ‘зҡ„еҸҜжү§иЎҢж–Үд»¶е°ҶжңҖз»Ҳзҡ„жңүж•ҲиҪҪиҚ·жіЁе…ҘеҲ°еҗҲжі•зҡ„зі»з»ҹиҝӣзЁӢдёӯгҖӮ

жӯӨж¬Ўж”»еҮ»зҡ„жЁЎеқ—еҢ–и®ҫи®ЎзЎ®дҝқдәҶд»»дҪ•дёҖдёӘйҳ¶ж®өйғҪдёҚдјҡжҡҙйңІе…¶е®Ңж•ҙзҡ„жҒ¶ж„Ҹж„ҸеӣҫгҖӮжңҖеҲқзҡ„зҪ‘з»ңй’“йұјз”өеӯҗйӮ®д»¶йҖҡеёёз”Ёе…ӢзҪ—ең°дәҡиҜӯж’°еҶҷпјҢеҶ’е……еҗҲжі•зҡ„е•ҶдёҡйҖҡдҝЎпјҢеҰӮд»ҳж¬ҫзЎ®и®ӨжҲ–и®ўеҚ•е®Ўж ёгҖӮ

жүҖйҷ„зҡ„.7z еӯҳжЎЈдёӯеҢ…еҗ«дёҖдёӘдјӘиЈ…жҲҗж–ҮжЎЈзҡ„.jse ж–Үд»¶пјҲдҫӢеҰӮпјҢdoc00290320092.jseпјүгҖӮеҪ“иҜҘи„ҡжң¬иў«жү§иЎҢж—¶пјҢе®ғдјҡд»ҺиҜёеҰӮ files.catbox [.] moe зӯүеҹҹеҗҚдёӢиҪҪдёҖдёӘ PowerShell жңүж•ҲиҪҪиҚ·пјҢйҡҸеҗҺиҜҘжңүж•ҲиҪҪиҚ·дјҡжЈҖзҙўдёҖдёӘ.NET жҲ– AutoIt йҮҠж”ҫеҷЁгҖӮ

иҝҷз§Қжү§иЎҢи·Ҝеҫ„дёҠзҡ„еҲҶеҸүжҳҜ Cascading Shadows ж”»еҮ»й“ҫзҡ„дёҖдёӘжҳҫи‘—зү№еҫҒ вҖ”вҖ” йҖҡиҝҮе…Ғи®ёж”»еҮ»иҖ…еҠЁжҖҒеҲҮжҚўжңүж•ҲиҪҪиҚ·пјҢжҸҗй«ҳдәҶе…¶жҠөеҫЎжЈҖжөӢзҡ„иғҪеҠӣгҖӮ

Palo Alto Networks зҡ„еҲҶжһҗеёҲжҢҮеҮәпјҢиҝҷеңәжҙ»еҠЁеҜ№иҝӣзЁӢз©әжҙһеҢ–жҠҖжңҜзҡ„дҫқиө–дҪҝе…¶жңүеҲ«дәҺдј з»ҹзҡ„жҒ¶ж„ҸиҪҜд»¶дј ж’ӯж–№жі•гҖӮ

йҖҡиҝҮе°Ҷи§ЈеҜҶеҗҺзҡ„ shellcode жіЁе…ҘеҲ°еғҸ RegAsm.exe жҲ– RegSvcs.exe иҝҷж ·еҸ—дҝЎд»»зҡ„иҝӣзЁӢдёӯпјҢжҒ¶ж„ҸиҪҜд»¶еҫ—д»ҘдјӘиЈ…жҲҗеҗҲжі•зҡ„ Microsoft е®һз”ЁзЁӢеәҸжқҘиҝҗиЎҢгҖӮ

иҝҷз§ҚжҠҖжңҜпјҢеҶҚеҠ дёҠж—©жңҹйҳ¶ж®өжһҒе°‘зҡ„ж··ж·ҶеӨ„зҗҶпјҢдҪҝеҫ—ж”»еҮ»й“ҫиғҪеӨҹеңЁдҝқжҢҒж“ҚдҪңзҒөжҙ»жҖ§зҡ„еҗҢж—¶пјҢйҖғйҒҝжІҷз®ұеҲҶжһҗгҖӮ

е°Ҫз®Ўе…¶еҚҒеҲҶеӨҚжқӮпјҢдҪҶ Advanced WildFire зҡ„еҶ…еӯҳжү«жҸҸеҠҹиғҪжҲҗеҠҹиҜҶеҲ«еҮәдәҶжүҖжңүйҳ¶ж®өпјҢиҝҷеҮёжҳҫдәҶиЎҢдёәжЈҖжөӢеңЁеҜ№жҠ—еҲҶеұӮеЁҒиғҒж–№йқўзҡ„йҮҚиҰҒжҖ§гҖӮ

****AutoIt жү§иЎҢи·Ҝеҫ„пјҡдёҖз§ҚйҖғйҒҝжЈҖжөӢзҡ„жүӢж®ө****

иҝҷеңәжҙ»еҠЁжңҖе…·еҲӣж–°жҖ§зҡ„ж–№йқўд№ӢдёҖжҳҜе…¶еҜ№ AutoIt зј–иҜ‘зҡ„еҸҜжү§иЎҢж–Үд»¶зҡ„дҪҝз”ЁпјҢиҝҷеңЁзҺ°д»ЈжҒ¶ж„ҸиҪҜд»¶дј ж’ӯдёӯжҳҜдёҖз§ҚдёҚеӨӘеёёи§Ғзҡ„ж–№жі•гҖӮ

AutoIt жҳҜдёҖз§Қз”ЁдәҺиҮӘеҠЁеҢ– Windows еӣҫеҪўз”ЁжҲ·з•ҢйқўпјҲGUIпјүдәӨдә’зҡ„и„ҡжң¬иҜӯиЁҖпјҢеңЁиҝҷйҮҢиў«йҮҚж–°еҲ©з”ЁжқҘи§ЈеҜҶе’Ңжү§иЎҢ shellcodeгҖӮ

AutoIt дәҢиҝӣеҲ¶ж–Үд»¶дёӯзҡ„и„ҡжң¬пјҲдҫӢеҰӮпјҢc93e37e35c4c7f767a5bdab8341d8c2351edb769a41b0c9c229c592dbfe14ff2пјүеҢ…еҗ«дёҖдёӘеҠ еҜҶзҡ„жңүж•ҲиҪҪиҚ·пјҢе®ғдјҡеҠЁжҖҒи§Јжһҗ APIпјҲеә”з”ЁзЁӢеәҸзј–зЁӢжҺҘеҸЈпјүи°ғз”ЁжқҘйҖғйҒҝйқҷжҖҒеҲҶжһҗгҖӮ

иҜҘи„ҡжң¬дјҡеңЁе°Ҷи§ЈеҜҶеҗҺзҡ„ shellcode жіЁе…ҘеҲ° RegSvcs.exe д№ӢеүҚпјҢе…Ҳе°Ҷе…¶еҶҷе…ҘеҶ…еӯҳгҖӮ

Func DecryptPayload()

Local $encrypted = вҖң9A3FвҖҰDAC1вҖқ В ; Truncated AES-encrypted shellcode

Local $key = вҖңB2E8вҖҰF7A9вҖқ

Local $decrypted = \_AES\_Decrypt($encrypted, $key)

Local $process = Run(вҖңRegSvcs.exeвҖқ, вҖңвҖқ, @SW\_HIDE)

\_InjectShellcode($process, $decrypted)

EndFunc

shellcode йҮҮз”ЁдәҶеҸҚе°„ејҸеҠ иҪҪжҠҖжңҜпјҢд»ҘдҫҝеңЁеҶ…еӯҳдёӯжү§иЎҢдёҖдёӘ.NET еҸҜжү§иЎҢж–Үд»¶пјҢд»ҺиҖҢз»•иҝҮеҹәдәҺзЈҒзӣҳзҡ„йҳІз—…жҜ’жү«жҸҸгҖӮ

еңЁдҪҝз”Ё IDA Pro иҝӣиЎҢи°ғиҜ•жңҹй—ҙпјҢз ”з©¶дәәе‘ҳиҝҪиёӘеҲ°дәҶжү§иЎҢжөҒзЁӢеҲ° DLLCALLADDRESS еҮҪж•°пјҢиҜҘеҮҪж•°дјҡи§ЈжһҗиҜёеҰӮ VirtualAlloc е’Ң CreateRemoteThread зӯүе…ій”®зҡ„ API ең°еқҖгҖӮ

иҝҷдҪҝеҫ— shellcode иғҪеӨҹеңЁзӣ®ж ҮиҝӣзЁӢдёӯеҲҶй…ҚеҶ…еӯҳгҖҒеҶҷе…Ҙи§ЈеҜҶеҗҺзҡ„.NET жңүж•ҲиҪҪиҚ·пјҢе№¶еҗҜеҠЁжү§иЎҢ вҖ”вҖ” жүҖжңүиҝҷдәӣж“ҚдҪңйғҪдёҚдјҡеңЁж–Үд»¶зі»з»ҹдёҠз•ҷдёӢд»»дҪ•з—•иҝ№гҖӮ

void ShellcodeMain() {

HMODULE kernel32 = LoadLibraryA(вҖңkernel32.dllвҖқ);

FARPROC virtAlloc = GetProcAddress(kernel32, вҖңVirtualAllocвҖқ);

LPVOID mem = virtAlloc(NULL, 0x1000, MEM\_COMMIT, PAGE\_EXECUTE\_READWRITE);

// и§ЈеҜҶе№¶е°ҶAgent TeslaеҸҳз§ҚеӨҚеҲ¶еҲ°еҶ…еӯҳдёӯ

memcpy(mem, decryptedPayload, payloadSize);

CreateThread(NULL, 0, (LPTHREAD\_START\_ROUTINE)mem, NULL, 0, NULL);

}

жңҖз»Ҳзҡ„жңүж•ҲиҪҪиҚ·жҳҜ Agent Tesla зҡ„дёҖдёӘеҸҳз§ҚпјҢе®ғдјҡйҖҡиҝҮ FTPпјҲж–Үд»¶дј иҫ“еҚҸи®®пјүпјҢдҪҝз”ЁзЎ¬зј–з Ғзҡ„еҮӯжҚ®пјҲдҫӢеҰӮпјҢз”ЁжҲ·еҗҚпјҡkel-bin@jeepcommerce [.] rsпјҢеҜҶз ҒпјҡJhrn) GcpiYQ7пјүе°ҶеҮӯжҚ®жі„йңІеҲ°еғҸ ftp.jeepcommerce [.] rs иҝҷж ·зҡ„жңҚеҠЎеҷЁдёҠгҖӮ

йҖҡиҝҮе°ҶжҜҸдёӘйҳ¶ж®өеҲҶйҡ”ејҖжқҘпјҢе№¶еҲ©з”ЁеҗҲжі•зҡ„е·Ҙе…·пјҢCascading Shadows ж”»еҮ»й“ҫдҪ“зҺ°дәҶзҪ‘з»ңй—ҙи°Қжҙ»еҠЁдёӯ вҖңеҲ©з”ЁзҺ°жңүе·Ҙе…·пјҲliving-off-the-landпјүвҖқ зӯ–з•Ҙж—ҘзӣҠеўһй•ҝзҡ„и¶ӢеҠҝгҖӮ

Unit 42ејәи°ғпјҢе°Ҫз®Ўж”»еҮ»й“ҫй”ҷз»јеӨҚжқӮпјҢдҪҶиҜёеҰӮ Cortex XDR зҡ„иЎҢдёәеЁҒиғҒйҳІжҠӨзӯүйҳІеҫЎжҺӘж–ҪиғҪеӨҹжЈҖжөӢеҲ°иҝӣзЁӢжіЁе…ҘејӮеёёгҖӮеҶҚз»“еҗҲ Advanced WildFire зҡ„еӨҡйҳ¶ж®өеҲҶжһҗпјҢеҗ„з»„з»ҮеҚідҫҝйқўеҜ№дёҚж–ӯжј”еҸҳзҡ„еӨҚжқӮеЁҒиғҒпјҢд№ҹиғҪеӨҹеҜ№е…¶иҝӣиЎҢзј“и§ЈгҖӮ

В

жң¬ж–Үзҝ»иҜ‘иҮӘcybersecuritynews [еҺҹж–Үй“ҫжҺҘ](https://cybersecuritynews.com/threat-actors-using-cascading-shadows-attack-chain/)гҖӮеҰӮиӢҘиҪ¬иҪҪиҜ·жіЁжҳҺеҮәеӨ„гҖӮ

е•ҶеҠЎеҗҲдҪңпјҢж–Үз« еҸ‘еёғиҜ·иҒ”зі» anquanke@360.cn

жң¬ж–Үз”ұ**е®үе…Ёе®ў**еҺҹеҲӣеҸ‘еёғ

иҪ¬иҪҪпјҢиҜ·еҸӮиҖғ[иҪ¬иҪҪеЈ°жҳҺ](https://www.anquanke.com/note/repost)пјҢжіЁжҳҺеҮәеӨ„пјҡ [https://www.anquanke.com/post/id/306674](/post/id/306674)

е®үе…ЁKER - жңүжҖқжғізҡ„е®үе…Ёж–°еӘ’дҪ“

жң¬ж–ҮиҪ¬иҪҪиҮӘ: [cybersecuritynews](https://cybersecuritynews.com/threat-actors-using-cascading-shadows-attack-chain/)

еҰӮиӢҘиҪ¬иҪҪ,иҜ·жіЁжҳҺеҮәеӨ„пјҡ <https://cybersecuritynews.com/threat-actors-using-cascading-shadows-attack-chain/>

е®үе…ЁKER - жңүжҖқжғізҡ„е®үе…Ёж–°еӘ’дҪ“

еҲҶдә«еҲ°пјҡ![еҫ®дҝЎ](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

* [зҪ‘з»ңж”»еҮ»](/tag/%D0%B7%D2%AA%E2%80%98%D0%B7%C2%BB%D2%A3%D0%B6%E2%80%9D%C2%BB%D0%B5%D2%AE%C2%BB)

**+1**4иөһ

ж”¶и—Ҹ

![](https://p0.ssl.qhimg.com/t010857340ce46bb672.jpg)е®үе…Ёе®ў

еҲҶдә«еҲ°пјҡ![еҫ®дҝЎ](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

## еҸ‘иЎЁиҜ„и®ә

жӮЁиҝҳжңӘзҷ»еҪ•пјҢиҜ·е…Ҳзҷ»еҪ•гҖӮ

[зҷ»еҪ•](/login/index.html)

![](https://p5.ssl.qhimg.com/t014757b72460d855bf.png)

[![](https://p0.ssl.qhimg.com/t010857340ce46bb672.jpg)](/member.html?memberId=175868)

[е®үе…Ёе®ў](/member.html?memberId=175868)

иҝҷдёӘдәәеӨӘжҮ’дәҶпјҢзӯҫеҗҚйғҪжҮ’еҫ—еҶҷдёҖдёӘ

* ж–Үз«
* **376**

* зІүдёқ
* **1**

### TAзҡ„ж–Үз«

* ##### [mavinject.exe йҒӯеҲ©з”ЁпјҢй»‘е®ўз»•иҝҮе®үе…ЁйҳІзәҝе…Ҙдҫөзі»з»ҹ](/post/id/306961)

  2025-04-28 10:48:18
* ##### [Docker жғҠзҺ°ж–°еһӢеҠ еҜҶжҢ–зҹҝж”»еҮ»пјҢеҖҹ Teneo е№іеҸ°ејҖиҫҹжҒ¶ж„ҸиҺ·еҲ©ж–°и·Ҝеҫ„](/post/id/306959)

  2025-04-28 10:39:59
* ##### [Cloudflare йҡ§йҒ“йҒӯж»Ҙз”ЁпјҢжҒ¶ж„Ҹ RAT дј ж’ӯеЁҒиғҒеҠ еү§](/post/id/306957)

  2025-04-28 10:34:35
* ##### [xrpl.js еә“йҒӯдҫӣеә”й“ҫж”»еҮ»пјҢи¶… 290 дёҮж¬ЎдёӢиҪҪз”ЁжҲ·з§Ғй’ҘжҲҗзӘғеҸ–зӣ®ж Ү](/post/id/306953)

  2025-04-28 10:29:02
* ##### [жҒ¶ж„ҸеҗҺй—ЁеҖҹ ViPNet жӣҙж–°жё—йҖҸпјҢдҝ„зҪ—ж–ҜеӨҡиЎҢдёҡж•°жҚ®е®үе…ЁжӢүе“ҚиӯҰжҠҘ](/post/id/306951)

  2025-04-28 10:22:13

### зӣёе…іж–Үз«

* ##### [Morteеғөе°ёзҪ‘з»ңиў«жҠ«йңІпјҡжӯЈеҲ©з”Ёи·Ҝз”ұеҷЁдёҺдјҒдёҡеә”з”ЁжјҸжҙһпјҢиҝ…йҖҹжү©еј е…¶вҖңеҠ иҪҪеҷЁеҚіжңҚеҠЎвҖқжҙ»еҠЁ](/post/id/312444)

  2025-09-29 18:04:01
* ##### [AkiraеӢ’зҙўиҪҜд»¶еҲ©з”ЁSonicWall VPNиҙҰжҲ·еҸ‘иө·жҖҘйҖҹе…Ҙдҫө](/post/id/312438)

  2025-09-29 18:03:28
* ##### [DarkCloudдҝЎжҒҜзӘғеҸ–еҷЁзҺ°ж–°еҸҳз§Қпјҡй...