---
title: A Security Vulnerability in the KmsdBot Botnet
url: https://www.schneier.com/blog/archives/2022/12/a-security-vulnerability-in-the-kmsdbot-botnet.html
source: Schneier on Security
date: 2022-12-16
fetch_date: 2025-10-04T01:42:14.800983
---

# A Security Vulnerability in the KmsdBot Botnet

# [Schneier on Security](https://www.schneier.com/)

Menu

* [Blog](https://www.schneier.com)
* [Newsletter](https://www.schneier.com/crypto-gram/)
* [Books](https://www.schneier.com/books/)
* [Essays](https://www.schneier.com/essays/)
* [News](https://www.schneier.com/news/)
* [Talks](https://www.schneier.com/talks/)
* [Academic](https://www.schneier.com/academic/)
* [About Me](https://www.schneier.com/blog/about/)

### Search

*Powered by [DuckDuckGo](https://duckduckgo.com/)*

Blog

Essays

Whole site

### Subscribe

[![Atom](https://www.schneier.com/wp-content/uploads/2019/10/rss-32px.png)](https://www.schneier.com/feed/atom/)[![Facebook](https://www.schneier.com/wp-content/uploads/2019/10/facebook-32px.png)](https://www.facebook.com/bruce.schneier)[![Twitter](https://www.schneier.com/wp-content/uploads/2019/10/twitter-32px.png)](https://twitter.com/schneierblog)[![Email](https://www.schneier.com/wp-content/uploads/2019/10/email-32px.png)](https://www.schneier.com/crypto-gram)

[Home](https://www.schneier.com)[Blog](https://www.schneier.com/blog/archives/)

## A Security Vulnerability in the KmsdBot Botnet

Security researchers [found](https://arstechnica.com/information-technology/2022/12/advanced-botnet-taken-down-by-an-all-too-human-flaw-syntax-error/) a software bug in the KmsdBot cryptomining botnet:

> With no error-checking built in, sending KmsdBot a malformed command­—like its controllers did one day while Akamai was watching­—created a panic crash with an “index out of range” error. Because there’s no persistence, the bot stays down, and malicious agents would need to reinfect a machine and rebuild the bot’s functions. It is, as Akamai notes, “a nice story” and “a strong example of the fickle nature of technology.”

Tags: [botnets](https://www.schneier.com/tag/botnets/), [vulnerabilities](https://www.schneier.com/tag/vulnerabilities/)

[Posted on December 15, 2022 at 7:10 AM](https://www.schneier.com/blog/archives/2022/12/a-security-vulnerability-in-the-kmsdbot-botnet.html) •
[10 Comments](https://www.schneier.com/blog/archives/2022/12/a-security-vulnerability-in-the-kmsdbot-botnet.html#comments)

### Comments

echo •
[December 15, 2022 10:54 AM](https://www.schneier.com/blog/archives/2022/12/a-security-vulnerability-in-the-kmsdbot-botnet.html/#comment-413990)

Humans tend to be full of it hence Akamai’s note on the story and fickle nature of technology which are really two completely separate branches of philosophy. Humans also produce said software and technology. So we have a dialectic between the amateur and the incompetent. What fun!

The bot did what the bot does. It can do nothing else although some wiseguy could come along and comment that the map is not the territory and we’d have to endure an hour long speech on how mathematics and physics and reality are not the same thing.

I’m in a mood today aren’t I?

noop •
[December 15, 2022 3:06 PM](https://www.schneier.com/blog/archives/2022/12/a-security-vulnerability-in-the-kmsdbot-botnet.html/#comment-414009)

Really cool research by the folks at Akamai. It’s rare we get to see a botnet fall flat on its face.

Clive Robinson •
[December 15, 2022 3:54 PM](https://www.schneier.com/blog/archives/2022/12/a-security-vulnerability-in-the-kmsdbot-botnet.html/#comment-414015)

@ ALL,

Re : Development 101

You read,

> *“With no error-checking built in”*

And think “For real!!!?”

As a rough rule of thumb professional educators tend in the early days of a neophyte’s divinations should be centered around

1, Exception handeling

Failure to do so renders the future progres of their work problematic if not void.

However, when “Example Code” goes up on one of those StackExchange type sites, it’s argued that “brevity is best” especially as “the developer should know…”.

Turns out a lot of “Example Code” becomes inadequately tested “production code”, for reasons a lot are aware of…

I guess it’s nice to know the dog craps[1] on the grass both sides of the developer fence.

[1] At one time being a dog poop collector was a proffession of sorts. Turns out “white poop” was nore valuable than other colours of dog poop… So hats are not the only occupational marker where white is prefered to black…

Ted •
[December 15, 2022 4:01 PM](https://www.schneier.com/blog/archives/2022/12/a-security-vulnerability-in-the-kmsdbot-botnet.html/#comment-414016)

Here’s the command that crashed the botnet:

!bigdata <http://www.bitcoin.com443> / 30 3 3 100

Note there’s no space between the web address and the port number. So this mis-formed C2 command did not have the correct number of arguments.

More crucially these bots did not have error handling code or persistence. So a simple typo by the botnet operators emerged as a glorious self-induced botnet knock out.

[Frank Wilhoit](http://broadheath.com) •
[December 15, 2022 6:15 PM](https://www.schneier.com/blog/archives/2022/12/a-security-vulnerability-in-the-kmsdbot-botnet.html/#comment-414022)

What this shows is that even in an environment such as this, where one might expect incentives for competence, those incentives are not effective; and if not here, then where?

Phillip •
[December 16, 2022 1:48 AM](https://www.schneier.com/blog/archives/2022/12/a-security-vulnerability-in-the-kmsdbot-botnet.html/#comment-414042)

Whose panic? I am no “Rustacean” or misanthrope, though any Rust language aficionado might even use the “panic!” macro.

My point? Presumably, the tech is so smooth, one can only panic when ordered to do something “unsafe.”

Arguably, this is humor. However, even deliberate panic is etymologically confusing, lately.

Estelle •
[December 16, 2022 3:54 PM](https://www.schneier.com/blog/archives/2022/12/a-security-vulnerability-in-the-kmsdbot-botnet.html/#comment-414109)

@Clive Robinson,

> As a rough rule of thumb professional educators tend in the early days of a neophyte’s divinations should be centered around
>
> 1, Exception handeling
> 2, Error checking
> 3, Error correction

More important than all of these, I’d say, is to make people think about the ways things could go wrong. It’s an important part of engineering, but many of the people calling themselves software “engineers” have never been near an engineering class. If you’re splitting a string into words, it’s not an “error” (per point 2) to get a string without a space. Accessing a non-existent array index, in some languages, might *be* an error but not return or raise an error or exception. C functions such as strtol() are notoriously difficult to use correctly (set errno=0 first, check for unexpected prefixes, use ‘endptr’ to check that at least one digit was read and there were no unexpected suffixes; also pay attention to the base and the locale, and, if casting the result to a potentially smaller type—because there’s no strtoi()—check for out-of-range values first; and if using the floating-point variants, keep in mind you might get a result that’s not equal to, greater than, or less than the boundary you’re checking against).

Functions that return error codes, or for which the language requires certain exceptions be handled, should be fairly obvious (though people still get it wrong). But then there’s stuff like fwrite(), which is documented to return a short count on error… if the error’s detected, which it might not be till fflush(); or maybe not, because a kernel can cache the data and not indicate failure till fdatasync() or close() (the latter having, till recently, been underspecified by POSIX and therefore impossible to use correctly in multi-threaded code, which is already difficult to get correct; for a brief time, even errno couldn’t be safely used in multi-threaded code). mmap() can make things even more difficult, but if one’s thinking about it, it should be obvious that errors can occur, there must be some unusual mechanism for indicating them, and that such indications could be deferred when writing data. Somehow, a lot of programs get written with no handling for ...