---
title: 【已复现】Apache Tomcat条件竞争致远程代码执行漏洞（CVE-2024-50379）
url: https://mp.weixin.qq.com/s?__biz=MzIwMDk1MjMyMg==&mid=2247492666&idx=1&sn=a650f29da3e91b115518248dd903d28c&chksm=96f7fb57a18072410e958679b3ef73487cd3d6846810b88bc0a0ff67d742354b887785790b04&scene=58&subscene=0#rd
source: 长亭安全应急响应中心
date: 2024-12-19
fetch_date: 2025-10-06T19:38:53.847997
---

# 【已复现】Apache Tomcat条件竞争致远程代码执行漏洞（CVE-2024-50379）

![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/FOh11C4BDicTlsZ2sGl2LPnQl8cpjibcKJF3HGgwugm5FHNSVsOMSsibjQDMqlhD13ykYutJIFd8yuibhvwOIfUiclA/0?wx_fmt=jpeg)

# 【已复现】Apache Tomcat条件竞争致远程代码执行漏洞（CVE-2024-50379）

长亭安全应急响应中心

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/FOh11C4BDicTlsZ2sGl2LPnQl8cpjibcKJBn9ncTNib38zZibvYic3F6lSoZ91ZJ7wYpsibZ5zcCS1wic6RibIe7WFAQdw/640?wx_fmt=jpeg&from=appmsg)

Apache Tomcat 是一个开源的 Java Servlet 容器和 Web 服务器，支持运行 Java Servlet、JavaServer Pages (JSP) 和其他基于 Java 的 Web 应用程序，广泛用于开发和部署企业级 Web 应用。

2024年12月，Apache 官方发布安全补丁修复了 Tomcat 中的一个远程代码执行漏洞。该漏洞导致**非默认配置**下的Tomcat可能会被攻击者利用，建议受影响的用户尽快修复此漏洞。

#

**漏洞描述**

Description

**0****1**

**漏洞成因**

该漏洞源于 Windows 文件系统与 Tomcat 在路径大小写敏感性处理上的不一致。攻击者利用了 Tomcat 路径校验逻辑中的缺陷，通过绕过路径一致性检查，将原本无法解析的文件（如大小写不同的 JSP 文件）转为可解析状态。

当默认 Servlet 的 readonly 参数被设置为 false（非默认配置）并允许使用 PUT 方法上传文件时，攻击者能够上传包含恶意 JSP 代码的文件并通过条件竞争不断发送请求，触发 Tomcat 对其解析和执行，最终实现远程代码执行。

## **漏洞影响**

成功利用该漏洞的攻击者可以实现远程代码执行，控制受影响的服务器，潜在的危害包括数据泄露、系统崩溃，甚至可能被用于传播勒索等恶意软件。

**处置优先级：高**

**漏洞类型：**逻辑漏洞

**漏洞危害等级：**严重

**触发方式：**网络远程

**权限认证要求：**无需权限

**系统配置要求：**非默认配置，需启用HTTP PUT方法，且操作系统为Windows

**用户交互要求：**无需用户交互

**利用成熟度：**POC/EXP已公开

**批量可利用性：**可使用通用 POC/EXP，批量检测/利用

**修复复杂度：**低，官方提供补丁修复方案

**影响版本**

Affects

**02**

```
11.0.0-M1 <= Apache Tomcat < 11.0.2

10.1.0-M1 <= Apache Tomcat < 10.1.34

9.0.0.M1 <= Apache Tomcat < 9.0.98
```

**解决方案**

Solution

**03**

##

## **临时缓解方案**

1. 根据业务需求评估，将 conf/web.xml文件中的 readOnly 参数设置为 true 或注释该参数，禁用 PUT 方法并重启 Tomcat 服务以使配置生效，从而临时规避该安全风险。

2. 使用WAF等防护设备对目标系统进行防护，拦截包含恶意代码的文件上传请求。

3. 如非必要，避免将相关资产直接暴露在互联网上。

## **升级修复方案**

Apache 官方已发布安全通告并发布了修复版本11.0.2、10.1.34、9.0.98，请尽快下载安全版本修复漏洞。

**漏洞复现**

Support

**04**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/FOh11C4BDicTlsZ2sGl2LPnQl8cpjibcKJF56Zhibd2GQt1HuCaZpqcPMlPTYbj08OlmN1GLFAurpjzJwhiaX0UEQg/640?wx_fmt=png&from=appmsg)

**产品支持**

Support

**05**

**云图：**默认支持该产品的指纹识别，同时支持该漏洞的PoC原理检测。

**洞鉴：**预计本周内发布更新支持该漏洞的检测。

**雷池：**默认支持检测该漏洞的利用行为。

**全悉：**默认可以检测使用PUT方法上传WebShell行为。

**时间线**

Timeline

**06**

12月17日 互联网公开披露该漏洞

12月18日 长亭应急安全实验室复现漏洞

12月18日 长亭安全应急响应中心发布通告

参考资料：

[1]. https://lists.apache.org/thread/y6lj6q1xnp822g6ro70tn19sgtjmr80r

**长亭应急响应服务**

全力进行产品升级

及时将风险提示预案发送给客户

检测业务是否受到此次漏洞影响

请联系长亭应急服务团队

7\*24小时，守护您的安全

第一时间找到我们：

邮箱：support@chaitin.com

预览时标签不可点

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/sz_mmbiz_png/FOh11C4BDicRRVzLmQjSLiavxtAic7KOwrG3LmOSNQjmWlwYtZXgu57OV1t9yic9E4GkU2noIicAq1nGlNT0MRiaBCMg/0?wx_fmt=png)

长亭安全应急响应中心

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/sz_mmbiz_png/FOh11C4BDicRRVzLmQjSLiavxtAic7KOwrG3LmOSNQjmWlwYtZXgu57OV1t9yic9E4GkU2noIicAq1nGlNT0MRiaBCMg/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过