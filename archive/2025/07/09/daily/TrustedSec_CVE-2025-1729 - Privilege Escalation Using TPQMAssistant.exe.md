---
title: CVE-2025-1729 - Privilege Escalation Using TPQMAssistant.exe
url: https://trustedsec.com/blog/cve-2025-1729-privilege-escalation-using-tpqmassistant-exe
source: TrustedSec
date: 2025-07-09
fetch_date: 2025-10-06T23:52:19.094403
---

# CVE-2025-1729 - Privilege Escalation Using TPQMAssistant.exe

[Skip to Main Content](#main)

All Trimarc services are now delivered through TrustedSec!
[Learn more](https://trustedsec.com/about-us/news/trimarc-joins-forces-with-trustedsec-to-strengthen-security-advisory-services)

Close

[TrustedSec](https://trustedsec.com/)

* [Solutions](https://trustedsec.com/solutions)

  ## Solutions

  Our custom solutions are tailored to address the unique challenges of different roles in security.

  [Solutions](https://trustedsec.com/solutions)

  + [01

    For Leadership

    We understand the challenges facing modern executives and develop solutions unique to leaders.](https://trustedsec.com/solutions/for-leadership)
  + [02

    For Operations

    We stay one step ahead to proactively safeguard our clients and partners.](https://trustedsec.com/solutions/for-operations)
  + [03

    For Infrastructure

    From architecture to resiliency and maintainability, we keep your tech aligned to best practices.](https://trustedsec.com/solutions/for-infrastructure)
  + [04

    For Assurance

    Our compliance experts guide partners through regulatory requirements to ensure standards are met.](https://trustedsec.com/solutions/for-assurance)
* [Services](https://trustedsec.com/services)

  ## Services

  From building to testing to hardening, our services support security at every stage.

  [Services](https://trustedsec.com/services)

  + [01

    Design

    Design an exceptional, custom security program alongside our security experts.](https://trustedsec.com/services/design)
  + [02

    Evaluate

    Evaluate your security program with proven assessment methodologies.](https://trustedsec.com/services/evaluate)
  + [03

    Harden

    Harden your security program with the help of our security experts.](https://trustedsec.com/services/harden)
  + [04

    Respond

    Respond to threats to your security program with the help of our security experts.](https://trustedsec.com/services/respond)
* [Research](https://trustedsec.com/research)
* [Blog](https://trustedsec.com/blog)
* [Resources](https://trustedsec.com/resources)
* [About Us](https://trustedsec.com/about-us)

  ## About Us

  Driven by purpose, fueled by experts.

  [About Us](https://trustedsec.com/about-us)

  + [01

    Our Team

    Meet our security experts.](https://trustedsec.com/about-us/our-team)
  + [02

    Our Partners

    Become a TrustedSec partner to help your customers anticipate and prepare for potential attacks.](https://trustedsec.com/about-us/our-partners)
  + [03

    News

    Our team is trusted by local and national media to be the subject matter experts for security news.](https://trustedsec.com/about-us/news)
  + [04

    Events

    See our upcoming webinars, conferences, talks, trainings, and more!](https://trustedsec.com/about-us/events)

Search

Menu

Search Input

Search

* [Contact Us](https://trustedsec.com/contact)
* [Report a breach](https://trustedsec.com/report-a-breach)

* [Solutions](https://trustedsec.com/solutions)
* [Services](https://trustedsec.com/services)
* [Research](https://trustedsec.com/research)
* [Blog](https://trustedsec.com/blog)
* [Resources](https://trustedsec.com/resources)
* [About Us](https://trustedsec.com/about-us)

Search

* [Contact Us](https://trustedsec.com/contact)
* [Report a breach](https://trustedsec.com/report-a-breach)

* [Blog](https://trustedsec.com/blog)
* [CVE-2025-1729 - Privilege Escalation Using TPQMAssistant.exe](https://trustedsec.com/blog/cve-2025-1729-privilege-escalation-using-tpqmassistant-exe)

July 08, 2025

# CVE-2025-1729 - Privilege Escalation Using TPQMAssistant.exe

Written by
Oddvar Moe

Vulnerability Assessment

![](https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/CVE-2025-1729_WebHero.jpg?w=320&h=320&q=90&auto=format&fit=crop&dm=1751569046&s=ed540cf5e447bd6b5d6e5fc2ecce123a)

Table of contents

* [Writable Directory and Missing DLL](#Directory)
* [Code Execution](#Execution)
* [From User to Admin - Scheduled Privilege Escalation](#Escalation)
* [Mitigation](#Mitigation)
* [Final Thoughts](#Final)
* [Timeline](#Timeline)

Share

* Share URL
* [Share via Email](/cdn-cgi/l/email-protection#90afe3e5f2faf5f3e4add3f8f5f3fbb5a2a0ffe5e4b5a2a0e4f8f9e3b5a2a0f1e2e4f9f3fcf5b5a2a0f6e2fffdb5a2a0c4e2e5e3e4f5f4c3f5f3b5a2a1b6f1fde0abf2fff4e9add3c6d5bda2a0a2a5bda1a7a2a9b5a2a0bdb5a2a0c0e2f9e6f9fcf5f7f5b5a2a0d5e3f3f1fcf1e4f9fffeb5a2a0c5e3f9fef7b5a2a0c4c0c1ddd1e3e3f9e3e4f1fee4bef5e8f5b5a3d1b5a2a0f8e4e4e0e3b5a3d1b5a2d6b5a2d6e4e2e5e3e4f5f4e3f5f3bef3fffdb5a2d6f2fcfff7b5a2d6f3e6f5bda2a0a2a5bda1a7a2a9bde0e2f9e6f9fcf5f7f5bdf5e3f3f1fcf1e4f9fffebde5e3f9fef7bde4e0e1fdf1e3e3f9e3e4f1fee4bdf5e8f5 "Share via Email")
* [Share on Facebook](http://www.facebook.com/sharer.php?u=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fcve-2025-1729-privilege-escalation-using-tpqmassistant-exe "Share on Facebook")
* [Share on X](http://twitter.com/share?text=CVE-2025-1729%20-%20Privilege%20Escalation%20Using%20TPQMAssistant.exe%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fcve-2025-1729-privilege-escalation-using-tpqmassistant-exe "Share on X")
* [Share on LinkedIn](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fcve-2025-1729-privilege-escalation-using-tpqmassistant-exe&mini=true "Share on LinkedIn")

While digging into the internals of my new Lenovo ThinkPad P1 Gen7, I came across an unexpected discovery that quickly escalated from curiosity to a viable privilege escalation vulnerability.

Every day at exactly 9:30AM, a scheduled task named:

**Lenovo\TrackPointQuickMenu\Schedule\ActivationDailyScheduleTask**

automatically launches the binary:

**C:\ProgramData\Lenovo\TPQM\Assistant\TPQMAssistant.exe**

![](https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/CVE_Oddvar/Fig01_Moe_CVE.png?w=320&q=90&auto=format&fit=max&dm=1751568846&s=1c8e8916f25c28147feba9d59522f2e6)

Figure 1 - Scheduled Task

This task only runs when a user is logged in, and what makes it particularly interesting is that this binary is vulnerable to dynamic-link library (DLL) sideloading—a classic and often-overlooked attack vector.

## Writable Directory and Missing DLL

The directory housing **TPQMAssistant.exe** is writable by standard users, which is already a red flag. The folder’s permission allows the **CREATOR OWNER** to write files, meaning any local user can drop files into this location.

![](https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/CVE_Oddvar/Fig0204Moe_CVE.png?w=320&q=90&auto=format&fit=max&dm=1751568854&s=ac45bde793a7cd5bee9c79619e58442b)

Figure 2 - CREATOR OWNER on Folder

When the scheduled task (or the binary itself) is triggered, it attempts to load hostfxr.dll from its working directory but fails, resulting in a NAME NOT FOUND event. This tells us the binary is looking for a dependency that doesn't exist in its own directory—a perfect opportunity for sideloading.

![](https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/CVE_Oddvar/Fig03_Moe_CVE.png?w=320&q=90&auto=format&fit=max&dm=1751568847&s=fd18a340b12fec5b9420d5a3e43e6e7c)

Figure 3 - Name Not Found

The directory containing **TPQMAssistant.exe** is writable by users allowing new files to be added to the folder.

![](https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/CVE_Oddvar/Fig0204Moe_CVE.png?w=320&q=90&auto=format&fit=max&dm=1751568854&s=ac45bde793a7cd5bee9c79619e58442b)

Figure 4 - Creator Owner on Folder

## Code Execution

By placing a malicious **hostfxr.dll** in the same directory as **TPQMAssistant.exe**, we can hijack the loading process. When the binary is executed, it successfully loads our planted DLL and runs our code. In my proof of concept code, I simply show a message box to verify the code execution.

![](https://trusted-sec.transforms.svdcdn.com/production/images/Blog-assets/CVE_Oddvar/Fig05_Moe_CVE.png?w=320&q=90&auto=format&fit=max&dm=1751568849&s=8512c8f6cec9d0fb6575df98582da7bb)

Figure 5 - Simple Proof of Concept Sour...