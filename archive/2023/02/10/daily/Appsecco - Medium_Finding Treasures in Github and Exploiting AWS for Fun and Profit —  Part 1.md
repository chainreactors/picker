---
title: Finding Treasures in Github and Exploiting AWS for Fun and Profit —  Part 1
url: https://blog.appsecco.com/finding-treasures-in-github-and-exploiting-aws-for-fun-and-profit-part-1-be5cfadf942?source=rss----e2adb3957733---4
source: Appsecco - Medium
date: 2023-02-10
fetch_date: 2025-10-04T06:16:16.866689
---

# Finding Treasures in Github and Exploiting AWS for Fun and Profit —  Part 1

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbe5cfadf942&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblog.appsecco.com%2Ffinding-treasures-in-github-and-exploiting-aws-for-fun-and-profit-part-1-be5cfadf942&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblog.appsecco.com%2Ffinding-treasures-in-github-and-exploiting-aws-for-fun-and-profit-part-1-be5cfadf942&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## Appsecco](https://blog.appsecco.com/?source=post_page---publication_nav-e2adb3957733-be5cfadf942---------------------------------------)

·

Follow publication

[![Appsecco](https://miro.medium.com/v2/resize:fill:76:76/1*-ERVMgF2P005dtPsm5nIqw.jpeg)](https://blog.appsecco.com/?source=post_page---post_publication_sidebar-e2adb3957733-be5cfadf942---------------------------------------)

Blog posts from the Security Testing Teams and DevSecOps Teams at Appsecco. Covering security around applications, Cloud environments like AWS, Azure, GCP, Kubernetes, Docker. Covering DevSecOps topics such as Secrets Management, Secure CI/CD Pipelines and more

Follow publication

# Finding Treasures in Github and Exploiting AWS for Fun and Profit — Part 1

[![Bhagavan Bollina](https://miro.medium.com/v2/resize:fill:64:64/1*KBLwUEM9IQdhQc_3X72iEQ.jpeg)](https://medium.com/%40XCriminal?source=post_page---byline--be5cfadf942---------------------------------------)

[Bhagavan Bollina](https://medium.com/%40XCriminal?source=post_page---byline--be5cfadf942---------------------------------------)

4 min read

·

Feb 9, 2023

--

2

Listen

Share

Press enter or click to view image in full size

![]()

Photo by [Immo Wegmann](https://unsplash.com/%40macroman?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/photos/lLRm3S-7Kfw?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

*Disclaimer: This article is written for educational purposes, the author and Appsecco does not encourage readers to do engage in questionable practices without the permission of the repository owner.*

*This is a story in which I discovered some AWS credentials and endpoints which I then used to gain root access to an EC2 instance.*

## Table of Contents

1. Introduction
2. How I found the treasure?
3. How can I automate this process?
4. What after finding the sensitive information?
5. References

## Introduction

GitHub is where over 56 million developers shape the future of software, together. Contribute to the open-source community, manage their Git repositories, and do lots of stuff. Apart from this developers also add API keys, passwords, customer data, etc. without understanding the impact of what a leak could do.

## How I found the treasure?

I was hunting on a private bug bounty program, in which the target’s scope includes all subdomains & their open source code repositories. Like any other bounty hunter, I navigated to GitHub and searched for any sensitive strings within GitHub, trimming the results down to the repositories that I knew were in scope.

I used a particular dork in the GitHub search: `filename:credentials aws_access_key_id` .

This shows up a lot of results, which you can sort and search for the repos you are interested in. Here are some additional dorks to try to find credentials and tokens

### GitHub Dorks

1. *filename:credentials aws\_access\_key\_id*
2. *“token” “AQoDY”*
3. *“rds.amazonaws.com”*
4. *filename:credentials AWS\_ACCESS\_KEY\_ID*

One of the repos of the target contained the AWS credentials, host endpoint and a snapshot identifier.

To demonstrate this, I have used my own repository which you can see in the screenshot below. You can see a host endpoint, AWS credentials, and Snapshot ID being leaked.

Press enter or click to view image in full size

![]()

Screenshot of my repository

I configured the AWS credentials, by running the below command

`aws configure --profile stolencreds`

I was then able to run aws cli commands with the profile argument on the target cloud account. The credentials had a lot of permissions within the account which I was able to discover using a tool (more on this a little later).

## How can we automate this process?

There are a bunch of interesting tools that can help us to find the credentials via automation. One of the more popular ones is `[trufflehog](https://github.com/trufflesecurity/trufflehog)`.

* Run the below command to search the sensitive information in the given git repository

`./trufflehog git <https://github.com/NAME/REPO>`

Press enter or click to view image in full size

![]()

Trufflehog tool demo

Trufflehog supports the detection of a LOT credentials in git repos and even on the filesystem.

## Found AWS credentials, now what?

Alongside the credentials, I found an EC2 instance endpoint. Riding on a hunch that this instance could somehow be accessed through the credentials, I started to explore my access.

There are multiple tools available that can give you a fair idea of what permissions a given AWS credentials have. I tried a tool called `weirdALL` to do this.

Press enter or click to view image in full size

![]()

The tool runs through a LOT of Get and Describe API calls across the target AWS account and prints what is allowed.

> All tools that do permission enumeration are bound to be noisy and a good monitoring team can pick up enumeration attempts easily.

Press enter or click to view image in full size

![]()

The credentials had a DescribeSnapshots permission that we can use to describe the EBS snapshots within the AWS account. I ran the aws cli command to figure out the snapshots and their status within the account.

`aws ec2 describe-snapshots --region <REGION> --profile stolencreds`

or

`aws ec2 describe-snapshots --region <REGION> --owner-id <ACCOUNT_ID>`

Press enter or click to view image in full size

![]()

Found the snapshot ID

After obtaining the Snapshot ID, I tried to check the visibility of the snapshots (public to AWS users or private to account) using the following command

`aws ec2 describe-snapshots --snapshot-ids <snapshot-id-here>`

It turned out to be public, which is a good find for attackers :D

Watch out for our Part 2 in the coming weeks, where I show how I exploited the public snapshot to uncover even more goodness.

## References

* [How to Scan GitHub Repository for Credentials](https://geekflare.com/github-credentials-scanner/#:~:text=GitHub%20has%20secrets%20scanning%20feature,with%20the%20compromised%20account's%20privileges.)
* [How to Scan GitHub Repositories for Committed Secrets and other Code Snippets](https://nightfall.ai/scan-github-repositories-secrets)
* [How to Scan GitHub Repositories for Secrets & Credentials with Open Source](https://www.conjur.org/blog/how-to-scan-github-repositories-for-secrets-credentials-with-open-source/)

[Infosec](https://medium.com/tag/infosec?source=post_page-----be5cfadf942---------------------------------------)

[Github](https://medium.com/tag/github?source=post_page-----be5cfadf942-----------------------------------...