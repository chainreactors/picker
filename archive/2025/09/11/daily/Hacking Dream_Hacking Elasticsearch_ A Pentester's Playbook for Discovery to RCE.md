---
title: Hacking Elasticsearch: A Pentester's Playbook for Discovery to RCE
url: https://www.hackingdream.net/2025/09/hacking-elasticsearch-pentesters-playbook-for-discovery-to-rce.html
source: Hacking Dream
date: 2025-09-11
fetch_date: 2025-10-02T19:57:39.126822
---

# Hacking Elasticsearch: A Pentester's Playbook for Discovery to RCE

* [Home](http://www.hackingdream.net)
* [About Author](http://www.hackingdream.net/p/about-author.html)
* [Contact US](http://www.hackingdream.net/p/contact-us.html)

[# ![Hacking Dream](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgI3MZul9awsB7xmLlAs9J9xDOsiYxbMQoa4EQkvg9T9oe4q5zkZRqV0W4UN2KhrQQWPLveTvQ9kkuHu2HfrahqY0Gc53G1cVCwQNY2G3MVkEOJoDvLIK9lFtBUc-HhRciiteWdHYV4SaE/s1600/Size-Modified.png)](https://www.hackingdream.net/)

Main menu

close

* [Home](http://www.hackingdream.net)
* [AI Sec](https://www.hackingdream.net/search/label/AI)
* [AI Pentest](http://www.hackingdream.net/search/label/AI%20Attacks)
* [Cheatsheets](https://www.hackingdream.net/search/label/Cheatsheet)
* [Pentest](https://www.hackingdream.net/search/label/Pentest)
* [\_Active Directory](https://www.hackingdream.net/search/label/Active%20Directory)
* [\_Linux](http://www.hackingdream.net/search/label/Kali%20Linux)
* [\_Wireless](http://www.hackingdream.net/search/label/Wifi%20Hacking)
* [\_Target Hacking](http://www.hackingdream.net/search/label/Target%20Hacking)
* [Purple Team](https://www.hackingdream.net/search/label/Purple%20Team)
* [Bin Exp](https://www.hackingdream.net/search/label/Exploitation)
* How To
* [\_Blogging](http://www.hackingdream.net/search/label/Blogging)
* [\_Solved Problems](http://www.hackingdream.net/search/label/Solved%20Problems)
* [\_Money Making](http://www.hackingdream.net/search/label/Money%20Making)
* [\_Top Ten](http://www.hackingdream.net/search/label/Top%20Ten)
* [\_Gaming](http://www.hackingdream.net/search/label/Games)

### Hacking Elasticsearch: A Pentester's Playbook for Discovery to RCE

[September 10, 2025](https://www.hackingdream.net/2025/09/hacking-elasticsearch-pentesters-playbook-for-discovery-to-rce.html "permanent link")

Hacking Elasticsearch: A Pentester's Playbook for Discovery to RCE

# Hacking Elasticsearch: A Pentester's Playbook for Discovery to RCE

*Updated on September 11, 2025*

Alright, let's talk shop. When I'm on an engagement and port 9200 or 9300 pops up on my nmap scan, I get interested. Elasticsearch is everywhere, and it's amazing how often it's left wide open, practically begging for someone to walk in. My methodical approach to hacking Elasticsearch has proven effective time and again. These clusters can be goldminesâ€”we're talking PII, credentials, application logs, you name it.

[![Hacking Elasticsearch: A Pentester's Playbook for Discovery to RCE](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhMn0lIxmnE_yUH3At1ZWVx7BKMYlb5qJRvIydfAvvkjOXK0VQk-pI9CNEVHDq1urgnmcF78WtFl8i_0m6jhckpTQBPHjW5ve-Qtu317bbW2_8vCRCIfnh1SlQLlkxqXWWU1MePRXcjoE3F7J3gTmGieFlPpEuAJGlL_0gjFOlIYvjoUR6qi1a5RjNuIJSk/w640-h264/Hacking-Elasticsearch-A-Pentesters-Playbook-for-Discovery-to-RCE.jpg "Hacking Elasticsearch: A Pentester's Playbook for Discovery to RCE")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhMn0lIxmnE_yUH3At1ZWVx7BKMYlb5qJRvIydfAvvkjOXK0VQk-pI9CNEVHDq1urgnmcF78WtFl8i_0m6jhckpTQBPHjW5ve-Qtu317bbW2_8vCRCIfnh1SlQLlkxqXWWU1MePRXcjoE3F7J3gTmGieFlPpEuAJGlL_0gjFOlIYvjoUR6qi1a5RjNuIJSk/s1024/Hacking-Elasticsearch-A-Pentesters-Playbook-for-Discovery-to-RCE.jpg)

Over the years, I've developed a solid playbook for testing these instances. It's a methodical process that starts with simple recon and escalates all the way to RCE. This is how I break down an Elasticsearch target, inspired by the same logic I've built into my own automation scripts.

## Phase 1: Cracking the Perimeter - Recon and Initial Foothold

Every successful pwn starts with good intel. Before I even think about firing off an exploit, I need to map the terrain and find the path of least resistance.

### 1. Fingerprinting the Target

First thing's first: I need to know the exact version I'm up against. Most exploits are version-specific, so this step is non-negotiable. I don't just hit the root endpoint (/). That's lazy, and it might be firewalled. I probe multiple endpoints to get a clear picture:

* `/` (The obvious one)
* `/_nodes`
* `/_cluster/health`
* `/_cat/nodes`

A 200 OK from any of these usually gives me the version number, build hash, and Lucene version. Now I have what I need to check my CVE lists and plan the next steps.

### 2. The Easiest Win: Checking for Misconfigurations

More often than you'd think, the front door is just unlocked.

* **Unauthenticated Access:** This is my primary check. A simple `curl http://<target>:9200` tells me everything. If I see that "You Know, for Search" banner without any auth challenge, it's game on.
* **Default Credentials:** If auth is on, the next step is a quick check for default creds. Combinations like `elastic:changeme` or `admin:elasticadmin` still work a surprising amount of the time.
* **Sensitive Information Exposure:** Even if the data indices are locked down, the cluster might still leak juicy metadata. I always check for exposed admin endpoints that can give me a full map of the environment:
  + `/_cat/nodes`, `/_nodes/stats`, `/_cluster/health`
  + `/_cat/indices`, `/_cat/shards`, `/_cluster/state`
  + `/_security/user`, `/_security/role` (on older versions)

### 3. We're In! Now What? Post-Exploitation

Finding an open, unauthenticated cluster is a critical finding, but the job isn't done. Now I need to demonstrate the impact.

**Dump Everything:** The first order of business is to prove I have read access to everything. I'll use the search API to dump all the data from all indices. This is undeniable proof of a massive data breach.

```
# Dump all data from the cluster to a file
curl 'http://<target>:9200/_search?pretty=true' > elasticsearch_dump.json
```

This command grabs the contents of the indices and saves them. For a client, seeing their sensitive data in this file is an eye-opener.

**Leave My Mark:** Next, I prove I have write access. This is even more powerful. I can modify data, delete it, or add my own. For a pentest, I'll add a non-destructive record to an existing index.

```
# Add a new record to an index
curl -X POST 'http://<target>:9200/some_index/some_type' -H 'Content-Type: application/json' -d'
{
    "name" : "pentest",
    "owned_by" : "Your Name",
    "message" : "This cluster is vulnerable to unauthorized data modification."
}'
```

This demonstrates I can tamper with their data, which could lead to application-level attacks or misinformation.

## Phase 2: Going Deeper - Weaponizing CVEs

Once I've looted the easy stuff, it's time to see if I can own the box itself. This is where that version information from Phase 1 becomes critical. I'll check my exploit database for anything that matches.

### 1. Remote Code Execution (RCE) - The Holy Grail

* [**CVE-2014-3120**](https://nvd.nist.gov/vuln/detail/CVE-2014-3120) (Dynamic Scripting RCE): A classic. Old versions had dynamic scripting on by default. Game over.
* [**CVE-2015-1427**](https://nvd.nist.gov/vuln/detail/CVE-2015-1427) (Groovy Sandbox Bypass): Another scripting engine flaw that leads straight to a shell.
* [**CVE-2021-44228**](https://nvd.nist.gov/vuln/detail/CVE-2021-44228) (Log4Shell): This thing was everywhere. Sending a simple `${jndi:ldap://...}` payload in a search query is often enough to get a callback.
* [**CVE-2021-22145**](https://nvd.nist.gov/vuln/detail/CVE-2021-22145) (Arbitrary Code Execution): A flaw in the snapshot repository feature that can be abused for code execution.

### 2. Privilege Escalation & Information Disclosure

* [**CVE-2020-7009**](https://nvd.nist.gov/vuln/detail/CVE-2020-7009) (Privilege Escalation via API Keys): If I have low-level access, I'll check if I can forge an API key with cluster admin rights.
* [**CVE-2015-5531**](https://nvd.nist.gov/vuln/detail/CVE-2015-5531) (Directory Traversal): This snapshot API bug lets me write files outside the intended directories, which can be a stepping stone to RCE.

### 3. Denial of Service (DoS)

I use these sparingly and with permission, but it's important to show how a fragile system can be knocked over. T...