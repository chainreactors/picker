---
title: PostgreSQL 高权限命令执行 (CVE-2019-9193)漏洞复现&实战
url: https://www.anquanke.com/post/id/281734
source: 安全客-有思想的安全新媒体
date: 2022-10-19
fetch_date: 2025-10-03T20:11:49.554652
---

# PostgreSQL 高权限命令执行 (CVE-2019-9193)漏洞复现&实战

首页

阅读

* [安全资讯](https://www.anquanke.com/news)
* [安全知识](https://www.anquanke.com/knowledge)
* [安全工具](https://www.anquanke.com/tool)

活动

社区

学院

安全导航

内容精选

* [专栏](/column/index.html)
* [精选专题](https://www.anquanke.com/subject-list)
* [安全KER季刊](https://www.anquanke.com/discovery)
* [360网络安全周报](https://www.anquanke.com/week-list)

# PostgreSQL 高权限命令执行 (CVE-2019-9193)漏洞复现&实战

阅读量**354757**

发布时间 : 2022-10-18 10:30:23

**x**

##### 译文声明

本文是翻译文章

译文仅供参考，具体内容表达以及含义原文为准。

![]()

## 漏洞简介

postgreSQL是一个功能强大对象关系数据库管理系统。由于9.3增加一个“COPY TO/FROM PROGRAM”功能。这个功能就是允许数据库的超级用户以及pg\_read\_server\_files组中的任何用户执行操作系统命令。

## 漏洞利用

这个漏洞是一个版本漏洞

从9.3版本开始，Postgres新增了一个 COPY TO/FROM PROGRAM功能，允许数据库的超级用户以及 pg\_read\_server\_files组中的任何用户执行操作系统命令，利用的前提

1、需要登录 2、需要高权限

所以要先弱口令爆破之后，然后查看是否是高权限，这个漏洞才有得玩。

这里之所以选择复现这个漏洞，因为其中的思路比较有意思，也就是看回显的思路。

先大体讲一下这个漏洞是怎么看回显的，他是通过命令执行然后把回显写入创建的一张表里面，下面来具体操作。

先删除你想要使用但是已经存在的表

DROP TABLE IF EXISTS cmd\_exec;

![]()

创建保存系统命令输出的表

CREATE TABLE cmd\_exec(cmd\_output text);

![]()

执行系统命令 利用特定函数copy xxxx from program

![]()

查看执行结果

![]()

这里要强调的点就是命令执行的看回显方法，其他倒是没什么，我觉得这个写入表来看回显的方法很好玩。

## 实战引申

那么下面给一个实战的例子 也是sql注入没有回显 然后通过把命令执行的结果写入表中 然后用select看回显 由于项目敏感这里只给出部分截图和思路

这里的条件

1、sql注入没有回显

2、后台是mssql可以执行xp\_cmdshell

3、后台有功能可以select查看对应的表

通过抓取后台和数据库相关的接口找到这个接口

/PH*SystemModule/DatabaseTable/GetList?tableName=test&databaseLinkId=f2d587de-43e5-4310-b968-4544f4961a39&*=1634809489388

通过对应接口审计源码

上述接口中获取到的关键词为

PH\_SystemModule

DatabaseTable

GetList

应该是目录结构 先记下来

然后看到项目的路径

![]()

是一个比较典型的mvc架构的项目，虽然不是熟悉的语言，但是架构都是共通的，其中module代表数据库相关的代码

再结合之前的路径名

![]()

everything全局搜索对应的关键词

![]()

成功定位到对应的代码文件

![]()

打开代码进行审计

这个strSql是直接从前台传入的，用?strSql=传入即可

![]()

跟进FindTable方法看看有没有waf

![]()

![]()

没有发现waf，可以直接构造参数来进行注入

然后通过这个注入点注入进去之后，后台并没有回显，于是构造语句写入数据库的表中然后后台用select进行查看

这里不能放图了，只能描述了，大体就是这么个思路，用来看命令执行的回显。

## 反弹shell

这里的漏洞其实可以使用反弹shell，但是直接执行会有问题，看例子

![]()

直接报错了

vps也没有得到shell

![]()

这里可以用编码来解决

![]()

执行命令，直接上线

![]()

![]()

这里的编码不仅仅限于base64 b32 等等都可以 主要是为了解决数据传输过程中的特殊字符被异常解析的问题

本文翻译自 原文链接。如若转载请注明出处。

商务合作，文章发布请联系 anquanke@360.cn

本文由**雷石安全实验室**原创发布

转载，请参考[转载声明](https://www.anquanke.com/note/repost)，注明出处： [https://www.anquanke.com/post/id/281734](/post/id/281734)

安全KER - 有思想的安全新媒体

本文转载自:

如若转载,请注明出处：

安全KER - 有思想的安全新媒体

分享到：![微信](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

* [漏洞分析](/tag/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90)

**+1**4赞

收藏

![](https://p2.ssl.qhimg.com/t01ebe472d127128939.png)雷石安全实验室

分享到：![微信](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

## 发表评论

您还未登录，请先登录。

[登录](/login/index.html)

![](https://p5.ssl.qhimg.com/t014757b72460d855bf.png)

[![](https://p2.ssl.qhimg.com/t01ebe472d127128939.png)](/member.html?memberId=148196)

[雷石安全实验室](/member.html?memberId=148196)

欢迎关注公众号@雷石安全实验室 安全工作者不定期分享渗透、APT、企业安全建设等新鲜干货

* 文章
* **48**

* 粉丝
* **44**

### TA的文章

* ##### [frida inlinehook 巧解Android逆向题](/post/id/286239)

  2023-02-15 10:30:45
* ##### [frida inlinehook 巧解Android逆向题](/post/id/284343)

  2023-01-03 15:30:42
* ##### [frida hook native层巧解Android逆向题](/post/id/283461)

  2022-12-01 10:30:06
* ##### [webshell免杀之函数与变量玩法](/post/id/282736)

  2022-11-07 14:00:27
* ##### [一道Android逆向题的取巧解题思路](/post/id/282006)

  2022-10-31 14:30:32

### 相关文章

* ##### [无文件 AsyncRAT 活动利用隐蔽的 PowerShell 有效载荷攻击德国用户](/post/id/308562)

  2025-06-18 15:22:31
* ##### [微软 Office 漏洞允许攻击者执行远程代码](/post/id/308412)

  2025-06-12 15:43:53
* ##### [美国CISA警告 SinoTrack GPS 跟踪器存在远程控制漏洞](/post/id/308398)

  2025-06-12 15:15:38
* ##### [微软修补被阿联酋黑客利用的零日漏洞](/post/id/308384)

  2025-06-12 14:28:52
* ##### [西门子能源紧急警报：专用 5G 核心中的关键漏洞 (CVSS 9.9) 暴露了敏感数据！](/post/id/308380)

  2025-06-12 14:24:14
* ##### [CoreDNS DoS 漏洞：未经验证的攻击者可通过 DNS-over-QUIC 使服务器崩溃](/post/id/308349)

  2025-06-11 16:08:49
* ##### [InsydeUEFI 漏洞 (CVE-2025-4275)： 安全启动绕过允许 Rootkits 和无法检测的恶意软件](/post/id/308341)

  2025-06-11 16:00:03

### 热门推荐

文章目录

* [漏洞简介](#h2-0)
* [漏洞利用](#h2-1)
* [实战引申](#h2-2)
* [反弹shell](#h2-3)

![](https://p0.qhimg.com/t11098f6bcd5614af4bf21ef9b5.png)

安全KER

* [关于我们](/about)
* [联系我们](/note/contact)
* [用户协议](/note/protocol)
* [隐私协议](/note/privacy)

商务合作

* [合作内容](/note/business)
* [联系方式](/note/contact)
* [友情链接](/link)

内容需知

* [投稿须知](https://www.anquanke.com/contribute/tips)
* [转载须知](/note/repost)
* 官网QQ群：568681302

合作单位

* [![安全KER](https://p0.ssl.qhimg.com/t01592a959354157bc0.png)](http://www.cert.org.cn/)
* [![安全KER](https://p0.ssl.qhimg.com/t014f76fcea94035e47.png)](http://www.cnnvd.org.cn/)

Copyright © 北京奇虎科技有限公司 三六零数字安全科技集团有限公司 安全KER All Rights Reserved [京ICP备08010314号-66](https://beian.miit.gov.cn/)[![](https://icon.cnzz.com/img/pic.gif)](https://www.cnzz.com/stat/website.php?web_id=1271278035 "站长统计")

微信二维码

**X**![安全KER](https://p0.ssl.qhimg.com/t0151209205b47f2270.jpg)