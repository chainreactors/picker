---
title: Server-Side Template Injection in an Unknown Language with a Documented Exploit — SSTI…
url: https://infosecwriteups.com/server-side-template-injection-in-an-unknown-language-with-a-documented-exploit-ssti-de01a069b946?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2024-11-29
fetch_date: 2025-10-06T19:14:53.135828
---

# Server-Side Template Injection in an Unknown Language with a Documented Exploit — SSTI…

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fde01a069b946&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fserver-side-template-injection-in-an-unknown-language-with-a-documented-exploit-ssti-de01a069b946&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fserver-side-template-injection-in-an-unknown-language-with-a-documented-exploit-ssti-de01a069b946&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-de01a069b946---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-de01a069b946---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# Server-Side Template Injection in an Unknown Language with a Documented Exploit — SSTI Vulnerability

[![Ryan G. Cox](https://miro.medium.com/v2/resize:fill:64:64/1*VkvYzjvK_fuZ2Js8dEFC_g.jpeg)](https://medium.com/%40ryangcox?source=post_page---byline--de01a069b946---------------------------------------)

[Ryan G. Cox](https://medium.com/%40ryangcox?source=post_page---byline--de01a069b946---------------------------------------)

4 min read

·

Nov 11, 2024

--

Listen

Share

Press enter or click to view image in full size

![]()

[The Cybersec Café](https://www.cyberseccafe.com/)

Welcome back for another Pentesting Methodology Lab Walkthrough at the Cybersec Cafe. Today, I’ll be approaching an SSTI vulnerability and detailing my methodology. These writeups are from controlled environment to explain my methodology in order to help you learn how to test applications yourself.

## Objective

identify the template engine being used and execute arbitrary code to delete *morale.txt* from the user Carlos’s home directory

## What We Know

The lab is vulnerable to a doucmented SSTI exploit online for this templating engine.

## What is a Server-Side Template Injection Vulnerability?

Server-Side Template Injection (SSTI) is a vulnerability that occurs when an application improperly handles user input in templates used for server-side rendering. This flaw allows attackers to inject malicious code into the template, leading to remote code execution or unauthorized access to sensitive data on the server.

If you enjoy this article and want to be the first to see more like it, consider **subscribing** to my newsletter, the [Cybersec Cafe](https://www.cyberseccafe.com/), for *free*. I post content there first, and here second. Plus, you’ll get it straight to your inbox.

My goal is to deliver you value in various cybersecurity topics each week and to become your ultimate destination for expanding your expertise or for any aspiring cybersecurity professionals to break into the field.

## Methodology

Want to give the lab a try yourself and follow along? You can check it out on PortSwigger’s website [here](https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-in-an-unknown-language-with-a-documented-exploit) for free.

## The Recon

Upon opening the application, we can see the typical shop that we have in a majority of labs we attack.

Press enter or click to view image in full size

![]()

Let’s click around to see if we can find anything glaringly obvious or different.Clicking the first product returns an error message, whereas the second product opens up a product page.

Press enter or click to view image in full size

![]()

The difference in behavior immediately makes me think that we found our attack vector.

We can open up the Site map in Burp and find that the message is displayed using a *message* parameter under the root request.

Press enter or click to view image in full size

![]()

Let’s send this over to the Repeater and start testing with it.

## Testing

Since we already know this is a template injection vulnerability, we can inject a testing string into the parameter.

`${{<%[%'"}}%\`

This will test commonly used syntax in different template languages.

We can inject this into our parameter with the hope it returns a detailed error message.

Press enter or click to view image in full size

![]()

Exactly what we were expecting.

Looking at the message, we can see this has returned an error message showing us this application is using Handlbars.

Time for some OSINT.

Let’s look up SSTI in HackTricks — my go-to first stop when looking for information on vulnerabilities.

If you navigate to the SSTI page, *Command+F* to search for [Handlebars](https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection) and we can see a payload.

Let’s grab it and throw it in our IDE.

## Exploitation

We can see that the exploit contains two payloads: the raw payload and a URL encoded version.

Lets use the raw payload to determine where we can make our changes, then make them in the URL encoded version since we’ll have to pass it through a GET request parameter.

Press enter or click to view image in full size

![]()

We can see that there is a whomai command being executed.

This is where we’ll want to inject our command.

Considering the objective or deleting the morale.txt file in carlos’ home directory, we can assume that the payload will be: *rm /home/carlos/morale.txt*

Let’s use *Command+F* in our IDE to find where *whoami* is in the URL encoded version and swap out our command.

Make sure to URL encode the space: *rm%20/home/carlos/morale.txt*

Here is the payload:

Press enter or click to view image in full size

![]()

Medium was having trouble pasting this payload into a code block, so I’ve pasted a screenshot.

Let’s input this into the message parameter in our Repeater and click Send.

Press enter or click to view image in full size

![]()

Bingo — lab solved!

## What We’ve Learned

OSINT is a powerful tool. There are many cases where you can find documented exploits for vulnerabilities with a quick search. At the very least, you can read documentation and get information on the technology being used, possibly pointing to holes.

—

Remember: The Cybersec Café gets articles first. Subscribe for free [here](https://www.cyberseccafe.com/).

Interested in getting into Cybersecurity? I have a course called the [Security Sip](https://securitysip.cyberseccafe.com/). The curriculum is designed to help you build skills progressively over 12 sections, 85 modules, and 155 exercises. With rapidly evolving threats and technologies widening the skill gap, it’s time to secure your future in cybersecurity. [**Available Now**](https://securitysip.cyberseccafe.com/#pricing)**!**

Oh, and if you want even more content ...