---
title: Multilingual skimmer fingerprints 'secret shoppers' via Cloudflare endpoint API
url: https://www.malwarebytes.com/blog/threat-intelligence/2023/02/multilingual-skimmer-fingerprints-users-via-cloudflare-endpoint-api
source: Malwarebytes Labs
date: 2023-02-22
fetch_date: 2025-10-04T07:42:58.046921
---

# Multilingual skimmer fingerprints 'secret shoppers' via Cloudflare endpoint API

[Skip to content](#primary)

Search

Search Malwarebytes.com

Search for:

* [Sign In](https://my.malwarebytes.com/en/login)

  [Sign in](https://my.malwarebytes.com/overview)

  [Activate subscription >](https://my.malwarebytes.com/landing/activate)

  [Add devices or upgrade >](https://my.malwarebytes.com/landing/upgrade)

  [Renew subscription >](https://my.malwarebytes.com/landing/manual-renewal)

  [Secure Hub >](https://my.malwarebytes.com/secure-hub)

  [Don’t have an account?
  **Sign up >**](https://my.malwarebytes.com/overview?flow=signup)

  Sign In

[Malwarebytes logo](https://www.malwarebytes.com/blog)

* Personal

  < Products

  **Device Protection & Antivirus**

  + [Premium Security Antivirus](https://www.malwarebytes.com/premium)
  + [Mobile Security for Android & iOS](https://www.malwarebytes.com/mobile)

  **Identity Protection**

  + [Identity Theft Protection](https://www.malwarebytes.com/identity-theft-protection)
  + [Personal Data Remover](https://www.malwarebytes.com/personal-data-remover)
  + [Digital Footprint Scanner](https://www.malwarebytes.com/digital-footprint)

  **Privacy Protection**

  + [Privacy VPN](https://www.malwarebytes.com/vpn)
  + [Browser Guard](https://www.malwarebytes.com/browserguard)
  + [AdwCleaner](https://www.malwarebytes.com/adwcleaner)

  Have a current computer infection?

  [**Free Virus Scan**](https://www.malwarebytes.com/solutions/virus-scanner)

  Worried it’s a scam?

  [**Free Scam Guard tool**](https://www.malwarebytes.com/solutions/scam-guard)

  Try our antivirus with a free, full-featured 14-day trial

  [**Free Antivirus**](https://www.malwarebytes.com/mwb-download)

  Get your free digital security toolkit

  [**Explore all free tools**](https://www.malwarebytes.com/free-tools)

  Find the right cyberprotection for you

  [**Compare plans and pricing**](https://www.malwarebytes.com/pricing)
* Business

  < Business

  **[Teams](https://www.malwarebytes.com/teams)**

  Protect small & home offices – no IT expertise needed

  **[ThreatDown](https://www.threatdown.com/?utm_campaign=mwb-referral&utm_source=malwarebytes.com&utm_medium=referral&utm_content=cta-mb-nav-threatdown)**

  Award-winning endpoint security for small and medium businesses
* Pricing

  < Pricing

  [Personal pricing](https://www.malwarebytes.com/pricing)

  Protect your personal devices and data

  [Small or home office pricing](https://www.malwarebytes.com/pricing/teams)

  Protect your team’s devices and data – no IT skills needed

  [Corporate pricing](https://www.threatdown.com/pricing/?utm_campaign=mwb-referral&utm_source=malwarebytes.com&utm_medium=referral&utm_content=cat-en-us-navbar-pricing-business-pricing-click)

  Explore award-winning endpoint security for your business
* [Partners](https://www.malwarebytes.com/partners)
* Resources

  < Resources

  [![Malwarebytes Labs](https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/07/mwb-labs-159px.svg)](https://www.malwarebytes.com/blog)

  + [Security terms glossary](https://www.malwarebytes.com/glossary)
  + [Threat Center](https://www.malwarebytes.com/blog/threats)
  + [Cybersecurity News](https://www.malwarebytes.com/blog)

  + [About Malwarebytes](https://www.malwarebytes.com/company)
  + [Press](https://www.malwarebytes.com/press/)
  + [Careers](https://www.malwarebytes.com/jobs)

  [Cybersecurity Resource Center](https://www.malwarebytes.com/cybersecurity)

  + [Antivirus](https://www.malwarebytes.com/cybersecurity/basics/antivirus)
  + [Malware](https://www.malwarebytes.com/malware)
  + [Phishing](https://www.malwarebytes.com/phishing)
  + [Ransomware](https://www.malwarebytes.com/ransomware)
  + [Small business hub](https://www.malwarebytes.com/small-business)
  + [See all articles](https://www.malwarebytes.com/cybersecurity)
* Help

  < Support

  [Malwarebytes Help Center](https://help.malwarebytes.com/hc/en-us)

  Malwarebytes and Teams Customers

  [ThreatDown Business Support](https://support.threatdown.com/hc/en-us/?utm_campaign=mwb-referral&utm_source=malwarebytes.com&utm_medium=referral&utm_content=cta-navbar-support-Threatdown-business-click)

  Nebula and Oneview Customers

  [Community Forums](https://forums.malwarebytes.com/)

Free Download

Search
Search

Search Malwarebytes.com

Search for:

![Multilingual skimmer fingerprints 'secret shoppers' via Cloudflare endpoint API](https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/02/asset_upload_file81648_259209.jpg?w=736)

[Threat Intel](https://www.malwarebytes.com/blog/category/threat-intel)

# Multilingual skimmer fingerprints ‘secret shoppers’ via Cloudflare endpoint API

Posted: February 21, 2023
 by [Jérôme Segura](https://www.malwarebytes.com/blog/authors/jeromesegura)

One important aspect of data theft in criminal markets revolves around the authenticity of the data that is being resold. There are different services that exist to vet such things as credit card numbers so that buyers can purchase with confidence.

Criminals are also very aware that anyone and in particular security researchers may want to interfere with their operations. Filling up [phishing](https://www.malwarebytes.com/phishing) pages with junk data is a sport of its own, although it may also be counterproductive at times. Using special cards for tracing purposes can also be used by defenders to follow the money.

We recently spotted a Magecart skimmer that collects the current victim’s [IP address](https://www.malwarebytes.com/cybersecurity/basics/what-is-ip-address) and browser user-agent in addition to their email, address, phone number and credit card data. Because the victim already filled in their home address, we believe this is a fingerprinting effort much like what is done in traditional [malware](https://www.malwarebytes.com/malware) campaigns.

### Skimmer targets various geolocations

The skimmer uses iframes that are loaded if the current page is the checkout and if the browser’s local storage does not include a font item (this is equivalent to using [cookies](https://www.malwarebytes.com/cybersecurity/computer/what-are-tracking-cookies) to detect returning visitors).

![](https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/02/easset_upload_file98434_259209_e.png)

*Figure 1: Skimmer checking for address bar and inserting iframe*

The final rendering is identical to official payment platforms and does not give anything away:

![](https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/02/easset_upload_file37146_259209_e.png)

*Figure 2: Fake payment forms injected by skimmer*

### Fingerprinting via Cloudflare API

The underlying code will scrape everything from the customer’s contact and payment forms. This is something that is often overlooked when talking about digital skimmers but yet is extremely important. While financial institutions can reissue you a new card in the mail, the information the criminals have collected is equivalent to a [data breach](https://www.malwarebytes.com/cybersecurity/basics/data-breach) and can be reused for other types of fraud later on.

![](https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/02/easset_upload_file90188_259209_e.png)

*Figure 3: Skimmer data collection and fingerprinting*

One thing we noticed that was a little unusual, is code that queries the legitimate [Cloudflare endpoint API](https://developers.cloudflare.com/fundamentals/get-started/reference/cdn-cgi-endpoint/) and parses out the results specifically for two things: the user’s current IP address and browser’s user-agent. A user-agent string might look something like this:

*Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36*

From this you can determine the user is running Windows 10 (64 bit version) with Chrome version 110.

![](https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/02/easset_upload_file68312_259209_e.png)

*Figure 4: Stolen data including IP address and user-agent string...