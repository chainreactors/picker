---
title: Exploiting XSS in hidden inputs and meta tags
url: https://buaq.net/go-171750.html
source: unSafe.sh - 不安全
date: 2023-07-12
fetch_date: 2025-10-04T11:51:36.368491
---

# Exploiting XSS in hidden inputs and meta tags

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/5fe6b3598143ed482ac1625c14450374.jpg)

Exploiting XSS in hidden inputs and meta tags

Published: 11 July 2023 at 13:00 UTC
*2023-7-11 21:0:0
Author: [portswigger.net(查看原文)](/jump-171750.htm)
阅读量:41
收藏*

---

![Gareth Heyes](https://portswigger.net/content/images/profiles/callout_gareth_heyes_114px.png)

* **Published:** 11 July 2023 at 13:00 UTC
* **Updated:** 11 July 2023 at 13:00 UTC

![](https://portswigger.net/cms/images/5a/fe/ff94-article-xss-in-hidden-inputs-and-meta-tags-blog-article.png)

**In this post we are going to show how you can (ab)use the new HTML popup functionality in Chrome to exploit [XSS](https://portswigger.net/web-security/cross-site-scripting) in meta tags and hidden inputs.**

It all started when I noticed the
[new popover behaviour with Chrome](https://developer.chrome.com/blog/introducing-popover-api/) on Twitter. We all know about annoying modal dialogs that nag you to subscribe to a newsletter - now you can create these popups without JavaScript! Oh the joy. It's going to be a newsletter apocalypse.

Anyway, I noticed this functionality and wondered what JavaScript events these pop ups introduce. Sure enough, you can use the events ontoggle and onbeforetoggle and these apply to the popover target - this is an element that has an attribute of popover. This attribute makes the element invisible until you toggle the element by using the attribute `popovertarget`, with an element such as a button.

This is useful for bypassing a WAF, since you can use the `onbeforetoggle` event which is not likely to be blocked by an attribute-based blocklist:

![A code sample with a button using the popovertarget attribute and a dialog with the onbeforetoggle event](https://portswigger.net/cms/images/87/fa/ba3d-article-popover-xss-onbeforetoggle.png)

In the example above you can see the button element targets the custom 'xss' element using the `popovertarget`. When the button is clicked, the `onbeforetoggle` event will be fired.

## XSS in hidden inputs

I posted this on Twitter as I always do and
[Mario Heiderich](https://twitter.com/cure53berlin) pointed out that it even works with hidden inputs. This is significant because normally if you have XSS inside a hidden input, it may be hard to exploit because most events won't work. You can use
[access keys](https://portswigger.net/research/xss-in-hidden-input-fields)but this requires heavy user interaction. However, using popovers allows you to use new events in hidden inputs:

![A code sample showing popovers being applied to hidden inputs](https://portswigger.net/cms/images/91/43/e4e5-article-popovers-hidden-inputs.png)

[Mario mentioned](https://twitter.com/cure53berlin/status/1675873083373105154) that it would require two injection points; one sanitised harmless HTML injection, and one inside a hidden input. But that got me thinking - maybe you only need one. I fired up a HTML page and tested what would happen if two elements had the same id. Imagine a website contains code using the `popovertarget` attribute, and has an XSS vulnerability inside a hidden input:

![A code sample showing duplicate id attributes to demonstrate that the first attribute is used](https://portswigger.net/cms/images/ef/19/2c42-article-popovers-duplicate-ids.png)

Our injected code would execute the `onbeforetoggle` event inside the hidden input because it occurs first. This means you only need one injection point, provided it occurs before any existing pop up. Popovers will then allow you to use the `ontoggle` and `onbeforetoggle` events to be fired in hidden inputs with a click. So it's very useful if you have XSS inside a hidden input, and you have an existing popover element on the page.

## XSS in meta tags

Now it's already getting pretty interesting but wait, there's more!
[Mathias Karlsson](https://twitter.com/avlidienbrunn/status/1676549516785221635) chimed in with a great point; this technique enables you to use the `onbeforetoggle` event on a meta element, provided there's an existing popover element. This is significant because, like hidden inputs, meta elements are heavily restricted.

In the example below you have an injection inside a meta element that uses a popover attribute and a duplicate id (newsletter) which targets the existing popup on the page:

![A code sample showing that the onbeforetoggle event will be fired in a meta element](https://portswigger.net/cms/images/cb/4f/5667-article-popovers-meta.png)

When the user tries to subscribe to the newsletter they will instead fire the `onbeforetoggle` event on the hidden input.

As always, we've updated our [XSS cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onbeforetoggle) with these new vectors. If you like XSS filter bypasses you might enjoy our Web Security Academy labs for
[exploiting XSS in a link tag](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-canonical-link-tag), and this one that
[filters most HTML tags](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-most-tags-and-attributes-blocked).

Enjoy!

[Back to all articles](https://portswigger.net/research/articles)

文章来源: https://portswigger.net/research/exploiting-xss-in-hidden-inputs-and-meta-tags
 如有侵权请联系:admin#unsafe.sh

© [unSafe.sh - 不安全](https://unsafe.sh) Powered By [PaperCache](https://github.com/code-scan/PaperCache)

* admin#unsafe.sh
* [安全马克](https://aq.mk)
* [星际黑客](https://xj.hk)
* [T00ls](https://t00ls.net)