---
title: 2024高校网络安全管理运维赛 wp - 渗透测试中心
url: https://www.cnblogs.com/backlion/p/18449889
source: 博客园 - 渗透测试中心
date: 2024-10-08
fetch_date: 2025-10-06T18:51:01.193070
---

# 2024高校网络安全管理运维赛 wp - 渗透测试中心

[![](https://img2024.cnblogs.com/blog/35695/202509/35695-20250929100304557-587378723.jpg)](https://qoder.com/)

* [![博客园logo](//assets.cnblogs.com/logo.svg)](https://www.cnblogs.com/ "开发者的网上家园")
* [会员](https://cnblogs.vip/)
* [众包](https://www.cnblogs.com/cmt/p/18500368)
* [新闻](https://news.cnblogs.com/)
* [博问](https://q.cnblogs.com/)
* [闪存](https://ing.cnblogs.com/)
* [赞助商](https://www.cnblogs.com/cmt/p/19081960)
* [HarmonyOS](https://harmonyos.cnblogs.com/)
* [Chat2DB](https://chat2db-ai.com/)

* ![搜索](//assets.cnblogs.com/icons/search.svg)
  ![搜索](//assets.cnblogs.com/icons/enter.svg)
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    所有博客
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    当前博客
* [![写随笔](//assets.cnblogs.com/icons/newpost.svg)](https://i.cnblogs.com/EditPosts.aspx?opt=1 "写随笔")
  [![我的博客](//assets.cnblogs.com/icons/myblog.svg)](https://passport.cnblogs.com/GetBlogApplyStatus.aspx "我的博客")
  [![短消息](//assets.cnblogs.com/icons/message.svg)](https://msg.cnblogs.com/ "短消息")
  ![简洁模式](//assets.cnblogs.com/icons/lite-mode-on.svg)

  [![用户头像](//assets.cnblogs.com/icons/avatar-default.svg)](https://home.cnblogs.com/)

  [我的博客](https://passport.cnblogs.com/GetBlogApplyStatus.aspx)
  [我的园子](https://home.cnblogs.com/)
  [账号设置](https://account.cnblogs.com/settings/account)
  [会员中心](https://vip.cnblogs.com/my)
  简洁模式 ...
  退出登录

  [注册](https://account.cnblogs.com/signup)
  登录

[![返回主页](/skins/custom/images/logo.gif)](https://www.cnblogs.com/backlion/)

# [渗透测试中心](https://www.cnblogs.com/backlion)

##

* [博客园](https://www.cnblogs.com/)
* [首页](https://www.cnblogs.com/backlion/)
* [新随笔](https://i.cnblogs.com/EditPosts.aspx?opt=1)
* [联系](https://msg.cnblogs.com/send/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83)
* [管理](https://i.cnblogs.com/)
* 订阅
  [![订阅](/skins/coffee/images/xml.gif)](https://www.cnblogs.com/backlion/rss/)

# [2024高校网络安全管理运维赛 wp](https://www.cnblogs.com/backlion/p/18449889 "发布于 2024-10-07 12:08")

## 0x00 前言

本文是关于“2024高校网络安全管理运维赛”的详细题解，主要针对Web、Pwn、Re、Misc以及Algorithm等多方向题目的解题过程，包含但不限于钓鱼邮件识别、流量分析、SQLite文件解析、ssrf、xxe等等。如有错误，欢迎指正。

## 0x01 Misc

### 签到

给了一个gif，直接在线分帧

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120819907-1390671592.png)

得到`synt{fvtava-dhvm-jryy-qbar}`，一眼凯撒，直接rot13解码

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120820672-896619389.png)

```
flag{signin-quiz-well-done}
```

### 钓鱼邮件识别

给了一个eml邮件文件，可以用邮箱软件查看，也可以直接查看（可能麻烦点）

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120821340-2116028310.png)

#### Flag 1

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120821870-868854486.png)

直接base64解码，得到`flag{wElCoMeTo}`

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120822465-143472377.png)

#### Flag 2

下面的内容是base64编码的信息

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120823075-143775805.png)

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120823860-2139638910.png)

解码后查看，得到`flag{phIsHhuntINg}`

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120824663-1335732162.png)

#### Flag 3

eml文件剩下的内容没有flag了，只能从发件人的域名下手了

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120825274-741323631.png)

查下dns解析，这里用的是360威胁情报中心

<https://ti.360.net/domain/foobar-edu-cn.com>

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120825852-1448939065.png)

（这个情报中心会记录比赛过程的解析历史，所以现在直接看子域名信息就能得到flag）

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120826443-1666592385.png)

下面还是正常过一遍查询流程

除了第三方服务平台，也可以用windows自带的nslookup，查看域名的TXT记录

```
nslookup -qt=txt foobar-edu-cn.com
```

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120827102-464790713.png)

根据提示，应该是得去找该域名下的子域名的解析记录，三个拼接出完整的flag

由于域名是在国外申请的，国内很多网站都解析不出来，只能用国外的网站慢慢试

<https://www.virustotal.com/gui/domain/spf.foobar-edu-cn.com/details> spf

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120827823-419696328.png)

<https://dnsspy.io/scan/foobar-edu-cn.com> default.\_domainkey

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120828533-1913588964.png)

<https://www.misk.com/tools/#dns/_dmarc.foobar-edu-cn.com> \_dmarc

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120829125-70163515.png)

分别得到三个部分，拼接得到flag

```
flag_part1={N0wY0u
flag_part2=_Kn0wH0wt0_
flag_part3=ANAlys1sDNS}
flag{N0wY0u_Kn0wH0wt0_ANAlys1sDNS}
```

其实那三个子域名是对应电子邮件服务器的几种协议，例如：SPF、DKIM 和 DMARC，分别提供对应服务

<https://help.aliyun.com/document_detail/2685946.html>

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120829659-358713079.png)

### easyshell

给一个pcap流量包，直接能看到在post请求shell.php，应该是在传马后命令执行

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120830385-906062108.png)

过滤下http流，确信上面猜想

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120831085-632034359.png)

追踪http流，post的内容是加密过的，结合题目和冰蝎4.0的流量特征，猜测这个是冰蝎马

冰蝎流量特征：

* Accept: application/json, text/javascript, \*/\*; q=0.01
* Content-type: Application/x-www-form-urlencoded
* Connection: Keep-Alive
* …

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120831833-1300603601.png)

冰蝎4.0使用AES加密，默认密钥为`e45e329feb5d925b`，即md5('rebeyond')的前16位

冰蝎3.0，默认密码为：e45e329feb5d925b，可以看看：[behinder\_decrypt/decropt.php at master · melody27/behinder\_decrypt · GitHub](https://github.com/melody27/behinder_decrypt/blob/master/decropt.php)

从最后一个响应包往回解码试试

这里需要注意Cyber的AES-CBC模式的iv不能空着，但又不需要偏移，所以填入0

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120832521-86490841.png)

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120833070-676910066.png)

找到一个有内容的

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120833701-870746676.png)

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120834315-1884909712.png)

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120834930-877210755.png)

看看请求包是在请求什么，这里放下解码后的结果，可以看出是在读取secret2.txt文件

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120835599-1233000164.png)

secret2.txt

```
Hello, but what you're looking for isn't me.
```

然后在前一个响应包找到关键内容

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120836251-715710221.png)

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120836999-1607009879.png)

是个zip压缩包，直接保存出来

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120837706-1326082165.png)

查看zip，有个secret1.txt和secret2.txt，需要密码

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120838351-1288041853.png)

结合已知secret2.txt的内容，我们可以通过已知明文攻击

先写个secret2.txt，保存为zip，保证和原来的加密算法一样

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120838945-1510132340.png)

开始明文攻击，这里有个小技巧，等他显示找回口令时停止，弹出窗口点保存就能解压了

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120839557-589895250.png)

得到`flag{70854278-ea0c-462e-bc18-468c7a04a505}`

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120840168-40626172.png)

### SecretDB

题目给了一个sqlite的db文件，打开只有`Too late, no flag for you.`

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120840748-1721185214.png)

应该得恢复被delete的信息，没有找到能直接恢复的工具，要么恢复不出来要么乱码，尝试手动提取

参考：<https://www.cnblogs.com/jiangcsu/p/6569045.html>

重点是单元内的结构

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120841412-646073074.png)

010editor打开secret.db，定位到flag处查看，红框下面的部分就是之前被删除的数据

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120842004-1410306822.png)

从上面数据库flag表的结构，我们能看出列为id、sort和message，sort是排序用的索引，message存储可见字符，所以我们可以简单的观察上图的可见字符，也就是message，那么他们的前一位就是sort了，例如可见字符9的十六进制为39，它的前一位为0e，所以索引为0e的值为9

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241007120842641-1339428999.png)

依次类推，提取剩余的值

```
0x17 -
0x0 f
0xe 9
0x1b 7
0x10 3
0xa b
0x19 2
0x14 b
0xf 2
0x12 -
0x23 4
0x16 6
0x1f a
0x25 8
0x2 a
0x1e f
0x5...