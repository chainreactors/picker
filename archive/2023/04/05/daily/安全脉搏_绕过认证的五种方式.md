---
title: 绕过认证的五种方式
url: https://www.secpulse.com/archives/198619.html
source: 安全脉搏
date: 2023-04-05
fetch_date: 2025-10-04T11:29:22.294952
---

# 绕过认证的五种方式

[![](https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo-header.png)](https://www.secpulse.com "安全脉搏")

* [首页](https://www.secpulse.com/)
* [分类阅读](https://www.secpulse.com/archives/category/category)

  #### 脉搏文库

  - [内网渗透](https://www.secpulse.com/archives/category/articles/intranet-penetration)
  - |
  - [代码审计](https://www.secpulse.com/archives/category/articles/code-audit)
  - |
  - [安全文献](https://www.secpulse.com/archives/category/articles/sec-doc)
  - |
  - [Web安全](https://www.secpulse.com/archives/category/articles/web)
  - |
  - [移动安全](https://www.secpulse.com/archives/category/articles/mobile-security)
  - |
  - [系统安全](https://www.secpulse.com/archives/category/articles/system)
  - |
  - [工控安全](https://www.secpulse.com/archives/category/articles/industrial-safety)
  - |
  - [CTF](https://www.secpulse.com/archives/category/exclusive/ctf-writeup)
  - |
  - [IOT安全](https://www.secpulse.com/archives/category/iot-security)
  - |

#### 安全建设

+ [业务安全](https://www.secpulse.com/archives/category/construction/businesssecurity)
+ |
+ [安全管理](https://www.secpulse.com/archives/category/construction/securityissue)
+ |
+ [数据分析](https://www.secpulse.com/archives/category/construction/bigdata)
+ |

#### 其他

+ [资讯](https://www.secpulse.com/archives/category/news)
+ |
+ [漏洞](https://www.secpulse.com/archives/category/vul)
+ |
+ [工具](https://www.secpulse.com/archives/category/tools)
+ |
+ [人物志](https://www.secpulse.com/archives/category/people)
+ |
+ [区块链安全](https://www.secpulse.com/archives/category/exclusive/block_chain_security)
+ |
+ [安全招聘](https://www.secpulse.com/archives/category/hiring)
+ |

- [安全问答](https://www.secpulse.com/newpage/question_list)
- [金币商城](https://www.secpulse.com/shop?donotcachepage=c010349fd98847cb9d6e07d3cbc19288)
- [安全招聘](https://www.secpulse.com/archives/category/hiring)
- [活动日程](https://www.secpulse.com/newpage/activity)
- [live课程](https://www.secpulse.com/live)
- [企业服务](https://duoyinsu.com/service.html)
- [插件社区](https://x.secpulse.com/)

小程序

![脉搏小程序](https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg)
[登录](https://www.secpulse.com/user_login)
|
[注册](https://www.secpulse.com/user-register)

# 绕过认证的五种方式

[Web安全](https://www.secpulse.com/archives/category/articles/web)

[TideSec](https://www.secpulse.com/newpage/author?author_id=26366)
![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng0.png)

2023-04-04

20,585

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198619-1680590731.png)

# 1.概述

认证绕过漏洞是现在 Web 应用中存在的常见缺陷，但它们并不总是那么容易被发现。

随着技术的不断发展，各式各样的平台整合，传统的身份验证方法正在逐渐减少，新的验证方式不仅为用户使用提供了便捷，安全性也上升了一个台阶。虽然像利用单点登录(SSO)这样的方式对旧的用户登录方式进行改进，但是这些技术仍然可能包含关键的漏洞。无论是业务逻辑错误还是其他一些缺陷配置，那么如何发现这些脆弱点呢？

# 2.思路

## 2.1.令牌刷新端的错误配置

在这种情况下，用户使用有效凭据登录到应用程序，就会创建身份验证令牌进行身份验证。而此身份验证令牌在一段时间后过会过期。就在过期之前的这段时间内，通过 `endpoint/refresh/tokenlogin` 向服务器发送了一个包含 `username`参数的请求，此时返回包中就会出现有效 auth 令牌。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198619-1680590732.png "null")

## 2.2. 错误的sso配置

随着平台的多样性，用户需求的不断提高，为了方便用户通过一次性用户身份验证登录多个应用程序和网站，大多数平台都会使用 SSO 系统。但是简单地使用 SSO 并不能自动保护系统: SSO 的配置也必须是安全的。

在这里，一个应用程序使用 Microsoft SSO 系统进行身份验证。当浏览`internal.test.com`网址时，浏览器会重定向到单点登录系统:

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198619-1680590736.png "null")

乍一看，它好像是安全的，但是分析后端请求显示，关于重定向响应内容，程序返回了异常大的内容，内容超过40000字节！

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198619-1680590738.png "null")

为什么要这么返回？能不能一些其他操作来直接跳转进目的地？

自己就会发现，服务端将用户发送到重定向到 SSO 的过程的内容里泄露了对该请求的内部响应。那么篡改响应试试看。

将`302` Find 头更改为`200 OK`，并删除整个 Location 头。成功绕过。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198619-1680590747.png "null")

当然，可以通过在`Burp Suite`中添加 `Match & Replace` 规则来直接删除并自动更改值，从而实现这一过程的自动化。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198619-1680590751.png "null")

## 2.3.CMS个例的访问问题

像 WordPress、 Drupal 和 Hubspot 这样的CMS也需要进行安全配置，以免出现这样的漏洞。

这里举一个Liferay的例子，也是基于巧合遇到的。这应用有一个无需身份验证即可访问的登录页面。

Liferay使用 portlet 作为应用的sso，它在数字编号中有一个参数 `p _ p _ id`。对于Portlet来讲，可以通过将参数更改为值58来访问登录 Portlet。在普通登录页面上，只能访问登录页。但是，通过直接访问 Portlet，可以访问`Create Account`功能，然后允许`self-registration`功能访问后台内容，无需授权。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198619-1680590755.png "null")

尽管 Liferay 以前使用过这个工作流，但它的最新版本使用 Portlet 名称而不是数字 id。不过，也可以通过更改名称来访问其他 Portlet。

## 2.4.JWT Token的错误解析

JWT 令牌或 JSON Web Token在Web 中应用十分广泛。但是，虽然默认情况下它们有一个安全机制，就是密钥，但是后端服务器的解析机制够不够安全就不一定了。

曾有个网站使用的是JWT，当直接访问时，应用程序将用户重定向到 `Microsoft SSO` 网页。

但是，一些 JS 文件可以在没有身份验证的情况下访问。测试时发现应用程序使用 JWT 令牌，这些令牌在安全登录后通过`Microsoft SSO`系统发送。在后端机制中，存在一个安全错误配置，它没有检查是否是为特定应用程序生成的 JWT 令牌——相反，它接受任何具有有效签名的 JWT 令牌。这里使用微软网站上的一个 JWT 令牌示例:

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198619-1680590757.png)

对内容进行解码：

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198619-1680590758.png)

访问内部接口，成功获取数据：

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198619-1680590767.png)

## 2.5.暴力修改Authentication

在此案例中，通过 base64编码的 XML 请求发送到后端验证。在登录机制上，它将用户名、密码分别发送。Scode 参数中的值是密码的md5值。。请求中还有另一个有趣的标志: scode 有一个值为2。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198619-1680590769.png)

尝试将值赋给1，成功了！于是尝试将Scode进行遍历。通过遍历发现，除了0之外，大多数都是报错的。换个思路，Scode 参数中的值是密码，对密码进行操作，也没有成功，密码值为空值呢？

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198619-1680590770.png "null")

最终发现，只要提供用户名和空密码就可以绕过认证。

# 3.结论

复杂的身份验证机制可能成为新的攻击途径，特别是在容易出现业务逻辑缺陷的应用程序中。由于自动化的扫描器通常无法找到这些漏洞，因此仍然需要手动来找到它们。

**本文作者：[TideSec](newpage/author?author_id=26366)**

**本文为安全脉搏专栏作者发布，转载请注明：**[**https://www.secpulse.com/archives/198619.html**](https://www.secpulse.com/archives/198619.html)

Tags: [cms](https://www.secpulse.com/archives/tag/cms)、[drupal](https://www.secpulse.com/archives/tag/drupal)、[Hubspot](https://www.secpulse.com/archives/tag/hubspot)、[JWT](https://www.secpulse.com/archives/tag/jwt)、[sso](https://www.secpulse.com/archives/tag/sso)、[Web](https://www.secpulse.com/archives/tag/web-2)、[wordpress](https://www.secpulse.com/archives/tag/wordpress)、[令牌](https://www.secpulse.com/archives/tag/%E4%BB%A4%E7%89%8C)、[绕过](https://www.secpulse.com/archives/tag/%E7%BB%95%E8%BF%87)、[认证绕过漏洞](https://www.secpulse.com/archives/tag/%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E)

点赞：
0
[评论：0](#goComment)
收藏：
0

*新浪微博
QQ空间
微信扫一扫*

### 相关文章

* [![【HackTheBox】攻克靶机实战interdimensional internet攻略分享](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/05/1684393312004-300x222.png)

  【HackTheBox】攻克靶机实战in…](https://www.secpulse.com/archives/200516.html "详细阅读 【HackTheBox】攻克靶机实战interdimensional internet攻略分享")
* [![记一次springboot项目漏洞挖掘](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-200022-1683537351-300x173.png)

  记一次springboot项目漏洞挖掘](https://www.secpulse.com/archives/200022.html "详细阅读 记一次springboot项目漏洞挖掘")
* [![从JS到内网横向](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/04/1682065936883-300x267.png)

  从JS到内网横向](https://www.secpulse.com/archives/199384.html "详细阅读 从JS到内网横向")

评论  (0)

昵称

必填
您当前尚未登录。
[登录？](https://www.secpulse.com/user_login "登录")
[注册](https://www.secpulse.com/user-register)

邮箱

必填（保密）

快来写下你的想法吧！

upload

|  |  |  |
| --- | --- | --- |
| [![]( https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/43b12cc12b9dbbe6a010c40d69088feb-300x298.png)](https://www.secpulse.com/newpage/author?author_id=26366aaa) | [TideSec ![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng0.png)](https://www.secpulse.com/newpage/author?author_id=26366) | |
| 文章数：145 | 积分： 185 |
|  | |

* [![阿波罗主机安全管理](/wp-content/themes/...