---
title: Wordfence Evasion Malware Conceals Backdoors
url: https://blog.sucuri.net/2022/10/wordfence-evasion-malware-conceals-backdoors.html
source: Sucuri Blog
date: 2022-10-21
fetch_date: 2025-10-03T20:28:49.981819
---

# Wordfence Evasion Malware Conceals Backdoors

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)

[Login](https://dashboard.sucuri.net/login/)

[Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)

Search for:

Search

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

# Wordfence Evasion Malware Conceals Backdoors

[![](https://secure.gravatar.com/avatar/49a04d32074892dc04d9ed823aa114f8492a90e9c88852302b083c90aa322c21?s=60&d=mm&r=g)](https://blog.sucuri.net/author/benmartin)

[Ben Martin](https://blog.sucuri.net/author/benmartin)

* October 20, 2022

![Wordfence Evasion Malware Conceals Backdoors](https://blog.sucuri.net/wp-content/uploads/2022/10/BlogPost_Feature-Image_1490x700_Wordfence-Evasion-Malware-Conceals-Backdoors-820x386.png)

Malware authors, with some notable [exceptions](https://blog.sucuri.net/2020/06/what-is-a-website-defacement.html), tend to design their malicious code to hide from sight. The techniques they use help their malware stay on the victim’s website for as long as possible and ensure execution. For example — [obfuscation techniques](https://blog.sucuri.net/2021/01/obfuscation-techniques-in-ransomweb-ransomware.html), [fake code comments](https://blog.sucuri.net/2015/10/malware-in-comments.html), naming conventions for injections that deploy SEO spam, [redirect visitors to malicious third party websites](https://blog.sucuri.net/2022/02/attackers-abuse-poorly-regulated-top-level-domains-in-ongoing-redirect-campaign.html), or steal credit card information from eCommerce stores.

To combat malware and keep WordPress websites safe from threats a variety of different security software has been developed in the form of plugins or extensions.

But, what if the security software *itself* is tampered with? This could allow malware to stay present even when measures have been put into place to protect the environment. This is exactly what we recently found in one such compromised environment.

In this post, we’ll reveal how attackers compromised a website and tampered with the existing Wordfence plugin to plant malicious website backdoors and evade detection.

**Contents:**

* **[Modifications in wordfence.php](#modifications-in-wordfence-php)**
* **[Wordfence plugin evasive techniques](#evasive-techniques)**
* **[Removal of important warnings](#removal-of-warnings)**
* **[Malicious activity via code removal](#code-removal)**
* **[Plugin update prevention](#update-prevention)**
* **[Resolution steps](#resolution-steps)**
* **[How to prevent malware](#how-to-prevent-malware)**

## The first clue: modifications in wordfence.php

Whenever we perform malware removal on our client’s website environments we are always on the lookout for new, previously undetected samples.

Attackers are enhancing their malware all the time and we uncover new variants for existing malicious PHP, JavaScript, and other scripts on a daily basis. We maintain one of the best [libraries of web-based malware](https://labs.sucuri.net/signatures/) in the world. Always checking for new samples “*in the wild”* is one of the ways that we do that.

Furthermore, one of the best ways of uncovering these new samples is through an [integrity check](https://blog.sucuri.net/2021/05/server-side-scans-and-file-integrity-monitoring.html) *–* that is, comparing the file hashes of the files on the server to known good copies.

When we checked the hashes of the plugin files on this one particular website we found two very interesting modifications:

```
./wp-content/plugins/wordfence/wordfence.php
./wp-content/plugins/wordfence/lib/wordfenceScanner.php
```

Let’s investigate what was amiss.

## Wordfence plugin evasive techniques

With over 4 million active installations the WordFence WordPress plugin is without a doubt one of the most popular security plugins in use today. It’s an excellent security suite with lots of features like malware scanning, brute force protection, 2FA, and more.

Like any other plugin, though, it can be tampered with if the attackers are able to gain a foothold into the environment. At the end of the day plugins are just code, and code will do whatever it’s told to do.

In this case, the attackers had accessed the compromised website and modified the WordFence plugin files *themselves* to conceal multiple malicious backdoors within the environment.

Let’s take a look at what was added to the **wordfence.php** file:

[![Malicious code found in wordfence.php plugin file](https://blog.sucuri.net/wp-content/uploads/2022/10/malicious_code_wordfence_php_plugin.png)](https://blog.sucuri.net/wp-content/uploads/2022/10/malicious_code_wordfence_php_plugin.png)

Malicious code found in wordfence.php plugin file

The WordFence plugin stores a lot of information within the WordPress database; that includes war...