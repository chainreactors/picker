---
title: CVE-2023-29298: Adobe ColdFusion Access Control Bypass
url: https://govuln.com/news/url/dNQR
source: Sec-News 安全文摘
date: 2023-07-13
fetch_date: 2025-10-04T11:51:28.831288
---

# CVE-2023-29298: Adobe ColdFusion Access Control Bypass

[![Rapid7](/_next/static/media/rapid7-logo.cd245920.svg)](/)

* Platform
* Services
* Resources
* Partners
* Company

##

[Request Demo](/request-demo/)

[Back to Blog](/blog/)

Exposure Management

# CVE-2023-29298: Adobe ColdFusion Access Control Bypass

[![Stephen Fewer](https://www.rapid7.com/cdn/assets/bltf15ddabb3353ea8a/68404474116bcf0c4b2201e8/Stephen-Fewer.jpg)

Stephen Fewer](/blog/author/sfewer-r7/)

Jul 11, 2023|Last updated on Dec 27, 2023|xx min read

![CVE-2023-29298: Adobe ColdFusion Access Control Bypass](https://www.rapid7.com/cdn/assets/blt1de2821d1eac3ffb/683ddc6570aa95f50bfe2f13/vuln-disclosure-banner.jpeg)

Rapid7 discovered an access control bypass vulnerability affecting Adobe ColdFusion, in a product feature designed to restrict external access to the ColdFusion Administrator. Rapid7 reported this vulnerability to Adobe on April 11, 2023 and we are now disclosing it in accordance with our vulnerability disclosure policy.

The access control feature establishes an allow list of external IP addresses that are permitted to access the ColdFusion Administrator endpoints on a ColdFusion web server. When a request originates from an external IP address that is not present in the allow list, access to the requested resource is blocked. This access control forms part of the recommended configuration for production environments, as described during installation of the product:

“Production Profile + Secure Profile: Use this profile for a highly-secure production deployment that will allow a more fine-grained secure environment.”

Alternatively, an installation that is not configured with the Secure Profile may manually configure the access control post installation.
 The vulnerability allows an attacker to access the administration endpoints by inserting an unexpected additional forward slash character in the requested URL.

## Product description

Adobe ColdFusion is a commercial application server for web application development. ColdFusion supports a proprietary markup language for building web applications and integrating into many external components, such as databases and third party libraries.

This issue affects the following versions of Adobe ColdFusion:

* Adobe ColdFusion 2023.
* Adobe ColdFusion 2021 Update 6 and below.
* Adobe ColdFusion 2018 Update 16 and below.

## Impact

This vulnerability undermines the security guarantees offered by the ColdFusion Secure Profile. Using the access control bypass as described above, an attacker is able to access every CFM and CFC endpoint within the ColdFusion Administrator path /CFIDE/, of which there are 437 CFM files and 96 CFC files in a ColdFusion 2021 Update 6 install. Note that *access* to these resources does not imply the attacker is *authorized* to use these resources, many of which will check for an authorized session before performing their operation. However the impact of being able to access these resources is as follows:

* The attacker may log in to the ColdFusion Administrator if they have known credentials.
* The attacker may bruteforce credentials.
* The attacker may leak sensitive information.

The attacker has increased the attack surface considerably and should a vulnerability be present in one of the many exposed CFM and CFC files, the attacker is able to target the vulnerable endpoint.

## Credit

This vulnerability was discovered by Stephen Fewer, Principal Security Researcher at Rapid7 and is being disclosed in accordance with Rapid7’s vulnerability disclosure policy.

## Vendor statement

CVE-2023-29298 has been addressed in Adobe's APSB23-40 Security Bulletin - CF2018 Update 17, CF2021 Update 7, and CF2023 GA build. Adobe greatly appreciates collaboration with the broader security community and our ongoing work with Rapid7.

## Analysis

The access control restricts access for external request to resources that are found within the following URL paths:

```
/restplay
/CFIDE/restplay
/CFIDE/administrator
/CFIDE/adminapi
/CFIDE/main
/CFIDE/componentutils
/CFIDE/wizards
/CFIDE/servermanager
```

Several Java servlets enforce the access control on their exposed resources:

* The coldfusion.CfmServlet which handles all requests to ColdFusion Module (CFM) endpoints.
* The coldfusion.xml.rpc.CFCServlet which handles requests to ColdFusion Markup Language (CFML) and ColdFusion Component (CFC) endpoints.
* The coldfusion.rds.RdsGlobals which handles requests for the Remote Development Service (RDS) feature.

The access control feature is implemented in the coldfusion.filter.IPFilterUtils class, and the method checkAdminAccess implements the logic for the access control, as shown below:

```
public class IPFilterUtils {
private static final String[] PATHS = new String[] { "/restplay", "/cfide/restplay", "/cfide/administrator", "/cfide/adminapi", "/cfide/main", "/cfide/componentutils", "/cfide/wizards", "/cfide/servermanager" };
public static void checkAdminAccess(HttpServletRequest req) {
String uri = req.getRequestURI();
String uriToMatch = uri.substring(req.getContextPath().length()).toLowerCase();
for (String path : PATHS) {
if (uriToMatch.startsWith(path)) {
String ip = req.getRemoteAddr();
if (!isAllowedIP(ip))
throw new AdminAccessdeniedException(ServiceFactory.getSecurityService().getAllowedAdminIPList(), ip);
break;
}
}
}
```

We can observe from the highlighted statement above that an HTTP request’s URL path is compared to a list of sensitive paths, and if found to begin with any of these sensitive paths, a further check is performed to see if the request’s external IP address is present in the allow list. If the request to a sensitive path is not from an allowed external IP address, an exception is raised which results in the request being denied.

As the attacker-controlled URL path is tested with a call to java.lang.String.startsWith, this access check can be bypassed by inserting an additional character at the start of the URL path, which will cause the startsWith check to fail but will still allow the underlying servlet to be able to resolve the requested resource. The character in question is an additional forward slash. For example, when requesting a resource that starts with the sensitive /CFIDE/adminapi path, the attacker can request this resource from the path //CFIDE/adminapi, which will bypass the access control while still being a valid path to the requested resource.

## Exploitation

The following was tested on Adobe ColdFusion 2021 Update 6 (2021.0.06.330132) running on Windows Server 2022 and configured with the Production and Secure profiles enabled and access to the ColdFusion Administrator limited to the localhost address 127.0.0.1.

We can demonstrate the vulnerability using the cURL command. For example when attempting to perform a remote method call wizardHash on the /CFIDE/wizards/common/utils.cfc endpoint, the following cURL command can be used:

*Note: The ampersand (&) has been escaped with a caret (^) as this example is run from Windows. On Linux you must escape the ampersand with a forward slash ().*

```
\> curl -v -k http://172.23.10.174:8500/CFIDE/wizards/common/utils.cfc?method=wizardHash^&inPassword=foo
```

We can see in the screenshot below how this request fails due to the access control being in place:

![image2.png](https://www.rapid7.com/cdn/assets/bltb783862d74d17404/683dde00da5c301d2aa833dd/image2.png)

However, if we issue the following cURL command, noting the double forward slash in the path:

```
c:\> curl -v -k http://172.23.10.174:8500//CFIDE/wizards/common/utils.cfc?method=wizardHash^&inPassword=foo
```

![image1.png](https://www.rapid7.com/cdn/assets/blt8e335a1696896dcd/683dde26e3c8aa315c830ccc/image1.png)

We can see that the access control has been bypassed and the request completed successfully.

Similarly, if we try to access the ColdFusion Administrator interface in a web browser from an external IP that is not allowed access, the following error is displayed.

![image6.png](https://www.rapid7.com/cdn/a...