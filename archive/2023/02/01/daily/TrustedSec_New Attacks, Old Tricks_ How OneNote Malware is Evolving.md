---
title: New Attacks, Old Tricks: How OneNote Malware is Evolving
url: https://www.trustedsec.com/blog/new-attacks-old-tricks-how-onenote-malware-is-evolving/
source: TrustedSec
date: 2023-02-01
fetch_date: 2025-10-04T05:23:09.261099
---

# New Attacks, Old Tricks: How OneNote Malware is Evolving

[Skip to Main Content](#main)

All Trimarc services are now delivered through TrustedSec!
[Learn more](https://trustedsec.com/about-us/news/trimarc-joins-forces-with-trustedsec-to-strengthen-security-advisory-services)

Close

[TrustedSec](https://trustedsec.com/)

* [Solutions](https://trustedsec.com/solutions)

  ## Solutions

  Our custom solutions are tailored to address the unique challenges of different roles in security.

  [Solutions](https://trustedsec.com/solutions)

  + [01

    For Leadership

    We understand the challenges facing modern executives and develop solutions unique to leaders.](https://trustedsec.com/solutions/for-leadership)
  + [02

    For Operations

    We stay one step ahead to proactively safeguard our clients and partners.](https://trustedsec.com/solutions/for-operations)
  + [03

    For Infrastructure

    From architecture to resiliency and maintainability, we keep your tech aligned to best practices.](https://trustedsec.com/solutions/for-infrastructure)
  + [04

    For Assurance

    Our compliance experts guide partners through regulatory requirements to ensure standards are met.](https://trustedsec.com/solutions/for-assurance)
* [Services](https://trustedsec.com/services)

  ## Services

  From building to testing to hardening, our services support security at every stage.

  [Services](https://trustedsec.com/services)

  + [01

    Design

    Design an exceptional, custom security program alongside our security experts.](https://trustedsec.com/services/design)
  + [02

    Evaluate

    Evaluate your security program with proven assessment methodologies.](https://trustedsec.com/services/evaluate)
  + [03

    Harden

    Harden your security program with the help of our security experts.](https://trustedsec.com/services/harden)
  + [04

    Respond

    Respond to threats to your security program with the help of our security experts.](https://trustedsec.com/services/respond)
* [Research](https://trustedsec.com/research)
* [Blog](https://trustedsec.com/blog)
* [Resources](https://trustedsec.com/resources)
* [About Us](https://trustedsec.com/about-us)

  ## About Us

  Driven by purpose, fueled by experts.

  [About Us](https://trustedsec.com/about-us)

  + [01

    Our Team

    Meet our security experts.](https://trustedsec.com/about-us/our-team)
  + [02

    Our Partners

    Become a TrustedSec partner to help your customers anticipate and prepare for potential attacks.](https://trustedsec.com/about-us/our-partners)
  + [03

    News

    Our team is trusted by local and national media to be the subject matter experts for security news.](https://trustedsec.com/about-us/news)
  + [04

    Events

    See our upcoming webinars, conferences, talks, trainings, and more!](https://trustedsec.com/about-us/events)

Search

Menu

Search Input

Search

* [Contact Us](https://trustedsec.com/contact)
* [Report a breach](https://trustedsec.com/report-a-breach)

* [Solutions](https://trustedsec.com/solutions)
* [Services](https://trustedsec.com/services)
* [Research](https://trustedsec.com/research)
* [Blog](https://trustedsec.com/blog)
* [Resources](https://trustedsec.com/resources)
* [About Us](https://trustedsec.com/about-us)

Search

* [Contact Us](https://trustedsec.com/contact)
* [Report a breach](https://trustedsec.com/report-a-breach)

* [Blog](https://trustedsec.com/blog)
* [New Attacks, Old Tricks: How OneNote Malware is Evolving](https://trustedsec.com/blog/new-attacks-old-tricks-how-onenote-malware-is-evolving)

January 31, 2023

# New Attacks, Old Tricks: How OneNote Malware is Evolving

Written by
Scott Nusbaum

Incident Response
Incident Response & Forensics
Malware Analysis
Office 365 Security Assessment
Purple Team Adversarial Detection & Countermeasures
Threat Hunting

![](https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/AnalysisOneNoteMalware_WebHero.jpg?w=320&h=320&q=90&auto=format&fit=crop&dm=1695566179&s=bb8b909aa957307bba008335c84b983a)

Share

* Share URL
* [Share via Email](/cdn-cgi/l/email-protection#37084442555d5254430a745f52545c120507584243120507435f5e441205075645435e545b521205075145585a1205076345424443525364525412050611565a470c5558534e0a79524012050776434356545c44120574120507785b5312050763455e545c441204761205077f5840120507785952795843521205077a565b405645521205075e441205077241585b415e59501204761205075f43434744120476120571120571434542444352534452541954585a120571555b58501205715952401a56434356545c441a585b531a43455e545c441a5f58401a585952595843521a5a565b405645521a5e441a5241585b415e5950 "Share via Email")
* [Share on Facebook](http://www.facebook.com/sharer.php?u=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fnew-attacks-old-tricks-how-onenote-malware-is-evolving "Share on Facebook")
* [Share on X](http://twitter.com/share?text=New%20Attacks%2C%20Old%20Tricks%3A%20How%20OneNote%20Malware%20is%20Evolving%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fnew-attacks-old-tricks-how-onenote-malware-is-evolving "Share on X")
* [Share on LinkedIn](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fnew-attacks-old-tricks-how-onenote-malware-is-evolving&mini=true "Share on LinkedIn")

## 1    Analysis of OneNote Malware

A lot of information has been circulating regarding the distribution of malware through OneNote, so I thought it would be fun to look at a sample. It turns out there are a lot of similarities between embedding malicious code into a OneNote document and the old macro/VBA techniques for Office documents. In this blog, we will go through the steps used to determine what the malicious code is and what it is doing.

OneNote is Microsoft’s note taking application that allows collaboration across organizations while enabling the participants to embed files and other artifacts. I have seen these tools successfully utilized in Incident Response engagements to help document incidents in real-time and keep artifacts organized.

Recently, malware authors have increasingly utilized a feature within OneNote to execute a select number of file types directly from within OneNote. Most file types that can be processed by MSHTA, WSCRIPT, and CSCRIPT can be executed from within OneNote. These file types include CHM, HTA, JS, WSF, and VBS. Once an end-user is tricked into clicking on the embedded file, it will be executed. These embedded scripts are mostly small downloaders that will reach out to an external site to get the real malware. I have not seen this, but the text in a OneNote document can also be created as a link to an external resource. This resource would then be downloaded to the user’s system but not executed. The next step in the phishing attempt could be to convince the user to execute the downloaded file.

## 2    Analysis of a OneNote Malware Sample

The sample that we are reviewing was obtained from VirusTotal, and at the time of download, the external URI references were no longer active.

As with all malware samples, I upload the sample to my forensic Linux system for analysis. This is done to prevent accidentally exploding the document and infecting my Windows virtual machine (VM).

The first two (2) commands that I always use on a piece of malware are **file** and **strings**. Running the **file** command on this sample, the response comes back as ***data***, meaning it is an unknown file type.

![](https://www.trustedsec.com/wp-content/uploads/2023/01/Nusbaum_1.png)

Hmm… that is not too helpful. Let’s see what the **strings** command can provide.

![](https://www.trustedsec.com/wp-content/uploads/2023/01/Nusbaum_2.png)

Figure 2 - Malicious HTA Script From OneNote File

Well, that is more interesting. The **strings** command provides four (4) different embedded HTA files. We will review what these do later. The **strings** command also provides five (5) different VBScripts. The next step is to run strings with the `-e l` option. This provides the Unicode strings. The Unicode strings do not add too much but allow us to see roughly how the file is pu...