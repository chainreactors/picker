---
title: 最实用的应急响应笔记思路总结（附工具）
url: https://www.secpulse.com/archives/194607.html
source: 安全脉搏
date: 2023-01-05
fetch_date: 2025-10-04T03:03:07.537043
---

# 最实用的应急响应笔记思路总结（附工具）

[![](https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo-header.png)](https://www.secpulse.com "安全脉搏")

* [首页](https://www.secpulse.com/)
* [分类阅读](https://www.secpulse.com/archives/category/category)

  #### 脉搏文库

  - [内网渗透](https://www.secpulse.com/archives/category/articles/intranet-penetration)
  - |
  - [代码审计](https://www.secpulse.com/archives/category/articles/code-audit)
  - |
  - [安全文献](https://www.secpulse.com/archives/category/articles/sec-doc)
  - |
  - [Web安全](https://www.secpulse.com/archives/category/articles/web)
  - |
  - [移动安全](https://www.secpulse.com/archives/category/articles/mobile-security)
  - |
  - [系统安全](https://www.secpulse.com/archives/category/articles/system)
  - |
  - [工控安全](https://www.secpulse.com/archives/category/articles/industrial-safety)
  - |
  - [CTF](https://www.secpulse.com/archives/category/exclusive/ctf-writeup)
  - |
  - [IOT安全](https://www.secpulse.com/archives/category/iot-security)
  - |

#### 安全建设

+ [业务安全](https://www.secpulse.com/archives/category/construction/businesssecurity)
+ |
+ [安全管理](https://www.secpulse.com/archives/category/construction/securityissue)
+ |
+ [数据分析](https://www.secpulse.com/archives/category/construction/bigdata)
+ |

#### 其他

+ [资讯](https://www.secpulse.com/archives/category/news)
+ |
+ [漏洞](https://www.secpulse.com/archives/category/vul)
+ |
+ [工具](https://www.secpulse.com/archives/category/tools)
+ |
+ [人物志](https://www.secpulse.com/archives/category/people)
+ |
+ [区块链安全](https://www.secpulse.com/archives/category/exclusive/block_chain_security)
+ |
+ [安全招聘](https://www.secpulse.com/archives/category/hiring)
+ |

- [安全问答](https://www.secpulse.com/newpage/question_list)
- [金币商城](https://www.secpulse.com/shop?donotcachepage=c010349fd98847cb9d6e07d3cbc19288)
- [安全招聘](https://www.secpulse.com/archives/category/hiring)
- [活动日程](https://www.secpulse.com/newpage/activity)
- [live课程](https://www.secpulse.com/live)
- [企业服务](https://duoyinsu.com/service.html)
- [插件社区](https://x.secpulse.com/)

小程序

![脉搏小程序](https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg)
[登录](https://www.secpulse.com/user_login)
|
[注册](https://www.secpulse.com/user-register)

# 最实用的应急响应笔记思路总结（附工具）

[Web安全](https://www.secpulse.com/archives/category/articles/web)

[hackctf](https://www.secpulse.com/newpage/author?author_id=34005)

2023-01-04

22,572

> 文章作者: 告白
>
> 原文链接: http://www.kxsy.work/2021/10/13/zui-shi-yong-de-ying-ji-xiang-ying-bi-ji-si-lu-xiao-jie/
>
> 本文章著作权归作者所有，任何形式的转载都请注明出处。

## **0x00 事件应急响应的流程分析**

事件整个类型大致归类于：

> 事件表现-信息收集-确认攻击类型-事件追查-修复

1）事件的表现：

> 网站类型：被篡改，信息丢失，乱码等
> 文件类型：被篡改，丢失，泄露等
> 系统类型：系统卡顿，CPU爆满，服务宕机等
> 流量类型：大量异常数据包，外部连接，网络网速卡顿等
> 第三方类型：服务异常，运行异常等

2）事件信息收集：windows-linux-MAC

> 对外服务情况
> 开放端口情况
> 系统版本
> 网络环境
> 漏洞情况
> 软件相关平台信息
> 口令整理收集
> 具备的防护情况

3）事件攻击类型：

> （1）WEB：漏洞攻击，综合类型攻击，流量攻击…..
> （2）第三方：数据库，远程软件，服务平台…..
> （3）操纵系统：权限提权，内网渗透，远程漏洞……..

4）事件追查：
根据事件的表现选择最佳方法追查与排查

> 1.日志分析
> 2.后门分析
> 3.流量分析
> 4.脚本软件分析
> 5.模拟渗透方法分析……

5）修复：

## **0x01 简单的应急事件分析思路：**

案例1：客户反应自己的网站首页被篡改，请求帮助

> 分析思路：攻击面可能涉及到网站或者服务器权限，攻击意图篡改主页
> 1.分析网站日志信息时间，将时间分段，判断出准备入侵时间段与入侵时间
> 2.查看服务器开启的端口信息，查看端口与对应的进程id #netstat -an
> 3.查看进程id对应的具体进程是什么 #tasklist /svc
> 4.进程管理器查看进程文件所在位置进行删除或者修补
> 5.网站的日志记录查看攻击者IP等更更多信息
> 6.使用工具：河马查杀：扫描网站目录是否存在可疑文件，再去日志对应的文件信息查看，可能获取到攻击者IP

步骤分析：
查看端口服务情况，是否有可以的端口服务开启—netstat -ano

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811488.png)

查看进程id对应的进程名：tasklist /svc

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811489.png)

进程管理查看你对应进程文件详细信息以及位置：

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811490.png)

河马shell查杀工具检测：将网站目录全面扫描，配合上述分析事件
河马shell查杀学习地址：https://www.shellpub.com/
十款查杀shell工具学习：https://www.cnblogs.com/xiaozi/p/12679777.html

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811492.png)

分析后对造成的入侵进行查杀封禁等操作，记录事件。

\*\*

**案例2：客户反应服务器卡顿，请求帮助**
分析思路：系统卡慢、宕机、CPU和内存占用高、网络拥塞或断网、磁盘空余空间无理由大幅度缩小等，根据以上表征，可以初步猜测系统面临的问题。
推荐监测工具分析可疑进程，利用杀毒软件分析可疑文件，利用端口工具抓取流量分析

```
连接信息查看：netstat -abo | findstr TCP
指定进程查看：tasklist | findstr 1716
服务查看：tasklist /SVC
动态链接库查看：tasklist /M
日志查看等：windows：
```

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811495.png)

进程排查：

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811497.png)

进程cpu情况排查：

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811504.png)

windows进程检测工具：PCHunter64
进程分析蓝色为系统外进程，可能木马等，进程信息可能伪装，网络分析：

学习地址：

链接：https://pan.baidu.com/s/1t0s4LqAmsEufHhyVAy7jlg
提取码：hsyy

Autoruns-启动项目管理工具：

链接：https://pan.baidu.com/s/1pdwgvUONzllkXLfW9wAozw
提取码：hsyy

PortScan-C段主机端口扫描：

链接：https://pan.baidu.com/s/1l3v91ncmxMDOValPr8FctQ
提取码：hsyy

windows执行列表查看：UserAssistView
学习地址：https://www.onlinedown.net/soft/628964.htm
所有执行文件的记录信息，记录执行时间，去日志记录查看这个时间段前后的文件进程执行情况，分析攻击的准备阶段与攻击阶段

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811505.png)

## **0x02 结合web日志-分析中间件日志-工具分析思路**

> 分析流程：保护阶段（严重断网处理）-分析阶段-复现阶段（非必要）-修复阶段-建议阶段

> 目的：分析出攻击时间段，攻击的操作，攻击后果，安全修复给出合理解决方案

> 必备知识点：
> 1.熟悉常见的web攻击技术
> 2.熟悉相关的日志启用以及存储查看
> 3.熟悉日志数据分析

> 准备工作：
> 1.收集目标服务器组件信息（大多中间件有日志记录非常重要）
> 2.部署相关的日志分析软件，平台等
> 3.熟悉安全攻击的指纹特征（很多攻击来源于工具）
> 4.能够针对事件表现第一时间触发思路

排查分类思路：

类型1：有明确的入侵对象时间信息等

有明确的对象时间信息，可以大大的提高分析效率，通过以下总结的思路排查
思路：基于时间，居于入侵的操作，基于设备指纹，基于其他第三方等

类型2：无明确的入侵对象时间信息

没有具体的信息需要全面摸查，通常以下总结的思路排查
1.web漏洞-检查源码类型以及漏洞情况
2.中间件漏洞-检查对应的版本 以及漏洞情况
3.第三方组件应用漏洞-检查使用存在最新的漏洞情况
4.操作系统层面导致漏洞-检查系统版本补丁漏洞情况
5.其他安全问题（弱口令，后门等），使用相关的shell，弱口令检查工具扫描

常见分析方法：

设备指纹库搜索，日志时间分析，后门追查，漏洞检查分析等

案例1：win+iis+mysql分析

重点分析iis的日志记录，不太清楚中间件的日志记录自行百度查询日志记录的位置，

下面以iis本地搭建的虚拟环境日志分析
打开IIS日志位置：

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811508.png)

iis日志的策略情况（根据网站管理员的配置为主）：

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811510.png)

日志分析：

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811512.png)

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811514.png)

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811518.png)

1.日志全局搜索攻击者IP地址，判断出入侵准备时间与入侵的整个时间段
根据获取到的IP地址查询地址物理位置，初步判断是否为攻击者真实IP，或者是代理IP
查询方式有很多这里举例
IP位置查询:https://chaipip.com/

> 这种就可能为代理IP，或者是境外服务器
>
> ![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811519.png)

2.通过获取到的可以后门文件，进行定位查询，分析出IP入侵的时间段，与可以后门文件的操作时间

3.搜索设备指纹，例如疑似被注入的SQLmap，或者注入的敏感字段select等，将入侵者的操作时间段判断出来

**案例2：linux+宝塔+tp5**

宝塔日志获取：登录宝塔面板-文件-根目录-www-server-nginx-conf配置文件查看日志位置，获取到www-wwwlogs信息

思路：
1.分析日志与上面一样，注意目录扫描信息（多种模拟请求就可能为字典目录爆破）
2.宝塔自带目录查杀-安全中查看结果
3.请求文件jpg资源因为访问一个主页自动加载的（避免误判）
4.日志全局搜索IP 分析这个IP操作的整个时间分析
4.漏洞执行代码的特征payload搜索

宝塔自带的目录查杀：

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811522.png)

请求文件jpg资源因为访问一个主页自动加载的（避免误判）

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811524.png)

工具审计日志使用：

1.360星图，能够分析iis/apache/nginx日志信息

官方下载地址：https://wangzhan.qianxin.com/activity/xingtu
目前官方已经停止维护。
360星图网盘下载链接：https://pan.baidu.com/s/1n\_ms9yRGKCxn8SVG6aFnzg
提取码：hsyy
使用：将日志放到指定目录下，或者修改配置文件指定日志的位置 运行bat即可，随后查看目录下分析报告
缺点：支持的中间件日志太少了
分析报告：

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811528.png)

分析结果，着重点出发入手分析！

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194607-1672811529.png)

2.十大shell查杀工具：https://www.cnblogs.com/xiaozi/p/13198071.html

推荐使用：蓝队必备日志分析：ELK，Splunk...