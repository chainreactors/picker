---
title: Threat Thursday: STRRat Malware
url: https://blogs.blackberry.com/en/2021/10/threat-thursday-strrat-malware
source: Over Security - Cybersecurity news aggregator
date: 2024-08-22
fetch_date: 2025-10-06T18:05:13.592012
---

# Threat Thursday: STRRat Malware

[BlackBerry](https://blogs.blackberry.com)

* [Secure Communications](https://blogs.blackberry.com/en/category/software-solutions/secure_comms)
* [Automotive & IoT](https://blogs.blackberry.com/en/category/automotive)
* [Corporate](https://blogs.blackberry.com/en/category/blackberry-news)

* ×

BlackBerry Blog

1. [BlackBerry Blog](/en.html)
2. Threat Thursday: STRRat Malware

# Threat Thursday: STRRat Malware

[RESEARCH & INTELLIGENCE](/en/category/research-and-intelligence "RESEARCH & INTELLIGENCE") / 10.14.21 /
[The BlackBerry Research and Intelligence Team](/en/author/the-blackberry-research-and-intelligence-team)

* [Share on X](https://x.com/intent/tweet?url=https://blogs.blackberry.com/en/2021/10/threat-thursday-strrat-malware&text=Threat%20Thursday:%20STRRat%20Malware&via=BlackBerry "Share on X")
* [Share on Facebook](https://www.facebook.com/sharer/sharer.php?u=https://blogs.blackberry.com/en/2021/10/threat-thursday-strrat-malware "Share on Facebook")
* [Share on LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://blogs.blackberry.com/en/2021/10/threat-thursday-strrat-malware&title=Threat%20Thursday:%20STRRat%20Malware&summary=&source=blogs.blackberry.com "Share on LinkedIn")
* Email

![](/content/dam/blogs-blackberry-com/images/blogs/2021/10/tt-strrat-875x530-ibb.png)

STRRat is a Java-based [Remote Access Trojan (RAT)](https://www.blackberry.com/us/en/solutions/endpoint-security/ransomware-protection/remote-access-trojan "Remote Access Trojan") that has a plethora of malicious functionality, focused primarily on information stealing and backdoor capabilities. It gathers credentials from browsers and email clients, and has online and offline keystroke logging abilities.

STRRat also has the capability of mimicking a ransomware attack. No files are encrypted; the malware just appends the file-extension “.crimson” while opening Notepad to display a false ransom note.

In-the-wild since mid-2020, the initial infection vector for STRRat is typically a malicious attachment masquerading as a business document, or a receipt/purchase order via email. This threat previously relied on a victim having a Java Runtime Environment (JRE) already present on their device. The malware now either deploys its own JRE instance or contains initial stage checks for the presence of a valid Java version.

### **Operating System**

![](/content/dam/blogs-blackberry-com/images/blogs/2021/10/strrat-table001.png)

### **Risk & Impact**

![](/content/dam/blogs-blackberry-com/images/blogs/2021/10/strrat-table002.png)

### **Infection Vectors**

STRRat has multiple ways to infect a victim’s device. Typically, the malware relies on mass malspamming or taking part in phishing campaigns to lure victims into opening trojanized email attachments.

The initial droppers related to STRRat vary. Some are malicious obfuscated JavaScript attachments meant to download the malware to the victim’s device. Others hide their code within Microsoft® Excel® and Word document macros. Once enabled, the malicious macros drop a further stage PowerShell script.

![](/content/dam/blogs-blackberry-com/images/blogs/2021/10/strrat-fig01.png)

*Figure 1: Example of STRRat Microsoft Excel initial stage downloader*

Some variants of STRRat have added a secondary downloader stage of the malware.

Instead of relying on the victim to execute a JavaScript directly from a malicious email, STRRat relies on the victim enabling the embedded macros within Microsoft Excel or Word. Doing so will allow this initial stage to retrieve and execute a string hosted at hxxp://35[.]163[.]204[.]167/oo.

![](/content/dam/blogs-blackberry-com/images/blogs/2021/10/strrat-fig02.png)

*Figure 2: Downloaded PowerShell file: oo.ps1*

Once the string “oo” is downloaded, the Microsoft Excel macro attempts to open cmd.exe and uses the PowerShell’s Invoke-Expression (IEX) cmdlet. The contents of the string oo are then executed to further STRRat’s chain of execution.

Inspecting the contents of oo, we can see that its code is heavily obfuscated PowerShell script. Though the code might not resemble anything human-readable or identifiable at this point, different variables within the code of oo are related to differences in length of the whitespace between curly braces, as seen in Figure 2. These can then be interpreted by their uniqueness in length. For example, in the case of “${   }” where there are three white spaces between the brackets, this would be deobfuscated as “Char[3].”

Instead of allowing oo to execute within the Microsoft® Office documents macro, it can be isolated and analyzed separately. Renaming the string oo to “oo.ps1,” we can inspect its contents without accidentally running the code. Running the PowerShell code separately and printing its output will rebuild these variables, removing this initial layer of obfuscation.

![](/content/dam/blogs-blackberry-com/images/blogs/2021/10/strrat-fig03.png)

*Figure 3: First layer of obfuscation*

Once the initial stage of deobfuscation is complete, we get a clearer view of what’s going on. However, this result is still not easily human-readable. After the white-spacing between each variable is calculated, it now displays [Char] integers instead.

This first layer also contains another IEX PowerShell cmdlet to run the obfuscated code once more, which produces its final deobfuscated code.

![](/content/dam/blogs-blackberry-com/images/blogs/2021/10/strrat-fig04.png)

*Figure 4: True output of oo.ps1*

Once this second layer of obfuscation is removed, we can get a much clearer picture of the true and malicious intent of the PowerShell code contained within oo. This code reaches out to download a ZIP file and unzips its content before attempting to run the file “Sys.cmd.”

To achieve persistence, the file also adds itself to the device’s Startup folder so that it will re-execute when a device reboots.

### **Technical Analysis**

If the oo script is successful, the malicious PowerShell code drops the contents of its ZIP. Most of its contents are benign, and they are what a user would expect from downloading an instance of Java Runtime Environment (JRE).

Early versions of STRRat relied on an instance of JRE on the victim’s device to execute. This would keep the download of STRRat extremely small. However, recently STRRat has shifted away from relying on its victim already having JRE.

Recent samples of STRRat will either attempt to detect the presence of a compatible version of Java prior to being deployed via a further malicious JavaScript file, or it will drop with a compatible instance of Java regardless. The contents of the downloaded ZIP file “esfsdghfrzeqsdffgfrtsfd.zip” shown below includes the contents of Java version 1.8.0\_261.

Excluding the two files “Sys.cmd” and “x.jar,” the contents of esfsdghfrzeqsdffgfrtsfd.zip are legitimate files related to this version of Java.

![](/content/dam/blogs-blackberry-com/images/blogs/2021/10/strrat-fig05.png)

*Figure 5: Contents of .ZIP file oo.ps1 downloaded*

This tactic of dropping a compatible Java version does increase the size of downloaded data STRRat needs to deploy on a victim’s device. But given that the files it is downloading are benign, the malware wagers on the benefit of a larger download for the possibility of more successful coverage of victim devices.

The first illegitimate file found within the downloaded ZIP is the script “Sys.cmd.” This is a tiny script that is designed to run cmd.exe while minimized and execute the version of Java it has just deployed to execute the core malware file, “x.jar.”

![](/content/dam/blogs-blackberry-com/images/blogs/2021/10/strrat-fig06.png)

*Figure 6: Contents of Sys.cmd*

X.jar contains the core STRRat malware and its components. This file works together with its 63 different “.class” files, aided by its resource file “config.txt.” Config.txt contains encrypted information that it uses to call home, which the malware will use once it is successfully running...