---
title: New “whoAMI” Attack Exploits AWS AMI Name Confusion for Remote Code Execution
url: https://thehackernews.com/2025/02/new-whoami-attack-exploits-aws-ami-name.html
source: The Hacker News
date: 2025-02-15
fetch_date: 2025-10-06T20:57:38.901292
---

# New “whoAMI” Attack Exploits AWS AMI Name Confusion for Remote Code Execution

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [New "whoAMI" Attack Exploits AWS AMI Name Confusion for Remote Code Execution](https://thehackernews.com/2025/02/new-whoami-attack-exploits-aws-ami-name.html)

**Feb 14, 2025**Ravie LakshmananVulnerability / DevOps

[![](data:image/png;base64...)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhJ6-Lt-TwBnhLVcwLcvvM4STMuSpq9We8Y7pLWdk_WqvgB6yH90grw-OU4vREhfmQ__p80wAEQDhmuTnLlz8yXkguqBjKEU9_BOjUHpWwUeelZLdTo7m0GlujkyXje1TpEcbWULfYzec3Vh8lzBWHABHcLPZvA8VUAakqW2pQuPQSR8XTH2X7Tbv5wXnoO/s790-rw-e365/whoAMI.png)

Cybersecurity researchers have disclosed a new type of name confusion attack called whoAMI that allows anyone who publishes an Amazon Machine Image ([AMI](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html)) with a specific name to gain code execution within the Amazon Web Services (AWS) account.

"If executed at scale, this attack could be used to gain access to thousands of accounts," Datadog Security Labs researcher Seth Art [said](https://securitylabs.datadoghq.com/articles/whoami-a-cloud-image-name-confusion-attack/) in a report shared with The Hacker News. "The vulnerable pattern can be found in many private and open source code repositories."

At its heart, the technique is a subset of a supply chain attack that involves publishing a malicious resource and tricking misconfigured software into using it instead of the legitimate counterpart.

[![DFIR Retainer Services](data:image/png;base64...)](https://thehackernews.uk/cloud-insight-d)

The attack exploits the fact that anyone can AMI, which refers to a virtual machine image that's used to boot up Elastic Compute Cloud (EC2) instances in AWS, to the community catalog and the fact that developers could omit to mention the "--owners" attribute when [searching](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/finding-an-ami.html) for one via the ec2:DescribeImages API.

Put differently, the name confusion attack requires the below three conditions to be met when a victim retrieves the AMI ID through the API -

* Use of the name filter,
* A failure to specify either the owner, owner-alias, or owner-id parameters,
* Fetching the most the recently created image from the returned list of matching images ("most\_recent=true")

This leads to a scenario where an attacker can create a malicious AMI with a name that matches the pattern specified in the search criteria, resulting in the creation of an EC2 instance using the threat actor's doppelgänger AMI.

This, in turn, grants remote code execution (RCE) capabilities on the instance, allowing the threat actors to initiate various post-exploitation actions.

All an attacker needs is an AWS account to publish their backdoored AMI to the public Community AMI catalog and opt for a name that matches the AMIs sought by their targets.

"It is very similar to a [dependency confusion attack](https://thehackernews.com/2024/04/apache-cordova-app-harness-targeted-in.html), except that in the latter, the malicious resource is a software dependency (such as a pip package), whereas in the whoAMI name confusion attack, the malicious resource is a virtual machine image," Art said.

Datadog said roughly 1% of organizations monitored by the company were affected by the whoAMI attack, and that it found public examples of code written in Python, Go, Java, Terraform, Pulumi, and Bash shell using the vulnerable criteria.

Following responsible disclosure on September 16, 2024, the issue was addressed by Amazon three days later. When reached for comment, AWS told The Hacker News that it did not find any evidence that the technique was abused in the wild.

"All AWS services are operating as designed. Based on extensive log analysis and monitoring, our investigation confirmed that the technique described in this research has only been executed by the authorized researchers themselves, with no evidence of usage by any other parties," the company said.

[![CIS Build Kits](data:image/png;base64...)](https://thehackernews.uk/platform-shield-d)

"This technique could affect customers who retrieve Amazon Machine Image (AMI) IDs via the ec2:DescribeImages API without specifying the owner value. In December 2024, we introduced Allowed AMIs, a new [account-wide setting](https://aws.amazon.com/about-aws/whats-new/2024/12/amazon-ec2-allowed-amis-enhance-ami-governance/) that enables customers to limit the discovery and use of AMIs within their AWS accounts. We recommend customers evaluate and implement this [new security control](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-allowed-amis.html)."

As of last November, HashiCorp Terraform has started issuing warnings to users when "most\_recent = true" is used without an owner filter in terraform-provider-aws [version 5.77.0](https://github.com/hashicorp/terraform-provider-aws/releases/tag/v5.77.0). The warning diagnostic is [expected](https://github.com/hashicorp/terraform-provider-aws/issues/40198) to be upgraded to an error effective version 6.0.0.

Found this article interesting? Follow us on [Google News](https://news.google.com/publications/CAAqLQgKIidDQklTRndnTWFoTUtFWFJvWldoaFkydGxjbTVsZDNNdVkyOXRLQUFQAQ), [Twitter](https://twitter.com/thehackersnews) and [LinkedIn](https://www.linkedin.com/company/thehackernews/) to read more exclusive content we post.

SHARE
[**](#link_share)
[**](#link_share)
[**](#link_share)
**

[**Tweet](#link_share)

[**Share](#link_share)

[**Share](#link_share)

**Share

**
[**Share on Facebook](#link_share)
[**Share on Twitter](#link_share)
[**Share on Linkedin](#link_share)
[**Share on Reddit](#link_share)
[**Share on Hacker News](#link_share)
[**Share on Email](#link_share)
[**Share on WhatsApp](#link_share)
[![Facebook Messenger](data:image/png;base64...)Share on Facebook Messenger](#link_share)
[**Share on Telegram](#link_share)

SHARE **

[AWS](https://thehackernews.com/search/label/AWS)[Cloud security](https://thehackernews.com/search/label/Cloud%20security)[cybersecurity](https://thehackernews.com/search/label/cybersecur...