---
title: Azure CLI Code Injection CVE-2022-39327 hits 9.8/10 CVSS score
url: https://buaq.net/go-133231.html
source: unSafe.sh - 不安全
date: 2022-10-30
fetch_date: 2025-10-03T21:17:26.686960
---

# Azure CLI Code Injection CVE-2022-39327 hits 9.8/10 CVSS score

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![]()

Azure CLI Code Injection CVE-2022-39327 hits 9.8/10 CVSS score

The most recent Azure CLI Code Injection vulnerability is a rar
*2022-10-29 15:51:10
Author: [lab.wallarm.com(查看原文)](/jump-133231.htm)
阅读量:61
收藏*

---

The most recent Azure CLI Code Injection vulnerability is a rare and dangerous case. It’s not often that the most popular cloud platform client is vulnerable to such critical issues as code injection. Regardless overall high risk of injections by OWASP Top 10 and OWASP API Security Top 10, code injections are not common for cloud infrastructures and providers and usually hits 3rs party applications and APIs. The case of CVE-2022-39327 is a unique one.

For instance, the following command line will execute an arbitrary shell command “*uname*” instead of the setting value **aaa1337|uname** for the parameter name **injection**:

```
az keyvault secret set --vault-name default --name injection --value "aaa1337|uname"
```

Azure CLI before version 2.40.0 (October 2022) is vulnerable to code injections by parameter values provided by the external sources.

This issue is probably the most valuable code injection finding after the ShellShock vulnerability is the Bash interpreter.

Upgrade to Azure CLI 2.40.0 or greater.

As of Azure CLI 2.40.0, a new .ps1 entry script is used as the entry point to call Python rather than cmd.exe. This removes the opportunity for cmd.exe to interpret input as a command invocation. Using this approach has introduced new issues however that you can read about in the “More information” section.

Immediately upgrade to 2.41.0 or greater is required. The manually call the azps.ps1 entry script is necessary for some critical scenarios.

Microsoft team says, that they have [reverted](https://github.com/Azure/azure-cli/pull/24015) to using the cmd.exe entry script as the default while keeping the **azps.ps1** entry script for manual Azure CLI calls if users require it.

The CVSSv3 score of the CVE-2022-32327 vulnerability in Azure CLI is 9.8 out of 10.0 possible, which makes it critical by the risk. Azure users should immediately upgrade to Azure CLI 2.40.0 or higher. Keep posted.

Subscribe for the latest news

文章来源: https://lab.wallarm.com/azure-cli-code-injection-cve-2022-39327-hits-9-8-10-cvss-score/
 如有侵权请联系:admin#unsafe.sh

© [unSafe.sh - 不安全](https://unsafe.sh) Powered By [PaperCache](https://github.com/code-scan/PaperCache)

* admin#unsafe.sh
* [安全马克](https://aq.mk)
* [星际黑客](https://xj.hk)
* [T00ls](https://t00ls.net)