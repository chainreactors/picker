---
title: 3 Lifehacks While Analyzing Orcus RAT in a Malware Sandbox
url: https://thehackernews.com/2023/01/3-lifehacks-while-analyzing-orcus-rat.html
source: The Hacker News
date: 2023-01-28
fetch_date: 2025-10-04T05:05:42.143605
---

# 3 Lifehacks While Analyzing Orcus RAT in a Malware Sandbox

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [3 Lifehacks While Analyzing Orcus RAT in a Malware Sandbox](https://thehackernews.com/2023/01/3-lifehacks-while-analyzing-orcus-rat.html)

**Jan 27, 2023**The Hacker NewsMalware Analyzing

[![Analyzing Orcus RAT](data:image/png;base64... "Analyzing Orcus RAT")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjrFhbL4_gv03Ob61jFjbxqzxtH1UvQKfPrBn15lnl2dvpSNFuADuNUWhrIb5eC4z619av6MQq4PgywUMXwsfOvollbvkief8uqjKCdtIQtW4Ro1v3Eo10v7Kv3hhf7J4yyrb0LDZWCRLvqUHccFRqzK3-X2URmRimiQ6_e9cycdwxEBjpReikHPBb9/s790-rw-e365/orcus-rat.png)

[Orcus](https://any.run/malware-trends/orcus?utm_source=hacker_news&utm_medium=article&utm_campaign=orcus0223&utm_content=mtt) is a Remote Access Trojan with some distinctive characteristics. The RAT allows attackers to create plugins and offers a robust core feature set that makes it quite a dangerous malicious program in its class.

RAT is quite a stable type that always makes it to the top.

|  |
| --- |
| [![ANY.RUN's top malware types in 2022](data:image/png;base64... "ANY.RUN's top malware types in 2022")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi_c_3xoB3oVjV1ahoL-pBir4dRrjIrD9dE8DAMkoJ5wy2flKCkmmZxqajOrA-F0EaXcQK0hkk-Ji6EdR4sqJhVrbdYSr_x8ulJFH2mxeHM4bRSTTPLD5AUjpm0gvLQ4sL5uEsIrhHHWkxN4dajHDHzXi3nRtrj0dNaRY-NGT9RbDimqEZJ-r_fs1_-/s790-rw-e365/2.png) |
| ANY.RUN's top malware types in 2022 |

That's why you'll definitely come across this type in your practice, and the Orcus family specifically. To simplify your analysis, we have collected 3 lifehacks you should take advantage of. Here we go.

## What is Orcus RAT?

**Definition**. Orcus RAT is a type of malicious software program that enables remote access and control of computers and networks. It is a type of Remote Access Trojan (RAT) that has been used by attackers to gain access to and control computers and networks.

**Capabilities**. Once downloaded onto a computer or network, it begins to execute its malicious code, allowing the attacker to gain access and control. It is capable of stealing data, conducting surveillance, and launching DDoS attacks.

**Distribution**. The malware is usually spread via malicious emails, websites, and social engineering attacks. It is also often bundled with other malicious software programs, such as Trojans, worms, and viruses.

## Lifehacks for Orcus RAT malware analysis

The malware is designed to be difficult to detect, as it often uses sophisticated encryption and obfuscation techniques to prevent detection. And if you need to get to the core of Orcus, the RAT configuration has all the data you need.

And there are several lifehacks that you should pay attention to while performing the analysis of Orcus RAT.

Today we investigate the .NET sample that you can download for free in [ANY.RUN database](https://app.any.run/submissions?utm_source=hacker_news&utm_medium=article&utm_campaign=orcus0223&utm_content=public_submissions):

> SHA-256: 258a75a4dee6287ea6d15ad7b50b35ac478c156f0d8ebfc978c6bbbbc4d441e1

### 1 — Get to know Orcus classes

You should start with checking malware classes where you can get the hidden program's characteristics. A bunch of data that classes contain is exactly what will be helpful for your research.

An Orcus.Config namespace has these classes:

* **Consts:** Orcus's files and directories data, e.g. the path to the file where user keystrokes are saved or to the directory where the plugins used by a sample reside.
* **Settings:** contain wrapper methods for decrypting the malware configuration and its plugins.
* **SettingsData:** is a static class only with the encrypted malware and plugin configuration fields.

### 2 — Find Orcus RAT resources

Once you dive into the **Settings** class, you can notice the **GetDecryptedSettings** method. Later, it calls out the **AES.Decrypt**. And it looks like your job is done and the malware configuration is finally found. But hold on - the assembly doesn't contain an **Orcus.Shared.Encryption** namespace.

|  |
| --- |
| [![GetDecryptedSettings method](data:image/png;base64... "GetDecryptedSettings method")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgHmUGmkVIprsDVgZRX4Qw5Z7OJTbUFfIBoBG_P8vIciH_ohhb4crkF-dT_HcfARUd5J9ValhvefCf2DuSYvKowGfYBJ9VJlEt92WtVxFruTjMJ39s-otCfRMR5o-X42Rhi-IecwjNkrbsJ-I3JV_TwiRZ3JCI8aWy9eCHTkoH5lnzctUyvxzMkxMu0/s790-rw-e365/1.png) |
| GetDecryptedSettings method |

Orcus RAT stores additional assemblies inside the malware resources using a 'deflate' algorithm. You can go to the resources to find the necessary assembly. Unpacking them will let you reveal the decryption algorithm that an Orcus sample uses. That brings one more lifehack for today.

### 3 — Decrypt data

Our treasure hunt goes on, as configuration data is encrypted.

Orcus RAT encrypts data using the AES algorithm and then encodes the encrypted data using Base64.

How to decrypt data:

* generate the key from a given string using Microsoft's PBKDF1 implementation
* decode the data from Base64
* apply the generated key to decrypt the data via the AES256 algorithm in CBC mode.

As a result of decoding, we get the malware configuration in the XML format. And all Orcus secrets are in your hands now.

### Get all at once in a malware sandbox

Malware analysis is not a piece of cake, it definitely takes time and effort to crack a sample. That's why it's always great to cut the line: get all at once and in a short time. The answer is simple – use a malware sandbox.

[ANY.RUN malware sandbox](https://any.run/?utm_source=hacker_news&utm_medium=article&utm_campaign=orcus0223&utm_content=landing) automatically retrieves configuration for the Orcus RAT. It's a much easier way to analyze a malicious object. Try it now – the service has already retrieved all data from this [Orcus sample](https://app.any.run/tasks/55dce88d-b52c-4a51-b3c8-b8e6dcff0b13?utm_source=hacker_news&utm_medium=article&utm_campaign=orcus0223&utm_content=task), so you can enjoy smooth research.

> ⚡ Write the "**hackernews1**" promo code at support@any.run using y...