---
title: Collect-MemoryDump - Automated Creation Of Windows Memory Snapshots For DFIR
url: https://buaq.net/go-134417.html
source: unSafe.sh - 不安全
date: 2022-11-07
fetch_date: 2025-10-03T21:51:31.037195
---

# Collect-MemoryDump - Automated Creation Of Windows Memory Snapshots For DFIR

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/cbd06d211994c598558dcc695d921fbc.jpg)

Collect-MemoryDump - Automated Creation Of Windows Memory Snapshots For DFIR

Collect-MemoryDump - Automated Creation of Windows Memory Snapshots for DFIR Collect-Memory
*2022-11-6 19:30:0
Author: [www.kitploit.com(查看原文)](/jump-134417.htm)
阅读量:45
收藏*

---

[![](https://blogger.googleusercontent.com/img/a/AVvXsEhixFbHS3MwG7MPECqraExhirI3V1fityuPCmwAKgh4qf0NkE5i1JbLAI-2gI2o3MI0T1v54X4bZ3G2odwgrJ2N1D8kgkzaUYfw9XDjELoyThz6oaIB6uqyie2h4lx1ofnnac3MPWD_aZPfiuZPMzLvmazKCU7EENADsdIPHsCcdQ4--ypuovxF5_-DDQ=w640-h428)](https://blogger.googleusercontent.com/img/a/AVvXsEhixFbHS3MwG7MPECqraExhirI3V1fityuPCmwAKgh4qf0NkE5i1JbLAI-2gI2o3MI0T1v54X4bZ3G2odwgrJ2N1D8kgkzaUYfw9XDjELoyThz6oaIB6uqyie2h4lx1ofnnac3MPWD_aZPfiuZPMzLvmazKCU7EENADsdIPHsCcdQ4--ypuovxF5_-DDQ)

Collect-MemoryDump - Automated Creation of Windows Memory Snapshots for DFIR

Collect-MemoryDump.ps1 is [PowerShell](https://www.kitploit.com/search/label/PowerShell "PowerShell") script utilized to collect a Memory Snapshot from a live Windows system (in a forensically sound manner).

Features:

* Checks for Hostname and Physical Memory Size before starting memory acquisition
* Checks if you have enough free [disk space](https://www.kitploit.com/search/label/Disk%20Space "disk space") to save memory dump file
* Collects a Raw Physical Memory Dump w/ DumpIt, Magnet Ram Capture, Belkasoft Live RAM Capturer and WinPMEM
* Collects a Microsoft Crash Dump w/ DumpIt for Comae Beta from Magnet Idea Lab
* Pagefile Collection w/ CyLR - [Live Response](https://www.kitploit.com/search/label/Live%20Response "Live Response") Collection tool by Alan Orlikoski and Jason Yegge
* Checks for Encrypted Volumes w/ Magnet Forensics Encrypted Disk Detector
* Collects BitLocker Recovery Key
* Checks for installed Endpoint Security Tools (AntiVirus and EDR)
* Enumerates all necessary information from the target host to enrich your DFIR workflow
* Creates a password-protected Secure Archive Container (PW: IncidentResponse)

## First Public Release

MAGNET Talks - Frankfurt, Germany (July 27, 2022)

## Download

Download the latest version of **Collect-MemoryDump** from the [Releases](https://github.com/evild3ad/Collect-MemoryDump/releases/latest "Releases") section.

> Note: Collect-MemoryDump does not include all external tools by default.

You have to download following dependencies:

* [Belkasoft Live RAM Capturer](https://belkasoft.com/ram-capturer "Belkasoft Live RAM Capturer")
* [Comae-Toolkit](https://www.magnetforensics.com/blog/how-to-get-started-with-comae/ "Comae-Toolkit")
* [MAGNET Encrypted Disk Detector](https://www.magnetforensics.com/resources/encrypted-disk-detector/ "MAGNET Encrypted Disk Detector")
* [MAGNET Ram Capture](https://www.magnetforensics.com/resources/magnet-ram-capture/ "MAGNET Ram Capture")

Copy the required files to following file locations:

**Belkasoft Live RAM Capturer**
 `$SCRIPT_DIR\Tools\RamCapturer\x64\msvcp110.dll`
 `$SCRIPT_DIR\Tools\RamCapturer\x64\msvcr110.dll`
 `$SCRIPT_DIR\Tools\RamCapturer\x64\RamCapture64.exe`
 `$SCRIPT_DIR\Tools\RamCapturer\x64\RamCaptureDriver64.sys`
 `$SCRIPT_DIR\Tools\RamCapturer\x86\msvcp110.dll`
 `$SCRIPT_DIR\Tools\RamCapturer\x86\msvcr110.dll`
 `$SCRIPT_DIR\Tools\RamCapturer\x86\RamCapture.exe`
 `$SCRIPT_DIR\Tools\RamCapturer\x86\RamCaptureDriver.sys`

**Comae-Toolkit**
 `$SCRIPT_DIR\Tools\DumpIt\ARM64\DumpIt.exe`
 `$SCRIPT_DIR\Tools\DumpIt\x64\DumpIt.exe`
 `$SCRIPT_DIR\Tools\DumpIt\x86\DumpIt.exe`

**MAGNET Encrypted Disk Detector**
 `$SCRIPT_DIR\Tools\EDD\EDDv310.exe`

**MAGNET Ram Capture**
 `$SCRIPT_DIR\Tools\MRC\MRCv120.exe`

## Usage

.\Collect-MemoryDump.ps1 [-Tool] [--Pagefile]

Example 1 - Raw Physical Memory Snapshot
 .\Collect-MemoryDump.ps1 -DumpIt

Example 2 - Microsoft Crash Dump (.zdmp) → optimized for uploading to [Comae Investigation Platform](https://www.comae.com/ "Comae Investigation Platform")
 .\Collect-MemoryDump.ps1 -Comae

Note: You can uncompress \*.zdmp files generated by DumpIt w/ Z2Dmp (Comae-Toolkit).

Example 3 - Raw Physical Memory Snapshot and Pagefile Collection → [MemProcFS](https://github.com/ufrisk/MemProcFS "MemProcFS")
 .\Collect-MemoryDump.ps1 -WinPMEM --Pagefile

[![](https://blogger.googleusercontent.com/img/a/AVvXsEgc80A-DNgW22YAoAZLzITsGVklxUuYnM6Q8obhx6ZT6KWIOyfJLVHt6bHuI5jYERlEm_Gz0a2jkXRkQNXrp0TJGN2zuDR1qRmK2fNQF5fVKF_nOkJ9UhMAxjwgHi2TFuShfuZ8HSlki2bE3GZzh5vFqGji7z5pORvhIy7PJ2T_9-WpU2fEtSrBwVBQwQ=w640-h262)](https://blogger.googleusercontent.com/img/a/AVvXsEgc80A-DNgW22YAoAZLzITsGVklxUuYnM6Q8obhx6ZT6KWIOyfJLVHt6bHuI5jYERlEm_Gz0a2jkXRkQNXrp0TJGN2zuDR1qRmK2fNQF5fVKF_nOkJ9UhMAxjwgHi2TFuShfuZ8HSlki2bE3GZzh5vFqGji7z5pORvhIy7PJ2T_9-WpU2fEtSrBwVBQwQ)

**Fig 1:** Help Message

[![](https://blogger.googleusercontent.com/img/a/AVvXsEhmIq8YjkbyotZCehDTpotzbUkZKauKRVQUmkDo6XVdaBRpwDyVSbZMMKEKTOp3kRpV_A-DMRUGrQ85QnDpgiUzQp-x9qXQoEy_NWkrDHbhsHQJu1rHFBBSFmbg3ltCKTXvnQPR0kYvKG3GotosoLoFdZPWsiR5d9ciPEnDKlXBtR_2y2hhnVag3cA8Ug=w640-h172)](https://blogger.googleusercontent.com/img/a/AVvXsEhmIq8YjkbyotZCehDTpotzbUkZKauKRVQUmkDo6XVdaBRpwDyVSbZMMKEKTOp3kRpV_A-DMRUGrQ85QnDpgiUzQp-x9qXQoEy_NWkrDHbhsHQJu1rHFBBSFmbg3ltCKTXvnQPR0kYvKG3GotosoLoFdZPWsiR5d9ciPEnDKlXBtR_2y2hhnVag3cA8Ug)

**Fig 2:** Check Available Space

[![](https://blogger.googleusercontent.com/img/a/AVvXsEhixFbHS3MwG7MPECqraExhirI3V1fityuPCmwAKgh4qf0NkE5i1JbLAI-2gI2o3MI0T1v54X4bZ3G2odwgrJ2N1D8kgkzaUYfw9XDjELoyThz6oaIB6uqyie2h4lx1ofnnac3MPWD_aZPfiuZPMzLvmazKCU7EENADsdIPHsCcdQ4--ypuovxF5_-DDQ=w640-h428)](https://blogger.googleusercontent.com/img/a/AVvXsEhixFbHS3MwG7MPECqraExhirI3V1fityuPCmwAKgh4qf0NkE5i1JbLAI-2gI2o3MI0T1v54X4bZ3G2odwgrJ2N1D8kgkzaUYfw9XDjELoyThz6oaIB6uqyie2h4lx1ofnnac3MPWD_aZPfiuZPMzLvmazKCU7EENADsdIPHsCcdQ4--ypuovxF5_-DDQ)

**Fig 3:** Automated Creation of Windows Memory Snapshot w/ DumpIt

[![](https://blogger.googleusercontent.com/img/a/AVvXsEjv5N601lGru9NtHLQFKvYC1gnsKH0KAv8rszlLvAbRrpLTBR3IcRz50s1L7AfhvH9aPH8-hd8FMhWgtcsE96EzMEKuVgCDQzX4mfCRwue2hg0HxFFxj340qTQVstp910gdJoGY3CeGAX9jvgRbHzALFzI1DJae7Ql7gXpzDTtHY6MQ-SCX2Bb4hO-i2A=w640-h332)](https://blogger.googleusercontent.com/img/a/AVvXsEjv5N601lGru9NtHLQFKvYC1gnsKH0KAv8rszlLvAbRrpLTBR3IcRz50s1L7AfhvH9aPH8-hd8FMhWgtcsE96EzMEKuVgCDQzX4mfCRwue2hg0HxFFxj340qTQVstp910gdJoGY3CeGAX9jvgRbHzALFzI1DJae7Ql7gXpzDTtHY6MQ-SCX2Bb4hO-i2A)

**Fig 4:** Automated Creation of Windows Memory Snapshot w/ Magnet RAM Capture

[![](https://blogger.googleusercontent.com/img/a/AVvXsEhUqxX3PbTw7ywTyAdk_NtCM6EX08VJbUG86rgnQ6_UEAdjltzaHv-ek_e0ArEZCogOYQtJdJ50In1EnZf-ONTrW9rylHp6kM4KtYuEcv39ib49rMHX8h0HSLxYbglE9Kus70ggKgi0YPtyV_enpw15wbuylEi88RmXJmXqDYT3Sm1Uzn75JAFVlgOORQ=w640-h438)](https://blogger.googleusercontent.com/img/a/AVvXsEhUqxX3PbTw7ywTyAdk_NtCM6EX08VJbUG86rgnQ6_UEAdjltzaHv-ek_e0ArEZCogOYQtJdJ50In1EnZf-ONTrW9rylHp6kM4KtYuEcv39ib49rMHX8h0HSLxYbglE9Kus70ggKgi0YPtyV_enpw15wbuylEi88RmXJmXqDYT3Sm1Uzn75JAFVlgOORQ)

**Fig 5:** Automated Creation of Windows Memory Snapshot w/ WinPMEM

[![](https://blogger.googleusercontent.com/img/a/AVvXsEj9ExFCy2K_uKT4rsXGIEGWwE8uEInkkH4DnbF9HSM0i2662VQ7cmanlyaIrBP5bC-qUixTIQ29G_WXjCticOk7dOaOFkvcFjtcWGe3_z30VXu0Ail3pbpWqN-c1KfxF1BuCFUEhjCBgZk5gg-MqtoeSuKopiHbk9fVcsJiqG6gadHk-fAEClhL7cbTMQ=w640-h436)](https://blogger.googleusercontent.com/img/a/AVvXsEj9ExFCy2K_uKT4rsXGIEGWwE8uEInkkH4DnbF9HSM0i2662VQ7cmanlyaIrBP5bC-qUixTIQ29G_WXjCticOk7dOaOFkvcFjtcWGe3_z30VXu0Ail3pbpWqN-c1KfxF1BuCFUEhjCBgZk5gg-MqtoeSuKopiHbk9fVcsJiqG6gadHk-fAEClhL7cbTMQ)

**Fig 6:** Automated Creation of Windows Memory Snapshot w/ Belkasoft Live RAM Capturer

[![](https://blogger.googleusercontent.com/img/a/AVvXsEgsBy1M...