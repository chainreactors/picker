---
title: Razer Synapse 3.7.0731.072516 Local Privilege Escalation Vulnerability exploit
url: https://sploitus.com/exploit?id=1337DAY-ID-38174&utm_source=rss&utm_medium=rss
source: Sploitus.com Exploits RSS Feed
date: 2023-01-31
fetch_date: 2025-10-04T05:12:46.532890
---

# Razer Synapse 3.7.0731.072516 Local Privilege Escalation Vulnerability exploit

[x]
Dark Mode

[##### SPLOITUS](/)

# Exploit for Razer Synapse 3.7.0731.072516 Local Privilege Escalation Vulnerability CVE-2021-44226 CVE-2022-47632

2023-01-30 | CVSS 7.3

Copy
Download
Source
[Share](#share-url)

```
## https://sploitus.com/exploit?id=1337DAY-ID-38174
Product:                   Razer Synapse
Manufacturer:              Razer Inc.
Affected Version(s):       Versions before 3.7.0830.081906
Tested Version(s):         3.7.0731.072516
Vulnerability Type:        Improper Certificate Validation (CWE-295)
Risk Level:                High
Solution Status:           Open
Manufacturer Notification: 2022-08-02
Solution Date:             2022-09-06
Public Disclosure:         2022-12-21
CVE Reference:             CVE-2022-47632
Author of Advisory:        Dr. Oliver Schwarz, SySS GmbH

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

Razer Synapse is an additional driver software for Razer gaming devices.
The manufacturer describes the product as a "unified cloud-based hardware
configuration tool" (see [1]).

Due to an unsafe installation path, improper privilege management, and
improper certificate validation, the associated system service
"Razer Synapse Service" is vulnerable to DLL hijacking.
As a result, local Windows users can abuse the Razer driver installer
to obtain administrative privileges on Windows.

In order to exploit the vulnerability, the attacker needs physical
access to the machine and needs to prepare the attack before Razer
Synapse is installed along with a Razer driver.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

The attack scenario considers a Windows machine without any previous
installation of any Razer device or software.
The attacker has a local unprivileged Windows account, physical access
to the machine, and a device which is either a Razer peripheral or able
to pretend to be one (such as a Bash Bunny or a Raspberry Pi Zero).
The attacker aims at executing code with full system privileges.

The attack exploits the Razer Synapse Service which runs with elevated
privileges. While the main binary of the service is stored in the
protected location "C:\Program Files (x86)\Razer\Synapse3\Service", it
dynamically loads libraries from
"C:\ProgramData\Razer\Synapse3\Service\bin".
Before the installation, standard users can write to this path, since
"C:\ProgramData" is world-writable on a standard installation of Windows.

The Synapse installation procedure changes access privileges, so that
standard users cannot write to the path any longer.
However, if the path is created before the driver installation, the
creator can set own files to be read-only and deny write access for
the SYSTEM user.

Upon start, the Synapse service checks the location for foreign DLLs,
removes them and aborts upon failure to delete them.
Nevertheless, the DLL check is simply based on verifying if the DLL is
associated with ANY certificate information. The service does not
verify if the certificate is actually valid or belongs to Razer.

Note that the described vulnerability is similar to CVE-2021-44226,
which has been fixed in Synapse version 3.7.0228.022817.
The new attack differs from the original one in that the attacker
now has to employ self-signed DLLs instead of non-signed ones.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

The attack consists of the following steps:

1. Before the installation of the driver/Synapse, the attacker creates
    "C:\ProgramData\Razer\Synapse3\Service", copies a custom/malicious
    and self-signed version of userenv.dll into the directory, sets the
    DLL to read-only, and denies write access for SYSTEM.

2. Afterwards, the attacker triggers the installation of Synapse.
    This can be done without any elevated privileges by plugging in a
    Razer device and following the installation procedure for Synapse
    if device-specific co-installers are not disabled.
    Alternatively, a device such as Bash Bunny or a Raspberry Pi Zero
    can be used and pretend to be a Razer device.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

Razer has published a patched version that will be deployed automatically
upon driver installation on current Windows builds.

To prevent similar attacks through other co-installers, system
administrators can disable them by setting the following key in the
Windows registry:

HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Device
Installer\DisableCoInstallers = 1

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2022-06-02: Vulnerability discovered
2022-08-02: Vulnerability reported to manufacturer
2022-09-06: Patch released by manufacturer
2022-12-21: Public disclosure of vulnerability
```

Share

Copy

![](https://mc.yandex.ru/watch/54912310)