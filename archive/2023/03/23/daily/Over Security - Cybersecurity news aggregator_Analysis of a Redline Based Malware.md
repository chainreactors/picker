---
title: Analysis of a Redline Based Malware
url: https://serhack.me/articles/analysis-redline-based-malware/
source: Over Security - Cybersecurity news aggregator
date: 2023-03-23
fetch_date: 2025-10-04T10:23:51.199083
---

# Analysis of a Redline Based Malware

[![SerHack logo](https://serhack.me/images/serhack-120.png)

SerHack Security Research](https://serhack.me/)

[ ]

[About](https://serhack.me/about/ "About")
[Blog](https://serhack.me/blog/ "Blog")
[Books](https://serhack.me/books/ "Books")
[EN](https://serhack.me/articles/analysis-redline-based-malware/ "en version")
[IT](https://serhack.me/it/articles/analisi-redline-based-malware/ "it version")

# Analysis of a Redline Based Malware

Published at March 22, 2023 – 17 min read – 3486 words

![Analysis of a Redline Based Malware](https://serhack.me/images/articles/reverse-engineering-redline-malware-eira/redline-malware_v4_800px.jpg)

In recent months, there have been increasing attempts to spread malware via some seemingly ‘harmless’ programs, luring the user through rewards such as sending money with cryptocurrency or NFT-themed gifts. The unsuspecting user by running an ‘innocent’ executable to access prizes becomes part of a botnet.

In this post, I would like to analyse in some detail the ‘Redline-EDIRA’ malware campaign that has been going on since around the beginning of May 2022. We will address several challenges that the novice analyst faces, and we will also see how the attackers have used various gimmicks to make reverse engineering difficult.

## Dissemination through Phishing

On a quiet afternoon, a new e-mail arrived with the subject line ‘*ACCESS TO PAID ALPHATEST “EIRA” Project*’. Eira project? It doesn’t ring a bell; thinking it was the usual person asking for useless feedback about his project, I decided not to open it. Curiosity was such high that after a couple of hours, I downloaded the e-mail and decided to open it in a sandboxed environment (just in case!).

The e-mail was about participation as a beta tester for a game called ‘EIRA’. In the e-mail, I was told that I was lucky because among many other people, I was drawn! I then had the chance to win some unique prizes such as NFT (only 500 copies!) and payments in ETH/USDT/LTC for each unlocked story chapter.

The e-mail afterwards invited me to download the client immediately, I needed to pay attention while I was registering because I needed to place a certain unique code that was contained within the e-mail. In the footer then there were a couple of contacts `offer@playeira.online` and `@cmo_sam_playeira` on Telegram.

The matter became very interesting: there are too many red flags to ignore this e-mail! So I preferred to get to the bottom of it and click on the “Join NOW!” button.

## The Curious Website

The website presents a game called [Eira](https://store.steampowered.com/app/1860960/Eira/), an open world set in a world called ‘Kauldron’. This game features a 15-year-old girl who is faced with a thousand challenges after inheriting a magic shop from her grandmother, Eira. The video game was officially developed by Gearonin Studio, a team of indie developers from Taiwan, and is currently available on [the Steam store](https://store.steampowered.com/app/1860960/Eira/).

![Sito web fake di Eira game](https://serhack.me/images/articles/reverse-engineering-redline-malware-eira/eira-website_800px.jpg)

Screenshot taken from the fake website

Within the website, the various possibilities a player has are presented: one can win valuable NFTs or cash prizes for each unlocked game chapter. The last part invites the user to register via an e-mail, a password and the code contained in the phishing e-mail. Apart from the graphics, the user experience certainly could not say much about the scam.

A quick visit to the source code of the website shows that the page was built with ReactJS and the server managing the pages is Nginx 1.18.0 . Note that the attacker leaves the default manifest of `demo-react-application` within the website: yet another **red-flag**. We continue with simulating typical user behaviour, trivially this translates into clicking the join now button and applying the code. The following modal is presented with a link to an executable:

![Modale per scaricare il client](https://serhack.me/images/articles/reverse-engineering-redline-malware-eira/modal-eira_369x620.jpg)

Modal that appears after inserting the code

Very interesting! We have to download the executable (`EiraLauncher.exe`) in order to run the game and win the promised prizes. Not bad, the typical user would say, but experience shows that malware is usually behind these executables. Delving even deeper into the webpage, we can see that the access codes have been encoded in plain text.

```
// Coded list of redeem codes
h = ["WI9S9IE2", "YAICLZ8T", "ZLZI6N1X", "Z3C3HFA5", "7WV6A9NC", "BC44FY1", "Y7WNG94", "F3L182D", "P7G8TU4", "W24FEZX", "T62TUWX", "54DGA7K", "TBN640M", "D0UF4AQ", "ZMF00QA", "SE2490A", "B0AEP84", "MP139AP", "U72GH81", "KF041LR", "HW4316K", "GE8131P", "S84TPAA", "OW43BNC", "WKCQK82", "BNXTG7K", "AA004RT", "XGP889T", "WUSHQ01", "DTO63Y8", "HO8BQQ2", "RQ9SEW2", "YT03EW2", "JX13H51", "SKN9617", "YVNS6G3", "NT3T17R", "N2R81EP", "XQ4KSV9"]
m = ["BC44FY1", "F3L182D", "Y7WNG94", "P7G8TU4", "W24FEZX", "T62TUWX", "54DGA7K", "TBN640M", "D0UF4AQ", "ZMF00QA", "SE2490A", "B0AEP84", "MP139AP", "U72GH81", "KF041LR", "HW4316K", "GE8131P", "S84TPAA", "OW43BNC", "WKCQK82", "BNXTG7K", "AA004RT", "XGP889T", "WUSHQ01", "DTO63Y8", "HO8BQQ2", "RQ9SEW2", "YT03EW2", "JX13H51", "SKN9617", "YVNS6G3", "NT3T17R", "N2R81EP", "XQ4KSV9"]
```

73 different codes for 73 different e-mail addresses. Strange to think that a company would leave the codes to access the game unencrypted, don’t you think? The various red flags begin to increase our curiosity. So we waste no more time and immediately start reverse engineering the binary.

## The Launcher

We then download EiraLauncher.exe (sha256: `b39c855c613f65221ed5d33b3b2e7e74c27ce1afff02a6505103d3ca99d4ec0c`) to continue the analysis, and we immediately notice that EiraLauncher.exe weighs 158 Mb. The size of the file is not such that we should be worried: we can assume that it contains the compressed game resources.

We have two different paths we can take at the moment: we can continue with the dynamic analysis, running the program directly in a protected environment, or we can carry out the static analysis, going to reverse engineer the program. Since the binary is beyond the maximum size of online sandboxes such as Any.run, and since we have no resources available to make a virtual machine, we decide to carry out an initial static analysis.

The file is a classic Windows PE executable. We immediately highlight the `checksum` field of the COFF header set to 0, and the timestamp, though not always accurate, shows that the program was compiled on 16 June 2022. Analysis of the sections does not reveal any special features: the binary contains all standard sections (specifically `.text`, `.rdata`, `.data`, `.pdata`). Moving on. Extrapolating the imports, we can see that the program uses some “anti-debugging” functions (`IsDebuggerPresent`, `IsProcessorFeaturePresent`) to check whether we are inside a sandbox environment or not. Another `ShellExecute` import raises further suspicions since the program is capable of executing commands.

The resources section, on the other hand, is more interesting. There are only 4 resources, 2 of which are manifest and icons. Since the program is quite heavy, we were expecting many more (perhaps with images, videos and other data to make the game work). It is now time to delve into what kind of files are included inside the binary.

The best tool to find out if the PE binary contains other file types is called binwalk and has now become the de facto standard for analysing firmware. The alternative would be to manually check every magic byte sequence within the binary, but binwalk is much more convenient. We therefore start binwalk by specifying the file `EiraLauncher.exe`.

```
binwalk EiraLauncher.exe
162560        0x27B00         Copyright string: "Copyright (c) by P.J. Plauger, licensed by Dinkumware, Ltd. ALL RIGHTS RESERVED."
210203 ...