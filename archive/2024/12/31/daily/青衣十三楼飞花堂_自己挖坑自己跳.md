---
title: 自己挖坑自己跳
url: https://mp.weixin.qq.com/s?__biz=MzUzMjQyMDE3Ng==&mid=2247487836&idx=1&sn=4ce7567512f92f77488b8a39dd01f58d&chksm=fab2d263cdc55b75159d1e325f153baff1e0c7f209cdf64e8e2b686af46336f4d2119b438152&scene=58&subscene=0#rd
source: 青衣十三楼飞花堂
date: 2024-12-31
fetch_date: 2025-10-06T19:41:07.885350
---

# 自己挖坑自己跳

![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/VbJOzZqovPMOHoRxTSqmibVhZDnd5k2IMMluSjIcKPl6D1oSffNNvPvetm1MakQaDHibAicJoqicjFImBhfsXx8Wqw/0?wx_fmt=jpeg)

# 自己挖坑自己跳

原创

沈沉舟

青衣十三楼飞花堂

说一件自己挖坑自己跳的扯淡之事，供大家幸灾乐祸。

在远程虚拟机中配置Win10，wf.msc限RDP的源与目标。开始设复杂密码，因为太过复杂，写在临时文件中，肉眼看了一遍，然后Copy/Paste到lusrmgr.msc的GUI中。虽然有个确认输入，实际就是Paste两次。

离开远程Guest Console，开始测RDP登录。nc测出3389/TCP可达，直接mstsc，弹出登录框，输入user/pass，登录失败。听说有沿线设备限制过RDP协议，自做聪明误判不是简单限制3389，而是做了协议解码后的干扰。

有些沿线设备的规则可能约束较强，比如逻辑与了3389，此时若切换到4489，就会绕过。回到远程Guest Console，reg add，改4489。不知何故，sc stop TermService失败，services.msc重启终端服务成功。调整wf.msc，nc测4489/TCP可达。mstsc登录，仍然失败。

脑子进水了，决定重启远程虚拟机，此处毫无逻辑。

重启后，mstsc登录失败依旧。至此，才开始怀疑pass设置有误。试图Guest Console登录，失败。天呐，改pass玩砸了。最后挣扎，在那个复杂密码的字符范围内做各种长短测试，比如首尾部多个空格，假设Copy时少复制了几个字符，等等。挣扎无果。

因故，无法对这台远程虚拟机动用U盘WinPE，满补丁Win10，悲剧。

事后复盘，第一次Copy/Paste时，很可能出现低级错误，剪贴板中的数据可能是其他意料之外的内容，并不是计划中的复杂密码，这是第一个大错误。发现RDP登录失败时，趁远程Guest Console还在，立即lusrmgr.msc改密码，手动输入两遍，即可抢救，但毫无逻辑地盲目重启，失去Guest Console，这是第二个大错误。沿线设备没有限制RDP，全是自己给自己加的戏，没有道理3389可达然后解码干扰，从概率上考虑，若真如此就属于没事找抽。事实表明，沿线设备没有找抽，是我找抽。

不想再折腾，直接废了这台远程虚拟机，重新远程上传已在本地改好配置的虚拟机，除了有点大、上传耗时长，没啥。

预览时标签不可点

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/VbJOzZqovPPoySptTrxD06kCctXhGgQYZW0c0DRia8IJn5AbKdQCtQjACoUdkP9QvsXo0icz8JYQ55t7Gv0L6YcA/0?wx_fmt=png)

青衣十三楼飞花堂

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/VbJOzZqovPPoySptTrxD06kCctXhGgQYZW0c0DRia8IJn5AbKdQCtQjACoUdkP9QvsXo0icz8JYQ55t7Gv0L6YcA/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过