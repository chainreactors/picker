---
title: Assemblyline as a Malware Analysis Sandbox, (Sat, Feb 4th)
url: https://isc.sans.edu/diary/rss/29510
source: SANS Internet Storm Center, InfoCON: green
date: 2023-02-05
fetch_date: 2025-10-04T05:45:48.184545
---

# Assemblyline as a Malware Analysis Sandbox, (Sat, Feb 4th)

# [Internet Storm Center](/)

[Sign In](/login.html)
[Sign Up](/register.html)

Handler on Duty: [Johannes Ullrich](/handler_list.html#johannes-ullrich "Johannes Ullrich")

Threat Level: [green](/infocon.html)

* [previous](/diary/29504)
* [next](/diary/29512)

# [Assemblyline as a Malware Analysis Sandbox](/forums/diary/Assemblyline%2Bas%2Ba%2BMalware%2BAnalysis%2BSandbox/29510/)

**Published**: 2023-02-04. **Last Updated**: 2023-02-04 23:53:30 UTC
**by** [Guy Bruneau](/handler_list.html#guy-bruneau) (Version: 1)

[0 comment(s)](/diary/Assemblyline%2Bas%2Ba%2BMalware%2BAnalysis%2BSandbox/29510/#comments)

If you are looking for a malware sandbox that is easy to install and maintain, Assenblyline (AL) [[1](https://cybercentrecanada.github.io/assemblyline4_docs/overview/how_it_works/)] is likely the system you want to be part of your toolbox. "Once a file is submitted to Assemblyline, the system will automatically perform multiple checks to determine how to best process the file. One of Assemblyline's most powerful functionalities is its recursive analysis model."[[2](https://cybercentrecanada.github.io/assemblyline4_docs/user_manual/submitting_file/)]

First step, install the server. My server configuration is as follow:

* Ubuntu 22.04
* Ubuntu Server (minimized)
* 8+ Cores
* 16+ GB RAM
* 100 GB
* 100+ GB /var/lib/docker
* Static IP

After rebooting and before installing AL, I update the server and added the following packages:

$ sudo apt-get update
$ sudo apt-get upgrade
$ sudo apt-get install -y apt-transport-https ca-certificates curl gnupg-agent software-properties-common
$ sudo apt-get install net-tools open-vm-tools htop ntp bind9-utils vim

Setup a separate disk for the docker which will also store the sample malware. Mine is 100 GB:

$ sudo cfdisk /dev/sdb
$ sudo pvcreate /dev/sdb1
$ sudo vgcreate malware\_vg01 /dev/sdb1
$ sudo vgdisplay malware\_vg01
$ sudo lvcreate -n /dev/mapper/malware\_vg01-virus --size 99G malware\_vg01
$ sudo lvdisplay malware\_vg01
$ sudo mkfs.xfs /dev/malware\_vg01/virus

Add the new disk to /etc/fstab

$ sudo vi /etc/fstab
Add: /dev/malware\_vg01/virus /var/lib/docker xfs defaults,noatime,nosuid 0 0
$ sudo mkdir -p /var/lib/docker
$ sudo mkdir -p /etc/docker
$ sudo mount -a
$ df -k

![](https://isc.sans.edu/diaryimages/images/malware_filesystem.PNG)

The server is ready to install Assemblyline. Next, I followed the instructions [here](https://cybercentrecanada.github.io/assemblyline4_docs/installation/appliance/docker/)  to install the software. I selected Docker to install AL for my VM appliance. After completing the installation, it is time to login: admin:admin

![](https://isc.sans.edu/diaryimages/images/al_login.PNG)

After logging in, check the Services tab for other Services Available you might choose to install. Some of them you need are paid the vendor to access the service (i.e. IntezerDynamic, IntezerStatic) while other are free to use and might need to register to enable them.

![](https://isc.sans.edu/diaryimages/images/al_other_svc.PNG)

Next, it is time to configure some of the other services under the Services tab such as adding an API key to use them (i.e. Virustotal)

![](https://isc.sans.edu/diaryimages/images/al_virustotal.PNG)

Before submitting any files, check out the Options tab to set other scan services:

![](https://isc.sans.edu/diaryimages/images/al_options.PNG)

**Submitting Files via API**

This is an example to submitting a sample via Rest API [[4](https://cybercentrecanada.github.io/assemblyline4_docs/integration/rest/)]. Check the reference where to go to create an API key in an account in the sandbox with the word mykey to generate the key. Here is an example to submit a file to AL:

$ curl -X POST https://malware/api/v4/submit/ \
    -k --insecure \
    -H 'x-user: admin' \
    -H 'x-apikey: mykey:SomeApiKeyHere' \
    -H 'accept: application/json' \
    -F '[[email protected]](/cdn-cgi/l/email-protection)'

$ curl -X POST https://malware/api/v4/submit/ -k --insecure -H 'x-user: admin' -H 'x-apikey: mykey:SomeApiKeyHere' -H 'accept: application/json' -F '[[email protected]](/cdn-cgi/l/email-protection)'

**Submitting Files to AL**

Using some of the files uploaded to my DShield sensor, I submitted 3 of them using the API for analysis.

![](https://isc.sans.edu/diaryimages/images/al_submission.PNG)

AL release regular updates who can be seen by clicking on the Bell in the top right corner which shows in green the current version. I found over time the following worked best for me to update my AL by doing the following commands in the following order:

![](https://isc.sans.edu/diaryimages/images/al_update.PNG)

**Updating AL**

$ sudo apt-get update
$ sudo apt-get upgrade
$ cd ~/deployments/assemblyline
$ sudo docker-compose pull
$ sudo docker-compose build
$ sudo docker-compose up -d
$ sudo docker-compose stop
$ sudo docker-compose start

**Indicator of Compromised**

ed902957efb11382546f2cff80e5284832f7f53c4e2b82b9d181c1f3ef65513f
db10d1e7a141350bfb25a9947088979fa6a1d32d4ad2629eceb54ecc82f92938
d546509ab6670f9ff31783ed72875dfc0f37fa2b666bd5870eecaaed2ebea4a8

[1] https://cybercentrecanada.github.io/assemblyline4\_docs/overview/how\_it\_works/
[2] https://cybercentrecanada.github.io/assemblyline4\_docs/user\_manual/submitting\_file/
[3] https://cybercentrecanada.github.io/assemblyline4\_docs/installation/appliance/docker/
[4] https://cybercentrecanada.github.io/assemblyline4\_docs/integration/rest/

-----------
Guy Bruneau [IPSS Inc.](http://www.ipss.ca/)
[My Handler Page](https://handlers.sans.org/gbruneau/)
Twitter: [GuyBruneau](https://twitter.com/guybruneau)
gbruneau at isc dot sans dot edu

Keywords: [Threatintel](/tag.html?tag=Threatintel) [Sanbox](/tag.html?tag=Sanbox) [Malware](/tag.html?tag=Malware) [infosec](/tag.html?tag=infosec) [Indicators](/tag.html?tag=Indicators) [Analysis](/tag.html?tag=Analysis) [detection](/tag.html?tag=detection)

[0 comment(s)](/diary/Assemblyline%2Bas%2Ba%2BMalware%2BAnalysis%2BSandbox/29510/#comments)

* [previous](/diary/29504)
* [next](/diary/29512)

### Comments

[Login here to join the discussion.](/login)

Top of page

×

![modal content]()

[Diary Archives](/diaryarchive.html)

* [![SANS.edu research journal](https://isc.sans.edu/images/researchjournal5.png)](/j/research)
* [Homepage](/index.html)
* [Diaries](/diaryarchive.html)
* [Podcasts](/podcast.html)
* [Jobs](/jobs)
* [Data](/data)
  + [TCP/UDP Port Activity](/data/port.html)
  + [Port Trends](/data/trends.html)
  + [SSH/Telnet Scanning Activity](/data/ssh.html)
  + [Weblogs](/weblogs)
  + [Domains](/data/domains.html)
  + [Threat Feeds Activity](/data/threatfeed.html)
  + [Threat Feeds Map](/data/threatmap.html)
  + [Useful InfoSec Links](/data/links.html)
  + [Presentations & Papers](/data/presentation.html)
  + [Research Papers](/data/researchpapers.html)
  + [API](/api)
* [Tools](/tools/)
  + [DShield Sensor](/howto.html)
  + [DNS Looking Glass](/tools/dnslookup)
  + [Honeypot (RPi/AWS)](/tools/honeypot)
  + [InfoSec Glossary](/tools/glossary)
* [Contact Us](/contact.html)
  + [Contact Us](/contact.html)
  + [About Us](/about.html)
  + [Handlers](/handler_list.html)* [About Us](/about.html)

[Slack Channel](/slack/index.html)

[Mastodon](https://infosec.exchange/%40sans_isc)

[Bluesky](https://bsky.app/profile/sansisc.bsky.social)

[X](https://twitter.com/sans_isc)

![](/adimg.html?id=)

© 2025 SANS™ Internet Storm Center
Developers: We have an [API](/api/) for you!   [![Creative Commons License](/images/cc.png)](https://creativecommons.org/licenses/by-nc-sa/4.0/)

* [Link To Us](/linkback.html)
* [About Us](/about.html)
* [Handlers](/handler_list.html)
* [Privacy Policy](/privacy.html)