---
title: AWS Cloud Development Kit Vulnerability Exposes Users to Potential Account Takeover Risks
url: https://thehackernews.com/2024/10/aws-cloud-development-kit-vulnerability.html
source: The Hacker News
date: 2024-10-25
fetch_date: 2025-10-06T18:56:03.964481
---

# AWS Cloud Development Kit Vulnerability Exposes Users to Potential Account Takeover Risks

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [AWS Cloud Development Kit Vulnerability Exposes Users to Potential Account Takeover Risks](https://thehackernews.com/2024/10/aws-cloud-development-kit-vulnerability.html)

**Oct 24, 2024**Ravie LakshmananVulnerability / Cloud Security

[![AWS Cloud Development Kit Vulnerability](data:image/png;base64... "AWS Cloud Development Kit Vulnerability")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjL5NVEmKTP6X2tKMj96lHho7dAkEVrlk9ky6iMCSj1eFt3aeMM8UaL_1EJjVVeuBZj8OfdNuidPfi_9yVlIQj0P6BblJb7-2FM-LiMtY-9U3tko0p9RcnUJfkPKTjvC1NoACy4UV0Wn_eoCzycE8CK5ZUDBRsXhG2aEKf-_DtMfy4jnBXsjE6ztEkY4qR0/s790-rw-e365/aws.png)

Cybersecurity researchers have disclosed a security flaw impacting Amazon Web Services (AWS) Cloud Development Kit (CDK) that could have resulted in an account takeover under specific circumstances.

"The impact of this issue could, in certain scenarios, allow an attacker to gain administrative access to a target AWS account, resulting in a full account takeover," Aqua researchers Ofek Itach and Yakir Kadkoda said in a [report](https://www.aquasec.com/blog/aws-cdk-risk-exploiting-a-missing-s3-bucket-allowed-account-takeover/) shared with The Hacker News.

Following responsible disclosure on June 27, 2024, the issue was addressed by the project maintainers in [CDK version 2.149.0](https://github.com/aws/aws-cdk/releases/tag/v2.149.0) released in July.

AWS [CDK](https://docs.aws.amazon.com/cdk/v2/guide/home.html) is an open-source software development framework for defining cloud application resources using Python, TypeScript, or JavaScript and provisioning them via CloudFormation.

The problem identified by Aqua builds upon [prior findings](https://thehackernews.com/2024/08/experts-uncover-severe-aws-flaws.html) from the cloud security firm about shadow resources in AWS, and how predefined naming conventions for AWS Simple Storage Service (S3) buckets could be weaponized to orchestrate Bucket Monopoly attacks and gain access to sensitive data.

Preparing an AWS environment for usage with the AWS Cloud Development Kit (AWS CDK) is accomplished by a process called bootstrapping, wherein certain AWS resources are provisioned to the environment. This includes an AWS S3 bucket, Amazon Elastic Container Registry (Amazon ECR) repository, and AWS Identity and Access Management (IAM) roles.

[![DFIR Retainer Services](data:image/png;base64...)](https://thehackernews.uk/cloud-insight-d)

"Resources and their configuration that are used by the CDK are defined in an AWS CloudFormation template," according to [AWS documentation](https://docs.aws.amazon.com/cdk/v2/guide/bootstrapping.html).

"To bootstrap an environment, you use the AWS CDK Command Line Interface (AWS CDK CLI) cdk bootstrap command. The CDK CLI retrieves the template and deploys it to AWS CloudFormation as a stack, known as the bootstrap stack. By default, the stack name is CDKToolkit."

Some of the [IAM roles](https://docs.aws.amazon.com/cdk/v2/guide/bootstrapping-env.html#bootstrapping-env-default) created as part of the bootstrapping process grant permission to upload and delete assets from the associated S3 bucket, as well as perform stack deployments with administrator access.

Aqua said the naming pattern of the IAM roles created by AWS CDK follows the structure "cdk-{Qualifier}-{Description}-{Account-ID}-{Region}," where each of the fields are explained below -

* Qualifier, a unique, nine-character string value that defaults to "hnb659fds" although it can be customized during the bootstrapping phase
* Description, resource description (e.g., cfn-exec-role)
* Account-ID, AWS account ID of the environment
* Region, AWS region of the environment

In a similar vein, the S3 bucket created during bootstrapping follows the naming pattern "cdk-{Qualifier}-assets-{Account-ID}-{Region}."

"Since many users run the cdk bootstrap command without customizing the qualifier, the S3 bucket naming pattern of the staging bucket becomes predictable," Aqua said. "This is because the default value for the bucket name qualifier is set to 'hnb659fds,' making it easier to anticipate the bucket's name."

With [thousands of instances](https://github.com/search?q=/cdk-hnb659fds-(.+-)%257B1,5%257D%255Cd/&type=code) discovered on GitHub where the default qualifier is used, this also means that guessing the bucket's name is as simple as finding the AWS Account ID and the region to which the CDK is deployed.

Combining this aspect with the fact that S3 bucket names are globally unique across all AWS accounts, the loophole opens the door for what's called [S3 Bucket Namesquatting](https://onecloudplease.com/blog/s3-bucket-namesquatting) (or Bucket Sniping), allowing an attacker to claim another user's CDK bucket if it doesn't exist already.

This could then pave the way for a partial denial-of-service (DoS) when a user attempts to bootstrap the CDK with the same account ID and region, a scenario that could be resolved by specifying a custom qualifier during bootstrapping.

A more serious consequence could occur if the victim's CDK has permission to both read and write data from and to the attacker-controlled S3 bucket, thereby making it possible to tamper with CloudFormation templates and execute malicious actions within the victim's AWS account.

"The deploy role of the CloudFormation service, which is the role CloudFormationExecutionRole in CDK, has administrative privileges within the account by default," Aqua pointed out.

"This means that any CloudFormation template written to the attacker's S3 bucket by the victim's CDK would be deployed later with administrative privileges in the victim's account. This would allow the attacker to create privileged resources."

In a hypothetical attack, should a user have initiated the CDK bootstrap process in the past and subsequently deleted the S3 bucket due to quota limits, an adversary could take advantage of the situation to create a bucket with the same name.

This could then cause the CDK to implicitly trust the rogue bucket and read/wri...