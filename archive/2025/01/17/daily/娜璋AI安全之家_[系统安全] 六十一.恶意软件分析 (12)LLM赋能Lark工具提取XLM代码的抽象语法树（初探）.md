---
title: [ç³»ç»Ÿå®‰å…¨] å…­åä¸€.æ¶æ„è½¯ä»¶åˆ†æ (12)LLMèµ‹èƒ½Larkå·¥å…·æå–XLMä»£ç çš„æŠ½è±¡è¯­æ³•æ ‘ï¼ˆåˆæ¢ï¼‰
url: https://mp.weixin.qq.com/s?__biz=Mzg5MTM5ODU2Mg==&mid=2247501228&idx=1&sn=b09f8443148d480c875e52d77103988a&chksm=cfcf7561f8b8fc774623011fade9c0218ad64e57b3768912d4159b85716e79823aa0097bc495&scene=58&subscene=0#rd
source: å¨œç’‹AIå®‰å…¨ä¹‹å®¶
date: 2025-01-17
fetch_date: 2025-10-06T20:11:42.200630
---

# [ç³»ç»Ÿå®‰å…¨] å…­åä¸€.æ¶æ„è½¯ä»¶åˆ†æ (12)LLMèµ‹èƒ½Larkå·¥å…·æå–XLMä»£ç çš„æŠ½è±¡è¯­æ³•æ ‘ï¼ˆåˆæ¢ï¼‰

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/0RFmxdZEDRNZSkJZhyaFuuJ0QswWsHUZsNHASe6DP3DiaSxN59buE8y027HTbbmqMDBz5SPQOxiam2Fh6TnNaFpg/0?wx_fmt=jpeg)

# [ç³»ç»Ÿå®‰å…¨] å…­åä¸€.æ¶æ„è½¯ä»¶åˆ†æ (12)LLMèµ‹èƒ½Larkå·¥å…·æå–XLMä»£ç çš„æŠ½è±¡è¯­æ³•æ ‘ï¼ˆåˆæ¢ï¼‰

åŸåˆ›

Eastmount

å¨œç’‹AIå®‰å…¨ä¹‹å®¶

> 2024å¹´4æœˆ28æ—¥æ˜¯Eastmountçš„å®‰å…¨æ˜Ÿçƒ â€”â€” ã€ç½‘ç»œæ”»é˜²å’ŒAIå®‰å…¨ä¹‹å®¶ã€æ­£å¼åˆ›å»ºå’Œè¿è¥çš„æ—¥å­ï¼Œå¹¶ä¸”å·²åšæŒ5ä¸ªæœˆæ¯å‘¨7æ›´ã€‚è¯¥æ˜Ÿçƒç›®å‰ä¸»è¥ä¸šåŠ¡ä¸º å®‰å…¨é›¶åŸºç¡€ç­”ç–‘ã€å®‰å…¨æŠ€æœ¯åˆ†äº«ã€AIå®‰å…¨æŠ€æœ¯åˆ†äº«ã€AIå®‰å…¨è®ºæ–‡äº¤æµã€å¨èƒæƒ…æŠ¥æ¯æ—¥æ¨é€ã€ç½‘ç»œæ”»é˜²æŠ€æœ¯æ€»ç»“ã€ç³»ç»Ÿå®‰å…¨æŠ€æœ¯å®æˆ˜ã€é¢è¯•æ±‚èŒã€å®‰å…¨è€ƒç ”è€ƒåšã€ç®€å†ä¿®æ”¹åŠæ¶¦è‰²ã€å­¦æœ¯äº¤æµåŠç­”ç–‘ã€äººè„‰è§¦è¾¾ã€è®¤çŸ¥æå‡ç­‰ã€‚ä¸‹é¢æ˜¯æ˜Ÿçƒçš„æ–°äººåˆ¸ï¼Œæ¬¢è¿æ–°è€åšå‹å’Œæœ‹å‹åŠ å…¥ï¼Œä¸€èµ·åˆ†äº«æ›´å¤šå®‰å…¨çŸ¥è¯†ï¼Œæ¯”è¾ƒè‰¯å¿ƒçš„æ˜Ÿçƒï¼Œéå¸¸é€‚åˆåˆå­¦è€…å’Œæ¢å®‰å…¨ä¸“ä¸šçš„è¯»è€…å­¦ä¹ ã€‚
>
> â€

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDROJ1RoIEHfImJuJ7kV607koyCt0jxRGu7e9Yic09B3CmrBZ70xVJicDHicAK2icfWRXL561kJvJCY9zPw/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**æ„Ÿè°¢è¯»è€…2024å¹´å¯¹æœ¬å…¬ä¼—å·çš„æ”¯æŒã€‚æ–°çš„ä¸€å¹´ç»§ç»­åˆ†äº«å¹²è´§ï¼Œå…±åŒè¿›æ­¥ï¼Œæ„Ÿæ©åŒè¡Œ ^\_^**

è¯¥ç³»åˆ—æ–‡ç« å°†ç³»ç»Ÿæ•´ç†å’Œæ·±å…¥å­¦ä¹ ç³»ç»Ÿå®‰å…¨ã€é€†å‘åˆ†æå’Œæ¶æ„ä»£ç æ£€æµ‹ï¼Œæ–‡ç« ä¼šæ›´åŠ èšç„¦ï¼Œæ›´åŠ ç³»ç»Ÿï¼Œæ›´åŠ æ·±å…¥ï¼Œä¹Ÿæ˜¯ä½œè€…çš„æ…¢æ…¢æˆé•¿å²ã€‚æ¼«æ¼«é•¿å¾è·¯ï¼Œåå‘è™å±±è¡Œã€‚äº«å—è¿‡ç¨‹ï¼Œä¸€èµ·å¥‹æ–—~

**å‰æ–‡ä»‹ç»äº†APTæ”»å‡»æ£€æµ‹æº¯æºä¸å¸¸è§APTç»„ç»‡çš„æ”»å‡»æ¡ˆä¾‹ã€‚è¿™ç¯‡æ–‡ç« å°†å°è¯•æ¢ç´¢åˆ©ç”¨å¤§æ¨¡å‹è¾…åŠ©æ¶æ„ä»£ç åˆ†æï¼Œå³LLMèµ‹èƒ½Larkå·¥å…·æå–XLMä»£ç çš„æŠ½è±¡è¯­æ³•æ ‘ã€‚åœ¨æ¶æ„ä»£ç åˆ†æè¿‡ç¨‹ä¸­ï¼Œå¤§å®¶ä¼šé‡åˆ°å„ç§å„æ ·çš„é—®é¢˜ï¼Œå¦‚ä½•ç»“åˆLLMå’ŒGPTå®Œæˆå¤æ‚ä»»åŠ¡ï¼Œæ›´å¥½åœ°ä¸ºå®‰å…¨å·¥ç¨‹å¸ˆåˆä½œè‡³å…³é‡è¦ã€‚åŸºç¡€æ€§æ¢ç´¢æ–‡ç« ï¼Œè¿˜è¯·å„ä½å¤§ä½¬å¤šå¤šæŒ‡æ•™ï¼Œå†™å¾—ä¸è¶³çš„åœ°æ–¹è¿˜è¯·æµ·æ¶µã€‚å¸Œæœ›æ‚¨å–œæ¬¢ï¼Œä¸”çœ‹ä¸”çæƒœã€‚**

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDRNZSkJZhyaFuuJ0QswWsHUZH4iaOqYlib2ibxec8kflB3YYk94wib1b3AowH3XyvA2oxtwyLJ7SdEsjog/640?wx_fmt=png&from=appmsg)

æ–‡ç« ç›®å½•ï¼š

* **ä¸€.æŠ½è±¡è¯­æ³•æ ‘**
* **äºŒ.Larkè§£æå™¨**

+ 1.ç®€ä»‹
+ 2.å®‰è£…

* **ä¸‰.Larkæå–XLMä»£ç çš„æŠ½è±¡è¯­æ³•æ ‘**
* **å››.LLMèµ‹èƒ½çš„æŠ½è±¡è¯­æ³•æ ‘æå–**

+ 1.å•æ ·æœ¬å¤„ç†
+ 2.æ‰¹é‡å¤„ç†

* **äº”.æ€»ç»“**

ä½œè€…çš„githubèµ„æºï¼š

* é€†å‘åˆ†æï¼š

+ https://github.com/eastmountyxz/

  SystemSecurity-ReverseAnalysis

* ç½‘ç»œå®‰å…¨ï¼š

+ https://github.com/eastmountyxz/

  NetworkSecuritySelf-study

ä½œè€…ä½œä¸ºç½‘ç»œå®‰å…¨çš„å°ç™½ï¼Œåˆ†äº«ä¸€äº›è‡ªå­¦åŸºç¡€æ•™ç¨‹ç»™å¤§å®¶ï¼Œä¸»è¦æ˜¯å…³äºå®‰å…¨å·¥å…·å’Œå®è·µæ“ä½œçš„åœ¨çº¿ç¬”è®°ï¼Œå¸Œæœ›æ‚¨ä»¬å–œæ¬¢ã€‚åŒæ—¶ï¼Œæ›´å¸Œæœ›æ‚¨èƒ½ä¸æˆ‘ä¸€èµ·æ“ä½œå’Œè¿›æ­¥ï¼Œåç»­å°†æ·±å…¥å­¦ä¹ ç½‘ç»œå®‰å…¨å’Œç³»ç»Ÿå®‰å…¨çŸ¥è¯†å¹¶åˆ†äº«ç›¸å…³å®éªŒã€‚æ€»ä¹‹ï¼Œå¸Œæœ›è¯¥ç³»åˆ—æ–‡ç« å¯¹åšå‹æœ‰æ‰€å¸®åŠ©ï¼Œå†™æ–‡ä¸æ˜“ï¼Œå¤§ç¥ä»¬ä¸å–œå‹¿å–·ï¼Œè°¢è°¢ï¼å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå°†æ˜¯æˆ‘åˆ›ä½œçš„æœ€å¤§åŠ¨åŠ›ï¼Œç‚¹èµã€è¯„è®ºã€ç§èŠå‡å¯ï¼Œä¸€èµ·åŠ æ²¹å–”ï¼

![](https://mmbiz.qpic.cn/mmbiz_jpg/0RFmxdZEDROZ0FiaQhr7u82U6dJibrM3VO0dUcD3EMLylohBICfH8ibt9D8T7r2jcvDCAFuf4VR5IhcypN5mvCSVg/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

> å£°æ˜ï¼šæœ¬äººåšå†³åå¯¹åˆ©ç”¨æ•™å­¦æ–¹æ³•è¿›è¡ŒçŠ¯ç½ªçš„è¡Œä¸ºï¼Œä¸€åˆ‡çŠ¯ç½ªè¡Œä¸ºå¿…å°†å—åˆ°ä¸¥æƒ©ï¼Œç»¿è‰²ç½‘ç»œéœ€è¦æˆ‘ä»¬å…±åŒç»´æŠ¤ï¼Œæ›´æ¨èå¤§å®¶äº†è§£å®ƒä»¬èƒŒåçš„åŸç†ï¼Œæ›´å¥½åœ°è¿›è¡Œé˜²æŠ¤ã€‚ï¼ˆå‚è€ƒæ–‡çŒ®è§åï¼‰

---

# ä¸€.æŠ½è±¡è¯­æ³•æ ‘

æŠ½è±¡è¯­æ³•æ ‘ï¼ˆAbstract Syntax Tree, ASTï¼‰Â æ˜¯ä¸€ç§æ ‘çŠ¶æ•°æ®ç»“æ„ï¼Œç”¨äºè¡¨ç¤ºæºä»£ç çš„æŠ½è±¡è¯­æ³•ç»“æ„ã€‚ä¸å…·ä½“è¯­æ³•æ ‘ï¼ˆConcrete Syntax Tree, CSTï¼‰ä¸åŒï¼ŒAST å»é™¤äº†ä¸ç¨‹åºè¯­è¨€è¯­æ³•æ— å…³çš„ç»†èŠ‚ï¼ˆå¦‚åˆ†å·æˆ–æ‹¬å·ï¼‰ï¼Œä»…ä¿ç•™ä»£ç çš„æ ¸å¿ƒè¯­ä¹‰ä¿¡æ¯ã€‚AST æ˜¯ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨åœ¨åˆ†ææºä»£ç æ—¶çš„é‡è¦ä¸­é—´è¡¨ç¤ºï¼Œå¹¿æ³›ç”¨äºä»£ç è§£æã€ä¼˜åŒ–ã€ä»£ç ç”Ÿæˆå’Œé™æ€åˆ†æç­‰åœºæ™¯ã€‚æ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºæºä»£ç ä¸­çš„ä¸€ç§ç»“æ„ï¼Œæ‰€ä»¥è¯´æ˜¯æŠ½è±¡çš„ï¼Œå› ä¸ºæŠ½è±¡è¯­æ³•æ ‘å¹¶ä¸ä¼šè¡¨ç¤ºçœŸå®è¯­æ³•çš„æ¯ä¸€ä¸ªç»†èŠ‚ã€‚

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDRNZSkJZhyaFuuJ0QswWsHUZ5QjAko119XDOYxU4ElJw625wLUAha4m6QiaSvYPiaapiazNmicoh47O9BQ/640?wx_fmt=png&from=appmsg)

æŠ½è±¡è¯­æ³•æ ‘ç‰¹æ€§ï¼š

* å±‚æ¬¡ç»“æ„ï¼šAST ä»¥æ ‘çš„å½¢å¼ç»„ç»‡ï¼Œæ ¹èŠ‚ç‚¹è¡¨ç¤ºç¨‹åºçš„æ•´ä½“ç»“æ„ï¼Œå­èŠ‚ç‚¹è¡¨ç¤ºè¯­å¥ã€è¡¨è¾¾å¼æˆ–å…¶ä»–è¯­è¨€æ„é€ ã€‚
* æŠ½è±¡æ€§ï¼šAST çœç•¥äº†å…·ä½“çš„è¯­æ³•ç»†èŠ‚ï¼Œä»…è¡¨ç¤ºä»£ç çš„é€»è¾‘ç»“æ„ã€‚
* è¯­è¨€æ— å…³æ€§ï¼šå°½ç®¡ AST æ˜¯ä¸ºç‰¹å®šç¼–ç¨‹è¯­è¨€ç”Ÿæˆçš„ï¼Œå…¶ç»“æ„å¯ä»¥é€šè¿‡ç‰¹å®šè§„åˆ™è·¨è¯­è¨€æ˜ å°„ã€‚

æŠ½è±¡è¯­æ³•æ ‘åœ¨å¾ˆå¤šé¢†åŸŸæœ‰å¹¿æ³›çš„åº”ç”¨ï¼ŒåŒ…æ‹¬ï¼š

* ç¼–è¯‘å™¨è®¾è®¡
* ç¨‹åºé™æ€åˆ†æ
* è‡ªåŠ¨åŒ–ä»£ç ç”Ÿæˆ
* ä»£ç è¯­ä¹‰ä¼˜åŒ–
* å®‰å…¨æ¼æ´æ£€æµ‹
* æ¶æ„ä»£ç è§£æå™¨
* æµè§ˆå™¨
* æ™ºèƒ½ç¼–è¾‘å™¨

ä¸‹é¢ç»™å‡ºæŠ½è±¡è¯­æ³•æ ‘çš„ç®€å•ç¤ºä¾‹ã€‚å‡è®¾å­˜åœ¨ä»¥ä¸‹ä¼ªä»£ç ï¼š

```
A1 = R12C34 + 5
```

æŠ½è±¡è¯­æ³•æ ‘è¡¨ç¤ºï¼š

```
start â”œâ”€â”€ assignment â”‚    â”œâ”€â”€ cell (A1) â”‚    â”œâ”€â”€ expression â”‚         â”œâ”€â”€ cell (R12C34) â”‚         â”œâ”€â”€ operator (+) â”‚         â”œâ”€â”€ int (5)
```

æ ¹èŠ‚ç‚¹æ˜¯ STARTï¼Œè¡¨ç¤ºä»£ç çš„èµ·å§‹ç‚¹ã€‚ASSIGNMENT æ˜¯ä¸€ä¸ªèµ‹å€¼æ“ä½œï¼Œå…·æœ‰å·¦å€¼ï¼ˆCELL A1ï¼‰å’Œå³å€¼ï¼ˆä¸€ä¸ªè¡¨è¾¾å¼ï¼‰ã€‚è¡¨è¾¾å¼ç”± CELL R12C34 å’Œ INT 5 é€šè¿‡æ“ä½œç¬¦ + ç»„æˆã€‚é€šè¿‡ASTï¼Œæˆ‘ä»¬å¯ä»¥æå–ä»£ç çš„è¯­ä¹‰ç»“æ„ï¼Œå¿½ç•¥å…·ä½“çš„è¯­æ³•ç»†èŠ‚ï¼Œå¦‚ç­‰å·å’Œç©ºæ ¼ï¼Œä»è€Œè¿›è¡Œæ›´æ·±å±‚æ¬¡çš„ä»£ç åˆ†æã€‚

---

# äºŒ.Larkè§£æå™¨

## 1.ç®€ä»‹

Larkï¼ˆé¹‚é¸£ï¼‰æ˜¯ä¸€ä¸ªPythonå®ç°çš„è¯­æ³•è§£æå™¨ï¼Œæ¥å—è¯­æ³•å’Œæ–‡æœ¬ï¼Œå¹¶ç”Ÿæˆè¡¨ç¤ºè¯¥æ–‡æœ¬çš„æŠ½è±¡è¯­æ³•æ ‘ã€‚å¼€æºåœ°å€å¦‚ä¸‹ï¼Œæ¨èå¤§å®¶å»Githubå­¦ä¹ ï¼š

* https://github.com/lark-parser/lark
* https://gitcode.com/gh\_mirrors/la/lark
* https://lark-parser.readthedocs.io/en/latest/json\_tutorial.html

> Lark is a parsing toolkit for Python, built with a focus on ergonomics, performance and modularity.
> Lark can parse all context-free languages. To put it simply, it means that it is capable of parsing almost any programming language out there, and to some degree most natural languages too.

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDRNZSkJZhyaFuuJ0QswWsHUZI7FDLXYP8PhvLz5Xw8yMlEx2nvxWNiboKTrVANgD2gMib6zxSj4Rp4CQ/640?wx_fmt=png&from=appmsg)

Larkèƒ½åšä»€ä¹ˆå‘¢ï¼Ÿ

* Parse all context-free grammars, and handle any ambiguity gracefully
* Build an annotated parse-tree automagically, no construction code required.
* Provide first-rate performance in terms of both Big-O complexity and measured run-time (considering that this is Python ğŸ˜‰
* Run on every Python interpreter (itâ€™s pure-python)
* Generate a stand-alone parser (for LALR(1) grammars)

Larkæ—¨åœ¨æ„å»ºè§£æå™¨ã€ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨ã€‚å®ƒæ”¯æŒä¸Šä¸‹æ–‡æ— å…³è¯­æ³•çš„å®šä¹‰å’Œé«˜æ•ˆè§£æï¼Œç‰¹åˆ«é€‚åˆå¤„ç†å¤æ‚çš„è¯­è¨€å’ŒæŠ½è±¡è¯­æ³•æ ‘ (AST) çš„æ„å»ºã€‚Lark åœ¨å­¦æœ¯ç•Œå’Œå·¥ä¸šç•Œå¹¿æ³›åº”ç”¨äºè‡ªç„¶è¯­è¨€å¤„ç†ã€ç¼–è¯‘å™¨è®¾è®¡ã€ä»£ç é™æ€åˆ†æç­‰é¢†åŸŸã€‚Larkçš„ç‰¹æ€§å¦‚ä¸‹ï¼š

ï¼ˆ1ï¼‰æ”¯æŒä¸Šä¸‹æ–‡æ— å…³æ–‡æ³• (Context-Free Grammar)
Lark æ”¯æŒå®Œæ•´çš„ BNFï¼ˆå·´ç§‘æ–¯-è¯ºå°”èŒƒå¼ï¼‰å’Œ EBNFï¼ˆæ‰©å±•å·´ç§‘æ–¯-è¯ºå°”èŒƒå¼ï¼‰ï¼Œå…è®¸ç”¨æˆ·å®šä¹‰çµæ´»çš„è¯­æ³•è§„åˆ™ã€‚EBNFåŸºæœ¬æ ¼å¼å¦‚ä¸‹ï¼Œterminal æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚å¯¹äºæ¯æ¡è§„åˆ™ï¼Œè§£æå™¨ä¼šé€šè¿‡é¡ºåºåŒ¹é…å®ƒçš„æ‰€æœ‰é¡¹ç›®ï¼Œå°è¯•æ¯ä¸ªå¤‡é€‰æ–¹æ¡ˆã€‚

```
rule_name : list of rules and TERMINALS to match          | another possible list of items          | etc.
TERMINAL: "some text to match"
```

ä¾‹å¦‚ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ EBNF è¯­æ³•è§„åˆ™ï¼š

```
?start: expressionexpression: term (("+" | "-") term)*term: factor (("*" | "/") factor)*factor: NUMBER | "(" expression ")"%import common.NUMBER%import common.WS%ignore WS
```

ï¼ˆ2ï¼‰é«˜æ•ˆçš„è§£æå™¨ç®—æ³•
Lark é»˜è®¤ä½¿ç”¨ LALR(1) ç®—æ³•è§£æä¸Šä¸‹æ–‡æ— å…³è¯­è¨€ï¼Œå…·æœ‰é«˜æ•ˆæ€§ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æ”¯æŒ Earley ç®—æ³•ï¼Œå¯ä»¥å¤„ç†åŒ…å«æ­§ä¹‰çš„è¯­æ³•ï¼Œé€‚åˆè§£æè‡ªç„¶è¯­è¨€ã€‚

ï¼ˆ3ï¼‰è‡ªåŠ¨æ„å»ºæŠ½è±¡è¯­æ³•æ ‘ (AST)
Lark æä¾›äº†ä¸€ä¸ªå¯æ‰©å±•çš„ Transformer æ¥å£ï¼Œç”¨äºç®€åŒ– AST çš„ç”Ÿæˆã€‚ç”¨æˆ·å¯ä»¥ç›´æ¥å®šä¹‰æ ‘èŠ‚ç‚¹çš„è½¬æ¢è§„åˆ™ï¼Œä»è€Œå°†è§£æç»“æœè½¬æ¢ä¸ºé€‚åˆç‰¹å®šä»»åŠ¡çš„æ•°æ®ç»“æ„ã€‚

ï¼ˆ4ï¼‰é”™è¯¯æ¢å¤å’Œè°ƒè¯•æ”¯æŒ
Lark æä¾›äº†å¼ºå¤§çš„è¯­æ³•é”™è¯¯å¤„ç†å’Œè°ƒè¯•å·¥å…·ï¼Œä½¿å…¶æˆä¸ºæ•™å­¦å’Œç ”ç©¶ä¸­æ¼”ç¤ºè§£æå™¨è®¾è®¡çš„ç†æƒ³é€‰æ‹©ã€‚Larkæ“…é•¿å¤„ç†æ­§ä¹‰é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯è§£æçŸ­è¯­"fruit flies like bananas"çš„ç»“æœï¼š

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDRNZSkJZhyaFuuJ0QswWsHUZj1Kgx13K0175qNNiaRxnOHQKBISL83dQyfbPSBoia5GjobbibfamJzMww/640?wx_fmt=png&from=appmsg)

ï¼ˆ5ï¼‰è¯­è¨€æ— å…³æ€§å’Œæ˜“ç”¨æ€§
Lark çš„è¯­æ³•å®šä¹‰å’Œè§£æé€»è¾‘æ˜¯è¯­è¨€æ— å…³çš„ï¼Œå¯ä»¥ç”¨äºè§£æå¤šç§ç¼–ç¨‹è¯­è¨€ã€è‡ªç„¶è¯­è¨€å’Œé¢†åŸŸç‰¹å®šè¯­è¨€ (DSL)ã€‚

ä¸‹é¢å±•ç¤ºäº†å…¶æ€§èƒ½æ¯”è¾ƒã€‚

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDRNZSkJZhyaFuuJ0QswWsHUZvn1thQS2EX0rWpq5O6Q2r5Eh8UDFbIK5sJJ7sxP6IVbCK1z4gd1NHQ/640?wx_fmt=png&from=appmsg)

---

## 2.å®‰è£…

Larkå®‰è£…è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œä½¿ç”¨pipå‘½ä»¤å³å¯ã€‚æ³¨æ„ï¼Œéœ€è¦ç¡®ä¿æ‚¨å·²ç»å®‰è£…äº† Python 3.6 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚

```
pip install lark-parser
```

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDRNZSkJZhyaFuuJ0QswWsHUZpXMGLicghEj3yDLKL6HtguOVuoVX5zwKVGvNXjnsvMVqsJ8lVF83XXg/640?wx_fmt=png&from=appmsg)

ä¸‹é¢ç»™å‡ºå®˜æ–¹çš„ç¤ºä¾‹ï¼š

```
from lark import Lark
l = Lark('''start: WORD "," WORD "!"
            %import common.WORD   // imports from terminal library            %ignore " "           // Disregard spaces in text         ''')
print( l.parse("Hello, World!") )
```

è¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š

```
Tree(start, [Token(WORD, 'Hello'), Token(WORD, 'World')])
```

è¯·æ³¨æ„ï¼Œåœ¨æœ€ç»ˆçš„æ ‘ç»“æ„é‡Œæœªå‡ºç°æ ‡ç‚¹ç¬¦å·ã€‚Larkä¼šè‡ªåŠ¨è¿‡æ»¤æ‰è¿™äº›ç¬¦å·ã€‚

---

# ä¸‰.Larkæå–XLMä»£ç çš„æŠ½è±¡è¯­æ³•æ ‘

ä¸‹é¢ç»™å‡ºå…¶å®ƒç¤ºä¾‹ä¾›å¤§å®¶å­¦ä¹ ï¼Œå…·ä½“ç”¨æ³•è¯·è¯»è€…ç»“åˆå…·ä½“éœ€æ±‚è¿›è¡Œå®è·µã€‚å­¦ä¹ æ–‡æ¡£å¦‚ä¸‹ï¼š

* https://lark-parser.readthedocs.io/en/latest/json\_tutorial.html

ï¼ˆ1ï¼‰è¿ç®—è§£æ

```
from lark import Lark
# å®šä¹‰æ–‡æ³•grammar = """    start: expr    expr: term (("+"|"-") term)*    term: factor (("*"|"/") factor)*    factor: NUMBER | "(" expr ")"    NUMBER: /\d+/    %import common.WS    %ignore WS"""
# åˆ›å»º Lark è§£æå™¨parser = Lark(grammar, start='start')
# è§£æè¡¨è¾¾å¼expression = "3 + 5 * (10 - 2)"tree = parser.parse(expression)
print(tree.pretty())
```

è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDRNZSkJZhyaFuuJ0QswWsHUZ2YIkxC4nWJtTWe2mGl6dbMNW0K70LCMTBJlictS75IQVSMDU42FO6oQ/640?wx_fmt=png&from=appmsg)

ï¼ˆ2ï¼‰Jsonè§£æ

```
from lark import Lark
json_parser = Lark("""    value: dict         | list         | ESCAPED_STRING         | SIGNED_NUMBER         | "true" | "false" | "null"
    list : "[" [value ("," value)*] "]"
    dict : "{" [pair ("," pair)*] "}"    pair : ESCAPED_STRING ":" value
    %import common.ESCAPED_STRING    %import common.SIGNED_NUMBER    %import common.WS    %ignore WS""", start="value")
text = '{"key": ["item0", "item1", 3.14, true]}'t = json_parser.parse(text)print(t.pretty())
```

è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDRNZSkJZhyaFuuJ0QswWsHUZHBuicQuUTicrMZvI60HG3SL3cKNIFiaFJZjUWvlcgXjjHVfGXaq1hd2uw/640?wx_fmt=png&from=appmsg)

ï¼ˆ3ï¼‰XLMå®ä»£ç è§£æ

```
from lark import Lark
# å®šä¹‰ XLM å®ä»£ç çš„è¯­æ³•è§„åˆ™grammar = """    start: statement+    statement: formula_fill | goto    formula_fill: "FORMULA.FILL" "(" ESCAPED_STRING "," worksheet ")"    goto: "GOTO" "(" cell_ref ")"    ESCAPED_STRING: "\"" /[^"]+/ "\""    worksheet: /[a-zA-Z0-9_!]+/    cell_ref: worksheet? INT    INT: /[0-9]+/
    %import common.WS    %ignore WS"""
# åˆå§‹åŒ– Lark è§£æå™¨parser = Lark(grammar, start='start', parser='lalr')
# å®šä¹‰éœ€è¦è§£æçš„ XLM å®ä»£ç xlm_code = '''FORMULA.FILL("=CHAR(R[3508]C[-87])",k0OzKZKXou2wBZX44T!)GOTO(k0OzKZKXou2wBZX44T!14)'''
# è§£æä»£ç ast = parser.parse(xlm_code)
# æ‰“å°è§£æç»“æœprint(ast.pretty())
```

å…³é”®ä»£ç ç»“æ„å¦‚ä¸‹ï¼š

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDRNZSkJZhyaFuuJ0QswWsHUZ7gO0AQMNNzoNYvpDd4dE...