---
title: TLS Certificate Verification Changes in Edge
url: https://textslashplain.com/2022/12/06/tls-certificate-verification-changes-in-edge/
source: text/plain
date: 2022-12-07
fetch_date: 2025-10-04T00:41:22.024242
---

# TLS Certificate Verification Changes in Edge

[Skip to content](#content)

[text/plain](https://textslashplain.com/)

ericlaw talks about security, the web, and software in general

# TLS Certificate Verification Changes in Edge

Posted by[ericlaw](https://textslashplain.com/author/ericlaw1979/)[2022-12-062023-08-21](https://textslashplain.com/2022/12/06/tls-certificate-verification-changes-in-edge/)Posted in[browsers](https://textslashplain.com/category/browsers/), [security](https://textslashplain.com/category/security/), [web](https://textslashplain.com/category/tech/web/)Tags:[certificates](https://textslashplain.com/tag/certificates/), [Chromium](https://textslashplain.com/tag/chromium/), [Edge](https://textslashplain.com/tag/edge/), [https](https://textslashplain.com/tag/https/), [security](https://textslashplain.com/tag/security/), [tls](https://textslashplain.com/tag/tls/)

**Last Updated August 21 **2023**:**

* Experimentation started in Edge 109 and reached 100% in Edge 111 for (mostly non-enterprise) clients that use [server-driven experiments](https://textslashplain.com/2019/07/16/updating-browsers-quickly-flags-respins-and-components/#:~:text=using%20OmahaProxy.-,Field%20Trial%20Flags,-In%20some%20cases).
* Enterprise behavior changed by default in Edge 112.
* The opt-out policy will go away as soon as Edge 113.
* [One bug](https://crbug.com/1415524) has been found in v111 and is now fixed. [Another issue](https://bugs.chromium.org/p/chromium/issues/detail?id=971714) is fixed in 114. [And another](https://bugs.chromium.org/p/chromium/issues/detail?id=1439638) was fixed for 115.
* Here’s the [official documentation](https://learn.microsoft.com/en-us/deployedge/microsoft-edge-security-cert-verification).

---

When establishing a secure HTTPS connection with a server, a browser must validate that the certificate sent by the server is valid — that is to say, that:

* it’s non-expired (current datetime is within the validity period specified in the `notBefore` and `notAfter` fields of the certificate)
* it contains the hostname of the target site in the `subjectAltNames` field
* it is properly signed with a strong algorithm, and
* either the certificate’s signer (Certificate Authority) is trusted by the system (Root CA) or it *chains* to a root that is trusted by the system (Intermediate CA).

In the past, Chromium running on Windows delegated this validation task to APIs in the operating system, layering a minimal set of additional validation (e.g. [this](https://textslashplain.com/2017/03/10/chrome-deprecates-subject-cn-matching/)) on top of the verdict from Windows. As a consequence, Chromium-based browsers relied on two things: The OS’ validation routines, and the OS’ trusted root certificate store.

Starting [in Edge version 109](https://learn.microsoft.com/en-us/deployedge/microsoft-edge-security-cert-verification), Edge will instead rely on code and trust data shipped in the browser for these purposes — certificate chain validation will use Chromium code, and root trust determination will (non-exclusively) depend on a trust list generated by Microsoft and shipped with the browser.

**Importantly: This *should* not result in any user-visible change in behavior for users.** That’s true even in the case where an enterprise depends upon a private PKI (e.g. Contoso has their own **Enterprise CA** for certificates for servers on their Intranet, or WoodGrove Bank is using a **“Break-and-Inspect” proxy server** to secure/spy on all of their employees’ HTTPS traffic). These scenarios should still work fine because the browser will still check the OS root certificate store[1] if the root certificate in the chain is not in the browser-carried trust list.

**Q:** If the outcome is the same, why make this change at all?

**A:** The primary goal is consistency — by using the same validation logic and public CA trust list across all operating systems, users on Windows, Mac, Linux and Android should all have the same experience, not subject to the quirks (and bugs) of the OS-provided verifiers or the sometimes- misconfigured list of OS-trusted CAs.

**Q:** I know I can use `certmgr.msc` to visualize the Windows OS root certificate store. Can I see what’s in Edge’s built-in store?

**A:** Yes, you can visit the `about:system` page and expand the `chrome_root_store` node:

[![](https://textslashplain.com/wp-content/uploads/2023/06/image.png?w=1024)](https://textslashplain.com/wp-content/uploads/2023/06/image.png)

---

**Update**: A colleague observed today that on MacOS, Edge using the system verifier returns `NET::ERR_CERT_VALIDITY_TOO_LONG` when loading a site secured by a certificate that he generated with a 5-year expiration. When switching to use the Chromium verifier, the error goes away, because Chromium only [enforces the certificate lifetime limit on certs chained to public CAs](https://chromium.googlesource.com/chromium/src/%2B/HEAD/net/docs/certificate_lifetimes.md), while Apple has a [stricter requirement](https://support.apple.com/en-us/HT210176) that they apply to even private CAs.

**Update:** An Enterprise customer noted that their certificates were rejected with `ERR_CERT_UNABLE_TO_CHECK_REVOCATION` when they had set Group Policy to require certificate revocation checks for non-public CAs (`RequireOnlineRevocationChecksForLocalAnchors`). The problem was that their CRL was returned with a lifetime of two years, which is not in accordance with the baseline requirements. [CRBug](https://bugs.chromium.org/p/chromium/issues/detail?id=971714) and [v114 fix to stop checking lifetime for non-public chains](https://chromium.googlesource.com/chromium/src/%2B/15b3734a6cf05808a8aaddedcec92d08168e7477).

Also, if you do enable revocation checks, you should ensure that your CRL files are [DER-encoded and served over HTTP](https://learn.microsoft.com/en-us/deployedge/microsoft-edge-security-cert-verification#known-revocation-checking-behavior-differences-on-windows).

**Update 4/18:** An Enterprise customer has reached out to complain that their internal PKI does not work with the new verifier; certificates are rejected with `ERR_CERT_INVALID` errors. In [looking](https://textslashplain.com/2020/04/08/analyzing-network-traffic-logs-netlog-json/) at the collected [NetLog](https://textslashplain.com/2020/01/17/capture-network-logs-from-edge-and-chrome/), we see:

```
ERROR: Unconsumed critical extension
oid: 2B060104018237150A
```

By marking this extension ([1.3.6.1.4.1.311.21.10](https://groups.google.com/g/microsoft.public.security.crypto/c/6WQlWj2i9Gw)) as [`critical`](https://www.securesenses.net/2013/05/x509-certificates-critical-vs-non.html), the certificate demands verifier reject the certificate unless it can ensure that the purposes described in this proprietary `MS Application Policies` extension describe the purpose for which the certificate is being validated.

Unfortunately, Chromium doesn’t have any handling for this vendor-extension and rejects the certificate. Microsoft has now documented that the [ApplicationPolicies](https://learn.microsoft.com/en-us/windows/win32/seccertenroll/supported-extensions#msapplicationpolicies) extension should be ignored if the verifier supports the standard EKU extension (which nearly everything does) and the certificate contains an EKU. [Chromium 115+ now follows this guidance](https://bugs.chromium.org/p/chromium/issues/detail?id=1439638).

**Update 4/19:** An Enterprise customer has reached out to complain that their internal PKI does not work with the new verifier; certificates are rejected with `ERR_CERT_INVALID` errors. In [looking](https://textslashplain.com/2020/04/08/analyzing-network-traffic-logs-netlog-json/) at the collected [NetLog](https://textslashplain.com/2020/01/17/capture-network-logs-from-edge-and-chrome/), we see:

```
ERROR: Not permitted by name constraints
```

The root certificate contains a `critical` **[Name Constraints field](https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.10)** that Chromium’s verifier [en...