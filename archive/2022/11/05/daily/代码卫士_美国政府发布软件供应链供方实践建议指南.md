---
title: 美国政府发布软件供应链供方实践建议指南
url: https://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247514400&idx=1&sn=374227cc2e54ab7b644eb2e852a2934f&chksm=ea94884adde3015cc267473775816d120725f906a9c2cc739a7d6c1dceb8cf8d6073d186bf86&scene=58&subscene=0#rd
source: 代码卫士
date: 2022-11-05
fetch_date: 2025-10-03T21:45:50.816753
---

# 美国政府发布软件供应链供方实践建议指南

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/oBANLWYScMSscKglt945wQljtRwibib3VibrSFMao3n0dYwy5Oia9JKjiaeichUQic3uKuD4QzxGAe9vQibqicZ2KyLBp0g/0?wx_fmt=jpeg)

# 美国政府发布软件供应链供方实践建议指南

CISA

代码卫士

![](https://mmbiz.qpic.cn/mmbiz_gif/Az5ZsrEic9ot90z9etZLlU7OTaPOdibteeibJMMmbwc29aJlDOmUicibIRoLdcuEQjtHQ2qjVtZBt0M5eVbYoQzlHiaw/640?wx_fmt=gif) 聚焦源代码安全，网罗国内外最新资讯！

![](https://mmbiz.qpic.cn/mmbiz_png/oBANLWYScMRSylJK2k7H6mNqiaS2G6WRaeeK34cLHE6pe9VeOIHYiboAnKB0TMoayZCxFpHMLljzTnz9DnNuFiaqQ/640?wx_fmt=png)

专栏·供应链安全

数字化时代，软件无处不在。软件如同社会中的“虚拟人”，已经成为支撑社会正常运转的最基本元素之一，软件的安全性问题也正在成为当今社会的根本性、基础性问题。

随着软件产业的快速发展，软件供应链也越发复杂多元，复杂的软件供应链会引入一系列的安全问题，导致信息系统的整体安全防护难度越来越大。近年来，针对软件供应链的安全攻击事件一直呈快速增长态势，造成的危害也越来越严重。

为此，我们推出“供应链安全”栏目。本栏目汇聚供应链安全资讯，分析供应链安全风险，提供缓解建议，为供应链安全保驾护航。

*注：以往发布的部分供应链安全相关内容，请见文末“推荐阅读”部分。*

![](https://mmbiz.qpic.cn/mmbiz_png/FIBZec7ucCiaWtRttKahE4rd7icPBW6mLiaWubZBfibktxAlCMH6dwLG1225lH4Xo8nmA5ENG7I4o905Qq23icpkHwg/640?wx_fmt=png)

**美国国家安全局 (NSA)、美国网络基础设施安全局 (CISA) 和国家情报总监办公室（ODNI）联合发布《软件供应链供方实践建议指南》。指南报告提到，由于保护软件供应链安全基于组织机构在供应链中扮演的角色，因此三部门所发指南将分为三个系列，分别针对开发人员、供方和客户。目前已发布针对开发人员的软件供应链安全实践建议指南，此为第二份指南，第三份针对客户的指南将于后续发布。这一系列软件供应链安全实践建议指南将有助于这三个不同角色之间以及网络安全专业人员之间的沟通，以提高软件供应链流程中的弹性和安全性。**

**如下是奇安信代码安全团队对该指南主要内容的编译。**

![](https://mmbiz.qpic.cn/mmbiz_gif/oBANLWYScMSscKglt945wQljtRwibib3VibM470FfS5ExFvHGDEaGibUcgkM59ZRFKYibWxvyj31Z9BbmGH2w828fKg/640?wx_fmt=gif)

**1、 引言**

本指南报告提到，之前软件供应链攻陷主要针对的是组织机构未修复的常见已知漏洞。虽然威胁行动者仍然在借此攻陷未修复系统，但目前他们不再等待公开的漏洞披露，而是主动将恶意代码注入将通过全球供应链被分发给下游的产品中。过去几年来，这些下一代软件供应链攻陷活动对于开源和商业软件产品而言都急剧增加。

技术客户通常会将软件下载与更广泛更传统的软件供应链活动分开管理。同时考虑软件作为供应链风险管理组件的上游和下游阶段，有助于发现问题并提供更好的系统化安全方法。然而，在软件产品方面，二者还是存在一些区别。传统的软件供应链周期是从起始点到消费点，通常可使客户退回无法正常运行的产品并限制任何影响。相反，如果软件包中被注入恶意代码且被分发给多个客户，则这种影响范围更难以控制且可能造成指数级影响。

常见的软件供应链攻陷方法包括：利用软件设计缺陷、将易受攻击的第三方组件集成到软件产品中、在最终软件产品交付前通过恶意代码渗透供应链网络，客户部署后注入恶意软件。

利益相关者必须缓解各自责任范围内的安全问题。然而，其它安全问题可能要求这样一种缓解方法：规定对另外利益相关者的依赖，或者多个利益相关者共享的责任。沟通或解决不当的依赖关系可能会导致漏洞和攻陷发生。

这类漏洞可能存在的地方包括：

* 未记录的特性或高风险功能
* 未知修改和/或对评估和部署之间的合同、功能或安全假设的修改
* 供方所有权和/或地理位置的变更，以及
* 不良的供方企业或开发清理

本文编译的是报告的第二部分，即提供针对供方（厂商）的最佳实践和标准，确保从生产到交付整个过程中软件的完整性和安全性。每个部分都包括威胁场景示例和推荐的缓解措施。威胁场景解释的是组成软件开发生命周期 (SDLC) 既定周期的流程如何关联可被利用的常见漏洞。所建议的缓解措施展示的是可减少威胁影响的控制和缓解措施。

![](https://mmbiz.qpic.cn/mmbiz_gif/oBANLWYScMSscKglt945wQljtRwibib3VibM470FfS5ExFvHGDEaGibUcgkM59ZRFKYibWxvyj31Z9BbmGH2w828fKg/640?wx_fmt=gif)

**2、 供方**

供方充当开发人员和客户的接口人或中介，因此主要担负如下责任：
1、 维护安全交付软件的完整性

2、 验证软件包和更新

3、 保持关注未知漏洞

4、 接收客户报告的问题或新发现的漏洞并通知开发人员修复

软件安全开发和交付系统的目标是帮助保护软件代码、证明和完整性的安全，从而创建对软件供应链攻陷的弹性或完全禁止攻陷。

本章提到的威胁场景与《NIST SP800-218：采用软件安全开发框架 (SSDF)，缓解软件漏洞风险》一致。这些场景的目的是提供关于开发人员、供方和客户之间应当存在的高级沟通机制指南。虽然本章关注的是通过传统的、本地化方法交付的软件，但也会讨论适用情况下的软件即服务 (SaaS) 交付。

**2.1 组织机构做好准备**

**2.1.1** **定义软件安全检查标准**

应当设立并执行确保安全交付软件的具体检查策略。所有SDLC中的角色均应当能够访问并知晓这些策略，而且应当包括将漏洞、将使用的缓解机制以及生命周期 (EOL) 支持告知客户。

**威胁场景：本地**

如下示例场景可制造可利用的漏洞：

1、 策略不存在或者未明确定义。

2、 团队未意识到或者在整个SDLC过程中未执行策略要求。

3、策略要求未非包容性（例如，不存在通知客户漏洞的明确机制），或者未在产品的EOL中提供客户支持。

**缓解建议**

如下缓解措施有助于降低与部署流程相关联的威胁和风险：

1、验证所交付的软件和所收到的软件一致。

2、创建完全签名的镜像和二进制。

3、确保用于验证该二进制的哈希是安全的。

4、确保通信信道是安全的。

5、设立和执行安全的更新/补丁流程。

6、验证可执行文档的修订层级：

（a） 应当执行版本控制

（b） 确保变更时间戳

（c）应当执行版本控制系统，在必要时恢复。

7、利用国际认可的标准如NIST SSDF，验证已开展组织机构检查；该标准有助于确保在软件发布前以及整个软件生命周期中，满足软件功能和安全要求。

**2.2 保护软件**

**2.2.1** **保护所有格式的代码不受越权访问**

应当保护所有格式的代码不受越权访问和篡改，应当在整个SDLC中应用最低权限原则。这对于确保交付给客户的代码中包括所有所需安全特性且这些特性按设计运作至关重要。包括代码中不包括额外的且可能隐藏的、将降低安全性功能（如后门或硬编码密码）。

**威胁场景：本地化**

如下情境展示了对软件代码完整性的威胁：

* 具有未授权访问权限和能力的人员清晰地查看了未加密的、未混淆的设计或源代码；
* 构建和交付流程中的代码或程序包遭越权修改或删除；
* 在将软件交付给客户前，对文档、代码或程序包实施了越权修改或删除。
* 存在后门或硬编码密码，可导致后续的越权访问。

**缓解建议**

* 执行基于角色的访问控制 (RBAC)，职责分离，践行最小权限
* 识别并审查可信任架构师、开发人员、测试人员和文档人员完成该项目的必须技能。
* 根据个体能力和兴趣，为不同人员分配一个或多个涉及、编程和质量保证 (QA) 任务，并基于他们在安全访问控制系统中的相应项目角色注册权限。
* 验证为每个个体分配的企业发布的开发系统符合所有的公司安全标准，包括全磁盘加密、最低密码复杂度、补丁管理；反病毒和入侵检测系统，基于AI的端点防护平台和端点检测和响应、数据丢失预防 (DLP) 等。
* 确保代码仓库、构建和测试环境的安全防护措施至少和关键网络能力如网络分段、防火墙、监控、自动化加密和远程备份的防护措施一样。
* 确保仅有企业发布的或批准的开发系统才能访问使用多因素认证或基于行为分析的持续认证的开发、构建和测试环境，且仅通过具有物理安全性的办公网络或通过VPNs访问。确保检测、报告和调查失败的访问尝试情况。对于移动或远程工作的员工而言尤为重要。
* 审计第三方软件（如使用二进制软件成分分析）并确保所含模块的安全性。
* 使用代码签名系统，交付经过数字签名的代码和相关联的支持文件。该代码签名系统保护敏感的签名密钥，且使用硬编码防护如FIPS 140-2/-3 硬编码安全模块 (HSM)。
* 在开发和运维支持团队中建立强大的安全文化。
* 审计人员、任务、系统和策略，确保它们是适当的、必要的和完整的。同时采用计划式样和事件触发式审计。

**威胁场景：SaaS**

如下说明了可被利用的云原生软件开发场景示例：

* 承诺更快上市、更好扩展性和管理性、低成本，同时维护同等开发安全性和完整性的软件开发流程，
* 采用要求变更本地开发和分发流程以及安全和安全管理的新方法，
* 关键变更，如采用容器化和微服务架构。

**缓解措施建议**

如下缓解措施有助于降低与开发流程相关联的威胁和风险：

* 使用强大的应用认证、授权、代码扫描、漏洞分析和数字化签名，
* 这些实践应当按需扩充，以解决与端点和运营云安全相关联的其它认证问题。

**2.2.2** **验证软件发布完整性的机制**

供方应当提供软件发布完整性验证机制，在整个软件生命周期中对代码进行数字化签名。经过数字化签名的代码可使接收者积极地验证并信任代码的证明和完整性。

**威胁场景：本地化**

缺乏可验证的证明和完整性，将使如下场景更容易发生：

* 对软件支持活动具有访问权限的攻击者可用恶意软件替换合法组件；
* 对软件支持活动具有访问权限的攻击者可将恶意代码插入合法组件中；
* 恶意代码插入可能发生在交付之前的供方一方，或者发生在使用前的接收者一方。

**缓解建议**

如下缓解措施有助于降低威胁和相关风险：

1、数字化签名代码，以便接收人员能够验证并信任代码的证明和完整性

（a） 由于代码签名仅在代码签名后提供防护益处，因此要缓解代码签名前发生的代码篡改和恶意代码注入风险，建议组织机构考虑执行可验证的构建流程，作为签名代码之前的节点。

（b） 该可验证的构建系统应当由逻辑上隔离的生产构建环境的次镜组成，该环境独立地编译和封装代码，与生产构建环境编译和封装例程并行。

（c） 可对比这两个平行操作的哈希结果，而且如果验证结果匹配，则可签名生产构建工件。

（d） 应当使用由受信任证书机构发布的代码签名证书来签名最终修订的二进制代码，应当提供验证这些签名的机制。

2、 设立和执行关键管理程序，包括：

（a）应当在HSM上安全地存储用于代码签名操作的私钥，缓解代码签名密钥被盗的风险，

（b）应当通过正确的基础设施安全控制，保护访问存储在HSM或代码签名基础设施上的关键材料和流程的系统，

（c）应当通过正确的基础设施安全控制保护代码签名操作，缓解代码签名密钥错用和滥用风险。

3、在安全检查清单中包括签名验证，且确保正确执行：

(a) 记录官方安全配置指南或同等文档中的签名验证机制或流程，

(b) 如第三方供方签名验证机制不适用于允许第三方供方的架构，则应开发并提供定制化的编程方法，

(c) 第三方软件的供方应当在收到软件包时以及在将其继承到任何内部构建流程前，设立对软件包真实性和完整的验证检查，

(d) 签名验证机制应当包括证书撤销清单检查和信任链验证，

(e) 在签名中包括由时间戳机构发放的时间戳。

**2.2.3** **归档并保护每个软件发布**

组织机构应当设立归档策略，允许组织机构指定主要发布和次要发布。 某些组织机构受特定标准如支付卡行业数据安全标准、HIPAA等的制约。这些标准对供方提出了频率和留存要求。然而，每个软件供方判断如何应当归档软件、在覆写或破坏前应当留存多久以及应当存储在何处。归档的软件发布可用于灾难恢复，也可用于网络事件取证调查。

**威胁场景：本地化**

缺少或不恰当地在企业范围内设立用于判断哪些文件和元数据应当存储在一起的策略，增加了如下威胁策略发生的可能性：

* 会用不安全、不易访问或不可用的不恰当存储媒介类型；
* 不经常审计文档，或审计与组织机构留存策略不符。

**缓解建议**

通过将所发布软件迁移到已归档状态（通常是成本更低的存储区域），组织机构可节约成本并为更关键的软件项目分配更快的存储速度。这一流程通过减少员工打开正在开发的文件和访问相关联元数据的时间，提高生产力。如下缓解措施有助于降低相关风险和威胁：

1、建立具有正确访问控制的仓库

2、确保代码和编译的可执行文档在永久文档中维护。

3、应当限制文档权限，并将软件存储为只读模式以防遭修改。以只读模式创建文档，以便在紧急、调查或数据泄露的情况下保证其完整性。这一方法同时确保客户可在软件遭攻陷的情况下仍可访问软件。

4、存储文档的媒介由组织机构判断，而决策通常取决于媒介的便利性、可靠性和可用性。组织机构一般使用网络存储和其它媒介如磁带设备。

(a)  磁带媒介对于需要低成本在较小空间存储大量数据的一些组织机构而言是标准做法。然而，该媒体的检索和恢复可能是个问题；

(b)  附加网络驱动也很常见，但这种媒介更为昂贵。网络存储的托管需要房地产进行托管以及昂贵的硬件来确保安全性并进行维护。然而，不像多数磁带系统，网络驱动提供的归档数据在组织机构或调查人员需要访问时是现成可用的，

(c)  云储存的优势是可用性和低成本，但速度取决于组织机构的带宽和网络速度。很多组织机构为获得便利性和低成本而迁移到云储存。然而，确保数据安全仍然是组织机构的责任。

(d)  其它存储类型如下：

* 块存储服务，它所暴露的软件定义块设备可展示到在云中运行的虚拟主机中，
* 对象存储服务，可映射到主机、应用甚至是其它云服务，可解决ID或元数据的离散、非结构化数据元素，
* 可扩展共享文件系统，可使可扩展主机集告诉访问相同的文件系统。

5、数据一般是通过软件自动归档的。归档软件所提供的特性和能力取决于供方，但多数供方在每种平台上都具有标准的特性：

(a)  系统管理员配置将被归档软件的时间、位置和频率。创建归档策略，判断迁移数据背后的规则。管理员通过归档策略确保，转移到存储位置的数据遵循适当的规定标准和要求，

(b)  同时也有必要使用与其它归档规则联合的留存策略。留存策略判断在覆写或毁坏数据前归档可停留的时长。备份的一般留存策略约为30天，但所归档数据可能在被毁坏前会留存更久的时间。某些组织机构在替换媒介或删除文档前，持有归档数据的时间为数年之久。对于最敏感的数据而言，归档永远不会被覆写或毁坏。归档和合规标准可能存在留存的策略要求，因此组织机构应当确保配置不会违反任何规定标准。

**2.3 生产安全的软件**

**2.3.1** **涉及满足安全要求的软件**

生产安全的软件并缓解安全风险是交付软件的关键目标，允许客户仅访问获得授权的信息和资源，禁止访问未获授权的信息和资源。为此，安全要求必须是准确完整的、代码必须符合这些要求，以及必须修复任何可利用的漏洞。

**威胁场景：本地化**

如下是可利用的示例场景：

* 开发人员未在SDLC中应用安全开发实践，
* 开发人员或相关安全团队未得到正确的威胁或风险评估培训
* 设计或运营要求未得到完全理解或执行

**缓解建议**

如下缓解措施有利于减少与该流程相关联的威胁和风险：

* 演示安全开发生命周期实践和流程，包括定义预期环境的设计标准，
* 执行威胁建模，实现安全目标；
* 获得尽可能多的软件来源和运维环境信息；
* 使用技能较高的软件架构师和安全专业人员，开展威胁和风险评估，了解不同的部署场景、事件和运维错误如何影响软件达到要求的能力；
* 记录设计和运营假设，以便更加容易地评估要求所产生的影响和其它安全变化。重新访问开发周期中的设计假设和决策。

**威胁场景：SaaS**

软件开发人员在SaaS解决方案中使用可持续交付或可持续部署方法论，集成安全性。如下是可利用的示例场景：

* 攻击者或不知情的员工可能将易受攻击的代码引入仓库，触发自动构建和部署编译代码，
* SaaS解决方案客户可能易遭系统上易受攻击代码的利用，
* 单个SaaS解决方案中不同模块之间的安全要求差异可能导致对所有组件的验证不充分，
* 威胁行动者或恶意内部人员可能攻陷由第三方供应商提供但并未由供方或第三方供方验证的模块。

**缓解建议: SaaS**

如下是威胁缓解示例：

* 在SaaS 供方和所有相关联子承包商和第三方供方之间设立、执行和验证常见的安全要求；
* 定义软件产品的安全评估常用工具，这些软件产品必须由负责代码开发的所有方适用；
* 在最低权限执行环境中，执行安全性未被完全审计的任何代码，直至代码得到完全评估。

**2.3.2** **按照安全要求，评估第三方供方软件**

组织机构中通常存在由第三方提供的软件，它们或存在于组织机构中或包含于其它产品中。供方必须确保原生开发的软件和由第三方获取的任何组件符合安全要求规定。

**威胁场景：本地化**

如下是可被利用的场景示例：

* 供方、第三方供方和客户之间的合同协议可能是“级联的”；第三方软件是额外漏洞的潜在来源，
* 供方在做出是否使用由电放提供的软件组件的风险决策时，排除常见因素（如地理位置、供方所有权/控制和历史表现），
* 未在软件工程质量（如圈复杂度）、最小加密密钥长度、识别获批加密算法、识别获批库或编译器选项中表达安全要求。

**缓解建议**

如下是缓解措施示例：

1、验证第三方软件是否符合安全要求；从而降低与使用所购买软件模块和服务相关联的风险。

2、评估第三方提供的软件是否符合可用的安全要求：

(a)   定义安全要求（如最小密钥长度、使用FIPS 140-2密码算法）

(b)  如适用，...