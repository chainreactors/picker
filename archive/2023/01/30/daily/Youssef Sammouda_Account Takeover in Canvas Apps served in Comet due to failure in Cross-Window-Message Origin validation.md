---
title: Account Takeover in Canvas Apps served in Comet due to failure in Cross-Window-Message Origin validation
url: https://ysamm.com/?p=783
source: Youssef Sammouda
date: 2023-01-30
fetch_date: 2025-10-04T05:11:10.207323
---

# Account Takeover in Canvas Apps served in Comet due to failure in Cross-Window-Message Origin validation

[Youssef Sammouda (sam0) personal blog](/)
[ ]

[About](/about/)

## Posts

* Jan 29, 2023

  ### [Account Takeover in Canvas Apps served in Comet due to failure in Cross-Window-Message Origin validation](/2023/01/29/account-takeover-in-canvas-apps-served-in-comet-due-to-failure-in-cross-window-message-origin-validation.html)
* Jan 29, 2023

  ### [DOM-XSS in Instant Games due to improper verification of supplied URLs](/2023/01/29/dom-xss-in-instant-games-due-to-improper-verification-of-supplied-urls.html)
* Jan 29, 2023

  ### [Account takeover of Facebook/Oculus accounts due to First-Party access\_token stealing](/2023/01/29/account-takeover-of-facebook-oculus-accounts-due-to-first-party-access_token-stealing.html)
* May 14, 2022

  ### [Multiple bugs chained to takeover Facebook Accounts which uses Gmail.](/2022/05/14/bug-chain-to-achieve-facebook-account-takeover-of-users-signed-up-with-gmail-accounts.html)
* Mar 4, 2022

  ### [More secure Facebook Canvas Part 2: More Account Takeovers](/2022/03/04/more-secure-facebook-canvas-part-2.html)
* Sep 29, 2021

  ### [Multiple bugs allowed malicious Android Applications to takeover Facebook/Workplace accounts](/2021/09/29/multiple-bugs-allowed-malicious-android-applications-to-takeover-facebook-workplace-accounts.html)
* Sep 3, 2021

  ### [More secure Facebook Canvas : Tale of $126k worth of bugs that lead to Facebook Account Takeovers](/2021/09/03/more-secure-facebook-canvas-applications-tale-of-126k-worth-of-bugs-that-lead-to-facebook-account-takeovers.html)
* Jun 27, 2021

  ### [Oversightboard.com site-wide CSRF due to missing checking](/2021/06/27/oversightboard-com-site-wide-csrf-due-to-missing-checking.html)
* Jun 27, 2021

  ### [Disclose unconfirmed email/phone of a Facebook user](/2021/06/27/disclose-unconfirmed-email-phone-of-a-facebook-user.html)
* May 20, 2021

  ### [Oculus SSO "Account Linking" bug leads to account takeover on third party websites and inside VR Games/Apps](/2021/05/20/oculus-sso-account-linking-bug-leads-to-account-takeover-on-third-party-websites-and-inside-vr-games-apps.html)
* May 13, 2021

  ### [One-click reflected XSS in www.instagram.com due to unfiltered URI schemes leads to account takeover](/2021/05/13/one-click-reflected-xss-in-www-instagram-com-due-to-unfiltered-uri-schemes-leads-to-account-takeover.html)
* May 7, 2021

  ### [Identify a Facebook user by his phone number despite privacy settings set](/2021/05/07/identify-a-facebook-user-by-his-phone-number-despite-its-privacy-settings.html)
* May 5, 2021

  ### [Account takeover of Instagram accounts due to unrestricted permissions of third-party application's generated tokens](/2021/05/05/account-takeover-of-instagram-accounts-due-to-unrestricted-permissions-of-third-party-ig-applications-generated-tokens.html)
* Apr 30, 2021

  ### [Facebook account takeover due to unsafe redirects after the OAuth flow](/2021/04/30/facebook-account-takeover-due-to-unsafe-redirects-after-the-oauth-flow.html)
* Apr 2, 2021

  ### [Facebook account takeover due to a bypass of allowed callback URLs in the OAuth flow](/2021/04/02/facebook-account-takeover-due-to-a-bypass-of-allowed-callback-urls-in-the-oauth-flow.html)
* Apr 2, 2021

  ### [Facebook account takeover due to a wide platform bug in ajaxpipe responses](/2021/04/02/facebook-account-takeover-due-to-a-wide-platform-bug-in-ajaxpipe-responses.html)
* Feb 18, 2021

  ### [Expose Facebook object type (including private objects)](/2021/02/18/expose-facebook-object-type-including-private-objects.html)
* Feb 18, 2021

  ### [Expose information about Partner accounts in Partner portal](/2021/02/18/expose-information-about-partner-accounts-in-partner-portal.html)
* Feb 18, 2021

  ### [Ability to find Facebook employee's test accounts which lead to the disclosure of internal information.](/2021/02/18/ability-to-find-facebook-employees-test-accounts-which-lead-to-the-disclosure-of-internal-information.html)
* Feb 18, 2021

  ### [Disclose internal CMS objects content](/2021/02/18/disclose-internal-cms-objects-content.html)
* Feb 18, 2021

  ### [Confirm if an invitation is sent to a specific email in Partners Portal / Possibility to resend the invitation](/2021/02/18/confirm-if-an-invitation-is-sent-to-a-specific-email-in-partners-portal-possibility-to-resend-the-invitation.html)
* Feb 18, 2021

  ### [XSS in Facebook CDN due to improper filtering of uploaded files extensions](/2021/02/18/xss-in-facebook-cdn-due-to-improper-filtering-of-uploaded-files-extensions.html)
* Feb 17, 2021

  ### [Enumerate internal cached URLs which lead to data exposure](/2021/02/17/enumerate-internal-cached-urls-which-lead-to-data-exposure.html)
* Feb 17, 2021

  ### [Leaking Facebook user information to external websites / Setting some cookies values](/2021/02/17/leaking-facebook-user-information-to-external-websites-setting-some-cookies-values.html)
* Feb 17, 2021

  ### [Open redirect in Instagram.com](/2021/02/17/open-redirect-in-instagram-com.html)
* Feb 17, 2021

  ### [Access private information about SparkAR effect owners who has a publicly viewable portfolio](/2021/02/17/access-private-information-about-sparkar-effect-owners-who-has-a-publicly-viewable-portfolio.html)
* Feb 17, 2021

  ### [Make recruiting referrals on behalf of employees](/2021/02/17/make-recruiting-referrals-on-behalf-of-employees.html)
* Feb 15, 2021

  ### [Leak of internal categorySets names and employees test accounts.](/2021/02/15/leak-of-internal-categorysets-names-and-employees-test-accounts.html)
* Feb 15, 2021

  ### [Delete linked payments accounts of a Facebook page (or user)](/2021/02/15/delete-linked-payments-providers-of-a-facebook-page-or-user.html)
* Feb 15, 2021

  ### [Access files uploaded by employees to internal CDNs / Regenerate URL signature of user uploaded content.](/2021/02/15/access-files-uploaded-by-employees-to-internal-cdns-regenerate-url-signature-of-user-uploaded-content.html)
* Feb 15, 2021

  ### [URLs in img tag aren't passed through safe\_image.php which lead to exposure of Facebook users IPs.](/2021/02/15/urls-in-img-tag-arent-passed-through-safe_image-php-which-lead-to-exposure-of-facebook-users-ips.html)
* Feb 15, 2021

  ### [View orders and financial reports lists for any page shop](/2021/02/15/view-orders-and-financial-reports-lists-for-any-page-shop-2.html)
* Jan 3, 2021

  ### [Expose the email address of Workplace users](/2021/01/03/expose-the-email-address-of-a-workplace-user.html)
* Jan 1, 2021

  ### [XSS on forums.oculusvr.com leads to Oculus and Facebook account takeovers](/2021/01/01/xss-on-forums-oculusvr-com-leads-to-oculus-and-facebook-account-takeovers.html)
* Dec 31, 2020

  ### [Bad regex used in Facebook Javascript SDK leads to account takeovers in websites that included it](/2020/12/31/bad-regex-in-facebook-javascript-sdk-leads-to-account-takeovers-in-third-party-websites-that-included-it.html)
* Nov 7, 2020

  ### [Facebook DOM Based XSS using postMessage](/2020/11/07/facebook-dom-based-xss-using-postmessage.html)
* Jul 23, 2020

  ### [Disclose content of internal Facebook javascript modules ( Revisited )](/2020/07/23/disclose-content-of-internal-facebook-javascript-modules-revisited.html)
* Jul 2, 2020

  ### [Admin disclosure of Facebook verified pages/ Disclose Facebook employee assigned to help a verified page.](/2020/07/02/admin-disclosure-of-facebook-verified-pages-disclose-facebook-employees-assigned-to-verified-pages.html)
* Jun 14, 2020

  ### [Privilege escalation in Partners Portal to Admin access](/2020/06/14/upgrade-permissions-to-admin-access-in-partners-portal.html)
* Jun 14, 2020

  ### [Internal directories enumeration in www](/2020/06/14/internal-directories-enumeration-in-www.html)
* Jun 14, 2020

  ### [Disclose the Instagram account linked to a Facebook user account or page](/2020/06/14/disclose-instagram-account-linked-to-a-facebook-user-or-page.html)
* Jun 14, 2020

  ### [Disclose internal files related to testing of some Facebook tool...