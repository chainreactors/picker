---
title: Come funziona l’exploit di Windows Installer che permette di ottenere i privilegi di admin
url: https://www.securityinfo.it/2024/09/13/come-funziona-lexploit-di-windows-installer-che-permette-di-ottenere-i-privilegi-di-admin/?utm_source=rss&utm_medium=rss&utm_campaign=come-funziona-lexploit-di-windows-installer-che-permette-di-ottenere-i-privilegi-di-admin
source: Securityinfo.it
date: 2024-09-14
fetch_date: 2025-10-06T18:30:11.379169
---

# Come funziona l’exploit di Windows Installer che permette di ottenere i privilegi di admin

Aggiornamenti recenti Ottobre 6th, 2025 9:00 AM

* [Registrati](https://www.securityinfo.it/registrazione/)
* Login
* Filtro

# [![](https://securityinfo.it/wp-content/uploads/2016/08/LogoSquadrato_750px-1.jpg)](https://www.securityinfo.it)

### partner

[![In collaborazione con](https://www.securityinfo.it/wp-content/uploads/2025/06/Security_empty-1.jpg)](https://securityinfo.it/partner "partner")

### News Recenti

* [Transparency Center Initiative di Kaspersky Lab: cosa significa per l’Italia](https://www.securityinfo.it/2019/01/18/transparency-center-initiative-di-kaspersky-lab-cosa-significa-per-litalia/)
* [CERT-AGID 27 settembre – 3 ottobre: Weebly, tessera sanitaria e CieID sotto attacco](https://www.securityinfo.it/2025/10/06/cert-agid-27-settembre-3-ottobre-weebly-tessera-sanitaria-e-cieid-sotto-attacco/)
* [RedHat vittima di un breach: sottratti oltre 500 GB di dati](https://www.securityinfo.it/2025/10/03/redhat-vittima-di-un-breach-sottratti-oltre-500-gb-di-dati/)
* [Clearskies: la suite di sicurezza avanzata made in Europe arriva in Italia](https://www.securityinfo.it/2025/10/03/clearskies-la-suite-di-sicurezza-avanzata-tutta-made-in-europe-arriva-in-italia/)
* [Ricerca FireMon: il 60% dei firewall non supera i controlli di conformità](https://www.securityinfo.it/2025/10/01/il-60-dei-firewall-non-supera-i-controlli-di-conformita-la-ricerca-di-firemon/)
* [Scoperto ShadowLeak, un attacco che sfrutta un bug zero-click di ChatGPT](https://www.securityinfo.it/2025/09/30/scoperto-shadowleak-un-attacco-che-sfrutta-un-bug-zero-click-di-chatgpt/)

* [Home](https://www.securityinfo.it)
* [News](https://www.securityinfo.it/category/news/)
* [Approfondimenti](https://www.securityinfo.it/category/approfondimenti/)
* [Opinioni](https://www.securityinfo.it/category/opinioni/)
* [Top Malware](https://www.securityinfo.it/top-malware-page/)
* [Minacce](https://www.securityinfo.it/category/minacce-2/)
* [Guide alla sicurezza](http://www.securityinfo.it/guide-alla-sicurezza/)
* [Podcast](https://www.securityinfo.it/podcast-page/)
* [Strumenti Utili](https://www.securityinfo.it/category/strumenti-utili/)

* Search for:

## Come funziona l’exploit di Windows Installer che permette di ottenere i privilegi di admin

Set 13, 2024  [Marina Londei](https://www.securityinfo.it/author/marina-londei/ "Articoli scritti da Marina Londei")
 [Approfondimenti](https://www.securityinfo.it/category/approfondimenti/), [In evidenza](https://www.securityinfo.it/category/in-evidenza/), [News](https://www.securityinfo.it/category/news/), [RSS](https://www.securityinfo.it/category/rss/), [Vulnerabilità](https://www.securityinfo.it/category/news/vulnerabilita/), [Vulnerabilità](https://www.securityinfo.it/category/approfondimenti/vulnerabilita-approfondimenti/)
 [0](https://www.securityinfo.it/2024/09/13/come-funziona-lexploit-di-windows-installer-che-permette-di-ottenere-i-privilegi-di-admin/#respond)

---

Nel suo ultimo Patch Tuesday Microsoft aveva segnalato la presenza della [CVE-2024-38014](https://msrc.microsoft.com/update-guide/en-US/advisory/CVE-2024-38014), una **vulnerabilità di elevation of privilege** presente nella funzionalità **Windows Installer** che consente a un attaccante di ottenere i privilegi SYSTEM e prendere il controllo del dispositivo.

![Windows Installer](https://www.securityinfo.it/wp-content/uploads/2024/09/digital-8280787_1920.jpg)

Pixabay

Come si legge sul [blog](https://sec-consult.com/blog/detail/msi-installer-repair-to-system-a-detailed-journey/) di SEC Consult, la firma di sicurezza che per prima ha individuato il bug, il problema **risiede nella shell command che si apre per un istante durante l’esecuzione dell’MSI installer** di Windows, più precisamente quando si utilizza la funzionalità *repair* per un programma già installato.

“*Mentre l’installazione e la rimozione del software richiedono solitamente autorizzazioni elevate, **la funzione di repair del software già installato può essere eseguita da un utente con privilegi bassi***” spiega **Micheal Baer**, ricercatore di SEC Consult Vulnerability Lab. “*Le funzioni di repair possono tuttavia essere eseguite nel contesto di NT AUTHORITY\SYSTEM, privilegi di accesso molto elevati in Windows. Se un utente è in grado di interferire con queste funzioni, può eseguire un attacco di privilege escalation*“.

## L’exploit di Windows Installer

Baer spiega che per sfruttare la vulnerabilità è **necessario avere accesso alla GUI e a un browser come Firefox o Chrome**; l’exploit non funziona con le versioni più recenti di Edge o Internet Explorer.

Dopo aver invocato il *repair* di un’applicazione già installata, il Windows Installer viene eseguito con privilegi SYSTEM ed esso aprirà una console con privilegi elevati; a questo punto è possibile **navigare la GUI della console per aprire un’altra shell command interattiva con privilegi elevati.**

Nel dettaglio, quando la console viene aperta occorre cliccare col tasto destro sulla barra della finestra prima che si chiuda, selezionare l’opzione “Proprietà” e poi cliccare su **“legacy console mode”**. Questa opzione aprirà una finestra di dialogo in cui l’utente dovrà selezionare il browser con cui aprire la nuova console, preferibilmente Firefox; dopo averlo selezionato, occorre cliccare Ctrl+O sul browser per aprire una finestra di dialogo per l’apertura di un file. Qui l’attaccante deve digitare *cmd.exe* nella barra in alto e cliccare su INVIO per aprire una nuova shell command, questa volta con privilegi SYSTEM.

Nel caso in cui la prima console si chiuda troppo in fretta, è possibile usare **SetOpLock.exe**, un tool che blocca l’applicazione in fase di *repair* e quindi il processo sottostante, lasciando aperta la shell command.

![](https://www.securityinfo.it/wp-content/uploads/2024/06/hacker-6512174_1920.jpg)

Nonostante ci siano alcune condizioni da rispettare per eseguire l’exploit e non tutti gli installer siano vulnerabili all’attacco, la vulnerabilità è considerata ad alto impatto in quanto **non richiede l’interazione utente per essere sfruttata**, né privilegi elevati. Per verificare se l’installer è vulnerabile, i ricercatori di SEC Consult hanno sviluppato e rilasciato uno script Python per analizzare i file .MSI e individuare quelli vulnerabili.

SEC Consult aveva individuato la vulnerabilità a gennaio di quest’anno e l’aveva subito segnalata a Microsoft. La compagnia aveva programmato il rilascio della patch per maggio, ma a causa di alcune regressioni nel fix è stata costretta a far slittare il rilascio a pochi giorni fa.

Microsoft invita i suoi utenti ad **aggiornare il prima possibile i dispositivi vulnerabili** installando l’ultima patch di sicurezza.

Condividi l'articolo

* [Tweet](https://twitter.com/share)

---

* [elevation of privileges](https://www.securityinfo.it/tag/elevation-of-privileges/), [Microsoft](https://www.securityinfo.it/tag/microsoft/), [MSI](https://www.securityinfo.it/tag/msi/), [shell](https://www.securityinfo.it/tag/shell/), [vulnerabilità](https://www.securityinfo.it/tag/vulnerabilita/), [Windows Installer](https://www.securityinfo.it/tag/windows-installer/)

[Un malware Linux colpisce Weblogic Server per eseguire un cryptominer](https://www.securityinfo.it/2024/09/13/un-malware-linux-colpisce-weblogic-server-per-eseguire-un-cryptominer/)
[Finto password manager usato per distribuire malware tra gli sviluppatori](https://www.securityinfo.it/2024/09/12/finto-password-manager-usato-per-distribuire-malware-tra-gli-sviluppatori/)

---

![](https://secure.gravatar.com/avatar/25fb9b2d4cf1cb03debb642c725b4309?s=90&d=mm&r=g)

##### [Marina Londei](https://www.securityinfo.it/author/marina-londei/)

##### Articoli correlati

* [![Firewall Cisco sotto attacco: una nuova campagna prende di mira i device ASA](https://www.securityinfo.it/wp-content/uploads/2025/09/Gemini_Generated_Image_d4x8rid4x8rid4x8-120x85.png)](https://www.securityinfo.it/2025/09/29/firewall-cisco-sotto-attacco-una-nuova-campagna-prende-di...