---
title: Researchers Release PoC Exploit for Windows CryptoAPI Bug Discovered by NSA
url: https://thehackernews.com/2023/01/researchers-release-poc-exploit-for.html
source: The Hacker News
date: 2023-01-27
fetch_date: 2025-10-04T05:01:04.021301
---

# Researchers Release PoC Exploit for Windows CryptoAPI Bug Discovered by NSA

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [Researchers Release PoC Exploit for Windows CryptoAPI Bug Discovered by NSA](https://thehackernews.com/2023/01/researchers-release-poc-exploit-for.html)

**Jan 26, 2023**Ravie LakshmananEncryption / Windows Security

[![Windows CryptoAPI Spoofing Vulnerability](data:image/png;base64... "Windows CryptoAPI Spoofing Vulnerability")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgcCIe1V0XFCm5Bcxm4oxeESEi7u-U52a_r1gvOT1QWGgTGPz-7Ap6qFHJU_aV6-S0Gg0l9Cd1648pkwizssbGHB82JaNxi0t8qfAoqjDkfqZgQW7r7udl0MPOhFBB9CJ8EI0cdUV0uW7OSFXH999jj1SG4oolZJyGXVnFi45vRhNS0dKUVJNN0CYD4/s790-rw-e365/poc-exploit.png)

Proof-of-concept (Poc) code has been released for a now-patched high-severity security flaw in the Windows CryptoAPI that the U.S. National Security Agency (NSA) and the U.K. National Cyber Security Centre (NCSC) reported to Microsoft last year.

Tracked as **CVE-2022-34689** (CVSS score: 7.5), the spoofing vulnerability was addressed by the tech giant as part of Patch Tuesday updates released in August 2022, but was only publicly disclosed two months later on October 11, 2022.

"An attacker could manipulate an existing public [x.509 certificate](https://en.wikipedia.org/wiki/X.509) to spoof their identity and perform actions such as authentication or code signing as the targeted certificate," Microsoft [said](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-34689) in an advisory released at the time.

[![DFIR Retainer Services](data:image/png;base64...)](https://thehackernews.uk/cloud-insight-d)

The [Windows CryptoAPI](https://learn.microsoft.com/en-us/windows/win32/seccrypto/cryptoapi-system-architecture) offers an interface for developers to add cryptographic services such as encryption/decryption of data and authentication using digital certificates to their applications.

[![Windows CryptoAPI Spoofing Vulnerability](data:image/png;base64... "Windows CryptoAPI Spoofing Vulnerability")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEitgEFWKe9cmmPiCeNUFeUHkiQrOP1gUF8DKPscD6rnc5kzIBJ6dfhlEIMJw7FQRTLYapnN-A4XYC5HJJTJPiGRHlJszCPjxLdiwYvHwlJxEdt4f1-pt1O3DmHY3xcTeKNtRz15wmRh-nHbvtkF69Sal7AuOAzPFA0X5TbYWWfhYuBZrWu1hW0fQC8p/s790-rw-e365/exploit.gif)

Web security company Akamai, which [released](https://github.com/akamai/akamai-security-research/tree/main/PoCs/CVE-2022-34689) the PoC, [said](https://www.akamai.com/blog/security-research/exploiting-critical-spoofing-vulnerability-microsoft-cryptoapi) CVE-2022-34689 is rooted in the fact that the vulnerable piece of code that's designed to accept an x.509 certificate carried out a check that solely relied on the certificate's MD5 fingerprint.

MD5, a message-digest algorithm used for hashing, is essentially [cryptographically broken](https://thehackernews.com/2022/11/french-electricity-provider-fined-for.html) as of December 2008 owing to the risk of [birthday attacks](https://en.wikipedia.org/wiki/Birthday_attack), a cryptanalytic method used to find collisions in a hash function.

[![Windows CryptoAPI Spoofing Vulnerability](data:image/png;base64... "Windows CryptoAPI Spoofing Vulnerability")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgTx8Y1pP9dX_Xbmq-NThHnkUQ4XTBB94Koai70cWynk-zlzM1DDDAvb_Rq39ihlv9aiKFa7pxmZFFpzPriB4M8DX9TxFNxTKQdGantkStEOsaIgxgCAMIZz7nCxnt0DHi_5MMRAewgryohrF6u3oHCeCQIiAspBmDqucgAIE6Vf15T1JF9BmPB_2Ig/s790-rw-e365/exploit.png)

The net effect of this shortcoming is that it opens the door for a bad actor to serve a modified version of a legitimate certificate to a victim app, and then create a new certificate whose MD5 hash collides with the rigged certificate and use it to masquerade as the original entity.

[![CIS Build Kits](data:image/png;base64...)](https://thehackernews.uk/platform-shield-d)

In other words, the flaw could be weaponized by a rogue interloper to stage a mallory-in-the-middle ([MitM](https://en.wikipedia.org/wiki/Man-in-the-middle_attack)) attack and redirect users relying on an old version of Google Chrome (version 48 and earlier) to an arbitrary website of the actor's choosing simply because the susceptible version of the web browser trusts the malicious certificate.

"Certificates play a major role in identity verification online, making this vulnerability lucrative for attackers," Akamai said.

Although the flaw has a limited scope, the Massachusetts-headquartered firm pointed out "there is still a lot of code that uses this API and might be exposed to this vulnerability, warranting a patch even for discontinued versions of Windows, like Windows 7."

Found this article interesting? Follow us on [Google News](https://news.google.com/publications/CAAqLQgKIidDQklTRndnTWFoTUtFWFJvWldoaFkydGxjbTVsZDNNdVkyOXRLQUFQAQ), [Twitter](https://twitter.com/thehackersnews) and [LinkedIn](https://www.linkedin.com/company/thehackernews/) to read more exclusive content we post.

SHARE
[**](#link_share)
[**](#link_share)
[**](#link_share)
**

[**Tweet](#link_share)

[**Share](#link_share)

[**Share](#link_share)

**Share

**
[**Share on Facebook](#link_share)
[**Share on Twitter](#link_share)
[**Share on Linkedin](#link_share)
[**Share on Reddit](#link_share)
[**Share on Hacker News](#link_share)
[**Share on Email](#link_share)
[**Share on WhatsApp](#link_share)
[![Facebook Messenger](data:image/png;base64...)Share on Facebook Messenger](#link_share)
[**Share on Telegram](#link_share)

SHARE **

[CryptoAPI](https://thehackernews.com/search/label/CryptoAPI)[encryption](https://thehackernews.com/search/label/encryption)[windows security](https://thehackernews.com/search/label/windows%20security)

[![c](data:image/svg+xml;base64...)](https://thehackernews.uk/cloud-defense)

Trending News

[![SolarWinds Releases Hotfix for Critical CVE-2025-26399 Remote Code Execution Flaw](data:image/svg+xml;base64... "SolarWinds Releases Hotfix for Critical CVE-2025-26399 Remote Code Execution Flaw")

SolarWinds Releases Hotfix for Critical CVE-2025-26399 Remote Code Execution Flaw](https://thehackernews.com/2025...