---
title: From Backup to Backdoor: Exploitation of CVE-2022-36537 in R1Soft Server Backup Manager
url: https://blog.fox-it.com/2023/02/22/from-backup-to-backdoor-exploitation-of-cve-2022-36537-in-r1soft-server-backup-manager/
source: Fox-IT International blog
date: 2023-02-23
fetch_date: 2025-10-04T07:50:26.047805
---

# From Backup to Backdoor: Exploitation of CVE-2022-36537 in R1Soft Server Backup Manager

[Skip to content](#content)

[![Fox-IT International blog](https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2025/06/Fox-logo-for-wordpress-blog-2.png?fit=180%2C49&ssl=1)](https://blog.fox-it.com/)

[Fox-IT International blog](https://blog.fox-it.com/)

News and opinions from Fox-IT

Menu

* [Home](http://blog.fox-it.com/)
* [Archive](https://blog.fox-it.com/archive/)
* [Back to Fox-IT](http://www.fox-it.com)

# From Backup to Backdoor: Exploitation of CVE-2022-36537 in R1Soft Server Backup Manager

[Global Threat Intelligence](https://blog.fox-it.com/author/mikestokkel/ "Posts by Global Threat Intelligence")

[Blog](https://blog.fox-it.com/category/blog/)

February 22, 2023March 3, 2023
7 Minutes

**Blog updated on 3 March 2023** to (i) remove a table containing data created on 09-01-23, more than one month earlier than publication of the original blog on 22-02-23 entitled ‘Backdoored ConnectWise R1Soft Server Backup Manager by Autonomous System Organization (Top 20 as of 2023-01-09)’; (ii) update a table containing data created on 09-01-23 entitled ‘Backdoored ConnectWise R1Soft Server Backup Manager by Country (Top 20 as of 2023-01-09); and (iii) minor incidental updates.

During a recent incident response case, we found traces of an adversary leveraging ConnectWise R1Soft Server Backup Manager software (hereinafter: R1Soft server software). The adversary used it as an initial point of access *and* as a platform to control downstream systems connected via the R1Soft Backup Agent. This agent is installed on systems to support being backed up by the R1Soft server software and typically runs with high privileges. This means that after the adversary initially gained access via the R1Soft server software it was able to execute commands on all systems running the agent connected to this R1Soft server.

The adversary exploited the R1Soft server software via CVE-2022-36537 [[1]](https://nvd.nist.gov/vuln/detail/CVE-2022-36537) [[2]](https://tracker.zkoss.org/browse/ZK-5150), which is a vulnerability in the ZK Java Framework that R1Soft Server Backup Manager utilises. The “ZK” Framework is an opensource Java framework for building enterprise web and mobile applications. After successfully exploiting the vulnerability, the adversary deployed a malicious database driver with backdoor functionalities.

Further research by us indicates that world-wide exploitation of R1Soft server software started around the end of November 2022. With the help of fingerprinting, we have identified multiple compromised hosting providers globally. On 9 January 2023, we identified a total of **286** servers running R1Soft server software with a specific backdoor. Fox-IT informed the Dutch NCSC to coordinate the sharing of this knowledge towards the relevant national CERTs on 12 January 2023.

Given the global scope of compromise, our aim is to spread awareness about the severity of this threat. This blog will describe the malicious driver that was deployed by leveraging the vulnerability and how to check if your systems are affected. A table with IOCs can be found at the end of this post which can be used to correlate against the data sources within your environment.

## R1Soft server software exploitation via ZK Framework

In October 2022, security company Huntress published about the **CVE-2022-36537** vulnerability in the ZK Framework [[3]](https://www.huntress.com/blog/critical-vulnerability-disclosure-connectwise/r1soft-server-backup-manager-remote-code-execution-supply-chain-risks). They stated that this vulnerability can be abused to bypass authentication and lead to remote code execution (RCE) in R1Soft server software and its connected backup agents.

On 9 December 2022, proof-of-concept exploits started to appear on the internet for this vulnerability [[4]](https://github.com/numencyber/Vulnerability_PoC/tree/main/CVE-2022-36537) [[5]](https://github.com/Malwareman007/CVE-2022-36537/) [[6]](https://medium.com/numen-cyber-labs/cve-2022-36537-vulnerability-technical-analysis-with-exp-667401766746). We traced back the earliest exploitation of this bug within our client’s environment to 29 November 2022.

## Indicators of successful exploitation

The R1Soft server software has the option to upload a new database driver. This loads a new Java Database Connector (JDBC) and it is exactly this component that is abused by the adversary to load a malicious JDBC driver.

When the malicious JDBC driver is loaded by the R1Soft server software it will create a log entry in `{r1soft_install_location}/log/server.log`. This can be used to verify that the malicious driver was loaded into the application when successfully exploited. Below is an example of such a log entry which was encountered during the incident response case:

```
2022-11-29 12:06:03,654 INFO - <UI> Host: 45.159.248[.]213; Imported CDPServer [Id:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx] The MySQL database driver was uploaded successfully
```

We found multiple malicious `r1soft-cdp-server-mysql-driver*.jar` files in the `/tmp` folder of the R1Soft servers during the incident response case. This is an artefact of uploading a new database driver to R1Soft servers. Analysis shows that the timestamp of the `Driver.class` in the JAR file matches the time of exploitations. This indicates that the JAR file is automatically generated during the exploitation process.

[![](https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2023/02/mysql-jar-ziplisting.png?resize=800%2C176&ssl=1)](https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2023/02/mysql-jar-ziplisting.png?ssl=1)

During the incident response case, we found traces of the adversary dropping the malicious JDBC driver in `{r1soft_install_location}/bin/mysql.jar` on the R1Soft server.

The following IP addresses were found in the server.log file exploiting the vulnerability in the R1Soft server software within the client’s environment:

* `5.8.33[.]147`
* `45.61.139[.]187`
* `45.159.248[.]213`
* `77.91.101[.]140`
* `142.11.195[.]29`

## Malicious database driver

The dropped malicious JDBC driver by the adversary creates upon execution a new web filter with the name `fa0sifjasfjai0fja` and URL pattern `/zkau/jquery`. Once the malicious JDBC driver has been registered, it starts listening for incoming requests and it has the following functionalities:

* Load new functionalities in memory.
* Command execution.

Based on the overlapping variable names and functions, we concluded that this driver contains the Java code from the Godzilla web shell [[7]](https://github.com/whwlsfb/cve-2022-22947-godzilla-memshell/blob/main/GMemShell.java)[[8]](https://github.com/H4ckForJob/kingkong#analysis).

As described in the “Indicators of successful exploitation” the JAR is automatically generated. Interestingly the public Proof-of-Concept exploit released 10 days later [4] also generates a JAR file during the exploitation instead of using a static JAR file.

We have published a decompiled version of the malicious `Driver.class` backdoor [here](https://gist.github.com/fox-srt/2627f2f65ef3354b1d1a5c823cc2cd5e)

**NOTE**: *To prevent abuse we have redacted the password that is required to interact with the backdoor.*

## Backdoor statistics

Using the backdoor URL and its default response, we can determine if a R1Soft server is backdoored.The following graphs show a top 20 breakdown by country as of 3 March 2023:

[![](https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2023/03/Picture1.png?resize=800%2C566&ssl=1)](https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2023/03/Picture1.png?ssl=1)

As of 3 March 2023, a total of **128** R1Soft servers remain backdoored, the graph above shows the top 20 countries, which make up 123 of those servers.

The graph below shows the total number of backdoored servers we detected on the internet over time, showing a significant decrease since 9 January 2023.

[![](https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2023/03/r1soft-backdoor-totals-202...