---
title: 奇安信情报沙箱助力，识破求职网站伪装下的恶意软件
url: https://mp.weixin.qq.com/s?__biz=MzI2MDc2MDA4OA==&mid=2247513070&idx=1&sn=7d42871fa4b0cd9c05a95e4636aff6dc&chksm=ea664499dd11cd8fb7f02f9dc41aa78fb89adb5d9b4809018358a7263d68352e0964ee19d594&scene=58&subscene=0#rd
source: 奇安信威胁情报中心
date: 2024-11-16
fetch_date: 2025-10-06T19:18:08.077627
---

# 奇安信情报沙箱助力，识破求职网站伪装下的恶意软件

![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDy6YItSOmR05iaaO28XOowuibtvkS3ApdaK1k9zkjda9ibaQKY3mc3ewNdg/0?wx_fmt=jpeg)

# 奇安信情报沙箱助力，识破求职网站伪装下的恶意软件

原创

红雨滴团队

奇安信威胁情报中心

概述

恶意软件为了吸引受害者运行程序，避免异常活动引起人们的警觉，往往借助各种各样的伪装隐藏真实的恶意行为。沙箱可以给我们提供受控的环境运行这些可疑的软件，并识别出在伪装之下的潜在恶意操作。此外，沙箱中的程序运行行为还可以作为指引信息，辅助专业分析人员进行更深入的分析。

近期，奇安信威胁情报中心在日常运营过程中发现一个可疑压缩包，同样发现该压缩包的开源情报提到样本来自域名为 cdn.careers2find[.]com 的网站[1]。该网站主页将自己描述为求职网站。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyDxIyEtOYiaeX2pXSy0mPqf2icCbPqek1eqFqZZgjqzicyicqAWuUsGu3icw/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDysXibvqDmRNZ47nfuoia9hicHuVf4ndic6pf6GdBfjvg8MM7iaM3QhhD3gog/640?wx_fmt=png&from=appmsg)

为了快速判断捕获的压缩包是否存在恶意行为，先将其上传到奇安信情报沙箱（https://sandbox.ti.qianxin.com/sandbox/page）进行分析。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDydWiaW2prFpXtBe6V2Hib3eLRp8khqKnFEic3SqibZrIj4AkFcZNqpmGYZw/640?wx_fmt=png&from=appmsg)

沙箱分析

样本基本信息如下：

|  |  |
| --- | --- |
| **奇安信情报沙箱报告链接** | https://sandbox.ti.qianxin.com/sandbox/page/detail?type=file&id=AZMJ5Lm1SZq0HOVfdN9Z |
| **样本文件名** | SignedConnection.zip |
| **样本****MD5** | bb4c8f42cc624c628e4b98bd43f29fa6 |
| **样本类型** | ZIP压缩包 |
| **样本大小** | 1022011字节 |

上传分析完成后，可以看到该样本的基本信息：包括文件大小、类型、hash等。**奇安信情报沙箱基于智能的恶意行为综合判断**已经识别出文件可疑并给出 10 分的恶意评分。RAS 检测带有 “Maybe\_Sideloading” 标签，表明样本可能采用 DLL 侧加载手段。该样本曾在多个不同的沙箱环境中运行，在右侧可以切换分析环境查看不同分析环境的沙箱报告。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyB3t2qXvUHQrkyibfw4a06Ne7FbBmRVNQqF0ZcfFnhbo47gQ7gmCAlDQ/640?wx_fmt=png&from=appmsg)

在样本基本信息下面紧接着**威胁情报AI助手**对此次沙箱分析结果的总结内容，可供用户参考。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDycy3DfNDLmrQxQ5xoQKKkE7knhknQIkBwiao0Zxqw4X9pyGibjmUyEwlQ/640?wx_fmt=png&from=appmsg)

**AV引擎**部分显示了数十家杀软引擎对样本的检测结果，可以看到多个杀软引擎判定该样本为恶意。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDysj44CBFFAk9IFvWOQ80WhtIo9zsyibR4mkj0icP9GicJHlFaUe9vocgqg/640?wx_fmt=png&from=appmsg)

**行为异常**总结了样本的可疑行为，右侧带向下箭头符号的条目可以展开详细信息。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyc2JBSakgKaFvNEH0MjdzIdOYvddo5RfCP2oDRicCQffEOFEY4Nvw3Pg/640?wx_fmt=png&from=appmsg)

该样本有一些值得注意的异常行为，包括写入注册表的自启动项，名称模仿 OneDrive，路径指向 ”C:\Users\admin\AppData\Local\Microsoft\WindowsInsights\workstation\FileCoAuth.exe”。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDySg9qKkJ4sotfEYic7GVdgkLHDVg2tVZAmNfPIce8JNaonZib9LibcZJfg/640?wx_fmt=png&from=appmsg)

执行 HTTP 请求访问托管在 Github上 的链接。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyksS3QECOvh5C3MQjhUW4AWGa3Q9eibtyXHCNbBpicrsJNVuicBfI0DzMg/640?wx_fmt=png&from=appmsg)

通过 api.ipify.org 查找公网 IP。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyJzoicmHX5N4EXfScySjSunoNTFxgOdTvOf4JfJd7G51p9NT6LktK3PQ/640?wx_fmt=png&from=appmsg)

访问 Google 云盘。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDy7VCxbaMzqMhL2v0vzudcoUJEUZcLElUib8Gp9pC7prl9rDMI2wKib8fw/640?wx_fmt=png&from=appmsg)

创建可执行文件，其中一个文件路径正是前面注册表自启动项指向的路径。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDy95jPNd7ibvQkVYPQ4QdtiaOInLHQoria76hic4LS5PjD9pyQFELXibqe3qA/640?wx_fmt=png&from=appmsg)

**深度解析**部分的流文件信息列举了 ZIP 压缩包中包含的文件名，其中一些名称与上面行为异常提到的可执行文件名相同，表明压缩包中的文件可能会被复制到其他目录下。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyfv9kEibpeKMqaLOV1BNvmqsoaTyuwQjw5A06F2pV0HomB3tCFGZ1gYg/640?wx_fmt=png&from=appmsg)

**主机行为**的进程信息显示压缩包中的 SignedConnection.exe 运行后会启动 ”C:\Users\admin\AppData\Local\Microsoft\WindowsInsights\workstation\FileCoAuth.exe” 文件。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyM7Aw0Zr0YwO4dkxC3P0ia5ekqjHeJfYmbUnvb0FC3mHukA9AI6dwhNQ/640?wx_fmt=png&from=appmsg)

点击 SignedConnection.exe，可以进一步看到该进程执行的一些操作，包括创建 ”C:\Users\admin\AppData\Local\Microsoft\WindowsInsights\workstation” 目录，向创建的目录中写入 EXE 和 DLL 文件，并设置注册表的自启动项。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyXfr8KSCTq25HVLm0XCctpFq4GDEzediaXn2FeZXz0245nUrwZCbXEBQ/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDybTUhtvEicarA7wzLDdy8dXwt9o5UlQrTKbkqV9EgGhiaXSGP1SAOibWdg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDytibiblibSVPIwHwPKhTQicyamHlGb9pHEfwahyc6mcZkItVteM7fJmBJQQ/640?wx_fmt=png&from=appmsg)

**网络行为**显示样本除了访问 api.ipify.org，Github 和 Google 云盘，还会访问一个可疑的域名 xboxapicenter[.]com。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDywWrXib9KJstPDty2EvmE4skYKHfFI9Rzub4mYxfOEWWnGX0rTnhGWQA/640?wx_fmt=png&from=appmsg)

结合**主机行为**中的信息，这些域名的访问均来自启动的 FileCoAuth.exe 进程。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyGKWiaU4s7eyNtV88HHm8tMIbSwUiavJI8T6ibPuOWo5JtiaQgMKSkRIgGg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyNNiaNAkQS0Qy9ibmwDLicaTicXlbic1L62Jgvv7d6EJEQZ3SicqcCnI6uyGQ/640?wx_fmt=png&from=appmsg)

在**运行截图**部分，该样本运行后提供一个连接服务器的用户界面，其中连接的域名为 quiz.careers2find[.]com，与压缩包下载网页的域名相同。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyfxUibqqFor84WZJla1NAmLrkaFeh67icTHEqrbMCibKib3ODRkk99t0mrQ/640?wx_fmt=png&from=appmsg)

根据奇安信情报沙箱提供的信息，我们对该 ZIP 压缩包样本有了初步的了解：ZIP 压缩包中包含 EXE 和 DLL 文件，可能采用 DLL 侧加载的方式执行恶意代码；压缩包的 SignedConnection.exe 运行后创建目录，并在创建目录中写入 EXE 和 DLL 文件，因为写入文件名称与压缩包文件名相同，所以此举可能涉及文件复制操作，然后通过注册表建立持久化，自启动项指向新目录中的 EXE 文件 FileCoAuth.exe，接着启动该 EXE 文件；启动的 FileCoAuth.exe 访问一系列域名；此外，样本还会创建 UI，可能以此为伪装掩盖上述恶意操作。

详细分析

**压缩包**

压缩包下载链接为 ”hxxps://cdn.careers2find.com/assets/app/SignedConnection.zip”。下载页面的右侧按钮点击后下载 ZIP 压缩包，左侧按钮打开 PDF，内容是下载压缩包的安装和使用指南。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDy5icZZ8j396edVXWGFuTY1b4s5UgJx4zfnVIIhUpc6WezXnN8plwGHdA/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDy8U6giaQfgZ9maGlOltm3Oeic7QdmHmxLwYMzwgp2icfB16jRONASa3VZQ/640?wx_fmt=png&from=appmsg)

压缩包中除了 Qt5Core.dll 和 secur32.dll，其他 PE 文件均带有数字签名，并且这两个文件的修改时间都在近期。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDy0azU0icho2Rd9VkP8hDiadfSNo6ewQgMgD1nWvNq26hFq9onR8BeDo5w/640?wx_fmt=png&from=appmsg)

压缩包中的 SignedConnection.exe 实际为 OneDrive 相关程序 FileCoAuth.exe。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyic3J7icMGddBccwEgR8snHtElHsucAVBvnXSlW7ZicJTNpokIPJlajvCg/640?wx_fmt=png&from=appmsg)

SignedConnection.exe 运行后通过 DLL 侧加载的方式运行同目录下的 secur32.dll。

**Secur32.dll**

secur32.dll 由 C# 编写，主要功能为创建一个用户界面迷惑受害者，移动后门DLL文件并建立持久化。

|  |  |
| --- | --- |
| **文件名** | **secur32.dll** |
| **MD5** | 3528837b4088a22f0043551431809b3d |
| **文件大小** | 342.50 KB (350720字节) |

DllMain 调用 CreateThread 执行 OnAPIENTRY 函数，OnAPIENTRY 进一步执行 MainThread 和 UIThread，前者完成恶意操作，后者实现用于伪装的UI。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDynytnsnwAGPXcfRCQ6LPJwQwV8o3vzaHsjfS57BBq086CMDFN9kBT3w/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDy9ESYaCcb4tY2TE6WfJIX4UvVFicZmdnAtiaqoV4Emp3w14UZ7IZU1Krw/640?wx_fmt=png&from=appmsg)

**MainThread**

MainThread 执行的操作在 StateValidation.Instantion 中。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyegtPhR4ib5FCZYmUxVdJ6JqdSibrf3s5V9dQYrMVUaoBEmUWicKRd9UJg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/2AqAgxkehic8MO9icCiaCkQ6X6ALBVSUXDyIt2twPEAI5jCFLhXKxY0Ew0wC32KjMicojw4VeaxL9McCgqKINXv2NA/640?wx_fmt=png&from=appmsg)

StateValidation.Instantion 执行的流程如下：

(1) 检查目录 ”%LocalAppData%\\Microsoft\\WindowsInsights\\workstation” 是否存在，如果存在则调用 CreateToolhelp32Snapshot、Process32FirstW、Process32NextW 等系统 API 查找是否存在 FileCoAuth.exe 进程，将找到的 FileCoAuth.exe 进程终止，并删除上述目录；

(2) 重新创建目录 ”%LocalAppData%\\Microsoft\\WindowsInsights\\workstation”；

(3) 调用 StateValidation.CPR 复制文件，将后门 DLL 文件和程序依赖的其他 DLL 文件复制到...