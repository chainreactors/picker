---
title: Re: Citrix Gateway & Cloud MFA - Insufficient Session Validation Vulnerability
url: https://seclists.org/fulldisclosure/2023/Jul/28
source: Full Disclosure
date: 2023-07-17
fetch_date: 2025-10-04T11:53:34.304437
---

# Re: Citrix Gateway & Cloud MFA - Insufficient Session Validation Vulnerability

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)

[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)

## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](26)
[By Date](date.html#28)
[![Next](/images/right-icon-16x16.png)](29)

[![Previous](/images/left-icon-16x16.png)](1)
[By Thread](index.html#28)
[![Next](/images/right-icon-16x16.png)](32)

![](/shared/images/nst-icons.svg#search)

# Re: Citrix Gateway & Cloud MFA - Insufficient Session Validation Vulnerability

---

*From*: Jens Timmerman <jens () caret be>
*Date*: Sun, 16 Jul 2023 00:29:19 +0200

---

```
Hi,

On 03/07/2023 16:59, info () esec-service de wrote:
```

> ```
> Document Title:
> ===============
> Citrix Gateway&Cloud MFA - Insufficient Session Validation Vulnerability
>
>
> Technical Details & Description:
> ================================
> ```
>
> An insufficient session validation web vulnerability was discovered in
> the Citrix Gateway (ADC/NetScaler) 13.0 & 13.1 web-application, Cloud
> and AAA Feature.
> The security vulnerability allows remote attackers to bypass the mfa
> function by hijacking the session data of an active user (non expired
> session) to followup
>
> ```
> with further compromising attacks.
> ```

```

```

I've been working with a lot of products I believe that are vulnerable
to a very similar exploit, and I was wondering how one should fix
this/protect against this attack?

```

```

I looked at
<https://owasp.org/www-community/attacks/Session_hijacking_attack>
<<https://owasp.org/www-community/attacks/Session_hijacking_attack>> but
the page linking to the related controls doesn't seem to exist.

```

```

On
<https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html>
I can read.

```

```

With the goal of detecting (and, in some scenarios, protecting against)
user misbehaviors and session hijacking, it is highly recommended to
bind the session ID to other user or client properties, such as the
client IP address, User-Agent, or client-based digital certificate. If
the web application detects any change or anomaly between these
different properties in the middle of an established session, this is a
very good indicator of session manipulation and hijacking attempts, and
this simple fact can be used to alert and/or terminate the suspicious
session.

```

```

So binding a session server side to an ip address and browser
fingerprint can detect if this is ongoing, but a suffisticated attacker
could still pull this off.

```

```

Can someone point me to some information on what the industry best
practices are to protect against this type of attack?

```
Regards,

Jens Timmerman

On 03/07/2023 16:59, info () esec-service de wrote:
```

> ```
> Document Title:
> ===============
> Citrix Gateway&Cloud MFA - Insufficient Session Validation Vulnerability
>
>
> References (Source):
> ====================
> https://www.vulnerability-lab.com/get_content.php?id=2324
> ```
>
> Vulnerability
> Magazine:<https://www.vulnerability-db.com/?q=articles/2023/07/03/citrix-gateway-cloud-mfa-insufficient-session-validation-vulnerability>
>
> ```
> Security Video: (Cloud)
> https://www.youtube.com/watch?v=vObgOpGpCSM
>
> Security Video: (OnPrem)
> https://www.youtube.com/watch?v=RFjRgiW2OWE
>
>
> Release Date:
> =============
> 2023-07-03
>
>
> Vulnerability Laboratory ID (VL-ID):
> ====================================
> 2324
>
>
> Common Vulnerability Scoring System:
> ====================================
> 5
>
>
> Vulnerability Class:
> ====================
> Insufficient Session Validation
>
>
> Current Estimated Price:
> ========================
> 2.000€ - 3.000€
>
>
> Product & Service Introduction:
> ===============================
> ```
>
> Cloud Software Group's NetScaler and NetScaler Gateway, previously
> better known as Citrix ADC and Citrix Gateway (and hereafter referred
> to as Citrix \*)
> provides secure and reliable access to web applications, enterprise
> applications and corporate data.
>
> ```
>
> ```
>
> "Citrix Gateway consolidates remote access infrastructure to provide
> single sign-on for all apps, whether in a data center, in a cloud, or
> if the apps are deployed as SaaS apps. It allows users to access any
> app from any device through a single URL. Citrix Gateway is easy to
> deploy and easy to manage. The most typical deployment configuration
> is to place the Citrix Gateway appliance in the DMZ. You can install
> multiple Citrix Gateway appliances on the network for more complex
> deployments."
>
> ```
>
> ```
>
> (Copy of the
> Homepage:[https://docs.citrix.com/de-de/citrix-gateway.html](https://docs.citrix.com/de-de/citrix-gateway.html%C2%A0) )
>
> ```
>
> ```
>
> "Many companies restrict website access to valid users only, and
> control the level of access permitted to each user.
> The authentication, authorization, and auditing feature allows a site
> administrator to manage access controls with the NetScaler appliance
> instead of managing these controls separately for each application.
> Doing authentication on the appliance also permits sharing this
> information across all websites within the same domain that are
> protected by the appliance."
>
> ```
>
> ```
>
> (Copy of the
> Homepage:<https://docs.netscaler.com/en-us/citrix-adc/current-release/aaa-tm.html>
> &[https://citrix.cloud.com](https://citrix.cloud.com ) &<https://cloud.citrix.com>)
>
> ```
> Abstract Advisory Information:
> ==============================
> ```
>
> The vulnerability laboratory core research team discovered a web
> vulnerability in the official Citrix Gateway (ADC/NetScaler) 13.0 &
> 13.1 web-application, Cloud and AAA Feature.
>
> ```
> Affected Product(s):
> ===================
> Manufacturer:
> Citrix/Cloud Software Group
>
> Products:
> Citrix ADC/NetScaler 13.0 & 13.1
> Citrix Gateway/Netscaler Gateway 13.0 & 13.1
> Citrix Cloud Services Website
> Possibly also earlier versions
>
>
> Vulnerability Disclosure Timeline:
> ==================================
> 2023-03-27: Researcher Notification & Coordination (Security Researcher)
> 2023-04-24: Vendor Notification (Security Department)
> 2023-04-26: Vendor Response/Feedback #1 (Security Department)
> 2023-04-27: Vendor Response/Feedback #2 (Security Department)
> 2023-05-04: Vendor Response/Feedback #2 (Security Department)
> 2023-**-**: Security Acknowledgements (Security Department)
> 2023-**-**: Vendor Fix/Patch by Check (Service Developer Team)
> 2023-07-03: Public Disclosure (Vulnerability Laboratory)
>
>
> Discovery Status:
> =================
> Published
>
>
> Exploitation Technique:
> =======================
> Remote
>
>
> Severity Level:
> ===============
> Medium
>
>
> Authentication Type:
> ====================
> Restricted Authentication (User Privileges)
>
>
> User Interaction:
> =================
> No User Interaction
>
>
> Disclosure Type:
> ================
> Responsible Disclosure
>
>
> Technical Details & Description:
> ================================
> ```
>
> An insufficient session validation web vulnerability was discovered in
> the Citrix Gateway (ADC/NetScaler) 13.0 & 13.1 web-application, Cloud
> and AAA Feature.
> The security vulnerability allows remote attackers to bypass the mfa
> function by hijacking the session data of an active user (non expired
> session) to followup
>
> ```
> with further compromising attacks.
> ```
>
> The insufficient session validation vulnerability is located in the
> Citrix Gateway login without web-application firewall (waf) and the
> Citrix Gateway login with
> web-application firewall (waf). Attackers can access the applications
> behind the Citrix Gateway...