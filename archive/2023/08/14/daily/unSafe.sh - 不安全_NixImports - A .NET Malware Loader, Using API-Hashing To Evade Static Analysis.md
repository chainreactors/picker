---
title: NixImports - A .NET Malware Loader, Using API-Hashing To Evade Static Analysis
url: https://buaq.net/go-174346.html
source: unSafe.sh - 不安全
date: 2023-08-14
fetch_date: 2025-10-04T11:59:14.402310
---

# NixImports - A .NET Malware Loader, Using API-Hashing To Evade Static Analysis

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![]()

NixImports - A .NET Malware Loader, Using API-Hashing To Evade Static Analysis

A .NET malware loader, using API-Hashing and dynamic invoking to evade static analysis How
*2023-8-13 20:30:0
Author: [www.kitploit.com(查看原文)](/jump-174346.htm)
阅读量:29
收藏*

---

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi0Zq8zJu8KUW6x6AabU-OR0RAh6f7ncktwNDdnF1BDB_ExxXnb7vYeSvoTmvK92klLZD_BTSKymjXg68SKD5rdJrcKhCo7Ba_RU6dnjYDwHLX0UvH5j7Gp8Ss9dVjvTBKqxnAhc4h3kwIC7j4R6fuc763g0CQvwtRvJdenCBwY_7x3mcfXa5RtVkwVUBLv/w640-h312/nix_references.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi0Zq8zJu8KUW6x6AabU-OR0RAh6f7ncktwNDdnF1BDB_ExxXnb7vYeSvoTmvK92klLZD_BTSKymjXg68SKD5rdJrcKhCo7Ba_RU6dnjYDwHLX0UvH5j7Gp8Ss9dVjvTBKqxnAhc4h3kwIC7j4R6fuc763g0CQvwtRvJdenCBwY_7x3mcfXa5RtVkwVUBLv/s1174/nix_references.png)

A .NET [malware](https://www.kitploit.com/search/label/Malware "malware") loader, using API-Hashing and [dynamic](https://www.kitploit.com/search/label/Dynamic "dynamic") invoking to evade static analysis

## How does it work?

NixImports uses my managed API-Hashing implementation HInvoke, to dynamically resolve most of it's called functions at runtime. To resolve the functions HInvoke requires two hashes the typeHash and the methodHash. These hashes represent the type name and the methods FullName, on runtime HInvoke parses the entire mscorlib to find the matching type and method. Due to this process, HInvoke does not leave any import references to the methods called trough it.

Another interesting feature of NixImports is that it avoids calling known methods as much as possible, whenever applicable NixImports uses internal methods instead of their wrappers. By using internal methods only we can evade basic hooks and monitoring employed by some security tools.

For a more detailed explanation checkout [my blog post](https://dr4k0nia.github.io/posts/NixImports-a-NET-loader-using-HInvoke/ "my blog post").

You can generate hashes for HInvoke using [this tool](https://gist.github.com/dr4k0nia/813087cee2875f5f82e37c8a731b80b0 "this tool")

## How to use

NixImports only requires a filepath to the .NET [binary](https://www.kitploit.com/search/label/Binary "binary") you want to pack with it.

```
NixImports.exe <filepath>
```

It will automatically generate a new executable called Loader.exe in it's root folder. The loader executable will contain your encoded [payload](https://www.kitploit.com/search/label/Payload "payload") and the stub code required to run it.

## Tips for Defenders

If youre interested in [detection engineering](https://www.kitploit.com/search/label/Detection%20Engineering "detection engineering") and possible detection of NixImports, checkout [the last section of my blog post](https://dr4k0nia.github.io/posts/NixImports-a-NET-loader-using-HInvoke/#tips-for-defenders "the last section of my blog post")

Or [click here](https://github.com/dr4k0nia/yara-rules/blob/main/dotnet/msil_mal_niximports_loader.yar "click here") for a basic yara rule covering NixImports.

NixImports - A .NET Malware Loader, Using API-Hashing To Evade Static Analysis
![NixImports - A .NET Malware Loader, Using API-Hashing To Evade Static Analysis](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi0Zq8zJu8KUW6x6AabU-OR0RAh6f7ncktwNDdnF1BDB_ExxXnb7vYeSvoTmvK92klLZD_BTSKymjXg68SKD5rdJrcKhCo7Ba_RU6dnjYDwHLX0UvH5j7Gp8Ss9dVjvTBKqxnAhc4h3kwIC7j4R6fuc763g0CQvwtRvJdenCBwY_7x3mcfXa5RtVkwVUBLv/s72-w640-c-h312/nix_references.png)
Reviewed by Zion3R
on
8:30 AM
Rating: 5

文章来源: http://www.kitploit.com/2023/08/niximports-net-malware-loader-using-api.html
 如有侵权请联系:admin#unsafe.sh

© [unSafe.sh - 不安全](https://unsafe.sh) Powered By [PaperCache](https://github.com/code-scan/PaperCache)

* admin#unsafe.sh
* [安全马克](https://aq.mk)
* [星际黑客](https://xj.hk)
* [T00ls](https://t00ls.net)