---
title: 浅谈如何让钓鱼攻击无所遁形
url: https://forum.butian.net/share/3704
source: 奇安信攻防社区
date: 2024-09-11
fetch_date: 2025-10-06T18:23:29.425122
---

# 浅谈如何让钓鱼攻击无所遁形

#

[问答](https://forum.butian.net/questions)

*发起*

* [提问](https://forum.butian.net/question/create)
* [文章](https://forum.butian.net/share/create)

[攻防](https://forum.butian.net/community)
[活动](https://forum.butian.net/movable)

Toggle navigation

* [首页 (current)](https://forum.butian.net)
* [问答](https://forum.butian.net/questions)
* [商城](https://forum.butian.net/shop)
* [实战攻防技术](https://forum.butian.net/community)
* [漏洞分析与复现](https://forum.butian.net/articles)
  NEW
* [活动](https://forum.butian.net/movable)
* [摸鱼办](https://forum.butian.net/questions/Play)

搜索

* [登录](https://forum.butian.net/login)
* [注册](https://user.skyeye.qianxin.com/user/register?next=http://forum.butian.net/btlogin)

### 浅谈如何让钓鱼攻击无所遁形

* [安全管理](https://forum.butian.net/topic/54)

一年一度的大型活动还在进行中，想必在这个过程中不管是BT还是甲方安全人员都会遇到各种各样的钓鱼攻击。本文的初衷就是助力各位BT相关人员分析研判各种钓鱼攻击，让钓鱼攻击无所遁形。

一年一度的大型活动还在进行中，想必在这个过程中不管是BT还是甲方安全人员都会遇到各种各样的钓鱼攻击。本文的初衷就是助力各位BT相关人员分析研判各种钓鱼攻击，让钓鱼攻击无所遁形。
本文是站在钓鱼邮件的角度进行分析讨论，但是通过延伸出来的几个点同样适用于其他钓鱼方式比如：电话钓鱼、微信QQ钓鱼等等。
### 发件人信息
#### 修改昵称进行伪装
常用钓鱼手法中，有些攻击者可能会在邮箱中修改昵称伪造发件人邮箱 比如下面这样 将正常昵称修改为 `测试 <admin@test.com>`![图片.png](https://cdn.nlark.com/yuque/0/2024/png/38680471/1722926477228-a87066cb-39bd-46ac-a4fb-bced90e5cf11.png#averageHue=%23e2c88d&clientId=u574e1dd0-0002-4&from=paste&height=655&id=uca9daa11&originHeight=819&originWidth=1370&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=79153&status=done&style=none&taskId=ub0659d56-f193-4df8-a296-3dae90fb0d9&title=&width=1096)下图为收件人看到的效果 如果不注意看后面的信息 可能就会被攻击者伪造的信息迷惑 ![图片.png](https://cdn.nlark.com/yuque/0/2024/png/38680471/1722926556993-3e04b462-8e1c-4a62-9f02-092dbe9a7e66.png#averageHue=%23fbf9f9&clientId=u574e1dd0-0002-4&from=paste&height=242&id=ub4c2a703&originHeight=302&originWidth=592&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=28989&status=done&style=none&taskId=u470946a5-2c45-4793-b07c-3e388dcadb4&title=&width=473.6)
#### 通过邮箱域名进行判断
通过对发件人的邮箱域名进行分析 可以使用whois查询域名注册相关信息 ![图片.png](https://cdn.nlark.com/yuque/0/2024/png/38680471/1722926869711-c62ef229-3623-430a-826a-9899f0f8b534.png#averageHue=%23f5dacd&clientId=u574e1dd0-0002-4&from=paste&height=543&id=u5c2a5c03&originHeight=819&originWidth=1004&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=135054&status=done&style=none&taskId=ucfd40bb0-c234-446b-b47e-7a86c6eb307&title=&width=665.4000244140625) 遇到这种域名注册时间就在最近的需要重点关注 攻击者为了避免被溯源 比较喜欢在国外注册新域名 所以大多数钓鱼邮件的域名注册时间都是在最近一段时间 这里也需要注意的是攻击者也喜欢在注册域名的时候变换一些相近字符、特殊字符迷惑受害者 比如 `baidu.com` 可能会被注册成`baldu.com`等等 可变换字符较多 所以遇到类似情况的时候需要高度注意 看是否是真实域名
#### 邮箱伪造
在第二种情况中说的是注册域名时通过变换相近的字符进行伪装，而这种情况就是通过常用的SPF邮箱伪造进行发送邮件。关于SPF邮箱伪造大家可以查看以前发过的一篇文章[谈谈电子邮件伪造与电子邮件炸弹](https://mp.weixin.qq.com/s/XR51P6bndAzf4yquOdXhFA)，这里就不过多介绍了
本来是想截一张图用来演示，时间原因就就不截图了 GitHub上有相关项目 大家可以自己去试试。 这个手法在七八年前使用频率就很高了，随着安全的发展对这种手法的防范也明显提高了，很多时候通过这种情况进行伪造邮件网关都过不了，这个不是我们本篇文章讨论的重点，能利用的情况也还是有的
遇到这种情况可以检查邮件头：在电子邮件的头信息中，可以找到一个叫做"Received-SPF"的字段。这个字段显示了SPF检查的结果。如果结果是"pass"，那么邮件的发送服务器已经通过了SPF检查。如果结果是"fail"或者"softfail"，那么邮件可能是伪造的。不过即使邮件通过了SPF检查，发件人地址仍然可能是伪造的，还是需要认真核实邮件内容
### 邮件内容
#### 正文内容分析
有大部分钓鱼邮件在正文中都会有注明公司或者联系人电话姓名等等诱导受害者信任，我们也可以通过这些信息进行判断，以下为真实钓鱼邮件内容，原图有水印不方便展示，下面信息由脚本通过msg文件进行提取 ![图片.png](https://cdn.nlark.com/yuque/0/2024/png/38680471/1722932339536-07bd7bd5-6ee7-456c-81db-bd93ddd72cd8.png#averageHue=%23fcfbfb&clientId=u574e1dd0-0002-4&from=paste&height=425&id=ud6cb926b&originHeight=591&originWidth=804&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=34847&status=done&style=none&taskId=uc8f6094f-1a22-457f-94f6-33d9c4db9aa&title=&width=578.2000122070312) 发件人信息通过上面列举的几种方法区分析即可，我们在这里主要看公司名、电话和传真 通过爱企查查询发现公司真实存在且正文中地址与查询到的相符，但是电话和传真并不符合，而且位数也不准确 极有可能是攻击者随意输入，如果是正确的位数 也可以通过微信、支付宝等方式进行查询去判断是否是真实信息 也可以通过邮件内容与相关人员进行确认 最近是否存在相关业务
#### 链接、二维码分析
钓鱼邮件往往会伪造补助、律师函、发票、投标信息、投诉举报等等，在文中可能会附有链接、或者二维码，遇到二维码推荐先通过解码平台对二维码解码 判断链接是否安全再进行访问 <https://jiema.wwei.cn/> ![图片.png](https://cdn.nlark.com/yuque/0/2024/png/38680471/1722933206673-e7a3fa47-b966-4d5c-8188-e02c277fd02f.png#averageHue=%23f2f1ed&clientId=u574e1dd0-0002-4&from=paste&height=212&id=ud8ebb86f&originHeight=396&originWidth=1285&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=23576&status=done&style=none&taskId=u7059542a-bbb4-47a3-840a-72ce1513465&title=&width=686.4000244140625) 解码二维码之后会得到一个链接，访问链接可能会遇到以下四种情况
##### 问卷填写
攻击者通过免费的问卷平台创建问卷 通过某些高温补贴、福利领取等等信息 诱导受害者填写相关信息 ![图片.png](https://cdn.nlark.com/yuque/0/2024/png/38680471/1722933579137-7eaef606-4770-4bd8-9882-547c64214629.png#averageHue=%23f8f4eb&clientId=u574e1dd0-0002-4&from=paste&height=474&id=u4fc01306&originHeight=695&originWidth=875&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=73068&status=done&style=none&taskId=u4d1a10b7-ea50-401a-b7a4-d6f80e03999&title=&width=597) 问卷填写这种手法往往不会让受害者填写敏感信息，只是诱导填写一些基本信息，这种往往最不容易被发现 但是攻击者可通过这些信息去进行进一步的利用 扩大危害 遇到此种邮件应第一时间向相关人员进行核实是否为真实信息
##### 账号密码填写
这种情况就比较常见了，伪造一个登录界面诱导受害者填写账号密码 ![图片.png](https://cdn.nlark.com/yuque/0/2024/png/38680471/1722934082890-d1858149-fbbb-46c9-9788-48ca4c46991a.png#averageHue=%23cad8fc&clientId=u574e1dd0-0002-4&from=paste&height=667&id=uae81ca75&originHeight=834&originWidth=1792&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=143440&status=done&style=none&taskId=ue3738c29-baf3-4314-b170-a3d8f69934c&title=&width=1433.6)在填写账号密码之前一定要确认域名是否正确 是否为官方网站 可以通过官方的ICP管理备案系统进行查询：<https://beian.miit.gov.cn/> ![图片.png](https://cdn.nlark.com/yuque/0/2024/png/38680471/1723514592351-568c1ff7-82b6-4645-b492-5962a18b1609.png#averageHue=%23e1e3da&clientId=ua181a374-94f0-4&from=paste&height=738&id=uaceafaae&originHeight=922&originWidth=1920&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=347807&status=done&style=none&taskId=u6db1362c-c108-4583-8e41-79e5130d03a&title=&width=1536)
##### 诱导文件下载
访问链接直接自动下载文件 ![图片.png](https://cdn.nlark.com/yuque/0/2024/png/38680471/1722934493365-d67417c6-c268-457c-8685-2f8deee2e678.png#averageHue=%23e1d0bb&clientId=u574e1dd0-0002-4&from=paste&height=307&id=ua3f22923&originHeight=384&originWidth=1256&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=31731&status=done&style=none&taskId=u467a1466-06e2-4a36-ba14-a244722abad&title=&width=1004.8) 遇到这种情况直接就是一个好家伙 上面这个案例是真实钓鱼邮件中在正文中附带一个链接，访问链接直接会下载一个发票.exe文件 如果遇到这种情况十有八九是钓鱼，啥好网站打开就直接下载exe文件 可以通过云沙箱进行分析但是操作要小心 防止误触打开文件 ![图片.png](https://cdn.nlark.com/yuque/0/2024/png/38680471/1722934894283-c5ef26a2-8e3c-4ad9-b028-b04672185294.png#averageHue=%23fbf5f4&clientId=u574e1dd0-0002-4&from=paste&height=454&id=ue5dcfa8f&originHeight=786&originWidth=1285&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=85659&status=done&style=none&taskId=u676108b3-ee87-468c-a264-75ce3cda0d6&title=&width=742.4000244140625) 然后可以发现没有善意 全是恶意行为
##### URL跳转
URL跳转也是用的比较多的一个手法，攻击者通过挖掘其他网站的漏洞通过URL跳转漏洞使受害者误以为访问官方网站时跳转到恶意网站
看一个遇到的真实案例，邮件原文截图由于水印太多就不放了，截了链接这一块（大家自行脑补一下原文） ![图片.png](https://cdn.nlark.com/yuque/0/2024/png/38680471/1723519840037-f6d5d6dd-845c-4cb9-bd68-b1e650d7242d.png#averageHue=%23e8e9e7&clientId=ua181a374-94f0-4&from=paste&height=107&id=u747fc952&originHeight=134&originWidth=437&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=22320&status=done&style=none&taskId=u6f1c570b-f0bb-4f4f-af20-f57fab22f5f&title=&width=349.6)
访问这个链接发现是个非常正规的官方网站，但是过了几秒就跳转到了另一个域名
来抓包看一下
![图片.png](https://cdn.nlark.com/yuque/0/2024/png/38680471/1723521858393-66f9efde-bda8-4378-8a7a-fe78d28150d1.png#averageHue=%23f8f7f7&clientId=ua181a374-94f0-4&from=paste&height=615&id=uc766f639&originHeight=769&originWidth=1507&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=363841&status=done&style=none&taskId=u62c8888e-d732-45e0-8bf8-0996e3bb1fa&title=&width=1205.6)攻击者通过某个官方网站的任意文件上传漏洞，上传了一个html文件，但是这个文件进行了js混淆加密大致内容就是判断受害者的浏览器信息进行跳转 ![图片.png](https://cdn.nlark.com/yuque/0/2024/png/38680471/1723520404598-10c770f3-ba32-4447-a586-50bb9b7952a3.png#averageHue=%23d1d2cc&clientId=ua181a374-94f0-4&from=paste&height=672&id=u7b65fbb3&originHeight=840&originWidth=1772&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=229229&status=done&style=none&taskId=u4a09973b-a866-4e60-9aec-...