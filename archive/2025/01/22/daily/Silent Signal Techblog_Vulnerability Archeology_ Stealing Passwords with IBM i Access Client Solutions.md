---
title: Vulnerability Archeology: Stealing Passwords with IBM i Access Client Solutions
url: https://blog.silentsignal.eu/2025/01/21/ibm-acs-password-dump/
source: Silent Signal Techblog
date: 2025-01-22
fetch_date: 2025-10-06T20:13:08.160835
---

# Vulnerability Archeology: Stealing Passwords with IBM i Access Client Solutions

[![Silent Signal](/assets/img/s2_avatar.jpg)](/)

Silent Signal

Professional Ethical Hacking Services

### Contact us

2025 © Silent Signal

![Vulnerability Archeology: Stealing Passwords with IBM i Access Client Solutions](/img/acs_borlopo.jpg)

# Vulnerability Archeology: Stealing Passwords with IBM i Access Client Solutions

[b](/authors/b.html) 2025-01-21

As part of our ongoing [research of the IBM i platform](https://ibmi.silentsignal.eu/) we monitor news and updates related to the platform. Two weeks ago IBM published a [support article](https://www.ibm.com/support/pages/windows-11-24h2-update-causes-issues-connecting-ibm-i) about a compatibility issue affecting IBM i Access Client Solutions (ACS) when running on Windows 11 24H2. The “no man’s land” between system boundaries is always a playground for hackers, and this article was fascinating because it pointed to the Local Security Authority subsystem of Windows:

> IBM ACS Application Package \*WINLOGON support (“Use Windows user name and password, no prompting”) is incompatible with LSA Protection.

LSA is responsible for the secure handling of the credentials that occur on the system, so it’s an obvious target for attacks - the infamous [Mimikatz](https://github.com/gentilkiwi/mimikatz) tool for example made its name by cleverly parsing all kinds of secrets from the memory of the LSASS.exe process, housing credentials. LSA Protection is a set of security features developed by Microsoft to protect credentials even from privileged local attackers.

Could it be that IBM is playing dirty games with LSASS just like Mimikatz?! This was the question that started our little journey into ACS.

## Recon

Before diving into the sea of bytes, it’s usually worth looking around for existing research and relevant documentation that can help our work.

First of all, the support article also states this:

> The Windows 11 24h2 update enables Local Security Authority (LSA) on install: https://support.microsoft.com/en-us/windows/inside-this-update-93c5c27c-f96e-43c2-a08e-5812d92f220d

The only relevant point in the linked [MS article](https://support.microsoft.com/en-us/windows/inside-this-update-93c5c27c-f96e-43c2-a08e-5812d92f220d) seems to be this:

> Local Security Authority (LSA) protection enablement on upgrade: automatic reinforcement of security during system upgrades

It’s unclear and quite strange how some restrictions “during system upgrades” may affect the usability of a 3rd party software overall. We couldn’t find further information about this additional protection for Windows, and based on our further results it seems unlikely that this particular change affects ACS.

When searching for the `*WINLOGON` authentication mode we found a much more useful [article](https://www.ibm.com/support/pages/ibm-i-access-acs-updates-windows) from IBM:

> This update disables the “Client Access Network” network provider, which was used to enable \*WINLOGON authentication support. To re-enable, follow these steps:
>
> 1. Open regedit.exe
> 2. Navigate to HKEY\_LOCAL\_MACHINE\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order
> 3. Edit the ProviderOrder value and add Cwbnetnt to the beginning of the comma separated list of providers
> 4. Restart your system
>    If you encounter problems, contact IBM Support for assistance.

Now that Registry path looks quite promising! Another search brings us to the research of [Grzegorz Tworek](https://github.com/gtworek/PSBits/tree/master/PasswordStealing/NPPSpy) and the [Network Provider DLL attack technique (T1556.008)](https://attack.mitre.org/techniques/T1556/008/)!

In short, Network Provider DLLs can be registered by privileged users on a system via the previous Registry key. On user login registered DLLs get automatically loaded by the freshly spawned `mpnotify.exe` process that passes them **cleartext credentials** via the `NPLogonNotify()` callback exported by the DLL.

So the good news is that ACS probably doesn’t play Mimikatz with our most sensitive Windows processes. The bad news is that ACS probably harvests plaintext Windows credentials, and secure handling of such data is *hard*.

Our high-level theory is now this:

* ACS gets plaintext Windows passwords *when a user logs in* via `mpnotify.exe`. Plaintext credentials are required because of the different cryptographic algorithms used by Windows and IBM i.
* ACS wants to use those credentials to log in to remote IBM i systems. Note that at this point, `mpnotify.exe` and the Network Provider loaded in it are no longer running.
* Consequently, ACS **must** persist the credentials so they are available for remote system connections at later times.

To verify this theory we should check the implementation!

An easy approach is to fire up ProcMon, filter for `mpnotify.exe`, and look for any persistent data storage operations that may save the password. Surely enough, the recorded Registry write to this value looks a bit suspicious:

```
HKLM\SOFTWARE\Wow6432Node\IBM\Client Access\CurrentVersion\Volatile\Communication\Time Stamps\.windows\<USER>\Function Admin Timestamp
```

Now if you are smarter than me, you can search the web for “Function Admin Timestamp”, and find [this article from 2016 by Tenable](https://www.tenable.com/security/research/tra-2016-18) describing that IBM System i Navigator stores Windows passwords with weak obfuscation in a Registry value readable by all local users. If you aren’t that smart, you’ll end up reversing the whole thing yourself, and maybe even write a [deobfuscator](https://github.com/silentsignal/ACS-dump/blob/main/acs_dump_old.py) :)

At this point, we could just write down our work as DUPLICATE and grab a drink, but the timeline still bugged us: there is a CVE for this problem from 2016, yet it was not earlier than 2024 that IBM decided to deprecate the `*WINLOGON` feature, and even in early 2025 they had to document the compatibility problem. This should mean that the feature is still alive and may still provide us with some nice leaks!

## Test Environment

IBM’s product naming is…special and changes over time so let’s summarize the main actors of our little play:

* **System i Navigator** is the product investigated by Tenable.
* **iSeries Navigator** is an older product from the V5 times (IBM i is now at the V7 version). Our test lab has a 2005 version installed. We reversed the original obfuscation with this one, which helped us a lot with the new ACS products.
* Nowadays if you download IBM i *Access Client Solutions* you get a Java-based application ( **IBM i Navigator** ), that doesn’t interact with the logon process.
* There is a separate package named “*ACS* Windows App Pkg” (aka. the **“Application Package”**) that provides integration tools (think ODBC driver) for Windows developers so their software can interact with IBM i.

Following [this guide](https://www.ibm.com/support/pages/how-create-ibm-i-connection-objects-acs-windows-application-package), you can configure “shared login” (that uses Windows credentials on IBM i) with both Navigator and the Application Package installed.

[![Affected configuration](/img/acs_vuln_config.png)](/img/acs_vuln_config.png)

Affected configuration

We couldn’t get the latest version of the Application Package to register a Network Provider DLL - this is probably the result of deprecation and fixes all the problems described. I could confirm the relevance of pre-2024 versions by hunting down a 2019 Application Package (Application Package version 11.26.00, `cwbnetnt.dll` version 13.64.26.0) that still registered itself.

[![Did you know that there is even <a href='https://learn.microsoft.com/en-us/troubleshoot/windows-client/setup-upgrade-and-drivers/network-provider-settings-removed-in-place-upgrade' target='_blank'>GUI</a> to see registered providers?](/img/acs_networkprovider_gui.png)](/img/acs_networkprovider_gui.png)

Did you know that there is even [GUI](https://learn.microsoft.com/en-us/troubleshoot/windows-client/s...