---
title: 【漏洞通告】Craft CMS 远程代码执行漏洞(CVE-2024-56145)
url: https://mp.weixin.qq.com/s?__biz=Mzg2NjgzNjA5NQ==&mid=2247523969&idx=1&sn=b096f169d52f79ead83a7f4899282a8f&chksm=ce461591f9319c87263fd82778e07d456f46f9766a855d4c240764614e96d53e893ccb619460&scene=58&subscene=0#rd
source: 深信服千里目安全技术中心
date: 2024-12-24
fetch_date: 2025-10-06T19:40:59.948869
---

# 【漏洞通告】Craft CMS 远程代码执行漏洞(CVE-2024-56145)

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/w8NHw6tcQ5xhPvIn8icqVFguodL4b8AiaibVAB3WOUQIKichAQffUsEHxmjeBkwXDxUCAHZGS4icdrMnib47WJWHicKKw/0?wx_fmt=jpeg)

# 【漏洞通告】Craft CMS 远程代码执行漏洞(CVE-2024-56145)

深瞳漏洞实验室

深信服千里目安全技术中心

![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5wticwnW9PNOkkqz62HoQfV5x1dZzQIgc48cExGpf6fm3Ggm59ic44Aoald2UGJOB7YcFDeVpwQ8VLg/640?wx_fmt=gif&from=appmsg)

**漏洞名称：**

Craft CMS 远程代码执行漏洞(CVE-2024-56145)

**组件名称：**

Craft CMS

**影响范围：**

5.0.0-RC1 ≤ Craft CMS < 5.5.2
4.0.0-RC1 ≤ Craft CMS < 4.13.2
3.0.0 ≤ Craft CMS < 3.9.14

**漏洞类型：**

代码执行

**利用条件：**

1、用户认证：不需要用户认证

2、前置条件：php.ini 配置文件中启用了"register\_argc\_argv"

3、触发方式：远程

**综合评价：**

<综合评定利用难度>：容易，能造成远程代码执行。

<综合评定威胁等级>：严重，能造成远程代码执行。

**官方解决方案：**

已发布

**漏洞分析**

![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5wticwnW9PNOkkqz62HoQfV5B4R5kicy16sehESLjCbpQiaWPYRuXU4S05w9cWvVoiaWiaQVAO7BHXzCibQ/640?wx_fmt=gif&from=appmsg)

**组件介绍**

Craft CMS 是一个流行的内容管理系统（CMS），它专注于为设计师和开发人员提供灵活的工具，以便他们可以创建精美的网站和数字体验。

![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5wticwnW9PNOkkqz62HoQfV5B4R5kicy16sehESLjCbpQiaWPYRuXU4S05w9cWvVoiaWiaQVAO7BHXzCibQ/640?wx_fmt=gif&from=appmsg)

**漏洞简介**

2024年12月23日，深瞳漏洞实验室监测到一则Craft CMS组件存在代码执行漏洞的信息，漏洞编号：CVE-2024-56145，漏洞威胁等级：严重。

Craft CMS存在远程代码执行漏洞，如果受影响版本的Craft CMS用户的 php.ini 配置文件中启用了"register\_argc\_argv"，**未授权攻击者可以利用该漏洞执行任意代码，导致服务器失陷。**

**影响范围**

目前受影响的Craft CMS版本：

5.0.0-RC1 ≤ Craft CMS < 5.5.2
4.0.0-RC1 ≤ Craft CMS < 4.13.2
3.0.0 ≤ Craft CMS < 3.9.14

**解决方案**

![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5wticwnW9PNOkkqz62HoQfV5B4R5kicy16sehESLjCbpQiaWPYRuXU4S05w9cWvVoiaWiaQVAO7BHXzCibQ/640?wx_fmt=gif&from=appmsg)

**临时修复建议**

在不影响业务的前提下，禁用 php.ini 中的 register\_argc\_argv 配置。

![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5wticwnW9PNOkkqz62HoQfV5B4R5kicy16sehESLjCbpQiaWPYRuXU4S05w9cWvVoiaWiaQVAO7BHXzCibQ/640?wx_fmt=gif&from=appmsg)

**官方修复建议**

安全版本：

Craft Cms 4.13.2

Craft Cms 5.5.2

官方已发布最新版本修复该漏洞，建议受影响用户将Craft Cms更新到安全版本及以上的版本。
下载链接：https://github.com/craftcms/cms/releases/tag/5.5.7
商业版下载链接：https://craftcms.com/pricing

![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5wticwnW9PNOkkqz62HoQfV5B4R5kicy16sehESLjCbpQiaWPYRuXU4S05w9cWvVoiaWiaQVAO7BHXzCibQ/640?wx_fmt=gif&from=appmsg)

**深信服解决方案**

**1.风险资产发现**

支持对Craft CMS的主动检测，可批量检出业务场景中该事件的**受影响资产**情况，相关产品如下：

**【深信服主机安全检测响应平台CWPP】** 已发布资产检测方案，指纹ID:0030795。

**【深信服云镜YJ】**已发布资产检测方案，指纹ID:0030795。

**【深信服漏洞评估工具TSS】**已发布资产检测方案，指纹ID:0030795。

**2.漏洞主动检测**

支持对Craft CMS 远程代码执行漏洞(CVE-2024-56145)的主动检测，可批量快速检出业务场景中是否存在**漏洞风险**，相关产品如下：

**【深信服云镜YJ】**预计2024年12月25日发布检测方案，规则ID:SF-2024-01349。

**【深信服漏洞评估工具TSS】**预计2024年12月30日发布检测方案，规则ID:SF-2024-01350。

**【深信服安全托管服务MSS】**预计2024年12月30日发布检测方案（需要具备TSS组件能力），规则ID:SF-2024-01350。

**【深信服安全检测与响应平台XDR】**预计2024年12月25日发布检测方案（需要具备云镜组件能力），规则ID:SF-2024-01349。

**3.漏洞安全监测**

支持对Craft CMS 远程代码执行漏洞(CVE-2024-56145)的监测，可依据流量收集实时监控业务场景中的**受影响资产情况，快速检查受影响范围**，相关产品及服务如下：

**【深信服安全感知管理平台SIP】**预计2025年01月07日发布监测方案，规则ID:11027859。

**【深信服安全托管服务MSS】**预计2025年01月07日发布监测方案（需要具备SIP组件能力），规则ID:11027859。

**【深信服安全检测与响应平台XDR】**预计2025年01月07日发布监测方案，规则ID:11027859。

**4.漏洞安全防护**

支持对Craft CMS 远程代码执行漏洞(CVE-2024-56145)的防御，**可阻断攻击者针对该事件的入侵行为**，相关产品及服务如下：

**【深信服下一代防火墙AF】**预计2025年01月07日发布防护方案，规则ID:11027859。

**【深信服Web应用防火墙WAF】**预计2025年01月07日发布防护方案，规则ID:11027859。

**【深信服安全托管服务M****SS】**预计2025年01月07日发布防护方案（需要具备AF组件能力），规则ID:11027859。

**【深信服安全检测与响应平台XDR】**预计2025年01月07日发布防护方案（需要具备AF组件能力），规则ID:11027859。

**参考链接**

https://github.com/craftcms/cms/security/advisories/GHSA-2p6p-9rc9-62j9

**时间轴**

**2024/12/23**

深瞳漏洞实验室监测到Craft CMS 远程代码执行漏洞信息。

**2024/12/23**

深瞳漏洞实验室发布漏洞通告。

点击**阅读原文**，及时关注并登录深信服**智安全平台**，可轻松查询漏洞相关解决方案。

![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5xhPvIn8icqVFguodL4b8AiaibhiaKL2d2z4Txp51Ut6PnBGEjbm81lr99icOzmia6bKzmxfGDuicdmWa6Og/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5wticwnW9PNOkkqz62HoQfV5ibpMxIN1Dv0aKCNVgiaaCbhbgic6dBgK607321iadDlWayykUH47ERwR3w/640?wx_fmt=png&from=appmsg)

预览时标签不可点

阅读原文

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5xUEmJGibg2JE8nVwwxzibBrJTEzuyfhPTuTZeyvTviay6rzGOGrHkAO45vyyibnV1FZThckmmfFfM6BA/0?wx_fmt=png)

深信服千里目安全技术中心

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5xUEmJGibg2JE8nVwwxzibBrJTEzuyfhPTuTZeyvTviay6rzGOGrHkAO45vyyibnV1FZThckmmfFfM6BA/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过