---
title: 威胁行为者利用GeoServer漏洞CVE-2024-36401
url: https://forum.butian.net/share/3783
source: 奇安信攻防社区
date: 2024-09-28
fetch_date: 2025-10-06T18:20:00.181048
---

# 威胁行为者利用GeoServer漏洞CVE-2024-36401

#

[问答](https://forum.butian.net/questions)

*发起*

* [提问](https://forum.butian.net/question/create)
* [文章](https://forum.butian.net/share/create)

[攻防](https://forum.butian.net/community)
[活动](https://forum.butian.net/movable)

Toggle navigation

* [首页 (current)](https://forum.butian.net)
* [问答](https://forum.butian.net/questions)
* [商城](https://forum.butian.net/shop)
* [实战攻防技术](https://forum.butian.net/community)
* [漏洞分析与复现](https://forum.butian.net/articles)
  NEW
* [活动](https://forum.butian.net/movable)
* [摸鱼办](https://forum.butian.net/questions/Play)

搜索

* [登录](https://forum.butian.net/login)
* [注册](https://user.skyeye.qianxin.com/user/register?next=http://forum.butian.net/btlogin)

### 威胁行为者利用GeoServer漏洞CVE-2024-36401

* [漏洞分析](https://forum.butian.net/topic/48)

GeoServer是一个用Java编写的开源软件服务器，允许用户共享和编辑地理空间数据。它是开放地理空间联盟（OGC）Web Feature Service（WFS）和Web Coverage Service（WCS）标准的参考实现。

翻译：<https://www.fortinet.com/blog/threat-research/threat-actors-exploit-geoserver-vulnerability-cve-2024-36401>
作者：Cara Lin 和 Vincent Li 日期：2024年9月5日
- \*\*受影响的平台：\*\* GeoServer 2.23.6、2.24.4和2.25.2之前的版本
- \*\*受影响的用户：\*\* 任何组织
- \*\*影响：\*\* 远程攻击者可以控制易受攻击的系统
- \*\*严重性等级：\*\* 严重
GeoServer是一个用Java编写的开源软件服务器，允许用户共享和编辑地理空间数据。它是开放地理空间联盟（OGC）Web Feature Service（WFS）和Web Coverage Service（WCS）标准的参考实现。7月1日，项目维护者发布了关于漏洞CVE-2024-36401（CVSS得分：9.8）的报告，该漏洞允许未经身份验证的用户通过特别制作的输入在默认GeoServer安装上执行远程代码（RCE），原因是不安全地评估属性名作为XPath表达式。这个缺陷已经在2.23.6、2.24.4和2.25.2版本中得到解决。
7月15日，美国网络安全和基础设施安全局（CISA）基于此漏洞被广泛利用的证据，将其添加到已知被利用漏洞（KEV）目录中，影响OSGeo GeoServer GeoTools。FortiGuard Labs第二天添加了IPS签名，并观察到多个活动针对此漏洞传播恶意软件。僵尸网络家族和挖矿组织立即发动攻击。我们还收集了sidewalk后门，GOREVERSE尝试利用这个漏洞并设置与命令和控制服务器（C2）的连接，以执行恶意操作。
\*\*概述\*\*
======
在本文中，我们将探讨有效载荷和恶意软件的细节。
\*\*GOREVERSE\*\*
![图1：攻击数据包](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-fe4c31d576c5f0edff23ffb3c25b61df25ac9b85.png)
图1：攻击数据包
有效载荷从“hxxp://181\[.\]214\[.\]58\[.\]14:61231/remote.sh”检索脚本。脚本文件首先验证受害者的操作系统和架构，以下载适当的文件，它将该文件保存为“download\\_file”。它适应包括Linux、FreeBSD、Illumos、NetBSD、OpenBSD和Solaris在内的各种操作系统类型。执行后，它删除文件以消除其活动痕迹。
![图2：脚本文件“remote.sh”](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-cb09559080e98c080e859d33f928980418c50066.png)
图2：脚本文件“remote.sh”
最终的可执行文件是“GOREVERSE”，它使用UPX打包。GOREVERSE是一个恶意工具，通常充当反向代理服务器，允许攻击者非法访问目标系统或数据。
![图3：GOREVERSE](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-ae47a105d93ea58e8b4866ccbc0b7f224cc9e342.png)
图3：GOREVERSE
执行后，它连接到特定的IP地址（181\[.\]214\[.\]58\[.\]14）和端口（18201），这不是标准的SSH端口。
![图4：GOREVERSE的日志](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-bb5b4eb5d96380c90e6f3b2f710598cef0f7c9e2.png)
图4：GOREVERSE的日志
从CVE-2024-36401的利用数据包中，我们观察到威胁行为者试图访问印度的IT服务提供商、美国的科技公司、比利时的政府实体以及泰国和巴西的电信公司。
\*\*SideWalk\*\*
------------
![图5：攻击数据包](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-fe58b3d03ff984b698726b74cb4a32175aa0770f.png)
图5：攻击数据包
攻击者从“hxxp://1\[.\]download765\[.\]online/d”检索脚本。这个批处理文件有助于下载执行文件。远程服务器上的所有ELF文件，被称为“SideWalk”恶意软件，旨在在ARM、MIPS和X86架构上运行。SideWalk是一个复杂的Linux后门恶意软件，也常与APT41黑客组织有关。
![图6：脚本文件“d”](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-ede63b152c435f4f13dc04782b95a34cef8decfa.png)
图6：脚本文件“d”
首先，SideWalk在TMP目录中创建一个用随机生成的字符串命名的文件夹。然后，它使用XOR密钥0xCC解码两个库文件libc.so.0和ld-uClibc.so.1，以及下一阶段的有效载荷，并将这些解码后的文件存储在之前创建的TMP路径中的文件夹里。
![图7：创建文件夹和文件](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-f75cb34a69b918dc93ba3f281cecfa04a4208c29.png)
图7：创建文件夹和文件
![图8：使用0xCC进行XOR解码](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-3ebd9184be6b3284e52008b2ced4a5c2c459df97.png)
图8：使用0xCC进行XOR解码
![图9：保存解码后的文件](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-fb4351ff1feb513d2c69732314a544ac83ae9ea6.png)
图9：保存解码后的文件
然后，它还使用XOR使用密钥0x89解码字符串数据。
![图10：使用0x89进行XOR解码](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-efb0bf156801874e74b49f2793c5a55600b6f0c6.png)
图10：使用0x89进行XOR解码
然后，它执行下一阶段的有效载荷，“ych7s5vvbb669ab8a”。它有三个主要功能：
1. 解密配置：配置使用ChaCha20算法进行解密。二进制输入包含一个16字节的MD5哈希，一个12字节的ChaCha20解密的nonce，以及一个4字节的部分，指示密文的长度，后面是实际的密文。根据汇编代码，解密密钥硬编码为“W9gNRmdFjxwKQosBYhkYbukO2ejZev4m”，并且解密过程运行15轮（0xF）。成功解密后，提取的C2是secure\[.\]systemupdatecdn\[.\]de（47\[.\]253\[.\]46\[.\]11），在端口80上监听，互斥体名称为“hfdmzbtu”。
![图11：使用ChaCha20解密配置](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-4fd77c8a3e121ff678494711e61c157ab24b7a8e.png)
图11：使用ChaCha20解密配置
![图12：加密的二进制文件](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-9b89a68fc9a777788101fa53e0d522daf73ed007.png)
图12：加密的二进制文件
![图13：解密后的配置](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-7bf95a236b386578a39e4c46b98cfca43722910c.png)
图13：解密后的配置
2. 建立C2通信：使用基于ChaCha20算法的加密会话与C2服务器建立通信。数据包结构包括一个4字节的部分，表示数据包长度，一个12字节的ChaCha20解密的nonce，20字节的消息元数据，以及最后的密文。初始交换包括用于后续消息加密的密钥（v-key和s-key）。在早期数据包中，原始密钥“W9gNRmdFjxwKQosBYhkYbukO2ejZev4m”解密消息元数据，而交换的密钥（v-key和s-key）解密密文。在数据包5中，传输了受害者的信息（计算机名称、操作系统和系统时间）。
![图14：C2连接的数据包捕获](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-4bd74123f6de5640c3aa1d9f14cfcee9634e61ec.png)
图14：C2连接的数据包捕获
![图15：C2通信](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-80dbb16a7a736210e60abf6a7360084625c18525.png)
图15：C2通信
3. 执行C2发出的命令：在这次攻击场景中，我们发现了一个名为Fast Reverse Proxy（FRP）的插件。Fast Reverse Proxy（FRP）是一个合法且广泛使用的工具，它通过将恶意网络流量与正常流量混合，使恶意网络流量的检测变得复杂，从而增强了网络攻击的隐蔽性。由于它是开源的，这个工具过去曾被多个威胁行为者利用，如Magic Hound、Fox Kitten和Volt Typhoon。使用FRP，攻击者在内部被破坏的机器和他们控制的外部服务器之间创建了一个加密隧道。这种方法使他们能够在被破坏的环境中保持立足点，窃取敏感数据，部署更多的恶意有效载荷或执行其他操作。在这个攻击案例中，SideWalk还下载了一个定制的配置文件，将连接指向远程服务器（47\[.\]253\[.\]83\[.\]86）通过端口443，进一步增强了攻击者的控制和持久性。
![图16：FRP的配置](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-677f62f421845c4bb443b7f70b5eb8aec796cb24.png)
图16：FRP的配置
![图17：FRP的数据包捕获](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-0b14403120340f4c3829345074252d2686854901.png)
图17：FRP的数据包捕获
分析脚本下载URL的遥测显示了一个集中的感染模式。主要目标似乎分布在三个主要地区：南美、欧洲和亚洲。这种地理分布表明了一个复杂且影响深远的攻击活动，可能利用了这些不同市场常见的漏洞或针对这些地区盛行的特定行业。
![图18：遥测](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-ff43dae10e8b5eba9a90b3986141dfe0bb96944d.png)
图18：遥测
\*\*Mirai变种 - JenX\*\*
------------------
![图19：攻击数据包](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-7cd550715a7ca4ea8135ab42e058b469c82beab2.png)
图19：攻击数据包
这个脚本从指定的URL“hxxp://188\[.\]214\[.\]27\[.\]50:4782”下载并执行名为“sky”的文件。它更改其权限以使其可执行，然后用参数“geo”运行它，然后删除该文件。
![图20：使用0x3A进行XOR解码的功能](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-75b8c98c33199553321799d1fa067c249f9b4203.png)
图20：使用0x3A进行XOR解码的功能
通过使用0x3A对文件内容进行XOR，提取了配置数据。这使我们能够找到像“bots\[.\]gxz\[.\]me”这样的信息，这是恶意软件尝试连接的C2服务器。
![图21：解码后的配置数据](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-599a22919aaf3f17ea827b4197a73b605b4c2fe7.png)
图21：解码后的配置数据
执行恶意软件时，会出现一个字符串。
![图22：执行消息](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-5a6762bfbb8804f94eb26db6e95d88566e728d99.png)
图22：执行消息
这个恶意软件有一个用于暴力攻击的凭据列表，以及与华为路由器漏洞CVE-2017-17215相关的硬编码有效载荷。该有效载荷尝试从59\[.\]59\[.\]59\[.\]59下载恶意软件。
![图23：硬编码的有效载荷](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-fb45c475f52f991cb3a2357b958cd2e8d2876dc7.png)
图23：硬编码的有效载荷
\*\*Condi\*\*
---------
攻击者首先终止了几个进程（mpsl、mipsel、bash.mpsl、mips、x86\\_64、x86），然后从远程服务器“hxxp://209\[.\]146\[.\]124\[.\]181:8030”下载并执行多个不同CPU架构（如ARM、MIPS、PPC、X86、M68K、SH4和MPSL）的机器人二进制文件。使用wget获取二进制文件，将其保存在/tmp目录中，使其可执行（chmod 777），并执行。
![图24：攻击数据包](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-13d39d97bf026d4579bec0fd4cacd7db7c54a87e.png)
图24：攻击数据包
以下部分以“bot.arm7”为例。通过指定的字符串“condi”可以识别恶意软件。
![图25：重要字符串](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-6f7c6454ffc053943b3b431b2a29ecba789e58a1.png)
图25：重要字符串
执行恶意软件后，会向“trcpay\[.\]xyz”发送许多DNS查询。
![图26：持续连接到C2服务器](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2024/09/attach-0111c653cc8b8b6eb43f05176bc4ed9b8a8754e9.png)
图26：持续连接到C2服务器
Condi僵尸网络首先尝试解析C2服务器地址及其功能。然后，它与C2服务器建立连接并等待解析命令。恶意软件具有多种DDoS攻击方法，如TCP洪水、UDP洪水和VSE DDoS攻击。
在追踪回远程服务器“hxxp://209\[.\]146\[.\]124\[.\]181:8030”时，我们发现它被构建为HFS（HTTP文件服务器），并且两个恶意工具——“Linux2.4”（另一个僵尸网络...