---
title: 楕円曲線上の複数の点からその曲線のパラメータを思考停止で求めるテク
url: https://furutsuki.hatenablog.com/entry/2023/01/18/144400
source: ふるつき
date: 2023-01-19
fetch_date: 2025-10-04T04:16:12.356617
---

# 楕円曲線上の複数の点からその曲線のパラメータを思考停止で求めるテク

[![ふるつき](https://cdn.image.st-hatena.com/image/square/22d94d91fe8214e59637e6fa6173edbe2edc56c6/backend=imagemagick;height=128;version=1;width=128/https%3A%2F%2Fcdn.user.blog.st-hatena.com%2Fblog_custom_icon%2F96439929%2F1745809789466802)](https://furutsuki.hatenablog.com/)

[ふるつき](https://furutsuki.hatenablog.com/)

[読者になる](https://blog.hatena.ne.jp/Furutsuki/furutsuki.hatenablog.com/subscribe?utm_campaign=subscribe_blog&utm_source=blogs_topright_button&utm_medium=button)

# [ふるつき](https://furutsuki.hatenablog.com/)

## v(\*'='\*)v 記事がよかったらスターつけていってください

[2023-01-18](https://furutsuki.hatenablog.com/archive/2023/01/18)

# [楕円曲線上の複数の点からその曲線のパラメータを思考停止で求めるテク](https://furutsuki.hatenablog.com/entry/2023/01/18/144400)

最近このテクを使う問題をいくつか解いたのでメモ。[楕円曲線](http://d.hatena.ne.jp/keyword/%EF%BF%BD%CA%B1%DF%B6%EF%BF%BD%EF%BF%BD%EF%BF%BD)![ E](https://chart.apis.google.com/chart?cht=tx&chl=%20E)と![ E](https://chart.apis.google.com/chart?cht=tx&chl=%20E)上のいくつかの点![ P, Q, R, S \in E](https://chart.apis.google.com/chart?cht=tx&chl=%20P%2C%20Q%2C%20R%2C%20S%20%5Cin%20E)みたいなのがあって、![ E](https://chart.apis.google.com/chart?cht=tx&chl=%20E)は与えられておらず![ P, Q, R, S](https://chart.apis.google.com/chart?cht=tx&chl=%20P%2C%20Q%2C%20R%2C%20S)の座標だけがある、みたいな状況。

（今回なら）4点の座標と、その座標が満たすべき制約（Weierstrass標準形なら![ y^2 \equiv x^3 + ax + b \mod p](https://chart.apis.google.com/chart?cht=tx&chl=%20y%5E2%20%5Cequiv%20x%5E3%20%2B%20ax%20%2B%20b%20%5Cmod%20p)）から、![ E](https://chart.apis.google.com/chart?cht=tx&chl=%20E)のパラメータ（![ a, b, p](https://chart.apis.google.com/chart?cht=tx&chl=%20a%2C%20b%2C%20p)）を求めたい。知っている限りだとASIS CTF 2019 Qualsの[Halloween Party](http://d.hatena.ne.jp/keyword/Halloween%20Party)とか、UIUCTF 2020のnook cryptoが出題例。

[scrapbox.io](https://scrapbox.io/crypto-writeup-public/ASIS_CTF_Quals_2019_%7C_Halloween_Party)

[scrapbox.io](https://scrapbox.io/crypto-writeup-public/UIUCTF_2020_%7C_nook_crypt)

上記writeupにもあるようにこれは愚直な式変形でできる。![ a](https://chart.apis.google.com/chart?cht=tx&chl=%20a)や![ b](https://chart.apis.google.com/chart?cht=tx&chl=%20b)のような知らないパラメータがなくなるように式変形して、複数の式でGCDを取ると剰余の法![ p](https://chart.apis.google.com/chart?cht=tx&chl=%20p)（か、その小さい倍数）が得られるので、あとは![ a](https://chart.apis.google.com/chart?cht=tx&chl=%20a)だけが不明とか![ b](https://chart.apis.google.com/chart?cht=tx&chl=%20b)だけが不明みたいな式を作って剰余方程式を解いていく、という方針。

そんなに難しいということはないんだが、式変形というのは結構大変なので自分でやらなくていいならやりたくない。幸い変数をどんどん消去するように式変形する、という処理は自動化できる。

どうやるかというと消去式（resultant）というやつを使う[\*1](#f-175116c2 "Sagemathではresultantというそのままの名前のメソッドが存在するのでこれを使ったら良いが、巷のCTFプレイヤーのコードを読んでいるとSylvester行列を経由して変数を消去するコードもよく見かける。どういう違いがあるかはわかっていないので、知っている人がいたら教えてください。")。細かい内部の挙動は置いておいて、これは2式と消したい変数を与えると、その消したい変数を消去した形の式を返すようなインタフェースを持つ関数だと思って良い。

![ f_1 = y_1^2 - (x_1^3 + ax_1 + b)](https://chart.apis.google.com/chart?cht=tx&chl=%20f_1%20%3D%20y_1%5E2%20-%20%28x_1%5E3%20%2B%20ax_1%20%2B%20b%29)

![ f_2 = y_2^2 - (x_2^3 + ax_2 + b)](https://chart.apis.google.com/chart?cht=tx&chl=%20f_2%20%3D%20y_2%5E2%20-%20%28x_2%5E3%20%2B%20ax_2%20%2B%20b%29)

みたいに2つ式を立てておいて、`g = f1.resultant(f2, b)`とすると![ g =  (y_1^2 - y_2^2) - (x_1^3 - x_2^3+ a(x_1 - x_2))](https://chart.apis.google.com/chart?cht=tx&chl=%20g%20%3D%20%20%28y_1%5E2%20-%20y_2%5E2%29%20-%20%28x_1%5E3%20-%20x_2%5E3%2B%20a%28x_1%20-%20x_2%29%29)みたいな式を返してくれる。このくらいなら人間がやってもわけないが、![ b](https://chart.apis.google.com/chart?cht=tx&chl=%20b)でなく![ a](https://chart.apis.google.com/chart?cht=tx&chl=%20a)を消したいという場合にも勝手にやってくれるので便利。

ただしこの方法も万能ではないので、resultantが使えないような式と変数の組み合わせや、そもそもresultantを呼び出せないような環が存在する。それぞれ消したいと指定した変数が消えてない式が帰ってきたりする場合や、除算が定義されていない集合上の[多項式](http://d.hatena.ne.jp/keyword/%C2%BF%EF%BF%BD%E0%BC%B0)を定義している場合。

ということで、最近ではとりあえずあらゆる値を変数にして![ \mathbb{Q}](https://chart.apis.google.com/chart?cht=tx&chl=%20%5Cmathbb%7BQ%7D)上の多変数[多項式環](http://d.hatena.ne.jp/keyword/%C2%BF%EF%BF%BD%E0%BC%B0%EF%BF%BD%EF%BF%BD)![ \mathbb{Q}\lbrack x_1, x_2, \dots \rbrack](https://chart.apis.google.com/chart?cht=tx&chl=%20%5Cmathbb%7BQ%7D%5Clbrack%20x_1%2C%20x_2%2C%20%5Cdots%20%5Crbrack)上で立式して、あらゆる式の組み合わせでとにかう消去式を試して変数を片っ端から消していきうまく消えているやつを使う、という方法をとっている。

例えば ASIS CTF Finals 2022で出題されたmonwardという問題や、idekCTF 2022で出題されたECRSAという問題でこのテクを使った。monwardはWeierstrass標準形ではなくてEdwards曲線でパラメータを求める問題だったが、同じテクが使えた。

[scrapbox.io](https://scrapbox.io/crypto-writeup-public/ASIS_CTF_Finals_2022_%7C_monward)

（idekCTF 2022のwriteupはまだ書いてないので、書いたら載せます）

[グレブナー基底](http://d.hatena.ne.jp/keyword/%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%D6%A5%CA%A1%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD)で全てを一発でやるとか、そうでなくても処理を一般化＆関数化するとか、もうちょっと洗練されたやり方がありそうだが、今のところはこれで満足しているし他に良い方法も知らない。

何かのタイミングでこのテクがお役に立てば幸いです && もっと良いテクを知っていたら教えてください。

[\*1](#fn-175116c2):Sagemathではresultantというそのままの名前のメソッドが存在するのでこれを使ったら良いが、巷のCTFプレイヤーのコードを読んでいるとSylvester行列を経由して変数を消去するコードもよく見かける。どういう違いがあるかはわかっていないので、知っている人がいたら教えてください。

Furutsuki
[2023-01-18 14:44](https://furutsuki.hatenablog.com/entry/2023/01/18/144400)

[読者になる](https://blog.hatena.ne.jp/Furutsuki/furutsuki.hatenablog.com/subscribe?utm_campaign=subscribe_blog&utm_medium=button&utm_source=blogs_entry_footer)

[![この記事をはてなブックマークに追加](https://b.st-hatena.com/images/entry-button/button-only.gif)](https://b.hatena.ne.jp/entry/s/furutsuki.hatenablog.com/entry/2023/01/18/144400 "この記事をはてなブックマークに追加")

関連記事

* [![AlpacaHack Round 3 (Crypto) writeup](https://cdn.image.st-hatena.com/image/square/6dd0742dd7e0e99b0ae271c9466436ab103498c0/backend=imagemagick;height=100;version=1;width=100/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2FF%2FFurutsuki%2F20240915%2F20240915182654.png "AlpacaHack Round 3 (Crypto) writeup")](https://furutsuki.hatenablog.com/entry/2024/09/15/201136)

  [2024-09-15](https://furutsuki.hatenablog.com/archive/2024/09/15)

  [AlpacaHack Round 3 (Crypto) writeup](https://furutsuki.hatenablog.com/entry/2024/09/15/201136)

  最近登場した個人戦CTFプラットフォームであるAlpacaHackで、Cr…
* [![CakeCTF 2023 作問感想](https://cdn.image.st-hatena.com/image/square/57b921967799a0175cea068c449b1d1e0dd09b71/backend=imagemagick;height=100;version=1;width=100/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2FF%2FFurutsuki%2F20231116%2F20231116015150.png "CakeCTF 2023 作問感想")](https://furutsuki.hatenablog.com/entry/2023/11/16/015259)

  [2023-11-16](https://furutsuki.hatenablog.com/archive/2023/11/16)

  [CakeCTF 2023 作問感想](https://furutsuki.hatenablog.com/entry/2023/11/16/015259)

  この記事はCTF AdventCalendarの-15日目の記事です こんにちは…
* [![TSGCTF 2023参加記](https://cdn.image.st-hatena.com/image/square/16c86559a3a78e67f44258cd91e37a824dd44616/backend=imagemagick;height=100;version=1;width=100/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2FF%2FFurutsuki%2F20231112%2F20231112115543.png "TSGCTF 2023参加記")](https://furutsuki.hatenablog.com/entry/2023/11/12/121722)

  [2023-11-12](https://furutsuki.hatenablog.com/archive/2023/11/12)

  [TSGCTF 2023参加記](https://furutsuki.hatenablog.com/entry/2023/11/12/121722)

  TSGCTF 2023にzer0ptsとして参加していました。これという問題…
* [![Ricerca CTF 2023 writeup / upsolve](https://cdn.image.st-hatena.com/image/square/298058b2bffe422918ac5e915861b0c0839ae26b/backend=imagemagick;height=100;version=1;width=100/https%3A%2F%2Fcdn.blog.st-hatena.com%2Fimages%2Ftheme%2Fog-image-1500.png "Ricerca CTF 2023 writeup / upsolve")](https://furutsuki.hatenablog.com/entry/2023/04/23/143704)

  [2023-04-23](https://furutsuki.hatenablog.com/archive/2023/04/23)

  [Ricerca CTF 2023 writeup / upsolve](https://furutsuki.hatenablog.com/entry/2023/04/23/143704)

  CTF日本最強企業であるところのリチェルカセキュリティが開催し…
* [![zer0pts秘伝のcrypto-writeupを公開します](https://cdn.image.st-hatena.com/image/square/298058b2bffe422918ac5e915861b0c0839ae26b/backend=imagemagick;height=100;version=1;width=100/https%3A%2F%2Fcdn.blog.st-hatena.com%2Fimages%2Ftheme%2Fog-image-1500.png "zer0pts秘伝のcrypto-writeupを公開します")](https://furutsuki.hatenablog.com/entry/2022/12/04/105458)

  [2022-12-04](https://furutsuki.hatenablog.com/archive/2022/12/04)

  [zer0pts秘伝のcrypto-writeupを公開します](https://furutsuki.hatenablog.com/entry/2022/12/04/105458)

  タイトルは盛りました。zer0ptsのFurutsukiです。 2019年ごろか…

* もっと読む

コメントを書く

[«
記...