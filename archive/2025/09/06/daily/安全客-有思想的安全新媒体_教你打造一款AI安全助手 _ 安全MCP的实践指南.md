---
title: 教你打造一款AI安全助手 | 安全MCP的实践指南
url: https://www.anquanke.com/post/id/311884
source: 安全客-有思想的安全新媒体
date: 2025-09-06
fetch_date: 2025-10-02T19:43:05.206888
---

# 教你打造一款AI安全助手 | 安全MCP的实践指南

ждќжАх

жўЁУ»╗

* [т«ЅтЁеУхёУ«»](https://www.anquanke.com/news)
* [т«ЅтЁеуЪЦУ»є](https://www.anquanke.com/knowledge)
* [т«ЅтЁетиЦтЁи](https://www.anquanke.com/tool)

Т┤╗тіе

уцЙтї║

тГджЎб

т«ЅтЁет»╝Уѕф

тєЁт«╣у▓ЙжђЅ

* [СИЊТаЈ](/column/index.html)
* [у▓ЙжђЅСИЊжбў](https://www.anquanke.com/subject-list)
* [т«ЅтЁеKERтГБтѕі](https://www.anquanke.com/discovery)
* [360уйЉу╗ют«ЅтЁетЉеТіЦ](https://www.anquanke.com/week-list)

# ТЋЎСйаТЅЊжђаСИђТгЙAIт«ЅтЁетіЕТЅІ | т«ЅтЁеMCPуџёт«ъУихТїЄтЇЌ

жўЁУ»╗жЄЈ**146221**

тЈЉтИЃТЌХжЌ┤ : 2025-09-05 10:40:51

**x**

##### У»ЉТќЄтБ░Тўј

ТюгТќЄТў»у┐╗У»ЉТќЄуФа

У»ЉТќЄС╗ЁСЙЏтЈѓУђЃ№╝їтЁиСйЊтєЁт«╣УАеУЙЙС╗ЦтЈітљФС╣ЅтјЪТќЄСИ║тЄєсђѓ

# т╝ЋУеђ№╝џТ»ЈСИфт«ЅтЁеС║║жЃйжЂЄтѕ░У┐ЄуџёуЌЏуѓ╣

тЄїТЎе2уѓ╣№╝їСйаУ┐ўтюетѕєТъљСИђСИфтцЇТЮѓуџётЉіУГдсђѓ

PowerShellу╝ќуаЂуџётЉйС╗цуюІСИЇТЄѓ№╝їУ┐ЏуеІжЊЙУи»уљєСИЇТИЁ№╝їтѕ░т║ЋТў»У»»ТіЦУ┐ўТў»уюЪт«ъТћ╗тЄ╗№╝ЪУђЂТЮ┐ТўјТЌЕУдЂТіЦтЉі№╝їСйєСйаУ┐ъУ┐ЎСИфтЉіУГдТў»тЋЦжЃйУ┐ўТ▓АТљъТўјуЎйРђд

тѕФТЁї№╝їУ┐ЎС║ЏуЌЏуѓ╣№╝їуЂФт▒▒т«ЅтЁеТЎ║УЃйСйЊ MCP жЃйУЃйтИ«СйаУДБтє│сђѓ№╝ѕТќЄуФаТюђтљјТЅФуаЂтіатЁЦт«ЅтЁеMCPт╝ђтЈЉУђЁуцЙуЙц№╝Ѕ

## тю║ТЎ»СИђ№╝џтцЇТЮѓтЉіУГдуюІСИЇТЄѓ№╝ЪAIТЅІТііТЅІТЋЎСйатѕєТъљ

### уЌЏуѓ╣ТЌХтѕ╗

СйаТћХтѕ░СИђТЮАтЉіУГд№╝џ

```
Alert: Suspicious PowerShell execution detected
Process: powershell.exe -encodedCommand [СИђжЋ┐СИ▓base64]
Parent: svchost.exe
```

С╝ау╗ЪтЂџТ│Ћ№╝џ

1. 1сђЂТЅІтіеУДБуаЂbase64№╝ѕ5тѕєжњЪ№╝Ѕ
2. 2сђЂтѕєТъљPowerShellУёџТюг№╝ѕ10тѕєжњЪ№╝Ѕ
3. 3сђЂТЪЦТЅЙуѕХУ┐ЏуеІТў»тљдТГБтИИ№╝ѕ10тѕєжњЪ№╝Ѕ
4. 4сђЂтЁ│УЂћтЁХС╗ќтЉіУГд№╝ѕ30тѕєжњЪ№╝Ѕ
5. 5сђЂтЙЌтЄ║у╗ЊУ«║№╝ѕтдѓТъюСйау╗ЈжфїтцЪуџёУ»Ю№╝Ѕ

### AIтіЕТЅІТЮЦтИ«т┐Ў

Сй┐уће alert\_investigator№╝ї3ТГЦТљът«џ№╝џ

уггСИђТГЦ№╝џСИбу╗ЎAI

```
analysis = mcp.alert_investigator.analyze(alert_data)
```

уггС║їТГЦ№╝џAIУ»ду╗єУДБУ»╗

* **┬и** УЄфтіеУДБуаЂ№╝џТЈГуц║у╝ќуаЂтЉйС╗цуџёуюЪт«ъТёЈтЏЙ
* **┬и** У┐ЏуеІтѕєТъљ№╝џтѕцТќГsvchost.exeТў»тљдСИ║ТГБтИИуѕХУ┐ЏуеІ
* **┬и** Тћ╗тЄ╗жЊЙт«џСйЇ№╝џТўјуА«тЉіУ»ЅСйаУ┐ЎТў»Kill ChainуџётЊфСИфжўХТ«х
* **┬и** IOCТЈљтЈќ№╝џУЄфтіеТЈљтЈќIPсђЂтЪЪтљЇсђЂТќЄС╗ХтЊѕтИїуГЅтЁ│жћ«С┐АТЂ»

уггСИЅТГЦ№╝џУјитЙЌСИЊСИџт╗║У««

```
СИЦжЄЇу║ДтѕФ№╝џжФўтЇ▒
уй«С┐Ат║д№╝џ92%
Тћ╗тЄ╗у▒╗тъІ№╝џуќЉС╝╝Cobalt Strike beacon
т╗║У««ТјфТќй№╝џ
1. уФІтЇ│жџћуд╗У»ЦСИ╗Тю║
2. ТБђТЪЦС╗ЦСИІтЁ│УЂћСИ╗Тю║№╝џ[тѕЌУАе]
3. жЃеуй▓С╗ЦСИІТБђТхІУДётѕЎ№╝џ[УДётѕЎтєЁт«╣]
```

**ТЋѕТъю№╝џС╗ј1т░ЈТЌХу╝ЕуЪГтѕ░1тѕєжњЪ№╝їУђїСИћтѕєТъљТЏ┤тЁежЮб№╝Ђ**

## тю║ТЎ»С║ї№╝џТИЌжђЈТхІУ»ЋТіЦтЉітєЎтѕ░тц┤уДЃ№╝ЪAIтИ«Сйат«їуЙјтЉѕуј░

### уЌЏуѓ╣ТЌХтѕ╗

ТИЌжђЈТхІУ»ЋтЂџт«їС║є№╝їСйєТіЦтЉіТђјС╣ѕтєЎ№╝Ъ

* **┬и** Т╝ЈТ┤ъТЈЈУ┐░СИЇтцЪСИЊСИџ№╝Ъ
* **┬и** С┐«тцЇт╗║У««тцфтЇЋУќё№╝Ъ
* **┬и** Та╝т╝ЈСИЇтцЪУДёУїЃ№╝Ъ
* **┬и** УІ▒ТќЄТіЦтЉіУ»ЇТ▒ЄжЄЈСИЇтцЪ№╝Ъ

### AIтіЕТЅІТЮЦтИ«т┐Ў

Сй┐уће threat\_intel\_producer№╝їУй╗ТЮЙућЪТѕљСИЊСИџТіЦтЉі№╝џ
УЙЊтЁЦСйауџётЈЉуј░№╝џ

```
тЈЉуј░SQLТ│етЁЦТ╝ЈТ┤ъ
URL: https://example.com/api/user?id=1
Payload: 1' OR '1'='1
```

AIУЄфтіеућЪТѕљ№╝џ

```
## Т╝ЈТ┤ъУ»дТЃЁ

### Т╝ЈТ┤ътљЇуД░
SQLТ│етЁЦТ╝ЈТ┤ъ (CWE-89)

### СИЦжЄЇуеІт║д
жФўтЇ▒ (CVSS 3.1: 8.6)

### Т╝ЈТ┤ъТЈЈУ┐░
тюеућеТѕиAPIТјЦтЈБтцётЈЉуј░SQLТ│етЁЦТ╝Ј
Т┤ъ№╝їТћ╗тЄ╗УђЁтЈ»жђџУ┐ЄТъёжђаТЂХТёЈSQLУ»ГтЈЦУјитЈќТЋ░ТЇ«т║ЊТЋЈТёЪС┐АТЂ»сђѓ

### ТіђТю»у╗єУіѓ
- Т│етЁЦуѓ╣№╝џidтЈѓТЋ░
- ТЋ░ТЇ«т║Њу▒╗тъІ№╝џMySQL 5.7
- тй▒тЊЇУїЃтЏ┤№╝џтЈ»УјитЈќтЁеУАеТЋ░ТЇ«

### С┐«тцЇт╗║У««
1. Сй┐ућетЈѓТЋ░тїќТЪЦУ»б
2. УЙЊтЁЦжфїУ»ЂСИјУ┐ЄТ╗ц
3. Тюђт░ЈТЮЃжЎљтјЪтѕЎ
4. жЃеуй▓WAFУДётѕЎ

### уц║СЙІС╗БуаЂ
```python
# С┐«тцЇтЅЇ
query = f"SELECT * FROM users WHERE id = {user_id}"

# С┐«тцЇтљј
query = "SELECT * FROM users WHERE id = ?"
cursor.execute(query, (user_id,))
```

```

**СИђжћ«ућЪТѕљ№╝їСИЊСИџт║дуъгжЌ┤ТЈљтЇЄ№╝Ђ**

## тю║ТЎ»СИЅ№╝џтљѕУДёТБђТЪЦУ«ЕСйаТіЊуІѓ№╝ЪAIтИ«СйаУй╗ТЮЙУ┐Єт«А

### уЌЏуѓ╣ТЌХтѕ╗

уГЅС┐ЮТхІУ»ёУдЂТЮЦС║є№╝їСйажюђУдЂ№╝џ
- ТЅЙтЄ║ТЅђТюЅтГўтѓеСИфС║║С┐АТЂ»уџётю░Тќ╣
- ТБђТЪЦТў»тљдугдтљѕGDPRУдЂТ▒ѓ
- ућЪТѕљтљѕУДёТіЦтЉі

ТЅІтіетЂџ№╝ЪжѓБТў»УдЂтЉйуџёУіѓтЦЈ...

### AIтіЕТЅІТЮЦтИ«т┐Ў

**Сй┐уће sensitive_data_detector№╝їУЄфтіетїќтљѕУДёТБђТЪЦ№╝џ**

```bash
# СИђУАїтЉйС╗ц№╝їТЅФТЈЈтЁежЃе
mcp.sensitive_data_detector.scan("/data/")
```

AIУЙЊтЄ║ТИЁТЎ░ТіЦтЉі№╝џ

```
ТЅФТЈЈу╗ЊТъюТ▒ЄТђ╗№╝џ
РћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂРћЂ
СИфС║║У║ФС╗йС┐АТЂ» (PII)
РћюРћђРћђ У║ФС╗йУ»ЂтЈи№╝џ234тцё [жФўжБјжЎЕ]
РћюРћђРћђ ТЅІТю║тЈиуаЂ№╝џ1,892тцё [СИГжБјжЎЕ]
РћћРћђРћђ жѓ«у«▒тю░тЮђ№╝џ5,234тцё [СйјжБјжЎЕ]

жЄЉУъЇС┐АТЂ» (PCI)
РћюРћђРћђ жЊХУАїтЇАтЈи№╝џ45тцё [ТъЂжФўжБјжЎЕ]
РћћРћђРћђ CVVуаЂ№╝џ0тцё [ТюфтЈЉуј░]

тЂЦт║иС┐АТЂ» (PHI)
РћћРћђРћђ тї╗уќЌУ«░тйЋ№╝џ123тцё [жФўжБјжЎЕ]

СИЇтљѕУДёжА╣№╝џ
1. /data/user_backup.sql - ТўјТќЄтГўтѓеУ║ФС╗йУ»ЂтЈи
2. /logs/payment.log - тїЁтљФт«їТЋ┤жЊХУАїтЇАтЈи
3. /temp/export.csv - Тюфтіат»єуџёСИфС║║С┐АТЂ»

СИђжћ«С┐«тцЇт╗║У««№╝џ
[уѓ╣тЄ╗ућЪТѕљС┐«тцЇУёџТюг]
```

## тю║ТЎ»СИЅ№╝џуфЂтЈЉ0dayСИЇуЪЦжЂЊТђјС╣ѕт║ћт»╣№╝ЪAIу╗ЎСйат║ћТђЦТќ╣ТАѕ

### уЌЏуѓ╣ТЌХтѕ╗

ТЌЕСИіСИђуЮЂую╝№╝їТЪљуЪЦтљЇу╗ёС╗ХуѕєтЄ║0day№╝їСйауџёу│╗у╗ЪућеС║єУ┐ЎСИфу╗ёС╗ХРђд

С╝ау╗ЪтЂџТ│Ћ№╝џ

1. 1сђЂуќ»уІѓGoogleТЅЙPOC№╝ѕ30тѕєжњЪ№╝Ѕ
2. 2сђЂтѕєТъљтй▒тЊЇУїЃтЏ┤№╝ѕ1т░ЈТЌХ№╝Ѕ
3. 3сђЂтѕХт«џт║ћТђЦТќ╣ТАѕ№╝ѕ2т░ЈТЌХ№╝Ѕ
4. 4сђЂтЈ»УЃйУ┐ўТў»ТюЅжЂЌТ╝ЈРђд

### AIтіЕТЅІТЮЦтИ«т┐Ў

Сй┐уће web\_risk\_assessor + threat\_intel\_producer у╗ётљѕТІ│№╝џ

```
# УЙЊтЁЦ0dayС┐АТЂ»
vuln_info = "Apache Log4j RCE (CVE-2021-44228)"

# AIт┐ФжђЪтЊЇт║ћ
response = mcp.
threat_intel_producer.analyze_0day(vuln_info)
```

30уДњтєЁУјитЙЌт«їТЋ┤Тќ╣ТАѕ№╝џ

```
сђљу┤ДТђЦсђЉLog4j RCE т║ћТђЦтЊЇт║ћТќ╣ТАѕ

тй▒тЊЇУ»ёС╝░№╝џ
РюЊ ТѓеТюЅ23СИфт║ћућеСй┐ућеС║єтЈЌтй▒тЊЇуЅѕТюг
РюЊ тЁХСИГ5СИфТџ┤жю▓тюетЁгуйЉ
РюЊ жбёУ«Атй▒тЊЇућеТѕи№╝џ10СИЄ+

уФІтЇ│ТјфТќй№╝џ
1. СИ┤ТЌХу╝ЊУДБ№╝џ
   export LOG4J_FORMAT_MSG_NO_LOOKUPS=true

2. у┤ДТђЦУАЦСИЂ№╝џ
   тЇЄу║ДУЄ│ log4j 2.17.0

3. ТБђТхІУДётѕЎ№╝џ
   ${jndi:ldap://[ТБђТхІуЅ╣тЙЂ]

4. ти▓уЪЦтѕЕућеIPж╗ЉтљЇтЇЋ№╝џ
   [УЄфтіеТЏ┤Тќ░уџётеЂУЃЂТЃЁТіЦ]

ТЌХжЌ┤у║┐№╝џ
- T+0: жЃеуй▓СИ┤ТЌХу╝ЊУДБ№╝ѕуФІтЇ│№╝Ѕ
- T+2h: т«їТѕљТаИт┐Ѓу│╗у╗ЪтЇЄу║Д
- T+24h: тЁежЃеу│╗у╗ЪтЇЄу║Дт«їТѕљ
```

## тю║ТЎ»тЏЏ№╝џУђЂТЮ┐УдЂт«ЅтЁеТђЂті┐Т▒ЄТіЦ№╝ЪAIтИ«СйауДњтЄ║ТіЦтЉі

### уЌЏуѓ╣ТЌХтѕ╗

Т»ЈтЉеСИђуџётЎЕТбд№╝џУђЂТЮ┐УдЂуюІСИітЉет«ЅтЁеТђЂті┐Рђд

СйажюђУдЂ№╝џ

* **┬и** у╗ЪУ«АтЉіУГдТЋ░ТЇ«
* **┬и** тѕєТъљтеЂУЃЂУХІті┐
* **┬и** Тђ╗у╗ЊжЄЇуѓ╣С║ІС╗Х
* **┬и**

### AIтіЕТЅІТЮЦтИ«т┐Ў

```
# СИђжћ«ућЪТѕљтЉеТіЦ
weekly_report = mcp.generate_executive_report(
    start_date="2024-01-22",
    end_date="2024-01-28"
)
```

AIУЄфтіеућЪТѕљу«Ауљєт▒ѓТіЦтЉі№╝џ

```
# т«ЅтЁеТђЂті┐тЉеТіЦ (2024.01.22-01.28)

## ТЅДУАїТЉўУдЂ
ТюгтЉетЁ▒тцёуљєт«ЅтЁеС║ІС╗Х1,234Ухи№╝їТѕљтіЪжў╗ТГб3УхижФўтЇ▒Тћ╗тЄ╗№╝їТЋ┤СйЊт«ЅтЁеТђЂті┐тЈ»ТјДсђѓ

## тЁ│жћ«ТїЄТаЄ
- тЉіУГдТђ╗ТЋ░№╝џ12,345 (уј»Т»ћРєЊ15%)
- жФўтЇ▒С║ІС╗Х№╝џ3Ухи (тЁежЃети▓тцёуй«)
- т╣│тЮЄтЊЇт║ћТЌХжЌ┤№╝џ15тѕєжњЪ (уј»Т»ћРєЊ50%)

## жЄЇуѓ╣С║ІС╗Х
1. **1Тюѕ24ТЌЦ - жњЊж▒╝жѓ«С╗ХТћ╗тЄ╗**
   - тй▒тЊЇ№╝џ50тљЇтЉўтиЦ
   - тцёуй«№╝џ30тѕєжњЪтєЁт«їТѕљжџћуд╗
   - Тћ╣У┐Џ№╝џти▓ТЏ┤Тќ░жѓ«С╗ХУ┐ЄТ╗цУДётѕЎ

## теЂУЃЂУХІті┐
[УЄфтіеућЪТѕљуџётЈ»УДєтїќтЏЙУАе]

## СИІтЉежЄЇуѓ╣
- т«їТѕљLog4jу╗ёС╗ХтЇЄу║Д
- т╝ђт▒ЋжњЊж▒╝жѓ«С╗ХТ╝ћу╗Ѓ
```

ТЋѕТъю№╝џ2т░ЈТЌХуџётиЦСйю№╝ї2тѕєжњЪТљът«џ№╝Ђ

# уюЪт«ъТћХуЏі№╝џСИЇтЈфТў»ТЋѕујЄТЈљтЇЄ

**СИфС║║ТѕљжЋ┐тіажђЪ**

Сй┐ућеMCPтљј№╝їСйаС╝џтЈЉуј░№╝џ

* **┬и**тГдС╣аТЏ▓у║┐тЈўт╣│№╝џAIС╝џУДБжЄіТ»ЈСИфтѕцТќГуџёСЙЮТЇ«№╝їтИ«Сйат┐ФжђЪТѕљжЋ┐
* **┬и**тцёуљєУЃйтіЏтђЇтбъ№╝џтљїТаиТЌХжЌ┤УЃйтцёуљє10тђЇуџёт«ЅтЁеС║ІС╗Х
* **┬и**СИЊСИџт║дТЈљтЇЄ№╝џУЙЊтЄ║уџёТіЦтЉітњїтѕєТъљТЏ┤тіаСИЊСИџУДёУїЃ

УЂїСИџтЈЉт▒ЋтіЕтіЏ

* **┬и**С╗јтиЦтЁиС║║тѕ░СИЊт«Х№╝џСИЇтєЇуќ▓С║јт║ћС╗ўТЌЦтИИ№╝їТюЅТЌХжЌ┤уаћуЕХжФўу║ДтеЂУЃЂ
* **┬и**СИфС║║тЊЂуЅїТЅЊжђа№╝џжФўУ┤ежЄЈуџёУЙЊтЄ║У«ЕСйатюетЏбжўЪСИГУё▒жбќУђїтЄ║

# т┐ФжђЪСИіТЅІ№╝џ5тѕєжњЪт╝ђтДІСйауџёAIт«ЅтЁеС╣ІТЌЁ

## Тќ╣т╝ЈСИђ№╝џТаЄтЄєжЁЇуй«№╝ѕТјеУЇљТќ░ТЅІ№╝Ѕ

```
{
  "mcpServers": {
    "security-intelligence": {
      "command": "uvx",
      "args": ["mcp-server-security-intelligence"],
      "env": {
        "API_KEY": "your-api-key"
      }
    }
  }
}
```

## Тќ╣т╝ЈС║ї№╝џт┐ФжђЪСйЊжфї

1. 1сђЂУ«┐жЌ«уЂФт▒▒т╝ЋТЊјтцДТеАтъІућЪТђЂт╣┐тю║
2. 2сђЂТљюу┤бРђЮт«ЅтЁеТЎ║УЃйСйЊ MCPРђЮ
3. 3сђЂСИђжћ«жЃеуй▓№╝їуФІтЇ│Сй┐уће

### Тќ╣т╝ЈСИЅ№╝џжЏєТѕљтѕ░уј░ТюЅтиЦтЁи

```
# уц║СЙІ№╝џжЏєТѕљтѕ░Сйауџёт«ЅтЁеУёџТюгСИГ
from mcp_security import MCPClient

# тѕЮтДІтїќ
mcp = MCPClient(api_key="your-key")

# тюеСйауџёТЌЦтИИУёџТюгСИГУ░Ѓуће
def...