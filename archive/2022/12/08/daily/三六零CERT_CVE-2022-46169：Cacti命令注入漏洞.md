---
title: CVE-2022-46169：Cacti命令注入漏洞
url: https://mp.weixin.qq.com/s?__biz=MzU5MjEzOTM3NA==&mid=2247491641&idx=1&sn=285394a64d4fd977f649d3dd9c12c8a8&chksm=fe26e538c9516c2e25a5f0f8a22c7a2cce6066f09495541fa4aa24bb19515e4457c8be79c3c3&scene=58&subscene=0#rd
source: 三六零CERT
date: 2022-12-08
fetch_date: 2025-10-04T00:53:37.371255
---

# CVE-2022-46169：Cacti命令注入漏洞

![cover_image](https://mmbiz.qpic.cn/mmbiz_png/Ic3Rgfdm96eo1JibiavBv5Gy2v7N5v7ZesHVy7CNIPRfjHbqk6NMkx5m9MrJYgvCsUYIfnysZSNDaRekRRT8N4og/0?wx_fmt=png)

# CVE-2022-46169：Cacti命令注入漏洞

360CERT

三六零CERT

**赶紧点击上方话题进行订阅吧！**

报告编号：B6-2022-120701

报告来源：360CERT

报告作者：360CERT

更新日期：2022-12-07

1

漏洞简述

2022年12月07日，360CERT监测发现`Cacti`的漏洞细节在互联网公开，漏洞编号为`CVE-2022-46169`，漏洞等级：`严重`，漏洞评分：`9.8`。

Cacti项目是一个开源平台，可为用户提供强大且可扩展的操作监控和故障管理框架。

对此，360CERT建议广大用户及时将`Cacti`升级到最新版本。与此同时，请做好资产自查以及预防工作，以免遭受黑客攻击。

2

风险等级

360CERT对该漏洞的评定结果如下

| 评定方式 | 等级 |
| --- | --- |
| 威胁等级 | 严重 |
| 影响面 | 一般 |
| 攻击者价值 | 高 |
| 利用难度 | 低 |
| 360CERT评分 | 9.8 |

3

漏洞详情

### CVE-2022-46169: Cacti命令注入漏洞

CVE: CVE-2022-46169

组件: Cacti

漏洞类型: 命令注入

影响: 代码执行

简述: 该漏洞存在于“remote\_agent.php”文件中，攻击者无需身份验证即可访问此文件。攻击者可利用get\_nfilter\_request\_var()函数检索的参数$poller\_id，来满足poller\_item =POLLER\_ACTION\_SCRIPT\_PHP条件，触发proc\_open()函数，从而导致命令执行。漏洞利用成功后，未经身份验证的攻击者可以在运行 Cacti 的服务器上执行任意代码。

4

影响版本

| 组件 | 影响版本 | 安全版本 |
| --- | --- | --- |
| Cacti | 1.2.22 | 1.2.23 、 1.3.0 |

5

修复建议

### 通用修补建议

根据`影响版本`中的信息，排查并升级到`安全版本`。

Cacti官方已针对该漏洞发布补丁，但补丁更新版本1.2.23和1.3.0目前暂未发布，详见：

*https://github.com/Cacti/cacti/security/advisories/GHSA-6p93-p743-35gf*

### 临时修补建议

1. 禁止lib/functions.php 文件中的 get\_client\_addr函数返回任意IP地址来防止授权绕过。同时不遵守 HTTP\_... $\_SERVER 变量。

2. 对 remote\_agent.php 文件应用以下更改来防止命令注入：变量 $poller\_id 应该是一个整数，因此应该通过函数 get\_filter\_request\_var 替代 get\_nfilter\_request\_var 来检索：

```
    function poll_for_data() {
            // ...
               $poller_id      = get_filter_request_var('poller_id');
               // ...
```

3. 为了进一步加强对命令注入的防御，$poller\_id 在传递给 proc\_open 之前应该使用 escapeshellarg 进行转义。

```
    function poll_for_data() {
    // ...
    $cactiphp = proc_open(read_config_option('path_php_binary') . ' -q ' . $config['base_path'] . '/script_server.php realtime ' . escapeshellarg($poller_id), $cactides, $pipes);
    // ...
```

6

产品侧解决方案

若想了解更多产品信息或有相关业务需求，可移步至http://360.net。

### 360威胁情报平台（TIP）

360威胁情报平台（TIP）一款构建全面情报管理、赋能、评价、分享能力的新一代本地化情报平台。可以用来增强对关键威胁的检测；可以自动化识别报警中的重点事件；还可以提供情报分析、外部攻击面管理、行业威胁情报等高阶能力，帮助组织全面应对数字时代的安全风险。

![](https://mmbiz.qpic.cn/mmbiz_jpg/Ic3Rgfdm96fc3uuHvQAXicialQy83N3eCkRrwaGzcSoicZnic0SibBTPqr36MqHTIwVCNPJia2JBtXHDZXk1PyOic2c9g/640)

### 360安全分析响应平台

360安全大脑的安全分析响应平台通过网络流量检测、多传感器数据融合关联分析手段，对该类漏洞的利用进行实时检测和阻断，请用户联系相关产品区域负责人获取对应产品。

![](https://mmbiz.qpic.cn/mmbiz_jpg/Ic3Rgfdm96fc3uuHvQAXicialQy83N3eCktibmePOyaDou66V1Tn2gIF7M4eKrbLgS1icx29cPeyGPPhqNcptkum7Q/640)

### 360安全卫士

Windows用户可通过360安全卫士实现对应补丁安装、漏洞修复、恶意软件查杀，其他平台的用户可以根据修复建议列表中的安全建议进行安全维护。

360CERT建议广大用户使用360安全卫士定期对设备进行安全检测，以做好资产自查以及防护工作。

![](https://mmbiz.qpic.cn/mmbiz_png/Ic3Rgfdm96fc3uuHvQAXicialQy83N3eCkF0Tic8H3Qj5o6v1uXKRYtIAticr3zbpiabNp0oqEwaFPy1zib4lfvSb10A/640)

### 360本地安全大脑

360本地安全大脑是将360云端安全大脑核心能力本地化部署的一套开放式全场景安全运营平台，实现安全态势、监控、分析、溯源、研判、响应、管理的智能化安全运营赋能。360本地安全大脑已支持对相关漏洞利用的检测，请及时更新网络神经元（探针）规则和本地安全大脑关联分析规则，做好防护。

![](https://mmbiz.qpic.cn/mmbiz_jpg/Ic3Rgfdm96fv8BDXxSz1NHRzia2veeibIsgSe0jZamE1BToDXxiaS6yqxWkfTJWSSQoptbnUnvr3FUGRicJ7NAibqCg/640)

### 360终端安全管理系统

360终端安全管理系统在360安全大脑极智赋能下，以云计算、大数据、人工智能等新技术为支撑，是面向企业级客户提供端点安全（EPP)、主机安全(CDR\CWPP)、高级威胁检测与响应(EDR)等各类能力和功能功能的同一平台管理产品。

创新领先的场景化管理方式，对勒索防护、挖矿防护、HW对抗、重大事件保障、APT防护、等保合规、数据安全防护场景等场景实现高效的终端安全运营管理。

![](https://mmbiz.qpic.cn/mmbiz_jpg/Ic3Rgfdm96eU2ex4YwXgeaHlP7LS11yEhxIXk6gQBazWcmC9txfEjuNMjnM5DjLhJkqRD0f3WO0fIpIEXAbjrA/640)

7

时间线

**2022-12-06** Cacti官方发布通告

**2022-12-07** 360CERT发布通告

8

参考链接

1.*https://github.com/Cacti/cacti/security/advisories/GHSA-6p93-p743-35gf*

2.*https://nvd.nist.gov/vuln/detail/CVE-2022-46169*

9

特制报告相关说明

一直以来，360CERT对全球重要网络安全事件进行快速通报、应急响应。为更好地为政企用户提供最新漏洞以及信息安全事件的安全通告服务，现360CERT推出了安全通告特制版报告订阅服务，以便用户做资料留存、传阅研究与查询验证。

今后特制报告将不再提供公开下载，用户可扫描下方二维码进行服务订阅。

![](https://mmbiz.qpic.cn/mmbiz_jpg/Ic3Rgfdm96dGuACWTa4BQzhoMl3chI7Tdch7TU5O21ECnPYAkbzMTfjcuvslias51NRldtrfia2XCvoI05Q91X8Q/640?wx_fmt=jpeg)

往期推荐

01

[CVE-2022-4262：Google Chrome V8类型混淆漏洞通告](http://mp.weixin.qq.com/s?__biz=MzU5MjEzOTM3NA==&mid=2247491631&idx=1&sn=23f6b889fb044adec5d046573adfb0c9&chksm=fe26e52ec9516c3893d2f61519c471f06c71fc7f6bec0eb8cc26efe21a1899f62f1ab3d93344&scene=21#wechat_redirect)

02

[CVE-2022-3328:Snapd 本地权限提升漏洞通告](http://mp.weixin.qq.com/s?__biz=MzU5MjEzOTM3NA==&mid=2247491628&idx=1&sn=6ec0e9e84b3a8960c7100785a6741d28&chksm=fe26e52dc9516c3b9e16e1cb8d130858e5bc64fb9be1f9681d62d55c011cd7879c76cf4334c3&scene=21#wechat_redirect)

03

[CVE-2022-44635:Apache Fineract文件上传漏洞](http://mp.weixin.qq.com/s?__biz=MzU5MjEzOTM3NA==&mid=2247491620&idx=1&sn=aab867bdaf03ac86716637ea65d1f294&chksm=fe26e525c9516c330aabbb26ffdf5b76e0dbfc37658568d6c856f24200693f16985f51c8e07b&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/mmbiz_png/Ic3Rgfdm96fDEiaYRAwzeORXyPTzIZEicJEJchzE6NNx8UKdqTdwDHNIYmwsIK7JlquzGrjaQS7ssnemOGtsTvYw/640?wx_fmt=png)

360CERT

https://cert.360.cn/

进入官网查看更多资讯

长按扫码关注我们

![](https://mmbiz.qpic.cn/mmbiz_png/Ic3Rgfdm96fDEiaYRAwzeORXyPTzIZEicJJ6oj5eUnvicLHzb45xcpgT8bhs83yg8VQjlRo8Av3jvfEv1NNMfHvRA/640 "微信公众号二维码.jpg")

![](https://mmbiz.qpic.cn/mmbiz_png/Ic3Rgfdm96fDEiaYRAwzeORXyPTzIZEicJLRf9N0If8jPYhCicZ5sao1dWa48hVm5xpUskBUnDMYmvTJHpsWTmBsw/640?wx_fmt=png)

点击在看，进行分享

![](https://mmbiz.qpic.cn/mmbiz_gif/Ic3Rgfdm96fDEiaYRAwzeORXyPTzIZEicJX2oU8HWWic5QdjaCkRHBK3anwULoleLibhW5SnibSGWCF1fjkYS5ia8JPg/640?wx_fmt=gif)

预览时标签不可点

阅读原文

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/Ic3Rgfdm96ehiaKaNLl4R2jEAKbwYWArdHJBHLPsfvia7icjTiaGrgEvu6D11iaH6NLKSibIZxPSaiaiaQE0O5WfrpicKcQ/0?wx_fmt=png)

三六零CERT

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/Ic3Rgfdm96ehiaKaNLl4R2jEAKbwYWArdHJBHLPsfvia7icjTiaGrgEvu6D11iaH6NLKSibIZxPSaiaiaQE0O5WfrpicKcQ/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过