---
title: Discovering a Deserialization Vulnerability in LINQPad
url: https://trustedsec.com/blog/discovering-a-deserialization-vulnerability-in-linqpad
source: TrustedSec
date: 2024-12-04
fetch_date: 2025-10-06T19:41:46.684348
---

# Discovering a Deserialization Vulnerability in LINQPad

[Skip to Main Content](#main)

All Trimarc services are now delivered through TrustedSec!
[Learn more](https://trustedsec.com/about-us/news/trimarc-joins-forces-with-trustedsec-to-strengthen-security-advisory-services)

Close

[TrustedSec](https://trustedsec.com/)

* [Solutions](https://trustedsec.com/solutions)

  ## Solutions

  Our custom solutions are tailored to address the unique challenges of different roles in security.

  [Solutions](https://trustedsec.com/solutions)

  + [01

    For Leadership

    We understand the challenges facing modern executives and develop solutions unique to leaders.](https://trustedsec.com/solutions/for-leadership)
  + [02

    For Operations

    We stay one step ahead to proactively safeguard our clients and partners.](https://trustedsec.com/solutions/for-operations)
  + [03

    For Infrastructure

    From architecture to resiliency and maintainability, we keep your tech aligned to best practices.](https://trustedsec.com/solutions/for-infrastructure)
  + [04

    For Assurance

    Our compliance experts guide partners through regulatory requirements to ensure standards are met.](https://trustedsec.com/solutions/for-assurance)
* [Services](https://trustedsec.com/services)

  ## Services

  From building to testing to hardening, our services support security at every stage.

  [Services](https://trustedsec.com/services)

  + [01

    Design

    Design an exceptional, custom security program alongside our security experts.](https://trustedsec.com/services/design)
  + [02

    Evaluate

    Evaluate your security program with proven assessment methodologies.](https://trustedsec.com/services/evaluate)
  + [03

    Harden

    Harden your security program with the help of our security experts.](https://trustedsec.com/services/harden)
  + [04

    Respond

    Respond to threats to your security program with the help of our security experts.](https://trustedsec.com/services/respond)
* [Research](https://trustedsec.com/research)
* [Blog](https://trustedsec.com/blog)
* [Resources](https://trustedsec.com/resources)
* [About Us](https://trustedsec.com/about-us)

  ## About Us

  Driven by purpose, fueled by experts.

  [About Us](https://trustedsec.com/about-us)

  + [01

    Our Team

    Meet our security experts.](https://trustedsec.com/about-us/our-team)
  + [02

    Our Partners

    Become a TrustedSec partner to help your customers anticipate and prepare for potential attacks.](https://trustedsec.com/about-us/our-partners)
  + [03

    News

    Our team is trusted by local and national media to be the subject matter experts for security news.](https://trustedsec.com/about-us/news)
  + [04

    Events

    See our upcoming webinars, conferences, talks, trainings, and more!](https://trustedsec.com/about-us/events)

Search

Menu

Search Input

Search

* [Contact Us](https://trustedsec.com/contact)
* [Report a breach](https://trustedsec.com/report-a-breach)

* [Solutions](https://trustedsec.com/solutions)
* [Services](https://trustedsec.com/services)
* [Research](https://trustedsec.com/research)
* [Blog](https://trustedsec.com/blog)
* [Resources](https://trustedsec.com/resources)
* [About Us](https://trustedsec.com/about-us)

Search

* [Contact Us](https://trustedsec.com/contact)
* [Report a breach](https://trustedsec.com/report-a-breach)

* [Blog](https://trustedsec.com/blog)
* [Discovering a Deserialization Vulnerability in LINQPad](https://trustedsec.com/blog/discovering-a-deserialization-vulnerability-in-linqpad)

December 03, 2024

# Discovering a Deserialization Vulnerability in LINQPad

Written by
James Williams

Red Team Adversarial Attack Simulation

![](https://trusted-sec.transforms.svdcdn.com/production/images/Blog-Covers/Linqpad_WebHero.jpg?w=320&h=320&q=90&auto=format&fit=crop&dm=1732734129&s=0b317d8ecdaaecc3df5216546169aa8f)

Table of contents

* [1.1 A Needle in a Haystack](#Needle)
* [1.2 Are We Still Thinking in Graphs?](#Graphs)
* [1.3 Building a Proof of Concept](#Concept)
* [1.4 Wrapping Up](#Wrapping)

Share

* Share URL
* [Share via Email](/cdn-cgi/l/email-protection#a09fd3d5c2cac5c3d49de3c8c5c3cb859290cfd5d4859290d4c8c9d3859290c1d2d4c9c3ccc5859290c6d2cfcd859290f4d2d5d3d4c5c4f3c5c385929186c1cdd09bc2cfc4d99de4c9d3c3cfd6c5d2c9cec7859290c1859290e4c5d3c5d2c9c1ccc9dac1d4c9cfce859290f6d5cccec5d2c1c2c9ccc9d4d9859290c9ce859290ece9eef1f0c1c48593e1859290c8d4d4d0d38593e18592e68592e6d4d2d5d3d4c5c4d3c5c38ec3cfcd8592e6c2cccfc78592e6c4c9d3c3cfd6c5d2c9cec78dc18dc4c5d3c5d2c9c1ccc9dac1d4c9cfce8dd6d5cccec5d2c1c2c9ccc9d4d98dc9ce8dccc9ced1d0c1c4 "Share via Email")
* [Share on Facebook](http://www.facebook.com/sharer.php?u=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fdiscovering-a-deserialization-vulnerability-in-linqpad "Share on Facebook")
* [Share on X](http://twitter.com/share?text=Discovering%20a%20Deserialization%20Vulnerability%20in%20LINQPad%3A%20https%3A%2F%2Ftrustedsec.com%2Fblog%2Fdiscovering-a-deserialization-vulnerability-in-linqpad "Share on X")
* [Share on LinkedIn](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ftrustedsec.com%2Fblog%2Fdiscovering-a-deserialization-vulnerability-in-linqpad&mini=true "Share on LinkedIn")

Like most red teamers, I spend quite a lot of time looking for novel vulnerabilities that could be used for initial access or lateral movement. Recently, my focus has been on deserialization vulnerabilities in .NET applications, especially those that are commonly used or installed by default. This research led to me discovering a deserialization vulnerability in [LINQPad](https://www.linqpad.net), a .NET scratchpad application commonly used by developers. In this post, we will look at how this vulnerability was found.

## 1.1 A Needle in a Haystack

If we want to find vulnerabilities in .NET apps, we need .NET apps to analyze (shocking, I know). Windows ships with quite a few .NET DLLs and executables already installed, but there are also plenty of popular third-party tools written in .NET. When looking for novel exploits, we really want to focus our search on commonly used applications; there is little point putting in hours of work to find a vulnerability in an app with 10 users. An easy way to load up a VM with commonly used apps is to simply use it for a while, do some work on it, and install whatever tools you need as you go. I used to be a .NET developer and spent quite a bit of time working in that ecosystem, so I spun up a dev VM and got to work. After a few weeks of using this VM, I ran [CerealKiller](https://github.com/two06/CerealKiller) and started analyzing its output. This tool will scan every DLL or .exe on a host, identify the ones built with .NET, and check for any references to the method signature you provide. In this case, we are looking for calls to BinaryFormatter.Deserialize.

This produced around 1,500 hits, predominantly in DLLs. The next step is to triage the results, looking for calls to BinaryFormatter.Deserialize, which contain user-controlled data. If we find one of those, we then need to track the entry point to that function and find out where the data comes from. This process is repeated until we either find that the function is not vulnerable or find a path from “run this exe with these arguments" to "trigger a deserialization call”. Being rather lazy, I decided to triage the .exe results first, as these would, hopefully, make it easier to find the entry point. Searching the CerealKiller results for .exe highlighted 64 results with many duplicates. The results also contained a few tools we can immediately rule out, such as ysoserial.net and some proof-of-concept code I had been working on. This left a handful of results, including apps like MSBuild, msdeploy, and LINQPad.

A quick triage of msdeploy.exe revealed that the vulnerable code was not called anywhere, and a Google search returned no hits for that method. At this stage, that was enough for me to put that one to the side and move on. MSBuild is a well-known LOLBin, so again I left that o...