---
title: How Browser’s Save As Feature might lead to Code Execution (CVE-2022–45415)
url: https://infosecwriteups.com/how-browsers-save-as-feature-might-lead-to-code-execution-cve-2022-45415-ebaa8711692?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2023-01-16
fetch_date: 2025-10-04T03:59:38.132956
---

# How Browser’s Save As Feature might lead to Code Execution (CVE-2022–45415)

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Febaa8711692&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fhow-browsers-save-as-feature-might-lead-to-code-execution-cve-2022-45415-ebaa8711692&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fhow-browsers-save-as-feature-might-lead-to-code-execution-cve-2022-45415-ebaa8711692&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-ebaa8711692---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-ebaa8711692---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# How Browser’s Save As Feature might lead to Code Execution (CVE-2022–45415)

[![Jayateertha Guruprasad](https://miro.medium.com/v2/resize:fill:64:64/1*bmKMCGbQfIUNeymH5M7Pow.jpeg)](https://jayateerthag.medium.com/?source=post_page---byline--ebaa8711692---------------------------------------)

[Jayateertha Guruprasad](https://jayateerthag.medium.com/?source=post_page---byline--ebaa8711692---------------------------------------)

3 min read

·

Jan 14, 2023

--

2

Listen

Share

Few days ago, while I was exploring browser based bugs, I read a article over internet explaining about a path traversal vulnerability in Safari browser using **Save Page As** Feature.
The file name was generated from content of **<title></title>** tag.
If title tag contained ../characters, The file could be saved in a directory other than desired or default Downloads directory. (If anyone finds the article, feel free to mention the article link in comments)

I wanted to recheck for the same vulnerability in other major browsers, all major browsers were safe from this vulnerability, They were clearly sanitizing user input or checking the canonical path to prevent path traversal vulnerability.

I also noticed that some major browsers such as **Mozilla Firefox** were also clearly generating file name from content of title tag, but sanitizing the input to prevent path traversal vulnerability.

> So, I begin think… **Okay, As input sanitization is in place, Is it possible to exploit in this scenario without path traversal ?**

Remember the file name is still generated using title tag, only difference being canonical check/input sanitization might be present to prevent path traversal vulnerability -> So, we still have control over extension of the file.

Scenario — Host a index.html file with below html content and try opening the hosted content in browser and use **Save Page As** feature of browser. ([Live Preview](https://bafybeibrsggi64rxlwptr3o4oihx6ggwld2yupglqh75axcjd6rldtb75y.ipfs.w3s.link/))

```
<html><head><title>malicious.exe</title></head><body>This is a html file</body></html>
```

**Although the original file is index.html (Which is a html file), it will be saved as malicious.exe as filename is generated with content from title tag.** (You might not reproduce this now, as this will already be fixed in Mozilla Firefox, when you are reading this article)

But, unfortunately you cannot execute a .exe, .bat, .ps1 etc files which are having html content.

I even tried to add binary/executable content inside html file with malicious filename in title tag, still you cannot execute it, as it’s not a valid executable.

So, now we control filename, but content inside file can only be html & we need a code execution…

> Is there a file extension which can have html content, but execute code ?

Here comes, **Microsoft Hyper Text Application** to our rescue, Found that **.hta** extension can contain classic HTML as well as **VBScript/JSScript**.

When .hta file is opened, the content inside it is parsed and executed by mshta.exe. FYI, this is not a new technique and is widely known and used by many APT groups. ([MITRE Reference](https://attack.mitre.org/techniques/T1218/005/))

Hence, made a good POC with html content and filename(index.html) which when saved using **Mozilla Firefox** browser’s **Save Page As** Feature, would result in saving the file with .hta extension (file name — mal.hta) which when opened, results in **code execution/victim getting pwned** !!!

**You can view the POC video for Mozilla Firefox browser below** —

PASTEBIN link for source code of malicious html file & live hosted preview can be viewed by clicking on [link 1](https://pastebin.com/8NcCBmmL) and [link 2](https://bafybeidgvz56ys2kt6jfgzyyrthotjewcugdh4jtf56igseupy4bh57psi.ipfs.w3s.link/index2.html) respectively.

Reported the same to Mozilla Firefox, found that they were already aware of a similar issue partially but without a security impact.

Seems, **Jefferson Scher** has earlier found & reported that — **Save Page As feature creates erroneous file extension if page title ends with a TLD**.

Once, I reported the issue providing a valid POC & security impact, it was quickly fixed and released.

![]()

Me enjoying the bounty after the hunt !

They also credited [CVE-2022–45415](https://www.mozilla.org/en-US/security/advisories/mfsa2022-47/#CVE-2022-45415) under my name and also provided a good bounty ($xxxx) for finding this vulnerability.

**Report Timeline —**

1. Reported — Oct 04, 2022
2. Fixed — Oct 20, 2022
3. Bounty Awarded — Oct 26, 2022

### Liked my article ? Follow me on twitter ([@jayateerthaG](https://twitter.com/jayateerthaG)) and medium for more content about bugbounty, Infosec, cybersecurity and hacking.

[Bug Bounty](https://medium.com/tag/bug-bounty?source=post_page-----ebaa8711692---------------------------------------)

[Hacking](https://medium.com/tag/hacking?source=post_page-----ebaa8711692---------------------------------------)

[Cybersecurity](https://medium.com/tag/cybersecurity?source=post_page-----ebaa8711692---------------------------------------)

[Infosec](https://medium.com/tag/infosec?source=post_page-----ebaa8711692---------------------------------------)

[Browsers](https://medium.com/tag/browsers?source=post_page-----ebaa8711692---------------------------------------)

--

--

2

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:96:96/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--ebaa8711692---------------------------------------)

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:128:128/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--ebaa8711692---------------------------------------)

Follow

[## Published in InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---post_publicatio...