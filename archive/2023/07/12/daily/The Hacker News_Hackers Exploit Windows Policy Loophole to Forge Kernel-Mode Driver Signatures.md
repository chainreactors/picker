---
title: Hackers Exploit Windows Policy Loophole to Forge Kernel-Mode Driver Signatures
url: https://thehackernews.com/2023/07/hackers-exploit-windows-policy-loophole.html
source: The Hacker News
date: 2023-07-12
fetch_date: 2025-10-04T11:58:19.926348
---

# Hackers Exploit Windows Policy Loophole to Forge Kernel-Mode Driver Signatures

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [Hackers Exploit Windows Policy Loophole to Forge Kernel-Mode Driver Signatures](https://thehackernews.com/2023/07/hackers-exploit-windows-policy-loophole.html)

**Jul 11, 2023**Ravie LakshmananCyber Threat / Endpoint Security

[![Kernel-Mode Driver Signatures](data:image/png;base64... "Kernel-Mode Driver Signatures")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPgbY8V35A7ppQVCG_7XPVg3kTWpucnWCFcJZZ83A08cyyGcjZ180VRmohnKwFhxcbYBIR1fcatS9AoVlooHZMFleVwYyq-gJGRyCURAFJvJ9r7A_7CdDoqtVhWgEr9o0dpSNj2UAp-Woum4BakV2aqZGfOpuGP4D6s4lypRbVgk23a3a-VDXMOXPlDijz/s790-rw-e365/windows-drier.jpg)

A Microsoft Windows policy loophole has been observed being exploited primarily by native Chinese-speaking threat actors to forge signatures on kernel-mode drivers.

"Actors are leveraging multiple open-source tools that alter the signing date of kernel mode drivers to load malicious and unverified drivers signed with expired certificates," Cisco Talos said in an [exhaustive two-part report](https://blog.talosintelligence.com/old-certificate-new-signature/) shared with The Hacker News. "This is a major threat, as access to the kernel provides complete access to a system, and therefore total compromise."

Following responsible disclosure, Microsoft [said](https://msrc.microsoft.com/update-guide/vulnerability/ADV230001) it has taken steps to block all certificates to mitigate the threat. It further stated that its investigation found "the activity was limited to the abuse of several developer program accounts and that no Microsoft account compromise has been identified."

The tech giant, besides suspending developer program accounts involved in the incident, emphasized that the threat actors had already gained administrative privileges on compromised systems prior to use of the drivers.

It's worth pointing out that the Windows maker had [rolled out](https://thehackernews.com/2022/12/ransomware-attackers-use-microsoft.html) similar blocking protections in December 2022 to prevent ransomware attackers from using Microsoft-signed drivers for post-exploitation activity.

[Driver signature enforcement](https://learn.microsoft.com/en-us/windows-hardware/drivers/install/driver-signing), which requires kernel-mode drivers to be digitally signed with a certificate from Microsoft's Dev Portal, is a [crucial line of defense](https://thehackernews.com/2023/05/new-wintapixsys-malware-engages-in.html) against malicious drivers, which could be potentially weaponized to evade security solutions, tamper with system processes, and maintain persistence. The policy change was introduced with the debut of Windows Vista.

The new weakness discovered by Cisco Talos makes it possible to forge signatures on kernel-mode drivers, thereby allowing Windows certificate policies to be bypassed.

This is made possible due to an [exception](https://learn.microsoft.com/en-us/windows-hardware/drivers/install/kernel-mode-code-signing-policy--windows-vista-and-later-) carved out by Microsoft to maintain compatibility, which permits cross-signed drivers if the computer was upgraded from an earlier release of Windows to Windows 10, version 1607; Secure Boot is off in the BIOS; and the drivers were "signed with an end-entity certificate issued prior to July 29th 2015 that chains to a supported cross-signed [certificate authority]."

[![DFIR Retainer Services](data:image/png;base64...)](https://thehackernews.uk/cloud-insight-d)

"The third exception creates a loophole that allows a newly compiled driver to be signed with non-revoked certificates issued prior to or expired before July 29, 2015, provided that the certificate chains to a supported cross-signed certificate authority," the cybersecurity company said.

As a result, a driver signed in this manner will not be prevented from being loaded on a Windows device, thereby enabling threat actors to take advantage of the escape clause to deploy thousands of malicious, signed drivers without submitting them to Microsoft for verification.

These rogue drivers are deployed using signature timestamp forging software such as [HookSignTool](https://github.com/Jemmy1228/HookSigntool) and [FuckCertVerifyTimeValidity](https://github.com/hzqst/FuckCertVerifyTimeValidity), which have been publicly available since 2019 and 2018, respectively.

HookSignTool has been accessible via GitHub since January 7, 2020, while FuckCertVerifyTimeValidity was first committed to the code hosting service on December 14, 2018.

[![Kernel-Mode Driver Signatures](data:image/png;base64... "Kernel-Mode Driver Signatures")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiHVd8wn3euchYEcf4Rm6X17E9ZhSJfLT3m06A5afzfV5Imo829eYdkcu6kqUYS81pCImFdUzGzata-jfkYIXtjcqoSbLRk6ndlAB69M1aM1VElX-hwxPHfpeaUM5cNi2ek0DrTRWVd43n5HJ453jdP6gzdJBo70pmxLpp-HijfyIrG1Vcku_U9Txns9UfY/s790-rw-e365/hacking.jpg)

"HookSignTool is a driver signature forging tool that alters the signing date of a driver during the signing process through a combination of hooking into the Windows API and manually altering the import table of a legitimate code signing tool," Cisco Talos explained.

Specifically, it involves hooking to the [CertVerifyTimeValidity function](https://learn.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-certverifytimevalidity), which verifies the time validity of a certificate, to change the signing timestamp during execution.

"This tiny project prevents the signtool from verifing [sic] cert time validity and let you sign your bin with outdated cert without changing system time manually," the GitHub page for FuckCertVerifyTimeValidity reads.

[![CIS Build Kits](data:image/png;base64...)](https://thehackernews.uk/platform-shield-d)

"It install hook into crypt32!CertVerifyTimeValidity and make it always return 0 and make kernel32!GetLocalTime return what you want as you can add "-fuckyear 2011" to signtool's command line to sign a cert from year 2011."

That said, pulling off a successful forgery requires a non-revoked code signing certificate that was is...