---
title: Malware Steals Account Credentials
url: https://blog.sucuri.net/2024/11/malware-steals-account-credentials.html
source: Over Security - Cybersecurity news aggregator
date: 2024-11-09
fetch_date: 2025-10-06T19:19:27.477465
---

# Malware Steals Account Credentials

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)

[Login](https://dashboard.sucuri.net/login/)

[Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)

Search for:

Search

* [Ecommerce Security](https://blog.sucuri.net/category/ecommerce-security)
* [Magento Security](https://blog.sucuri.net/category/magento-security)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)

# Malware Steals Account Credentials

[![](https://secure.gravatar.com/avatar/067bd4ee574f53bb79d411d83b5cc84ea794c798f945cb84a001cbe05fee65df?s=60&d=mm&r=g)](https://blog.sucuri.net/author/matt-morrow)

[Matt Morrow](https://blog.sucuri.net/author/matt-morrow)

* November 8, 2024

![Malware Steals Account Credentials](https://blog.sucuri.net/wp-content/uploads/2024/11/Malware-Steals-Account-Credentials-820x385.png)

It’s common for malware to target e-commerce sites, and these attackers are usually seeking to steal credit card details. In most cases, they will insert scripts that extract data from the checkout forms to siphon fields like the cardholder name, card number and expiration date. Once they have that information, their job is done and they’ll use the data for other nefarious purposes (usually putting it up for sale on the black market). However, every now and then we encounter a case where in addition to that they are also looking to steal details for accounts that customers have created on these sites along with admin account credentials. We’ll explore one such case.

## The malware

Magento is quite complex and allows for heavy customization of the core files. We encountered a suspicious script loading in the following file:

```
./pub/static/adminhtml/Magento/backend/en_US/mage/dataPost.js.
```

![loaded datapost file](https://blog.sucuri.net/wp-content/uploads/2024/11/loaded-datapost-file.png)

In the usual fashion, the malware is heavily obfuscated making use of randomly named variables and hex encoded function names.

Once decoded using a [js deobfuscator](https://deobfuscate.relative.im/), we can begin to piece together what the script is doing:

![datapost script decoded](https://blog.sucuri.net/wp-content/uploads/2024/11/datapost-script-decoded.png)

## Breaking it down

We can see some key components that give away the script’s intent. We already know the script was located in **Magento/backend/en\_US/mage/dataPost.js**. This file is used by Magento for processing AJAX requests via forms, like we would see with customer signup and login forms.

Knowing what this Magento component does, these variables are of particular interest.

```
g: 'aHR0cHM6Ly9jZG4uanF1ZXJpLmF0L3I=
l: '#username'
p: '#login'
b: '.action-login'
```

Among other things, the **action-login** function in Magento processes login requests by validating user credentials. So what we are seeing is that the script waits for that action to trigger and then scrapes the data entered into the form. But where is the password, you might ask?

Looking at the form on the site, we can see that the username and password are both configured as elements in the **login** array.

![username and password elements](https://blog.sucuri.net/wp-content/uploads/2024/11/username-password-elements.png)

At the bottom of our malicious script, we can see a function to iterate through the form array values.

![bottom of malicious script](https://blog.sucuri.net/wp-content/uploads/2024/11/bottom-script.png)

Remember from above, **dBNA73C** was the malicious script’s container name, and **.p** was designated for **login** – the site’s form array containing the values the attackers are interested in.

That leaves us with one last value.

```
g: 'aHR0cHM6Ly9jZG4uanF1ZXJpLmF0L3I=
```

This is a simple base64 encoding for the domain where they will be sending the login details:

```
hxxttps://cdn[.]jqueri[.]at/
```

This domain is known to be a malware provider [associated with previous attacks](https://sitecheck.sucuri.net/results/https/cdn.jqueri.at) and is hosted on a server along with other domains known to be associated with customer account and credit card theft.

![reverseip lookup](https://blog.sucuri.net/wp-content/uploads/2024/11/reverseip-lookup.png)

A point to make here is that attackers will often use domains that are very similar to known good domains. In this case, they use a variation of known JQuery repositories in an attempt to evade detection – this domain could easily blend into a network resource analysis.

One thing that strikes me as particularly interesting in this case is that, unlike many cases of malware that generically target sites, this appears to have been tailored specifically for the site where this malware was injected – the malware looks for specific variables in the login form design.

Once the attackers have login details, specifically for admin accounts, they can make any number of changes to the site design and even install malicious m...