---
title: URL files and WebDAV used for IcedID (Bokbot) infection, (Fri, Feb 24th)
url: https://isc.sans.edu/diary/rss/29578
source: SANS Internet Storm Center, InfoCON: green
date: 2023-02-25
fetch_date: 2025-10-04T08:07:43.544738
---

# URL files and WebDAV used for IcedID (Bokbot) infection, (Fri, Feb 24th)

# [Internet Storm Center](/)

[Sign In](/login.html)
[Sign Up](/register.html)

Handler on Duty: [Johannes Ullrich](/handler_list.html#johannes-ullrich "Johannes Ullrich")

Threat Level: [green](/infocon.html)

* [previous](/diary/29574)
* [next](/diary/29582)

# [URL files and WebDAV used for IcedID (Bokbot) infection](/forums/diary/URL%2Bfiles%2Band%2BWebDAV%2Bused%2Bfor%2BIcedID%2BBokbot%2Binfection/29578/)

**Published**: 2023-02-24. **Last Updated**: 2023-02-24 01:37:45 UTC
**by** [Brad Duncan](/handler_list.html#brad-duncan) (Version: 1)

[2 comment(s)](/diary/URL%2Bfiles%2Band%2BWebDAV%2Bused%2Bfor%2BIcedID%2BBokbot%2Binfection/29578/#comments)

***Introduction***

[IcedID](https://www.checkpoint.com/cyber-hub/threat-prevention/what-is-malware/icedid-malware/) (also known as [Bokbot](https://www.team-cymru.com/post/tracking-bokbot-icedid-infrastructuremapping-a-vast-and-currently-active-icedid-network)) is an information stealer/backdoor malware that can lead to other activity like Cobalt Strike and Virtual Network Computing (VNC) traffic.  IcedID is often [distributed through email](https://isc.sans.edu/diary/28884), and we've also seen it [delivered by fake software sites from Google ad traffic](https://isc.sans.edu/diary/Google%2Bads%2Blead%2Bto%2Bfake%2Bsoftware%2Bpages%2Bpushing%2BIcedID%2BBokbot/29344).

For email-based distribution, we've seen [OneNote files](https://www.proofpoint.com/us/blog/threat-insight/onenote-documents-increasingly-used-to-deliver-malware) as an initial lure this month ([here's one example](https://twitter.com/k3dg3/status/1623333951069646857)). But these distribution patterns occasionally change.  For example, on Tuesday 2023-02-21, we found a distribution pattern using .url files and WebDAV traffic for an IcedID infection.

Today's diary reviews an infection from Thursday 2023-02-23 generated by one of those .url files.

[![](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-01a.jpg)](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-01.jpg)
*Shown above:  Flow chart for the infection activity.*

***The Discovery***

On Tuesday 2023-02-21, [@wwp96](http://twitter.com/wwp96) tweeted about [an open directory](https://twitter.com/wwp96/status/1628126394487300096) at hxxp://104.156.149[.]6/webdav/.  Searching VirusTotal revealed at least 22 .url files that attempt to contact the server.  These .url files all use file:\\\\ instead of http:// for the URL, and they all grab a similarly-named .bat file from the open directory.

[![](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-02a.jpg)](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-02.jpg)
*Shown above:  URL file and the associated BAT file.*

The .bat file runs a DLL installer for IcedID on the same server at \\104.156.149[.]6\webdav\host.dll.

***WebDAV Traffic***

The .url and .bat files both use [WebDAV](http://webdav.org/) to retrieve and run the malware.  WebDAV stands for "Web Distributed Authoring and Versioning," and it's a set of extensions to the HTTP protocol that allows users to access and edit files on a remote web server.

You can access WebDAV servers using Windows File Explorer. The image below shows what happened when we opened \\104.156.149[.]6\webdav\ in a File Explorer window.

[![](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-03a.jpg)](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-03.jpg)
*Shown above:  Opening the malicious WebDAV server in Windows File Explorer.*

This WevDAV activity generated several HTTP PROPFIND and GET requests.  While GET requests are seen in almost any HTTP traffic, these PROPFIND requests are specific to WebDAV.  Reviewing our pcap of the IcedID infection in Wireshark, we can find several HTTP PROPFIND requests over TCP port 80.

[![](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-04a.jpg)](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-04.jpg)
*Shown above:  Traffic from the infection filtered in Wireshark, highlighting the WebDAV PROPFIND requests.*

Following TCP streams for any of the PROPFIND requests reveals a Microsoft WebDAV user agent in the request headers.  The WebDAV server returns an XML file with properties of the specified directory or file.

[![](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-05a.jpg)](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-05.jpg)
*Shown above:  TCP stream of a WebDAV PROPFIND request over HTTP.*

***IcedID Traffic From The Infected Windows Host***

After the WebDAV activity, infection traffic was similar to previous IcedID infections.  The only unusual activity was an HTTP GET request using cURL to hxxp://mandalorecnote[.]com/images/ caused by the .bat file.

[![](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-06a.jpg)](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-06.jpg)
*Shown above:  Traffic from the infection filtered in Wireshark.*

The HTTP GET request to hxxp://mandalorecnote[.]com/images/ returned a 12kB 64-bit DLL.  This DLL doesn't appear to be used for the IcedID infection, and a cursory forensic investigation didn't find it saved to disk.  It's likely a decoy file or decoy traffic, and the DLL doesn't immediately seem malicious.  However, it's still an indicator for this specific wave of IcedID activity.

[![](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-07a.jpg)](https://isc.sans.edu/diaryimages/images/2023-02-24-ISC-diary-image-07.jpg)
*Shown above:  12 kB DLL returned from mandalorecnote[.]com, possible decoy traffic or file.*

***Indicators of Compromise (IOCs)***

The following are IOCs from the infection we generated on Thursday 2023-02-23.

22 .url files found on VirusTotal that contact the malicious WebDAV server.

Read: SHA256 hash - file name

* 0a79166f95d1f1a3542135241ea42026188916ea9c06510c20247849c5ad6f0e - PO#56034.url
* 0dfd67dafe621b57eac338e581d65598197cdb0a499a8345fa9beeae9196d8e8 - PO#15986.url
* 145b2d2a7d52f6c9ff96fbd2338204a7eb062ed271893faa7ad5a87b0879fa50 - PO#66438.url
* 1574ed0b6c1b82089dc8fc098acc3bb86c63aa11f24e45c6683a485fe109777a - PO#89932.url
* 161baa1e72a4f23c9c7fee1431d3fcb07a0fd832a4318c1ebe7526de71baedda - PO#39134.url
* 1c3ece4a1e0c9cf42a063b76da6d22c1bd43e929ce01cc51d506880b8d86f72f - PO#36627.url
* 2505d97d1b34bc27e13e6e212fa591866a3a384952d404ceb7c1a8f385ac6238 - PO#84049.url
* 266c106ef803493a9dc14f48437c482088764ea47eb14214f09d49ad1ad62c71 - PO#31084.url
* 2bdc4b5aa6b3f9395065f2c31ba130ecc21fbe4db3fcdb3c60a526e34e72bd74 - PO#61467.url
* 48b05dcb2f48ae742498e040135079a8b59f3698d1619c44622b0fe558760342 - PO#92390.url
* 4cc43b0ec10ad3f8521504df13f38182d945b865dac070b8663c262ec2b2ed69 - PO#96856.url
* 5d9ffcd009e5fde1eaa2eb6a2fbead02b3169024401720e2a06e90e3edd10cb9 - PO#37820.url
* 690b002884d71774f0877ad69385c12d0f814606296c69b647bd19a900cdd768 - PO#66703.url
* acc3d0964c41f6553d3aca71ba8baec044a2158ea019ecf50d8fa1d9e6720298 - PO#68631.url
* accf567245e184467ead9e9e5a52ab68d7bd0c9eaa81848b439cec69fd808416 - PO#69421.url
* b1c1977b5d5b0705fa3e29b9cd5760e2f394698ad9594f626104021893bddc20 - PO#59042.url
* c823261b03d11d23e76756643c8ca28baf024353464297346612af908bda4d8e - PO#94545.url
* d02a84eb7972ce9e1a092702595750ec687f850ebbd1879a3fe5944f51b24473 - PO#16873.url
* d5332249fcef78250100b4a147ef336279f188336f2d543dd5b3638973b107be - PO#84805.url
* dcf2a4d0ee66d3f47d9ff4ee9bcbc63c3286559a0ba80ab129034639b063f7f1 - PO#44959.url
* f4c46cf9ffd25764a63bcc6d158bfad5495802f830266111a37d39f107eee6d4 - PO#36434.url
* fae4e3388e95d2e710257ae86ff482258f0f51458f42d116349ebc6a9266b29f - PO#99805.url

Files from an infected Windows host:

SHA256 hash: [2bdc4b5aa6b3f9395065f2c31ba130ecc21fbe4db3fcdb3c60a526e34e72bd74](https://www.virustotal.com/gui/file/2bdc4b5aa6b3f9395065f2c31ba130ecc21fbe4db3fcdb3c60a526e34e72bd74)

* File size: 66 bytes
* File name: PO#61467.url
* File description:...