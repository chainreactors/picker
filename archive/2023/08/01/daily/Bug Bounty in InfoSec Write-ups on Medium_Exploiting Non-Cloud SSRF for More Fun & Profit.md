---
title: Exploiting Non-Cloud SSRF for More Fun & Profit
url: https://infosecwriteups.com/exploiting-non-cloud-ssrf-for-more-fun-profit-3597934518c8?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2023-08-01
fetch_date: 2025-10-06T17:00:26.633318
---

# Exploiting Non-Cloud SSRF for More Fun & Profit

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3597934518c8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fexploiting-non-cloud-ssrf-for-more-fun-profit-3597934518c8&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fexploiting-non-cloud-ssrf-for-more-fun-profit-3597934518c8&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-3597934518c8---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-3597934518c8---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# Exploiting Non-Cloud SSRF for More Fun & Profit

[![Basavaraj Banakar](https://miro.medium.com/v2/resize:fill:64:64/0*1QIfk5BpjK00wyJI.jpg)](https://basu-banakar.medium.com/?source=post_page---byline--3597934518c8---------------------------------------)

[Basavaraj Banakar](https://basu-banakar.medium.com/?source=post_page---byline--3597934518c8---------------------------------------)

4 min read

·

Jul 4, 2023

--

3

Listen

Share

Hi Everyone, This is [Basavaraj](https://twitter.com/basu_banakar), Back again with another **SSRF** Writeup :) You can check my older writeups here <https://basu-banakar.medium.com/>

Press enter or click to view image in full size

![]()

Let's jump in directly, while hunting on some random target in my spare time, I came across one subdomain where we can see the reports related to the company and marketing, I found one functionality where we can see the report in pdf format.

Press enter or click to view image in full size

![]()

To see the report in PDF format

And after clicking on the **PDF** Button it made one request and the response looked like this.

Press enter or click to view image in full size

![]()

request and response

Now quickly inserted one random URL ex: evil.com in the status\_url param and got the response of that evil.com, Now I confirmed the **Full Read SSRF.**

Press enter or click to view image in full size

![]()

Confirmed the full read SSRF

What next, Will check for local file read via **file:///** protocol, Now added **file:///etc/passwd** and sent the request and the response is **403 by Akamai** :(

Press enter or click to view image in full size

![]()

WAF Blocked due to file protocol

Dropped this here, and went for internal port scanning for localhost, and scanned 1–10000 Ports by using intruder and successfully found 2 open ports i.e 25 and 9080

Press enter or click to view image in full size

![]()

25 Port open with esmtp postfixservice

Press enter or click to view image in full size

![]()

9080 Open with some random internal webserver

Now I thought this exploit is enough to report, And reported this to the company and their response was like this :)

Press enter or click to view image in full size

![]()

Love these kinds of responses :)

> Now I started exploring more about this issue on the same day like Trying other protocols like Gopher, trying to find internal IPs, internal hosts, etc but no success, one more bad luck is they are not using the cloud as well :(

Took a break for 2hrs and started exploring more about **Akamai** waf that blocking **file:///** protocol and came to know that there will be a set of WAF rules which are blocking the common files like **etc/passwd, etc/hosts, etc/shadow,** etc. and I started exploring different file paths regarding centos and I was able to read some files successfully but found one interesting file i.e **proc/net/arp**

Press enter or click to view image in full size

![]()

file:///proc/net/arp

Now noted down all the internal IPs and built the **two CIDR** **Ranges** which look like this :)

> ***172.31.0.0/23***
> 172.31.0.1–255
> 172.31.1.1–255
>
> ***172.31.8.0/23***
> 172.31.8.1–255
> 172.31.9.1–255

Now I converted these **CIDR ranges** to IP addresses and I got **1024** IP addresses.

> What next?

Now let's use intruder to brute force these IPs :) and the results were astonishing :)

Press enter or click to view image in full size

![]()

got access to a random internal web server

Press enter or click to view image in full size

![]()

Internal web server with directory listing enabled with some files

Now here comes the tricky part, Now in response of the below request, I searched for hostnames that belong to the target for example “**.target.”** and found some 6000+ results for example: **some-internal-app.target.ad** here I guess .**ad** represents an active directory

Press enter or click to view image in full size

![]()

6000+ internal hostnames

Press enter or click to view image in full size

![]()

example hostname

> Now extracted all **internal hostnames and started brute-forcing them again using intruder**, Now this will be the end because as an attacker **I could have takeover the company 😂**

And here are the results :)

Press enter or click to view image in full size

![]()

Internal web server :)

Press enter or click to view image in full size

![]()

Some monitoring service

Press enter or click to view image in full size

![]()

Internal mapping manager

Press enter or click to view image in full size

![]()

Some internal login page

Press enter or click to view image in full size

![]()

HAProxy Stats

> And that's a wrap, I was able to access 1000+ web services that are running in the internal network of the company.

**If you have any suspicious SSRF endpoint, Hit me up on Twitter/Instagram we can collab :)**

Twitter : <https://twitter.com/basu_banakar>

Instagram: <https://instagram.com/basu_banakar>

[Cybersecurity](https://medium.com/tag/cybersecurity?source=post_page-----3597934518c8---------------------------------------)

[Bug Bounty](https://medium.com/tag/bug-bounty?source=post_page-----3597934518c8---------------------------------------)

[Ssrf](https://medium.com/tag/ssrf?source=post_page-----3597934518c8---------------------------------------)

[Ethical Hacking](https://medium.com/tag/ethical-hacking?source=post_page-----3597934518c8---------------------------------------)

[Penetration Testing](https://medium.com/tag/penetration-testing?source=post_page-----3597934518c8---------------------------------------)

--

--

3

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:96:96/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--3597934518c8---------------------------------------)

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:128:128/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post...