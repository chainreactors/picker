---
title: Utilizing Morse Code to Evade Signature Based Detection Systems
url: https://c99.sh/utilizing-morse-code-to-evade-signature-based-detection-systems/
source: C99.sh
date: 2023-05-02
fetch_date: 2025-10-04T11:39:21.282681
---

# Utilizing Morse Code to Evade Signature Based Detection Systems

# [C99.sh](https://c99.sh/)

## . . . Security Focus . . .

* [Home](https://c99.sh/)
* Categories
  + [Application Security](https://c99.sh/category/application-security/)
  + [Red Team](https://c99.sh/category/red-team/)
  + [Security Tools](https://c99.sh/category/security-tools/)
  + [Cryptography](https://c99.sh/category/cryptography/)
  + [Threat Hunting](https://c99.sh/category/threat-hunting/)
  + [Abstract](https://c99.sh/category/abstract/)
* [Archives](https://c99.sh/archives/)
* [Contact](https://c99.sh/contact/)
* [GitHub](https://github.com/iomoath)
* [Proxy Detection Test](https://proxyscore.c99.sh)
* [⏯︎ قناة يوتيوب](https://www.youtube.com/%40moath.maharmeh/)

# Utilizing Morse Code to Evade Signature Based Detection Systems

posted in [Cryptography](https://c99.sh/category/cryptography/), [Red Team](https://c99.sh/category/red-team/)

on
[May 1, 2023](https://c99.sh/utilizing-morse-code-to-evade-signature-based-detection-systems/ "9:05 am")
 by
[Moath Maharmeh](https://c99.sh/author/core/ "View all posts by Moath Maharmeh")

SHARE

[Tweet](https://twitter.com/share)

[![Pin It](//assets.pinterest.com/images/PinExt.png "Pin It")](http://pinterest.com/pin/create/button/?url=https://c99.sh/utilizing-morse-code-to-evade-signature-based-detection-systems/&media=https://c99.sh/wp-content/uploads/2023/05/morse_code_cover2.jpg&description=Utilizing Morse Code to Evade Signature Based Detection Systems)

![](https://c99.sh/wp-content/uploads/2023/05/morse_code_cover2.jpg)

## Introduction

Table of Contents

Toggle

* [Introduction](#Introduction "Introduction")
* [What is Morse Code?](#What_is_Morse_Code "What is Morse Code?")
  + [The Morse Code](#The_Morse_Code "The Morse Code")
    - [Letters –](#Letters_%E2%80%93 "Letters –")
    - [Numbers –](#Numbers_%E2%80%93 "Numbers –")
    - [Punctuation –](#Punctuation_%E2%80%93 "Punctuation –")
* [Entropy analysis](#Entropy_analysis "Entropy analysis")
  + [How does Entropy analysis apply to intrusion detection?](#How_does_Entropy_analysis_apply_to_intrusion_detection "How does Entropy analysis apply to intrusion detection?")
* [Reducing Entropy level using Morse Code](#Reducing_Entropy_level_using_Morse_Code "Reducing Entropy level using Morse Code")
  + [Calculating the Entropy Score](#Calculating_the_Entropy_Score "Calculating the Entropy Score")
  + [The Morse Code Encoder](#The_Morse_Code_Encoder "The Morse Code Encoder")
* [Summary](#Summary "Summary")
* [Interesting reads](#Interesting_reads "Interesting reads")
* [References](#References "References")

This article demonstrates reducing the Entropy score with a goal of evading the static detection by encoding characters using only dashes and dots. Inspired by the Morse Code!

Primary Keywords: **Binary Entropy analysis** | **Evading Static Analysis** | **Morse Code Encoder**

## What is Morse Code?

Morse Code is a communications “language” that was initially developed for transmission of letter by letter textual information by wire using the telegraph system. The code has also found wireless applications using signal lamps and audio devices and has also been used in long range radio communications and radio navigation applications [1].

### The Morse Code

Samuel Morse developed the initial facets of the code which bares his name but others contributed to the code as it now exists. The International Morse Code encodes each letter of the basic Latin alphabet, each of the Arabic numerals and a small set of punctuation and procedural signals (prosigns) as a sequence of short and long electrical pulses referred to as “dots” (short) and “dashes” (long) or “dits” and “dahs” [1]. The code is depicted in the following table [2]:

#### **Letters –**

|  |  |  |  |
| --- | --- | --- | --- |
| **A** | .- | **N** | -. |
| **B** | -… | **O** | — |
| **C** | -.-. | **P** | .–. |
| **D** | -.. | **Q** | –.- |
| **E** | . | **R** | .-. |
| **F** | ..-. | **S** | … |
| **G** | –. | **T** | – |
| **H** | …. | **U** | ..- |
| **I** | .. | **V** | …- |
| **J** | .— | **W** | .– |
| **K** | \_.\_ | **X** | -..- |
| **L** | .-.. | **Y** | -.– |
| **M** | — | **Z** | –.. |

#### Numbers –

|  |  |  |  |
| --- | --- | --- | --- |
| **1** | .—- | **6** | -…. |
| **2** | ..— | **7** | –… |
| **3** | …– | **8** | —.. |
| **4** | ….- | **9** | —-. |
| **5** | ….. | **0** | —– |

#### Punctuation –

|  |  |  |  |
| --- | --- | --- | --- |
| **& Ampersand** | .-… | **‘ Apostrophe** | .—-. |
| **@ At sign** | .–.-. | **) Bracket, close (parenthesis)** | -.–.- |
| **: Colon** | —… | **( Bracket, open (parenthesis)** | -.–. |
| **, Comma** | –..– | **= Equals sign** | -…- |
| **! Exclamation mark** | -.-.– | **. Full-stop (period)** | .-.-.- |
| **– Hyphen** | -….- | **× Multiplication sign (also x)** | -..- |
| **% Percentage (literally 0/0)** | —– -..-. —– | **+ Plus sign** | .-.-. |
| **” Quotation marks** | .-..-. | **? Question mark (query)** | ..–.. |
| **/ Slash** | -..-. |  |  |

## Entropy analysis

Entropy is a measure of randomness within a set of data. When referenced in the context of information theory and cybersecurity, most people are referring to Shannon Entropy. This is a specific algorithm that returns a value between 0 and 8 were values near 8 indicate that the data is very random, while values near 0 indicate that the data is very homologous [3].

### How does Entropy analysis apply to intrusion detection?

Shannon entropy can be a good indicator for detecting the use of packing, compression, and encryption in a file. Each of the previously mentioned techniques tends to increase the overall entropy of a file. This makes sense intuitively. Let’s take compression for example. Compression algorithms reduce the size of certain types of data by replacing duplicated parts with references to a single instance of that part. The end result is a file with less duplicated contents. The less duplication there is in a file, the higher the entropy will be because the data is less predictable than it was before [3].

As it turns out, malware authors also tend to rely heavily on packing, compression, and encryption to obfuscate their tools on order to evade signature based detection systems [3].

![](https://c99.sh/wp-content/uploads/2023/04/File_Entropy_Analysis_result.png)

**Figure 1:** Histogram of entropy of legitimate versus malicious files [3].

![](https://c99.sh/wp-content/uploads/2023/04/Entropy_analysis_results_CMSC691am-1024x545.png)

**Figure 2** shows the results of the entropy analysis for the sample sets described in [4]

## Reducing Entropy level using Morse Code

The primary goal here is to reduce the entropy level. The scenario described in this article is that we have a .NET PE that loads and executes an embedded PE that has been encoded using Base64 and Morse code.

In the code snippet below, we can see that the program is loading a Morse code from an embedded resource, then decodes it and executes it in memory.

1. Read the content of the embedded file “mc”
2. Decode the content of the file from Morse code to Base64
3. Load and Invoke the assembly bytes in memory

```
Morse Code sample snippet:
-~...-~..-..-~--.-~.-~.-~--~.-[...snip...]~.-~.-~-..-.~-..-.~---..~.-
```

![](https://c99.sh/wp-content/uploads/2023/04/C_Sharp_CUSTOM_LOADER.png)

**Figure 3:** .NET Loader – code snippet

### Calculating the Entropy Score

We can calculate the Entropy score using the sigcheck.exe utility that comes with the Microsoft Sysinternals Suite: > `sigcheck.exe -h -a FILE_PATH`

Here are the results for two different PE samples, one with an embedded PE resource encoded as a Morse Code and another sample embedded and encoded as a base64. We can see that the sample that used Base64 has a 5.781 Entropy score, and the one that used Morse code has a 2.572.

![](https://c99.sh/wp-content/uploads/2023/05/PE_Encoded_base64.png)

**Figure 4** shows the results of the entropy analysis for a PE file that has an embedded PE encoded in Base64.

–

![](https://c99.sh/wp...