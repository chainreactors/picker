---
title: CMIYC 2024: RAdmin3 Challenge
url: https://reusablesec.blogspot.com/2024/08/cmiyc-2024-radmin3-challenge.html
source: Reusable Security
date: 2024-08-16
fetch_date: 2025-10-06T18:03:32.847603
---

# CMIYC 2024: RAdmin3 Challenge

[Skip to main content](#main)

### Search This Blog

# [Reusable Security](https://reusablesec.blogspot.com/)

Password Cracking, Crypto, and General Security Research

### CMIYC 2024: RAdmin3 Challenge

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

By

[Matt Weir](https://www.blogger.com/profile/16111343330590419341 "author profile")

-
[August 14, 2024](https://reusablesec.blogspot.com/2024/08/cmiyc-2024-radmin3-challenge.html "permanent link")

[![An AI generated image of a kitten with a tophat](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgOLL0nL_eB8vFaeNt8Fu0K1xxeQsUA6VlK3iOJUGIibcfKuswHKvcTo1_kTTOA04cUerCAgCUG-VHzbBKXZyw934eCs5A-OMSoisEEn1SwFDkQ0f1lNne0S3ieA9tWpONiudGE_VtSgT8edbuWjC3xpR1h9VaoHtDawfZUcGdQ5ZdElMBSeAShLS0jgPQ/s16000/cmiyc2024_banner2.webp "This is what midjourney thinks a Windows registry entry looks like")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgOLL0nL_eB8vFaeNt8Fu0K1xxeQsUA6VlK3iOJUGIibcfKuswHKvcTo1_kTTOA04cUerCAgCUG-VHzbBKXZyw934eCs5A-OMSoisEEn1SwFDkQ0f1lNne0S3ieA9tWpONiudGE_VtSgT8edbuWjC3xpR1h9VaoHtDawfZUcGdQ5ZdElMBSeAShLS0jgPQ/s1220/cmiyc2024_banner2.webp)

> ***"Nothing is more permanent than a temporary solution.***"

> **- Russian Proverb**

# Introduction:

This is a continuation of my write-up about this year's Crack Me If You Can challenge. You can view the previous entry focusing on the StripHash challenge [[here](https://reusablesec.blogspot.com/2024/08/cmiyc-2024-striphash-challenge.html)]. Like the last write-up, this one is going to focus on one specific hash format (RAdmin3), details about that hash format, and how to load those hashes into a cracking session. I'm going to defer most of the actual cracking of these passwords to a later writeup though since running a successful cracking session relies on solving other challenges found throughout the contest.

## Important Links, Tools, and References for this Post:

# * **Synactiv's blog post: Cracking Radmin Server 3 Passwords** + **Link:** <https://www.synacktiv.com/en/publications/cracking-radmin-server-3-passwords> + **Reason:** This is really an amazing blog post going into dumping Radmin password hashes, reverse engineering their hashing algorithm, and then cracking them. I can't recommend this write-up enough if you want to crack Radmin password hashes. * **radmin3\_to\_hashcat.pl** + **Link:** <https://github.com/hashcat/hashcat/blob/master/tools/radmin3_to_hashcat.pl> + **Note:**This tool is part of the base Hashcat install + **Reason:** This is the primary tool to convert the Radmin3 dump that Korelogic provided to hashes that Hashcat can crack. * **Example Hashcat Formatted Hashes** + **Link:**<https://hashcat.net/wiki/doku.php?id=example_hashes> + **Reason:**You really should have this page bookmarked regardless of if you are competing in a competition or not. Whenever I'm starting a non-standard password cracking session I find myself referring back to this site to try to figure out what type of hash I'm dealing with, or to understand how I need to format it so I can crack it with Hashcat.

# Background on Radmin3 Hashes:

I'll admit that before this contest, I had never encountered Radmin3 password hashes. That probably reflects on my lack of recent full scope pentest experiences. On the flip side, their inclusion in this year's CMIYC challenge also highlights the contest organizer's (Korelogic) experiences with pentesting since the entire challenge revolves around limitations in current public open-source tools supporting Radmin3 cracking.

To learn more about the Radmin3 hash itself, how to obtain them, and how they are used, I \*strongly\* recommend you check out Synactiv's excellent blog post on this subject (linked above). The TLDR summary is that Radmin3 hashes are generated by a Windows remote server management tool (Radmin Server 3). My understanding is these hashes reside on the server itself (vs. being cached on client side systems), but this isn't a centrally managed tool so gaining access to one server and cracking an administrator's password will likely grant you access to other servers during an engagement. Also, having an administrator's cracked password is good for all sorts of other "fun" as well.

The hashes themselves are stored in the Windows registry and can be dumped using standard Windows registry tools. I'll dig more into that later as this was a core component of this year's CMIYC challenge. The actual hashing algorithm is weird. It starts out with a fairly standard:

* **sha\_hash = SHA1(salt + SHA1("username:password"))**

But then goes a bit crazy with:

* **Hash = pow(g,int(sha\_hash.hex(),16),modulus)**

The Radmin Server development team obviously has an aspiring cryptographer on their staff! Now while such an optimization is annoying/challenging to someone encountering it the first time, the Synactiv team managed to find a number of attack optimizations that limits the value of that last step. This just goes to show how hard it is to develop a secure hashing algorithm.

# Extracting the Radmin3 Hashes:

In the first PGP encrypted KoreLogic provided for the CMIYC contest there was a file called radmin.reg that was 6473 lines long and formatted like a Microsoft Windows registry dump of the keys/values in:

* [HKEY\_LOCAL\_MACHINE\SOFTWARE\WOW6432Node\Radmin\v3.0\Server\Parameters\Radmin Security\]

Looking at this data, the filename itself, and the fact that Radmin3 hashes were listed in Korelogic's contest scoreboard it's pretty easy to guess there are Radmin3 password hashes in this file. So how do we convert these to a format we can crack? The short answer for me was to do a lot of Googling, but the more repeatable answer is that there is a tool called **radmin3\_to\_hashcat.pl** that comes bundled with Hashcat. A direct link to it is listed above as well. So let's try to use that Perl script on the challenge registry file!

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjOwJ8ExWGFIODIYxGviwRKmklHv0ANoAGplbWpTh2eW1PwhLsLtXOV123Bgkn5esi-tKqJswU8o73GMFHJJpkj1lsYFGoJritYS4357QDsdnE8lS9g3GCBc4n8dOdv0d1yPxkk8ah35NUJBB7G6H2q2a1E5Be6_WLLX8KmQevFYhSe6trjGLx32e9qStQ/s16000/radmin_dump_0.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjOwJ8ExWGFIODIYxGviwRKmklHv0ANoAGplbWpTh2eW1PwhLsLtXOV123Bgkn5esi-tKqJswU8o73GMFHJJpkj1lsYFGoJritYS4357QDsdnE8lS9g3GCBc4n8dOdv0d1yPxkk8ah35NUJBB7G6H2q2a1E5Be6_WLLX8KmQevFYhSe6trjGLx32e9qStQ/s1816/radmin_dump_0.png)

Not really surprising the script errored out. Korelogic certainly doesn't have a track record of making things easy for players. Let's look at the radmin3\_to\_hashcat.pl script to understand what may be breaking.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguFH1HoDkA3aE3kYGn1GRTLjNcJDC2HiF6YrG4wxrNnM-bTHAt92OSw1ZZnWQ3n6fBjAsFkzaY8nED5lSSzgAbm3m7Km4B6q90vYwEciV6PM2e3QEGOUq0I1hyphenhyphenOWiprBNxQbCdd7EU25rWJm3u9YXmoFLtJCsKBrOfz2dQly9VYv_5xwxlE-p1lj7RIAc/w640-h573/radmin_dump_tool1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguFH1HoDkA3aE3kYGn1GRTLjNcJDC2HiF6YrG4wxrNnM-bTHAt92OSw1ZZnWQ3n6fBjAsFkzaY8nED5lSSzgAbm3m7Km4B6q90vYwEciV6PM2e3QEGOUq0I1hyphenhyphenOWiprBNxQbCdd7EU25rWJm3u9YXmoFLtJCsKBrOfz2dQly9VYv_5xwxlE-p1lj7RIAc/s1442/radmin_dump_tool1.png)

And let's compare it to the start of our challenge registry file.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhCuL6CPgwUkkeJl-4o29PjhBROreb2r4z6qXkV2ARxWnSwpko_5F82pWUrlBeULjH2wyWYV4Px-lrV15bZkXg8_4otvj52-3Hi99rdjAuEBSkDgLsqjwiISBjeABKuC3FHdGuBrf5sYTrRntjyu_vgfRAKLVB-kcDZoH5DRTeGxnmsieynt_DHihYOkyU/w640-h420/radmin_registry.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhCuL6CPgwUkkeJl-4o29PjhBROreb2r4z6qXkV2ARxWnSwpko_5F82pWUrlBeULjH2wyWYV4Px-lrV15bZkXg8_4otvj52-3Hi99rdjAuEBSkDgLsqjwiISBjeABKuC3FHdGuBrf5sYTrRntjyu_vgfRAKLVB-kcDZoH5DRTeGxnmsieynt_DHihYOkyU/s1879/radmin_registry.png)

Oh hey, it looks like some extra registry keys and debugging info was included in the file by th...