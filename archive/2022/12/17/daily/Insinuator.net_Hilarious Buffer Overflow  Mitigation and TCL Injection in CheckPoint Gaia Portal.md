---
title: Hilarious Buffer Overflow  Mitigation and TCL Injection in CheckPoint Gaia Portal
url: https://insinuator.net/2022/12/hilarious-buffer-overflow-mitigation-and-tcl-injection-in-checkpoint-gaia-portal/
source: Insinuator.net
date: 2022-12-17
fetch_date: 2025-10-04T01:45:54.775792
---

# Hilarious Buffer Overflow  Mitigation and TCL Injection in CheckPoint Gaia Portal

[Insinuator.net](https://insinuator.net/)

Bold Statements

Primary Menu

* [About](https://insinuator.net/about/)

* [RSS Feed](https://insinuator.net/?feed=rss)
* [Follow us](http://twitter.com/insinuator)

## Categories

* [Breaking](https://insinuator.net/category/breaking/)
* [Building](https://insinuator.net/category/building/)
* [Events](https://insinuator.net/category/events/)
* [Misc](https://insinuator.net/category/misc/)

## Tags

[4G](https://insinuator.net/tag/4g/)
[Active Directory](https://insinuator.net/tag/active-directory/)
[advisory](https://insinuator.net/tag/advisory/)
[Android](https://insinuator.net/tag/android/)
[Black Hat](https://insinuator.net/tag/black-hat/)
[Bluetooth](https://insinuator.net/tag/bluetooth/)
[C3](https://insinuator.net/tag/c3/)
[Cisco](https://insinuator.net/tag/cisco/)
[cloud](https://insinuator.net/tag/cloud/)
[Day-Con](https://insinuator.net/tag/day-con/)
[DHCPv6](https://insinuator.net/tag/dhcpv6/)
[disclosure](https://insinuator.net/tag/disclosure/)
[Docker](https://insinuator.net/tag/docker/)
[ERNW white paper](https://insinuator.net/tag/ernw-white-paper/)
[exploit](https://insinuator.net/tag/exploit/)
[forensics](https://insinuator.net/tag/forensics/)
[fuzzing](https://insinuator.net/tag/fuzzing/)
[GSM](https://insinuator.net/tag/gsm/)
[hardening](https://insinuator.net/tag/hardening/)
[hardware](https://insinuator.net/tag/hardware/)
[HITB](https://insinuator.net/tag/hitb/)
[iOS](https://insinuator.net/tag/ios/)
[IoT](https://insinuator.net/tag/iot/)
[IPv6](https://insinuator.net/tag/ipv6/)
[Linux](https://insinuator.net/tag/linux/)
[malware](https://insinuator.net/tag/malware/)
[medical](https://insinuator.net/tag/medical/)
[network](https://insinuator.net/tag/network/)
[pentest](https://insinuator.net/tag/pentest/)
[reversing](https://insinuator.net/tag/reversing/)
[RIPE](https://insinuator.net/tag/ripe/)
[risk](https://insinuator.net/tag/risk/)
[SAP](https://insinuator.net/tag/sap/)
[SDR](https://insinuator.net/tag/sdr/)
[Telco](https://insinuator.net/tag/telco/)
[TelcoSecDay](https://insinuator.net/tag/telcosecday/)
[tool](https://insinuator.net/tag/tool/)
[TROOPERS](https://insinuator.net/tag/troopers/)
[trust](https://insinuator.net/tag/trust/)
[virtualization](https://insinuator.net/tag/virtualization/)
[VMware](https://insinuator.net/tag/vmware/)
[VoIP](https://insinuator.net/tag/voip/)
[vulnerability](https://insinuator.net/tag/vulnerability/)
[web application](https://insinuator.net/tag/web-application/)
[Windows](https://insinuator.net/tag/windows/)

## Archives

Archives

Select Month
 October 2025 Â (1)
 September 2025 Â (2)
 August 2025 Â (2)
 July 2025 Â (3)
 June 2025 Â (4)
 May 2025 Â (2)
 April 2025 Â (2)
 March 2025 Â (2)
 February 2025 Â (1)
 January 2025 Â (2)
 November 2024 Â (2)
 September 2024 Â (2)
 August 2024 Â (2)
 June 2024 Â (2)
 May 2024 Â (4)
 April 2024 Â (4)
 February 2024 Â (1)
 October 2023 Â (3)
 September 2023 Â (2)
 August 2023 Â (1)
 July 2023 Â (1)
 June 2023 Â (2)
 May 2023 Â (3)
 December 2022 Â (1)
 September 2022 Â (2)
 August 2022 Â (1)
 June 2022 Â (1)
 April 2022 Â (1)
 March 2022 Â (1)
 December 2021 Â (1)
 October 2021 Â (1)
 July 2021 Â (1)
 May 2021 Â (4)
 April 2021 Â (2)
 March 2021 Â (1)
 February 2021 Â (3)
 January 2021 Â (5)
 December 2020 Â (4)
 November 2020 Â (6)
 October 2020 Â (2)
 September 2020 Â (5)
 July 2020 Â (3)
 June 2020 Â (1)
 May 2020 Â (1)
 April 2020 Â (2)
 March 2020 Â (3)
 February 2020 Â (3)
 January 2020 Â (2)
 December 2019 Â (2)
 November 2019 Â (6)
 October 2019 Â (4)
 September 2019 Â (3)
 August 2019 Â (3)
 July 2019 Â (6)
 June 2019 Â (6)
 May 2019 Â (7)
 April 2019 Â (7)
 March 2019 Â (2)
 February 2019 Â (4)
 January 2019 Â (14)
 December 2018 Â (4)
 November 2018 Â (11)
 October 2018 Â (6)
 September 2018 Â (1)
 August 2018 Â (4)
 July 2018 Â (3)
 June 2018 Â (3)
 May 2018 Â (3)
 April 2018 Â (5)
 March 2018 Â (8)
 February 2018 Â (12)
 January 2018 Â (2)
 December 2017 Â (2)
 November 2017 Â (3)
 October 2017 Â (7)
 September 2017 Â (5)
 August 2017 Â (3)
 July 2017 Â (3)
 June 2017 Â (6)
 May 2017 Â (5)
 April 2017 Â (3)
 March 2017 Â (8)
 February 2017 Â (6)
 January 2017 Â (8)
 December 2016 Â (12)
 November 2016 Â (14)
 October 2016 Â (12)
 September 2016 Â (12)
 August 2016 Â (9)
 July 2016 Â (9)
 June 2016 Â (7)
 May 2016 Â (10)
 April 2016 Â (23)
 March 2016 Â (29)
 February 2016 Â (14)
 January 2016 Â (12)
 December 2015 Â (15)
 November 2015 Â (6)
 October 2015 Â (9)
 September 2015 Â (7)
 August 2015 Â (5)
 July 2015 Â (6)
 June 2015 Â (14)
 May 2015 Â (9)
 April 2015 Â (9)
 March 2015 Â (13)
 February 2015 Â (10)
 January 2015 Â (18)
 December 2014 Â (10)
 November 2014 Â (10)
 October 2014 Â (7)
 September 2014 Â (3)
 August 2014 Â (9)
 July 2014 Â (5)
 June 2014 Â (1)
 May 2014 Â (9)
 April 2014 Â (1)
 March 2014 Â (3)
 February 2014 Â (5)
 January 2014 Â (13)
 December 2013 Â (5)
 November 2013 Â (5)
 October 2013 Â (4)
 September 2013 Â (1)
 August 2013 Â (10)
 July 2013 Â (10)
 June 2013 Â (5)
 May 2013 Â (4)
 April 2013 Â (10)
 March 2013 Â (4)
 February 2013 Â (12)
 January 2013 Â (6)
 December 2012 Â (2)
 November 2012 Â (4)
 October 2012 Â (1)
 September 2012 Â (3)
 July 2012 Â (3)
 June 2012 Â (3)
 May 2012 Â (8)
 April 2012 Â (2)
 March 2012 Â (5)
 February 2012 Â (6)
 January 2012 Â (4)
 December 2011 Â (7)
 November 2011 Â (7)
 October 2011 Â (6)
 September 2011 Â (3)
 August 2011 Â (3)
 July 2011 Â (6)
 June 2011 Â (4)
 May 2011 Â (4)
 April 2011 Â (5)
 March 2011 Â (5)
 January 2011 Â (2)
 December 2010 Â (6)
 November 2010 Â (5)
 October 2010 Â (3)
 September 2010 Â (4)
 August 2010 Â (5)
 July 2010 Â (6)
 June 2010 Â (2)
 December 2009 Â (1)
 November 2009 Â (1)
 October 2009 Â (3)
 0 Â (1)

Search for:

Search

* [ERNW](https://www.ernw.de)
* [ERNW Research](https://www.ernw-research.de)

[Back](https://insinuator.net/#post-14113)

[Misc](https://insinuator.net/category/misc/)

[December 16, 2022](https://insinuator.net/2022/12/hilarious-buffer-overflow-mitigation-and-tcl-injection-in-checkpoint-gaia-portal/) by [Florian Grunow](https://insinuator.net/author/fgrunow/)

# Hilarious Buffer Overflow Mitigation and TCL Injection in CheckPoint Gaia Portal

[Florian Grunow](https://insinuator.net/author/fgrunow/ "Florian Grunow")

Hey there,

I am going to disclose two bug classes I found a while ago in CheckPoint R77.30: Two buffer overflows in the username (no shit) and HTTP method of a request to the administrative UI pre-auth and some interesting injections into the TCL web interface.

Letâ€™s start with the TCL part. The web interface reacted pretty weird when a payload contained a colon. Diving deeper into this it became clear that a colon would actually cause an error from the TCL interpreter. By going down this rabbit hole and learning some TCL (:D) you could see that injecting a colon breaks some part of the application code, probably because colons are control characters in TCL e.g. preceding a global variable in TCL (::MyVar) or separating namespaces.

Thatâ€™s bad. Reaching a point where the target application is giving you syntax errors because of your input is always a red flag. By diving into this and understanding the application code a bit more it turned out that you can actually set global variables in the TCL environment unauthenticated! A request to the TCL like this
 `GET /cgi-bin/home.tcl?::OMFG=wtf HTTP/1.1`

will set a global variable *OMFG* with the value *wtf*. This behavior can not only be used to set new global variables (that will probably not be useful), but also to set existing ones. There are some that have a direct impact on the application logic, like *MP\_PREFIX*. This can be used to e.g., inject stuff into the response, therefore works like a reflected XSS. This increases the attack surface a lot and I leave it up to the reader to experiment. My assumption is, that the authenticated part will also have a bunch of nice logic flaws that can be abused in a similar way. I never checked. Ping me if you found something nice with this technique. ðŸ™‚

Checkpoint fixed the issue for the unauthenticated part by introducing somet...