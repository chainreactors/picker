---
title: Malware Analysis
url: https://forensicfossil.com/2024/11/malware-analysis-financialsxlsexe
source: Instapaper: Unread
date: 2024-11-22
fetch_date: 2025-10-06T19:23:16.189163
---

# Malware Analysis

![](https://forensicfossil.com/themes/blog/images/logo.png)

## [Forensicfossil](https://forensicfossil.com/)

SOC Analyst Blog

[Twitter](https://twitter.com/forensicfossil)[Instagram](https://instagram.com/forensicfossil)[RSS](https://forensicfossil.com/feed/rss)

Toggle navigation

* [Home](https://forensicfossil.com/)

1. [Home](https://forensicfossil.com/)
»2. [Project](https://forensicfossil.com/category/project)
» Malware Analysis

[![Malware Analysis](https://www.slideteam.net/media/catalog/product/cache/1280x720/m/a/malware_analysis_slide01.jpg)](https://forensicfossil.com/2024/11/malware-analysis-financialsxlsexe)

# Malware Analysis

16 November 2024 - Posted in
[Project](https://forensicfossil.com/category/project) by
[forensicfossil](https://forensicfossil.com/author/forensicfossil)

**MALWARE ANALYSIS:** Malware analysis is the process of examining malicious software to understand its functionality, origin, and potential impact. This involves studying the malware's code, behavior, and structure to identify how it operates, how it spreads, and what kind of harm it can cause.

Malware analysis can be divided into two primary types:

**Static Analysis:**

Examining the malware without executing it. Analysts look at the code, file structure, and other characteristics to gather clues about its functionality. Tools like disassemblers, decompilers, and hex editors are often used in this process.
Note : Basic static analysis does not require that the code is actually run. Instead, static analysis examines the file for signs of malicious intent. It can be useful to identify malicious infrastructure, libraries or packed files.

**Dynamic Analysis:**

Observing the malware's behavior in a controlled environment, like a virtual machine or sandbox, to see how it interacts with the system in real-time. This helps analysts understand the malware's actions, network connections, and any files or registry entries it modifies.
Note: The challenge with dynamic analysis is that adversaries are smart , and they know sandboxes are out there, so they have become very good at detecting them. To deceive a sandbox, adversaries hide code inside them that may remain dormant until certain conditions are met. Only then does the code run.

\*\*

. CASE SCENERIO:

\*\*

An employee, Sarah, from the finance department of XYZ Corporation, received an email with the subject line "Quarterly Financial Review". Attached to the email was a file named "financials.xls". Believing the file contained important data, Sarah opened it. However, she noticed something unusual: the file briefly displayed blank cells before closing itself automatically.

Feeling suspicious, Sarah immediately contacted the IT team, who were tasked with investigating the file for potential malicious intent.

* **STATIC ANALYSIS:**

TridNet: is a tool used to identify file types based on their binary signatures, not just their file extensions.
![TridNet](https://forensicfossil.com/content/images/20241116132524-Picture35.png)

TridNet identified the Excel .xml file as an executable, providing a key clue that the file was compressed using UPX.

* **HXD Analysis:**
  Hex Editor Allows you to view the raw binary data of a file, grouped into bytes and displayed in hexadecimal format. This is useful for seeing exactly what a file contains.

![enter image description here](https://forensicfossil.com/content/images/20241116132912-Picture36.png)

HxD: Opening the file in HxD, I observed a file signature starting with 4D 5A 90 00, which is commonly known as the "MZ" signature. This signature is a strong indicator that the file is a Windows executable (EXE) rather than a PDF. To confirm this, I’ll use the website [file signature](https://garykessler.net/library/file_sigs.html) to look up the hex pattern and verify its classification.

![Confirmed it an executable ](https://forensicfossil.com/content/images/20241116133409-picture37.png)

Hashcalc:
Hash values play a critical role in investigations because they provide a unique identifier for files, making it easy to track and verify them without directly interacting with potentially dangerous contents.

Time to get the hash and upload it, but I learned some organizations use their own tools like VirusTotal so threat actors don’t know they’ve been discovered. This is new to me.

![hash](https://forensicfossil.com/content/images/20241116133715-Picture38.png)

I’ll scan the MD5 hash on VirusTotal since I don’t have access to private scanning tools, lol.

![enter image description here](https://forensicfossil.com/content/images/20241116133831-Picture39.png)

I can see 56 vendors have already flagged this file as malicious, so it’s clearly a well-known malicious document

* **Header Analysis:**

CFF Explorer:
CFF Explorer is a versatile tool designed for examining and editing Portable Executable (PE) files, the standard format for executables in Windows. It offers detailed insights into various aspects of PE files, including headers, sections, imports, exports, and resources.

![header-CFF](https://forensicfossil.com/content/images/20241116134505-Picture40.png)

1. **Key Observations:**
   2.file type : 32-bit Portable Executable (PE)
2. file info: UPX 2.90 [LZMA] (Delphi stub) -> Markus Oberhumer, Laszlo Molnar ...
3. PE Size : The file size is small (42.50 KB), which is typical of packed files.

OPTIONAL HEADER ANALYSIS:

This confirms that it’s a packed file. UPX is a packer used to compress files, making them harder to analyze.

![Packer UPX](https://forensicfossil.com/content/images/20241116201335-Picture42.png)

* Images Based :

The Image Base is a critical field in the Optional Header of a PE file. It specifies the preferred virtual memory address where the operating system should load the file.

Address of Entry Point:
The Address of Entry Point is the address where execution starts. It is given as an RVA (Relative Virtual Address).

Section Headers Analysis:
![packed](https://forensicfossil.com/content/images/20241116202138-Picture43.png)
It obvious this file has been packed so i could unpacked it here using CFF Explorer UPS Utility.

UFX UTILITY:

We could unpack it here, but I’ll be using the command line to unpack it into a new .exe file.

![enter image description here](https://forensicfossil.com/content/images/20241116202353-Picture44.png)

UPX Unpacker :

![unpacked-version](https://forensicfossil.com/content/images/20241116202459-Picture45.png)

Compression Ratio:

75.89%, meaning the packed file is much smaller than the unpacked one.

Packers compress files, obfuscate their contents, and can hide malicious code to evade detection and analysis.

![enter image description here](https://forensicfossil.com/content/images/20241116202851-Picture46.png)

Analysis on the unpacked file:

In CFF Explorer, adding the Image Base and the Address of Entry Point (EntryPoint RVA) gives you the absolute memory address where the program's execution begins once loaded into memory. This helps identify the starting point of the executable code.

![enter image description here](https://forensicfossil.com/content/images/20241116203156-Picture47.png)

* **STRING ANALYSIS:**
  BinText is a lightweight utility designed to extract text strings from binary files. It is particularly valuable for reverse engineering and malware analysis, as it enables analysts to view ASCII and Unicode strings embedded within executables and other binary formats.

![quote ](https://forensicfossil.com/content/images/20241116203527-Picture48.png)

The string includes a scareware message warning the user that their computer is infected, likely designed to pop up after the executable has completed its malicious actions.

![enter image description here](https://forensicfossil.com/content/images/20241116204056-Picture49.png)

I see an IP address and URL in the string. The malware is likely set to reach out to this address after execution, probably connecting to a C2 server for further instructions or data...