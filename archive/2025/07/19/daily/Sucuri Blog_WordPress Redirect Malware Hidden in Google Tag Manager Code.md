---
title: WordPress Redirect Malware Hidden in Google Tag Manager Code
url: https://blog.sucuri.net/2025/07/wordpress-redirect-malware-hidden-in-google-tag-manager-code.html
source: Sucuri Blog
date: 2025-07-19
fetch_date: 2025-10-06T23:39:32.838084
---

# WordPress Redirect Malware Hidden in Google Tag Manager Code

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)

[Login](https://dashboard.sucuri.net/login/)

[Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)

Search for:

Search

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

# WordPress Redirect Malware Hidden in Google Tag Manager Code

[![](https://secure.gravatar.com/avatar/3bb7fb42c6bf04c758d570c2f6bb217266c127e77766dc9d8e6754f15cdd5867?s=60&d=mm&r=g)](https://blog.sucuri.net/author/puja-srivastava)

[Puja Srivastava](https://blog.sucuri.net/author/puja-srivastava)

* July 17, 2025

![WordPress Redirect Malware Hidden in Google Tag Manager Code](https://blog.sucuri.net/wp-content/uploads/2025/07/WordPress-Redirect-Malware-Hidden-in-Google-Tag-Manager-Code-820x385.png)

Last month, a customer contacted us after noticing their WordPress website was unexpectedly redirecting to a spam domain. The redirection occurred approximately 4-5 seconds after a user landed on the site.

Upon closer inspection of the site’s source code we found a suspicious Google Tag Manager loading.

This isn’t the first time we’ve seen GTM abused. Earlier this year, we analyzed a [credit card skimming attack](https://blog.sucuri.net/2025/02/google-tag-manager-skimmer-steals-credit-card-info-from-magento-site.html) where attackers injected a payment skimmer via a GTM container.

This blog post details our full investigation into this campaign, how it was injected, how it worked, and how we removed it.

## What Did We Find?

The infection was not in a theme or plugin file, instead, it was hidden directly inside the WordPress database. The attacker injected a seemingly legitimate Google Tag Manager (GTM) script using a container ID they controlled.

![Google Tag Manager script](https://blog.sucuri.net/wp-content/uploads/2025/07/google-tag-manager-script-scaled.png)

The injected code loaded a remote JavaScript file from:

```
https://www.googletagmanager.com/gtm.js?id=GTM-PL2J2GLH
```

This script redirected the user to a domain **spelletjes**[**.**]**nl** currently known to be associated with spam campaigns. Upon further analysis, we found this GTM container being used across over 200 infected websites (as per data from [PublicWWW](https://publicwww.com/websites/%22spelletjes.nl%22/)).

![redirect destination](https://blog.sucuri.net/wp-content/uploads/2025/07/redirect-destination.png)

The attacker added this code into both the `wp_options` table (under the option name `ihaf_insert_body`) and the `wp_posts` table.

This allowed the attacker to execute malicious behavior without needing access to the file system, making the infection harder to detect through standard file-based scanners.

## Attack Vector & IoCs

The injected script uses a container ID **GTM-PL2J2GLH** and loads the following remote file:

```
hxxps://www[.]googletagmanager[.]com/gtm.js?id=GTM-PL2J2GLH
```

Once loaded, this script executes a client-side redirection using JavaScript:

![attack vector and IoCs](https://blog.sucuri.net/wp-content/uploads/2025/07/attack-vector-and-iocs-scaled.png)

This payload is entirely controlled by the attacker via their GTM account. Because it is hosted on googletagmanager.com, a widely used service, this redirect avoids many common security filters.

## Analysis of the Malware

### Injected JavaScript in wp\_options

The attacker placed the following code inside the `option_value` of the `wp_options` table, using the `option_name` value `ihaf_insert_body` (`ihaf` – “insert headers and footers”, plugin is now called- wpcode). This was likely inserted via the wp-admin panel due to a compromised admin user, via the panel.

![injected JavaScript in wp_options](https://blog.sucuri.net/wp-content/uploads/2025/07/injected-javascript-in-wp_options.png)

The purpose of this loader is to fetch external JavaScript from Google’s CDN, which then executes a redirect on the client side.

### Malicious Redirect Script in GTM Container

The final payload, hosted remotely and controlled by the attacker, was found to contain the malicious redirection script.

```
\u003Cscript type=\"text\/gtmscript\"\u003Ewindow.location.href=\"https:\/\/www.spelletjes[.]nl\/\";\u003C\/script\u003E
```

This Unicode-escaped string decodes to:

```
<script type="text/gtmscript">window.location.href="https://www.spelletjes.nl/";</script>
```

## Impact of the Malware

This infection causes website visitors to be forcibly redirected to **spelletjes**[**.**]**nl**, a site that serves ads and games.

The redirection harms user trust and SEO, damages conversions, and may result in your site being flagged by security scanners or browser warnings. Moreover, it’s highly deceptive because the payload hides within a seemingly legitimate GTM script.

## Remediation S...