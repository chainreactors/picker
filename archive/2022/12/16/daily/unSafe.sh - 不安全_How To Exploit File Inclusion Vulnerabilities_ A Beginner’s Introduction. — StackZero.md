---
title: How To Exploit File Inclusion Vulnerabilities: A Beginner’s Introduction. — StackZero
url: https://buaq.net/go-140167.html
source: unSafe.sh - 不安全
date: 2022-12-16
fetch_date: 2025-10-04T01:39:05.333430
---

# How To Exploit File Inclusion Vulnerabilities: A Beginner’s Introduction. — StackZero

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![]()

How To Exploit File Inclusion Vulnerabilities: A Beginner’s Introduction. — StackZero

This is a summary of the article in my blog: https://stackzero.net/file-inclusion-introduction/In th
*2022-12-15 19:37:41
Author: [infosecwriteups.com(查看原文)](/jump-140167.htm)
阅读量:18
收藏*

---

> This is a summary of the article in my blog: <https://stackzero.net/file-inclusion-introduction/>

In this article, we will be exploring the ins and outs of file inclusion vulnerability exploitation. We will cover what file inclusion vulnerabilities are, how they work, and how hackers can exploit it.

A file inclusion vulnerability is a security flaw that allows an attacker to access/execute arbitrary files on a target system.
We can often find this type of vulnerability in web applications that dynamically include files based on user input.
The lack of appropriate checks could allow the attacker to gain unauthorized access to sensitive data.
File inclusion vulnerabilities can be difficult to detect and protect against, making them a common target for hackers.

Now that we have seen the definition, let’s go a bit deeper and see how it works.

File inclusion works by allowing an application to dynamically include and execute files based on user input. But just to stress more the concept, try to imagine this example:
We consider a hypothetical application that:

* allows users to upload their own profile pictures
* generates a link to the uploaded picture and displays it on the user’s profile page.

However, if the application does not properly validate the file type or the location of the file, an attacker could:

* exploit this by uploading a malicious file and tricking the application into executing it.
* get unauthorized access to some sensitive data

There are two main types of file inclusion vulnerabilities: local file inclusion (LFI) and remote file inclusion (RFI).

1. **Local file inclusion** (LFI) vulnerabilities occur when an attacker can manipulate an application to include and execute files from the local file system. We can find this particular vulnerability in web applications that don’t check for user input and load dynamically some files.
   It can be extremely dangerous when the target application has also an [Unrestricted File Upload](https://stackzero.net/unrestricted-file-upload-vulnerability/) vulnerability as we have seen in the related article.
   The combination of these two vulnerabilities can let an attacker do whatever he wants. In other cases, the vulnerability can be still dangerous but it can have some limits.
2. **Remote file inclusion** (RFI) vulnerabilities occur when an attacker can manipulate an application to include and execute files from a remote location. We can find this vulnerability in applications that dynamically include files from external sources, based on user input. Such as a website that displays user-generated content. An attacker can exploit this type of vulnerability by tricking the application into including and executing a malicious file from a remote server under his control.

In other words:

* **LFI** allows the inclusion of files in the local file system
* With **RFI** the file can be on a remote server.

The difference between directory path traversal and file inclusion is not so clear so, in this introduction, I want to go a bit deeper!

By looking at the web, I noticed that those two vulnerabilities cause a bit of confusion, so I’ll try to explain them at my best!

Path traversal and file inclusion are similar in that they both involve manipulating the file system of a target system. However, they differ in the specific ways that they are exploited and the types of vulnerabilities that they target.

* **Path traversal**, also known as directory traversal, is a type of vulnerability that allows an attacker to access files and directories that are outside of the intended directory structure. The attacker in this case manipulates the file path of a request to access files or directories that should not be visible. For example, an attacker could exploit a path traversal vulnerability by accessing the root directory of a server and viewing sensitive files that are not normally accessible to them.
* **File inclusion**, on the other hand, involves manipulating an application to include and execute files from the file system.

Overall, while both path traversal and file inclusion involve manipulating the file system of a target system, they target different types of vulnerabilities and their exploitation is pretty different.
Summing up, Directory Path Traversal vulnerabilities allow an attacker to access files and directories that are outside of the intended directory structure, while File Inclusion vulnerabilities allow an attacker to include and execute arbitrary files on a target system.
So the main difference is that File Inclusion, as the name says, includes a file and then executes it.

Even if it’s just an introduction to file inclusion vulnerability, I want to show you a practical example of LFI.
Obviously, I’ll try to keep the technical part as little as possible.

First of all, to exploit this vulnerability we want our malicious payload inside the target server. So in order to simulate a real case, I want to couple this vulnerability with the already seen “ [Unrestricted File Upload](https://stackzero.net/unrestricted-file-upload-vulnerability/) “

Here is an example of an application that has these vulnerabilities:

* Local File Inclusion
* Unrestricted File Upload

If you want to run it on your machine, you should have an HTTP server which supports PHP ( [XAMPP](https://www.apachefriends.org/) can be a valid alternative). In this tutorial, I assume you are working on your Kali Machine, so you just need to install PHP by typing this in your terminal and then use the [built-in server](https://www.php.net/manual/en/features.commandline.webserver.php):

```
sudo apt install php libapache2-mod-php
```

Now you can create a file called “index.php” and write this code inside:

```
<?php
// include the file passed as GET parameter
if (isset($_GET['file'])) {
    include($_GET['file']);
}

// upload the file
if (isset($_FILES['file'])) {
    move_uploaded_file($_FILES['file']['tmp_name'], 'uploads/' . $_FILES['file']['name']);
}

?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<body>
    <div class="container">
        <div class="row">

<div class="col-md-6">
                <form action="" method="POST" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="file">Upload file</label>
                        <input type="file" class="form-control" name="file" id="file">
                    </div>
                    <button type="submit" class="btn btn-primary">Submit</button>
                </form>
            </div>
        </div>
    </div>
</body>
</html>
```

This is a PHP script that:

* Handles file uploads
* Includes a file if a `GET` parameter named `file` is set
* Checks if the `file` parameter is set in the `$_GET` superglobal array
* If it is, the script will include the file specified by the parameter.
* Next, the script checks if a file has been uploaded via a `POST` request by checking if the `...