---
title: 网络基础设施安全指南（上）
url: http://blog.nsfocus.net/cyberinfrastructure/
source: 绿盟科技技术博客
date: 2023-06-09
fetch_date: 2025-10-04T11:48:09.666985
---

# 网络基础设施安全指南（上）

* [登录](http://blog.nsfocus.net/wp-login.php)
* [注册](http://blog.nsfocus.net/wp-login.php?action=register)

[![Logo](http://blog.nsfocus.net/wp-content/uploads/2020/07/blog-logo.png)](https://blog.nsfocus.net/)

* [技术产品](https://blog.nsfocus.net/category/technology-product/)
* [数智安全](https://blog.nsfocus.net/category/digital-intelligence-secuirty/)
* [威胁通告](https://blog.nsfocus.net/category/threat-alert/)
* [研究调研](https://blog.nsfocus.net/category/security-research/)
* [洞见RSA](https://blog.nsfocus.net/category/rsac/)
* [公益译文](https://blog.nsfocus.net/category/translation/)
* [安全分享](https://blog.nsfocus.net/category/security-sharing/)

[![Logo](http://blog.nsfocus.net/wp-content/uploads/2020/07/blog-logo.png)](https://blog.nsfocus.net/)

* [技术产品](https://blog.nsfocus.net/category/technology-product/)
* [数智安全](https://blog.nsfocus.net/category/digital-intelligence-secuirty/)
* [威胁通告](https://blog.nsfocus.net/category/threat-alert/)
* [研究调研](https://blog.nsfocus.net/category/security-research/)
* [洞见RSA](https://blog.nsfocus.net/category/rsac/)
* [公益译文](https://blog.nsfocus.net/category/translation/)
* [安全分享](https://blog.nsfocus.net/category/security-sharing/)

# 网络基础设施安全指南（上）

### 网络基础设施安全指南（上）

[2023-06-08](https://blog.nsfocus.net/cyberinfrastructure/ "网络基础设施安全指南（上）")[小蜜蜂翻译组](https://blog.nsfocus.net/author/xiaomifeng/ "View all posts by 小蜜蜂翻译组")

阅读： 1,325

## 一、前言

当前，新漏洞频出，被攻击者加以利用，而安全功能和设备保护方法也与时俱进，不断革新，进而，网络安全指南也要持续更新。错误配置、不当配置处理和弱加密密钥会导致整个网络中的漏洞暴露无遗。所有网络都有被入侵的风险，尤其是设备没有妥善配置和维护时。管理员角色对于保护网络免受攻击至关重要，需要配备专门人员来保护网络上的设备、应用程序和信息。

本报告介绍了总体网络安全和保护网络设备的最佳实践，管理员可以此为参考防止攻击者利用其网络。虽然本文提供的是通用指导，适用于各种网络设备，但仅以思科互联网络操作系统（IOS）设备为例，就所提建议给出了一些示例命令。

**1.1 关于零信任**

“零信任”是一种安全模型、一套系统设计原则以及一种协调的网络安全和系统管理策略，默认传统网络边界内外均存在威胁。美国国家安全局（NSA）完全支持零信任安全模型，本报告中的大部分指导可以按照零信任指南中的建议应用于各种边界。不过，本报告侧重于提供指导，缓解现有网络的常见漏洞和弱点。随着系统负责人引入新网络设计以实现更成熟的零信任原则，本指南也会相应修改。

## 二、网络架构与设计

实现多层防御的安全网络设计对于防御威胁和保护网络内的资源至关重要。对于网络边界设备和内部设备，设计均应遵循安全最佳实践和零信任原则。

**2.1 安装边界和内部防御设备**

网络需要大量的防御策略来保护一个个组件及其包含的信息。应在网络边界实施多层防御，以抵御外部威胁，监控和限制出入流量。

NSA建议根据安全最佳实践在网络边界配置和安装安全设备：

* 安装边界路由器，实现对外部网络（例如互联网服务提供商（ISP））的连接。
* 在整个网络中部署多层下一代防火墙，限制出入流量，检查网络区域之间的所有内部活动。每一层都应该利用不同厂商来防止攻击者利用同一个未修补漏洞进入内部网络。
* 将可公开访问的系统和出站代理放置在一个或多个非军事区（DMZ）子网的防火墙层之间，这样便可合理控制外部设备、DMZ设备和内部系统之间的访问。
* 实施网络监控方案，例如网络入侵检测系统（NIDS）、流量探针或全包捕获设备，记录和跟踪出入流量。
* 部署多个专用远程日志服务器，以便关联不同设备的活动，检测横向移动。
* 在核心区域部署冗余设备，确保可用性。若配置为负载均衡模式，可提高网络吞吐量，降低延时。

**2.2 将相似网络系统归为一组**

网络中的相似系统应在逻辑上分为一组，防止来自其他类型系统的攻击性横向移动。攻击者会针对更容易被利用的系统，如打印机，在进入目标后进一步移动到网络上的其他系统。合理的网络分段可大大降低攻击者进入和利用这些其他系统的能力。此外，若将不同类型的系统按逻辑分组，则它们之间的访问限制会更易于管理、控制和监视。

NSA建议将相似系统划分到子网或虚拟局域网（VLAN），或通过防火墙或过滤路由器物理分隔各子网。工作站、服务器、打印机、电信系统和其他网络外围设备应相互隔离。运营技术，如工业控制系统，通常需要与其他信息技术和高风险网络（如互联网）隔离开来。这种物理隔离提供了更强的保护，因为攻击者要绕过访问限制必须突破子网之间的中间设备。在内部路由器、交换机或防火墙上配置访问限制，仅允许必要端口和协议以执行网络操作或有效完成任务。访问控制列表（ACL）可能需要复制并直接应用于交换机以限制VLAN之间的访问，或者应用于在内部子网之间执行路由的核心路由器。

**2.3 清除后门连接**

后门网络连接位于不同网络区域中的两个或多个设备之间，这些网络区域通常具有不同类型的数据和安全要求。入侵设备后，攻击者可以使用此连接绕过访问限制，进入网络其他区域。外部边界路由器不仅连接到ISP，也直接连接到内部或管理网络，这就是一个后门网络连接。攻击者若能入侵此外部边界路由器，就可能会绕过所有防火墙进入到内部网络。

NSA建议清除所有后门网络连接，并谨慎连接具有多个网络接口的设备。检查设备的所有网络接口是否具有相似安全级别，或者中间设备是否对不同网络区域进行了逻辑和物理隔离。

**2.4 使用严格的边界访问控制**

网络边界设备是安全模型中的基本元素，应互相补充，通过实施ACL来调节网络流量的进出。这些访问控制规则集应明确配置为仅允许支持网络任务所必须的服务和系统。如果防火墙和边界路由器配置的网络安全策略不足，会导致不必要的内部网络进出，增加网络入侵和信息收集的风险。

NSA建议，审慎考虑可以建立哪些连接，配置规则集仅允许哪些连接，同时拒绝其他所有连接。使用这种方法，可以用一条规则拒绝多种连接，而不需要为每个连接创建单独的拒绝规则。若需要动态应用其他边界规则集终止或中断攻击，NSA建议使用入侵防护系统（IPS）。

NSA还建议，此类规则集的日志应至少包括拒绝或丢弃网络流量的所有规则，并包括管理员访问关键设备的成功或失败信息。

**2.5 实施网络访问控制（NAC）方案**

攻击者若想攻入网络，必须通过网络的外部边界或从网络内部获得访问权限。NAC方案可防止未授权物理连接，监控网络上已授权的物理连接。

NSA建议采用NAC方案识别和验证连接到网络的各台设备。端口安全机制可在交换机上实现，及时发现通过设备的媒体访问控制（MAC）地址连接到网络的未授权设备。

然而，端口安全会很难管理。合法网络端口（例如时常更改的联网设备，如会议室）可能被拦截，增加支持工作量。此外，攻击者也能通过欺骗MAC地址绕过这种机制。更稳健的方案是利用802.1X，基于安装在设备上的可信数字证书对设备进行认证。虽然证书的生成和安装加大了方案的实现难度，但它比端口安全更容易管理，提供了更高级别的保证。

**2.6 限制和加密虚拟专用网络（VPN）**

VPN网关通常可以通过互联网访问，容易遭遇网络扫描、暴力尝试和零日漏洞等网络威胁。为防护这些漏洞，管理员应禁用所有不必要的功能，并对流向VPN网关的流量采用严格的流量过滤规则。

NSA建议，根据需要限制VPN网关对用户数据报协议（UDP） 500端口、UDP 4500端口、封装安全负载（ESP）等端口的访问。

尽可能仅接受已知VPN对端IP地址发来的流量。若远程对端IP地址未知，就无法将远程访问VPN添加到静态过滤规则中。若无法将流量匹配到具体IP地址，在VPN网关前面部署IPS来监视畸形IPsec报文，检查IPsec会话协商。

所有IPsec VPN都需要配置IPsec策略和互联网密钥交换（IKE）策略，确定在建立IPsec隧道时的各阶段协商方法。如果将任一阶段配置为允许弱加密，则整个VPN都可能面临风险，数据机密性受到影响。每条IKE策略至少包括三个关键部分：

1. Diffie-Hellman算法/组

2. 加密算法

3. 哈希算法

以下是国家安全系统委员会15号政策（CNSSP 15）的建议最低设置：

* Diffie-Hellman组：16，具有4096位模幂（MODP）
* Diffie-Hellman组：20，具有384位椭圆曲线群（ECP）
* 加密：高级加密标准（AES）-256
* 哈希：安全哈希算法（SHA）-384

根据CNSSP 15的最低要求，Diffie-Hellman 15组也可以接受，但由于已发现互操作性问题，不建议使用。

可以在两个端点之间建立VPN隧道，为不可信网络（如互联网）提供加密信道。在建立VPN方案、策略或转换集时，确保其遵循CNSSP 15建议。CNSSP 15要求在互联网工程任务组（IETF）的《商业国家安全算法（CNSA）套件互联网协议安全（IPsec）加密》文件草案中进行了解释。

为了防止它们无意中被使用，请使用以下配置命令禁用互联网安全关联和密钥管理协议（ISAKMP）和IKEv2的默认策略和提议：

no crypto isakmp default policy

no crypto ikev2 policy default no crypto ikev2 proposal default

no crypto ipsec transform-set default

注意：如果禁用默认策略，则仅使用明确配置的策略。

使用以下示例配置命令建立IKEv2提议、策略和配置文件：

crypto ikev2 proposal

encryption aes-gcm-256 group [16|20]

crypto ikev2 policy

proposal

crypto ikev2 profile match identity remote … authentication remote … authentication local …

配置文件的配置将取决于为其配置的网络，并且必须具有本地和远程身份验证方法以及match语句。还可以建立单独的密钥环，应用于为多个预共享密钥创建的配置文件。

使用以下示例配置命令建立IPsec转换集：

crypto ipsec transform-set esp-gcm 256

mode tunnel

使用以下示例配置命令创建IPsec配置文件，利用上面定义的IKEv2配置文件和IPsec转换集：

crypto ipsec profile

set transform-set

set pfs group16

set ikev2-profile

IPsec配置文件应使用以下配置命令应用于隧道接口：

interface

tunnel protection ipsec profile

no shutdown

## 三、安全维护

老旧的软硬件可能包含已知漏洞，让攻击者可以轻而易举地利用网络。定期将软硬件升级到厂商支持的较新版本，可以缓解这些漏洞。此外，软件下载后，在使用前和使用过程中应验证其完整性。应定期进行安全维护，确保设备持续安全运行。

**3.1 验证软件和配置完整性**

攻击者通过篡改操作系统文件、内存中运行的可执行代码或加载网络设备操作系统的固件或引导加载程序，可将恶意软件引入网络设备。网络设备上的软件被恶意修改后，可能被攻击者用来破坏数据完整性、泄露敏感信息或导致拒绝服务（DoS）。

NSA建议，将文件的加密哈希与厂商发布的已知合法哈希进行比较，验证设备上安装和运行的操作系统文件的完整性。升级操作系统文件时，在安装前后对文件执行相同的完整性验证，确保未进行任何篡改。可以使用以下exec命令在操作系统映像文件上计算基本的在线哈希：

verify /sha512

较老的设备可能只支持消息摘要5（MD5）哈希，可以使用以下exec命令计算这种哈希：

verify /md5

可以将计算出的哈希与https://www.cisco.com/网站支持页面的相关文件信息进行比较。

这些软件修改操作较为复杂，攻击者一般选择更改配置，因为这会比较简单。配置更改可能意味着设备已被入侵。

NSA还建议实施配置更改控制过程，安全创建设备配置备份，用以检测恶意更改。需要更改配置时，记录更改并描述授权、目的和任务理由。将当前设备配置与最近的备份进行比较，定期验证是否存在修改。若发现可疑更改，验证是否经过授权。

**3.2 妥善维护文件系统，进行引导管理**

许多网络设备至少有两种配置，其中一种或多种保存在持久性存储中，一个活动副本运行在内存中。应保存或提交对配置的永久更改，防止设备重启或断电时出现配置不一致。可以使用以下exec命令将配置更改保存在设备上：

copy running-config startup-config

针对临时性更改，NSA建议，在更新的配置行之前插入注释，说明更改原因和计划删除时间，之后根据实际情况删除注释和临时更改。若设备不支持注释，在配置的备份副本中插入注释，与设备上的版本进行比较。远程复制配置时使用加密协议，例如安全文件传输协议（SFTP）或安全复制协议（SCP）。必须保护此备份或归档配置机制以及备份存储库，防止未授权访问。

NSA还建议，检查各台设备上是否存在未使用或不必要的文件，若有，使用以下exec命令删除：

dir /recursive all-filesystems

delete

设备上存储的较老的操作系统文件或备份配置文件很可能不再需要，应予删除。设备上若存在多个版本的软件，攻击者就可能重新加载老旧版本，在较新版本的操作系统中再次引入修补过的漏洞。

**3.3 维护最新的软件和操作系统**

维护最新的操作系统和稳定的软件可防止关键漏洞和安全问题，因为这些漏洞和问题会在新版本修复。运行老旧操作系统或有漏洞软件的设备容易受到各种已知漏洞的影响，攻击者通常利用这些设备进入网络。

NSA建议，将所有设备上的操作系统和软件升级到厂商提供的最新稳定版本。升级操作系统可能需要额外的硬件或内存升级，获得新软件版本可能需要与厂商签订维护或支持合同。大多数网络基础设施设备不支持自动更新功能，需要向厂商申请并安装最新软件。

有关最新思科操作系统的文件列表，参见https://www.cisco.com/网站的支持页面。

**3.4 及时了解厂商支持的硬件**

厂商最终会停止支持某些硬件平台，如果出现故障，这些设备将无法维修。除了设备不稳定和内存需求问题外，由于缺乏软件更新修复已知漏洞，攻击者利用设备的风险也会增加。厂商支持的较新的硬件平台改进了安全功能，包括防护已知漏洞。

NSA建议，一旦厂商发布生命周期终止（End-of-Life）通知或宣布不再支持某个设备，根据厂商建议制定计划，升级为较新设备或更换受影响设备。应立即升级或更换老旧或已停止支持的设备，确保网络服务和安全支持的可用性。

有关思科尚在支持的设备列表，参见https://www.cisco.com/网站的支持页面。

## 四、认证、授权和记账（AAA）

集中式AAA服务器提供了一种综合机制来管理对设备的管理访问，账号对于攻击者来说更难突破，因为凭证并非直接存储在设备上。合理配置这些服务器为管理和监视访问提供了权威来源，提高了访问控制的一致性，减少了配置维护工作量，降低了管理成本。所有设备应首先通过以下示例命令配置为使用最新的AAA服务：

aaa new-model

应用上述配置后，设备将不再使用传统的身份认证和授权方法。

**4.1 实施集中式服务器**

所有设备应配置为使用集中式AAA服务器。NSA建议，在网络上至少安装两台AAA服务器，以确保可用性，协助检测和预防攻击活动。如果一台服务器因定期维护或其他原因不可用，其余服务器可继续提供集中式AAA服务。服务器应：

* 配置为使用专门的复杂预共享密钥对设备进行认证，确保只有经过授权的设备才能使用AAA服务（参见5.6 创建强密码）。
* 配置为使用相同协议（如TACACS+、RADIUS或LDAP）以保证一致性，并尽可能使用加密传输（例如RadSec、DIAMER、LDAPS或IPsec封装）。
* 相互同步，确保用户凭证和访问控制的一致性。

具有多个AAA服务器的服务器组可以使用以下配置命令进行配置：

aaa group server {tacacs+ | radius | ldap}

server-private key

server-private key

一些较老的设备可能在配置中使用关键字tacacs-server或radius-server，这就没法为每个服务器分配单独的密钥。

NSA建议，用上述配置格式替换这些行，并为每个服务器分配一个单独的预共享密钥。若攻击者获得一台服务器的预共享密钥，则需要撤销该密钥，但设备可以继续使用具有不同密钥的其他服务器。

**4.2 配置身份认证**

身份认证是指验证个人或实体的身份。所有设备应首先配置为使用AAA服务的集中式服务器，并且只有在所有集中式服务器不可用时，才使用本地管理员账号。这同样适用于特权级认证；只有在所...