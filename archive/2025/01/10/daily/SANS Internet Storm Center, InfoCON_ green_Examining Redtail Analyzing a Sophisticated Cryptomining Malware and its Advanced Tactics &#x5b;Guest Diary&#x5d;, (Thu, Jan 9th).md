---
title: Examining Redtail Analyzing a Sophisticated Cryptomining Malware and its Advanced Tactics &#x5b;Guest Diary&#x5d;, (Thu, Jan 9th)
url: https://isc.sans.edu/diary/rss/31568
source: SANS Internet Storm Center, InfoCON: green
date: 2025-01-10
fetch_date: 2025-10-06T20:12:07.029121
---

# Examining Redtail Analyzing a Sophisticated Cryptomining Malware and its Advanced Tactics &#x5b;Guest Diary&#x5d;, (Thu, Jan 9th)

# [Internet Storm Center](/)

[Sign In](/login.html)
[Sign Up](/register.html)

Handler on Duty: [Johannes Ullrich](/handler_list.html#johannes-ullrich "Johannes Ullrich")

Threat Level: [green](/infocon.html)

* [previous](/diary/31564)
* [next](/diary/31574)

# [Examining Redtail Analyzing a Sophisticated Cryptomining Malware and its Advanced Tactics [Guest Diary]](/forums/diary/Examining%2BRedtail%2BAnalyzing%2Ba%2BSophisticated%2BCryptomining%2BMalware%2Band%2Bits%2BAdvanced%2BTactics%2BGuest%2BDiary/31568/)

**Published**: 2025-01-09. **Last Updated**: 2025-01-09 01:45:26 UTC
**by** [Guy Bruneau](/handler_list.html#guy-bruneau) (Version: 1)

[2 comment(s)](/diary/Examining%2BRedtail%2BAnalyzing%2Ba%2BSophisticated%2BCryptomining%2BMalware%2Band%2Bits%2BAdvanced%2BTactics%2BGuest%2BDiary/31568/#comments)

[This is a Guest Diary by Cody Hales, an ISC intern as part of the SANS.edu [BACS](https://www.sans.edu/cyber-security-programs/bachelors-degree/) program]

**Introduction**

From August to November 2024, my honeypot has captured a wide array of malicious content. In this analysis, I will focus on a specific strain of malware called redtail and the scripts that enable its execution. redtail is a cryptocurrency mining malware (coin miner) that stealthily installs itself on compromised systems, exploiting the host’s resources for unauthorized cryptocurrency mining to benefit the threat actor. I have observed this malware being executed on my honeypot 4 times by 3 different threat actors.

To execute successfully, redtail utilizes two extra scripts: one script identifies the CPU architecture of the victim system, ensuring compatibility for the malware, and a second script removes any other cryptomining software that may already exist on the compromised system. This dual approach highlights the advanced tactics employed by threat actors to maintain persistence and evade detection.

Using a combination of modern threat intelligence feeds and my own observations, I will shed light on the tactics employed by the threat actors behind these attacks and examine the sophisticated features of coin mining malware currently active. Additionally, I will discuss the broader implications of this analysis, why it is relevant, and how to prevent or mitigate the threat.

**Description of the Subject**

*redtail* is a particularly dangerous piece of malware due to its ability to run on multiple CPU architectures as well as its ability to continuously evolve, significantly broadening the range of devices and hosts it can compromise. As recently as April 2024, a new variant of redtail was documented, exploiting a critical vulnerability in Palo Alto Networks' PAN-OS (CVE-2024-3400). This vulnerability allows a threat actor to create an arbitrary file that could eventually enable command execution with root privileges on the NGFW, bypassing security measures in place [[17](https://www.akamai.com/blog/security-research/2024-redtail-cryptominer-pan-os-cve-exploit)]. The samples analyzed in this post offer a look into variants of *redtail* crypto mining malware actively circulating today.

**Analysis of the Attack Observations**

Based on an initial analysis that began with an earlier attack observation [[19](https://canvas.sans.edu/courses/409/assignments/4080?module_item_id=5346)], on October 15, 2024, at 00:47:54 UTC, a threat actor using IP address 5.182.211.148 connected to the honeypot with the credentials "root/nimda." This was the threat actors’ first and only attempt at gaining access to the honeypot. The threat actor probed a single port, TCP/2222, before establishing the connection. The session ID for this connection was 99c515936ae6. After the threat actor gained access, they uploaded a total of 6 files to the honeypot: clean.sh, redtail.arm7, redtail.arm8,  redtail.i686, redtail.x86\_64, and setup.sh.

![](https://isc.sans.edu/diaryimages/images/Cody_Hales_pic1.png)

The following screen capture for my honeypot shows the command the threat actor ran to install the scripts needed to prepare and run *redtail*.

![](https://isc.sans.edu/diaryimages/images/Cody_Hales_pic2.png)

After gaining access the threat actor makes clean.sh executable via the chmod -x command, then runs the script. This script appears to remove any attempt a previous threat actor has made to install cryptomining software, specifically disabling c3pool\_miner, a Monero cryptomining tool, as well as any malicious cronjobs and scheduled tasks. After the script runs, the threat actor forcefully removes any evidence of the clean.sh script; this is accomplished using the rm -rf command. Below is a screenshot of the clean.sh script captured from my honeypot.

![](https://isc.sans.edu/diaryimages/images/Cody_Hales_pic3.png)

After the clean.sh script is removed, the threat actor follows the same steps to make setup.sh executable, runs the script, and then forcibly removes any evidence that the script was present on the system. Below is a screenshot of the setup.sh script captured from my honeypot. This screenshot will be referenced again later.

![](https://isc.sans.edu/diaryimages/images/Cody_Hales_pic4.png)

After the clean.sh and setup.sh scripts have been run and removed, the threat actor creates a *.ssh* directory, if it does not already exist. The threat actor then uses the chattr (change attribute) command with -ia to remove the immutable and append only attributes for the authorized\_keys file under the .ssh directory. The threat actor then adds a SSH public key to the *authorized\_keys* file by using the echo ssh-rsa ... rsa-key-20230629 command. This allowed the threat actor to gain persistent access without needing a password, establishing a backdoor. Then the chattr +ia command is run to reestablish the immutable and append only attributes to the *authorized\_keys* file. This makes the file more difficult to delete, aiding in maintaining persistence. The uname -a command is run, displaying system information such as kernel version, hostname, and operating system. The final command to be run is echo -e \x61\x75\x74\x68\x5F\x6F\x6B\x0A; using cyberchef to convert the hexadecimal the line reads auth\_ok ( \x61\x75\x74\x68\x5F\x6F\x6B) with a new line (\x0A) [20]. This shows that the SSH key has been added successfully.

Directly after the previous string of commands were run the logs show the 6 files being uploaded over secure FTP on port 69.

![](https://isc.sans.edu/diaryimages/images/Cody_Hales_pic5.png)

Focusing on the *redtail* files, a quick search of the file hash using virustotal shows that they are cryptomining malware. As an example, when the file hash for the first redtail variant (redtail.arm7) is run in virustotal it gets a community score of 31/64 [6].  That virustotal page can be seen in the following screenshot.

![](https://isc.sans.edu/diaryimages/images/Cody_Hales_pic6.png)

**Further Analysis**

From October 15th to November 11th the *redtail* malware attack has been attempted 4 times, all using the same clean.sh and setup.sh scripts and similar redtail files. The first of these attacks was highlighted in the previous section. This threat actor’s IP address, 5.182.211.148, came from The Netherlands, receiving a severity score of 5 of 5, a confidence score of 4 of 5, and a risk score of 4 or 5 by threatstop.com. When the IP was run in virustotal, it received a 10/94 community score [[2](https://www.virustotal.com/gui/ip-address/5.182.211.148/detection)]. Both threatstop and virusetotal confirmed that the IP was from The Netherlands. Below is a screenshot of the whois information for IP address 5.182.211.148 provided by threatstop.com.

![](https://isc.sans.edu/diaryimages/images/Cody_Hales_pic7.png)

The 3 other attacks made to the honeypot were made by two IP addresses 94.103.125.37 and 87.120.113.231, both originating in Bulgaria. These Bulgarian IP addresses had similar virustotal scores to the IP from The Netherlands; 94.103.125.37 received a 7/94 community score [...