---
title: How I Leak Other‚Äôs Access Token by Exploiting Evil Deeplink Flaw
url: https://infosecwriteups.com/how-i-leak-others-access-token-by-exploiting-evil-deeplink-flaw-a0a566677639?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2023-03-14
fetch_date: 2025-10-04T09:28:44.281879
---

# How I Leak Other‚Äôs Access Token by Exploiting Evil Deeplink Flaw

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa0a566677639&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fhow-i-leak-others-access-token-by-exploiting-evil-deeplink-flaw-a0a566677639&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fhow-i-leak-others-access-token-by-exploiting-evil-deeplink-flaw-a0a566677639&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-a0a566677639---------------------------------------)

¬∑

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-a0a566677639---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# How I Leak Other‚Äôs Access Token by Exploiting Evil Deeplink Flaw

[![Crisdeo Nuel Siahaan](https://miro.medium.com/v2/da:true/resize:fill:64:64/0*Bf1zm5UZxOiKCWwf)](https://medium.com/%40k_kisanak?source=post_page---byline--a0a566677639---------------------------------------)

[Crisdeo Nuel Siahaan](https://medium.com/%40k_kisanak?source=post_page---byline--a0a566677639---------------------------------------)

8 min read

¬∑

Mar 13, 2023

--

2

Listen

Share

Press enter or click to view image in full size

![]()

## Introduction

Deep linking has become a crucial aspect of modern mobile app development, allowing for seamless navigation within and between apps. However, this seemingly flawless feature of deep linking can become a point of exploitation due to misconfigurations in many Android apps.

In this article, I‚Äôm going to talk about deep linking and the bug I found that allowed me to steal another user‚Äôs access token. So, let‚Äôs just begin.

## What the deeplink doin?

Have you ever clicked on a link and been taken straight to a specific part of an app? This is called deep linking, and it‚Äôs a big part of how many apps work.

![]()

Deeplink mechanism ([source](https://hackernoon.com/react-native-deep-linking-for-ios-and-android-d33abfba7ef3))

### üìú Deeplink & Exported Activity

A deeplink is a type of hyperlink that can take you directly to a specific page or function within an app instead of just opening the app‚Äôs homepage. Applications usually set the deeplink route by specifying them in *AndroidManifest.xml* file like this:

```
<activity android:name="com.anjay.DeepLinkActivity" android:exported="true">
    <intent-filter>
        <action android:name="android.intent.action.MAIN"/>
        <category android:name="android.intent.category.LAUNCHER"/>
    </intent-filter>
    <intent-filter>
        <action android:name="android.intent.action.VIEW"/>
        <category android:name="android.intent.category.DEFAULT"/>
        <category android:name="android.intent.category.BROWSABLE"/>
        <data android:scheme="anjay" android:host="mantapgan"/>
        <data android:pathPattern="/gaming"/>
    </intent-filter>
</activity>
```

* Deeplink can access `com.anjay.DeepLinkActivity` due to being exported
* `<action android:name="android.intent.action.VIEW"/>` specifies the action of the intent, which is to view data.
* `<category android:name="android.intent.category.DEFAULT"/>` specifies the default category for the intent.
* `<category android:name="android.intent.category.BROWSABLE"/>` specifies that deeplink can access the component by the link on web browser or external application.
* Deeplink form will be: `anjay://mantapgan/gaming`

**Exported activities** (indicated by the `<activity android:exported=‚Äùtrue‚Äù>`attribute) are activities that can be accessed and launched by other apps on the device, and it‚Äôs a requirement for deep linking to work properly.

### üîç WebView

Apps often use WebView to show website content inside an application, such as displaying news articles from different sources in one news app. To make it work, URL must be passed into a WebView so they‚Äôll know which webpage or web application to display.

### üêõ Where‚Äôs the flaw?

The vulnerability I‚Äôm about to present is called **Loading arbitrary URLs in a WebView,** which happened when attacker injects arbitrary URL resulting in the application display the attacker‚Äôs website unintendedly. If JavaScript is enabled, then even an XSS attack can happen on the WebView. It means, The impact of this flaw may be vary, depending on the app.

Deeplinks are one of the features that can be the ‚Äúgate‚Äù that allows malicious URLs to be injected into WebView function. In some cases, deeplinks can control WebView through parameters such as `url`, `extra_url`, `link`, `redirect`, or `page` which will act as URIs that will be passed into the WebView loader. **If we can modify these parameters that we have supplied and there is no validation for the URL, so that WebView is able to access any URL**‚Ä¶ then congratulations, it‚Äôs likely a bug üéâüéâ.

Press enter or click to view image in full size

![]()

Loading arbitrary URLs in a WebView

### üõ°Ô∏è How to protect?

Validating the URL passed to a WebView is crucial to ensure that the intended website is opened and to prevent potential security risks such as phishing or malware attacks. Therefore, it is recommended that developers perform proper URL validation before loading the URL in the WebView component of their application.

## The Bug

The target is an Donation and Fundraising application from my country. Unfortunately, due to the non-disclosure policy let‚Äôs call the application as **redacted** okay? üòâ

Initially, I used **jadx-gui** to decompile and analyze the APK file. After decompiling the APK, I examined the *AndroidManifest.xml* file to identify **exported activities**. There‚Äôs one of them that look like this:

```
<activity android:theme="@style/AppTheme.Transparent" android:name="com.redacted.android.ui.deeplink.DeepLinkActivity" android:exported="true">
    <intent-filter android:autoVerify="true">
        <action android:name="android.intent.action.VIEW"/>
        <category android:name="android.intent.category.DEFAULT"/>
        <category android:name="android.intent.category.BROWSABLE"/>
        <data android:scheme="https" android:host="redacted.com"/>
        <data android:path=""/>
        <data android:path="/"/>
        <data android:pathPattern="/mydonation"/>
        <data android:pathPattern="/inbox"/>
        <data android:pathPattern="/help"/>
        <data android:pathPattern="/contact"/>
    </intent-filter>
    <intent-filter android:autoVerify="true">
        <action android:name="android.intent.action.VIEW"/>
        <category android:name="android.intent.category.DEFAULT"/>
        <category android:name="android.intent.category.BROWSABLE"/>
        <data android:scheme="rdct"/>
    </intent...