---
title: Exploit Development – A Sincere Form of Flattery
url: https://www.blackhillsinfosec.com/exploit-development-a-sincere-form-of-flattery/
source: Black Hills Information Security
date: 2023-02-10
fetch_date: 2025-10-04T06:13:44.442435
---

# Exploit Development – A Sincere Form of Flattery

[![Black Hills Information Security, Inc.](https://www.blackhillsinfosec.com/wp-content/uploads/2025/03/BHIS_TEXT_BHIS.png)](https://www.blackhillsinfosec.com "Black Hills Information Security, Inc.")

[RSS](https://www.blackhillsinfosec.com/feed/)

* [All Services](https://www.blackhillsinfosec.com/services/)
  + [Complete Service Guide](https://www.blackhillsinfosec.com/services/complete-service-guide/)
  + [Active SOC](https://www.blackhillsinfosec.com/services/active-soc/)
  + [AI Security Assessments](https://www.blackhillsinfosec.com/services/ai-security-assessments/)
  + [Blockchain Security](https://www.blackhillsinfosec.com/services/blockchain-security/)
  + [Blue Team Services](https://www.blackhillsinfosec.com/services/blue-team-services/)
  + [Continuous Penetration Testing](https://www.blackhillsinfosec.com/services/antisoc/)
  + [High-Profile Risk Assessments](https://www.blackhillsinfosec.com/services/high-profile-risk-assessments/)
  + [Incident Response](https://www.blackhillsinfosec.com/services/incident-response/)
  + [Penetration Testing](https://www.blackhillsinfosec.com/services/)
* [Contact Us](https://www.blackhillsinfosec.com/contact-us/)
  + [Contact Us](https://www.blackhillsinfosec.com/contact-us/)
  + [Email Sign-Up](https://mailchi.mp/blackhillsinfosec.com/bhis-sign-up)
* [About Us](https://www.blackhillsinfosec.com/who-we-are/)
  + [Security Consultants](https://www.blackhillsinfosec.com/about/security-analysts/)
  + [Admin](https://www.blackhillsinfosec.com/about/admin-staff/)
  + [SOC Team](https://www.blackhillsinfosec.com/about/soc-team/)
  + [BHIS Family of Companies](https://www.blackhillsinfosec.com/bhis-tribe-of-companies/)
* [Free Resources](https://www.blackhillsinfosec.com/free-cybersecurity-tools/)
  + [Blogs](https://www.blackhillsinfosec.com/blog/)
  + [Free Cybersecurity Tools](https://www.blackhillsinfosec.com/free-cybersecurity-tools/)
  + [Free Cybersecurity Webcasts](https://www.blackhillsinfosec.com/free_cybersecurity_webcasts/)
  + [Podcasts](https://podcasts.apple.com/us/podcast/black-hills-information-security/id1410835265)
  + [RITA](https://www.activecountermeasures.com/free-tools/rita/)
* [Training](https://www.blackhillsinfosec.com/bhis-and-antisyphon-training/)
  + [BHIS & Antisyphon Training](https://www.blackhillsinfosec.com/bhis-and-antisyphon-training/)
  + [WWHF Conference](https://wildwesthackinfest.com)
* [Online Community](https://blackhillsinfosec.com/community)
  + [Discord](https://discord.gg/BHIS)
  + [LinkedIn](https://www.linkedin.com/company/black-hills-information-security/)
  + [YouTube](https://www.youtube.com/c/BlackHillsInformationSecurity/videos)
  + [Bluesky](https://bsky.app/profile/bhinfosecurity.bsky.social)
  + [Twitter/X](https://twitter.com/BHinfoSecurity)
  + [Upcoming Events](https://blackhillsinfosec.com/events)
* [Fun Stuff](https://spearphish-general-store.myshopify.com/)
  + [Backdoors & Breaches](https://www.blackhillsinfosec.com/tools/backdoorsandbreaches/)
  + [Merch, Zines & More](https://spearphish-general-store.myshopify.com/)
  + [PROMPT# Zine](https://www.blackhillsinfosec.com/prompt-zine/)
  + [REKCAH](https://www.blackhillsinfosec.com/rekcah/)
  + [Books](https://www.blackhillsinfosec.com/tools/books/)

9
Feb
2023

[Informational](https://www.blackhillsinfosec.com/category/informational/), [moth](https://www.blackhillsinfosec.com/category/author/moth/)
[Exploit Development](https://www.blackhillsinfosec.com/tag/exploit-development/), [Python](https://www.blackhillsinfosec.com/tag/python/), [Scapy](https://www.blackhillsinfosec.com/tag/scapy/), [TCPDump](https://www.blackhillsinfosec.com/tag/tcpdump/), [Vulnerability](https://www.blackhillsinfosec.com/tag/vulnerability/), [Wireshark](https://www.blackhillsinfosec.com/tag/wireshark/)

# [Exploit Development – A Sincere Form of Flattery](https://www.blackhillsinfosec.com/exploit-development-a-sincere-form-of-flattery/)

[moth](https://github.com/0x6d6f7468) //

![](https://www.blackhillsinfosec.com/wp-content/uploads/2023/02/BLOG_chalkboard_-1-1024x576.png)

Recently, BHIS penetration tester Dale Hobbs was on an Internal Network Penetration Test and came across an RPC-based arbitrary command execution vulnerability in his vulnerability scan results.

![](https://www.blackhillsinfosec.com/wp-content/uploads/2023/02/Picture1-1.png)

**Nessus Plugin ID 59642**

I had mentioned in passing that I was working on learning more about remote procedure calls, and Dale invited me to take a look at this vulnerability with him, an invitation that I happily accepted.

Quick disclaimer before the party starts: All credit to the initial disclosure of this vulnerability goes to Ron Bowes and Tenable. Even though this vulnerability is 10 years old at this point, this blog post will unfortunately not be accompanied by exploit code in order to protect Tenable’s intellectual property rights. For the same reason, specific exploit bytes are also redacted in cases where they were taken directly from packet captures. While I would love to eventually release the exploit code to the public for the benefit of other information security practitioners, this blog post instead focuses on the process of creating (and more importantly troubleshooting) exploit development.

With all of that out of the way — it’s party time.

## Vulnerability Details

Let’s start this adventure by looking at what Nessus has to say about this vulnerability. [Nessus Plugin ID 59642](https://www.tenable.com/plugins/nessus/59642) details that the vulnerability allows privileged command execution through an unauthenticated RPC interface.

![](https://www.blackhillsinfosec.com/wp-content/uploads/2023/02/Picture2-1.png)

**Vulnerability Details**

Sounds relatively simple, but I’ve been burnt by assumptions of simplicity countless times before this. Before getting too eager, let’s take a look at what other information is available regarding the vulnerability. The upSploit URL in the references section looks promising, so let’s go there first and—

![](https://www.blackhillsinfosec.com/wp-content/uploads/2023/02/Picture3-1.png)

**Unable to Browse to upSploit.com**

Oh. Ok, maybe the Internet Archive has a reference to it. Plugging in the URL, there turned out to be a single copy of the page, saved in 2013.

![](https://www.blackhillsinfosec.com/wp-content/uploads/2023/02/Picture4-1.png)

**Archive Search Results for Vulnerability Disclosure**

Well, let’s take a look and see what we’re working with. According to the [archived article](https://web.archive.org/web/20131025050111/https%3A//www.upsploit.com/index.php/advisories/view/UPS-2012-0012), a typical exploit connection looks something like the following:

* Select the vulnerable interface, `unidata72`
* Authenticate (opcode 0x04)
* Perform operations such as running OS commands (opcode 0x06)

Alright, that’s a start, but it’d be really cool to see how Nessus is exploiting this vulnerability. According to Tenable, there are no known exploits available for the vulnerability.

![](https://www.blackhillsinfosec.com/wp-content/uploads/2023/02/Picture5-1.png)

**No Known Exploits Available**

Maybe looking at their script source code will give some insights, as can often be done for other findings during a test. Looking at the plugin file name will show us where to look and—

![](https://www.blackhillsinfosec.com/wp-content/uploads/2023/02/Picture6-1.png)

**Nessus Script Filename**

Ah. Uncool. From what I’ve read, an `nbin` file is a compiled Nessus file format that allows vendors to provide proof-of-concept code without disclosing the technical details to everybody. A good idea, but frustrating to run into while testing. Clearly, Nessus has some secret sauce going on, because the vulnerability scan shows that the `ipconfig` Windows command was successfully executed, and the output was received.

![](https://www.blackhillsinfosec.com/wp-content/uploads/2023/02/Picture7-1.png)

**Vulnerability Exploited by Nes...