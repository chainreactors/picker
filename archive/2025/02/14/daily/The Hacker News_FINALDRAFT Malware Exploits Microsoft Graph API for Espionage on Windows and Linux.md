---
title: FINALDRAFT Malware Exploits Microsoft Graph API for Espionage on Windows and Linux
url: https://thehackernews.com/2025/02/finaldraft-malware-exploits-microsoft.html
source: The Hacker News
date: 2025-02-14
fetch_date: 2025-10-06T20:39:44.766601
---

# FINALDRAFT Malware Exploits Microsoft Graph API for Espionage on Windows and Linux

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [FINALDRAFT Malware Exploits Microsoft Graph API for Espionage on Windows and Linux](https://thehackernews.com/2025/02/finaldraft-malware-exploits-microsoft.html)

**Feb 13, 2025**Ravie LakshmananMalware / Cyber Espionage

[![FINALDRAFT Malware](data:image/png;base64... "FINALDRAFT Malware")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhenQjv3GBgM3Pgd6Me8TJzUxlT7kfqm6qa8VAdEPRYYHZzGDLJWDd8E-Fqw_HSSXksB2rqQ41HwYYdW5vpX6CAkq08b4-Juq0ltt4GSzKTCQ-XWdwbQHa7URTf2ZrLJpWespjvS1aD8kmc5RunhRZ6UX58ygEShTTT6JMt2Ob9VvWitGBxa_vLduz-fUJq/s790-rw-e365/malware.png)

Threat hunters have shed light on a new campaign targeting the foreign ministry of an unnamed South American nation with bespoke malware capable of granting remote access to infected hosts.

The activity, detected in November 2024, has been attributed by Elastic Security Labs to a threat cluster it tracks as **REF7707**. Some of the other targets include a telecommunications entity and a university, both located in Southeast Asia.

"While the REF7707 campaign is characterized by a well-engineered, highly capable, novel intrusion set, the campaign owners exhibited poor campaign management and inconsistent evasion practices," security researchers Andrew Pease and Seth Goodwin [said](https://www.elastic.co/security-labs/fragile-web-ref7707) in a technical analysis.

[![DFIR Retainer Services](data:image/png;base64...)](https://thehackernews.uk/cloud-insight-d)

The exact initial access vector used in the attacks is currently not clear, although it has been observed that Microsoft's [certutil application](https://thehackernews.com/2024/04/hackers-exploit-fortinet-flaw-deploy.html) is used to download additional payloads from a web server associated with the Foreign Ministry.

The certutil commands used to retrieve the suspicious files have been found to be executed via the Windows Remote Management's Remote Shell plugin ([WinrsHost.exe](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/winrs)) from an unknown source system on a connected network.

"It indicates that attackers already possessed valid network credentials and were using them for lateral movement from a previously compromised host in the environment," the researchers noted.

The first of the files to be executed is a malware named PATHLOADER that allows for the execution of encrypted shellcode received from an external server. The extracted shellcode, dubbed FINALDRAFT, is subsequently injected into the memory of a newly-spawned "mspaint.exe" process.

[![](data:image/png;base64...)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg4uAx-2SdfTCyYukJa1jxjILtRHQWXZOmMUpYmGITEBQbZI2t7V_-qU-f4kA_j-E3Dl9I_vomobg2ALwkQxlpO1_ckWc48QoVFnVWLPYdbHt4zs5mdPWPB7NMW7uPEg-eOy41tOiBjjzwQK1NFRpcRRIQf8utOW5V966FE8v9YQnTMK4qATrX-O_SL73Wz/s790-rw-e365/es.png)

Written in C++, [FINALDRAFT](https://www.elastic.co/security-labs/finaldraft) is a full-featured remote administration tool that comes fitted with capabilities to execute additional modules on the fly and abuses the Outlook email service via the Microsoft Graph API for command-and-control (C2) purposes. It's worth noting that the abuse of the Graph API has been previously detected in another backdoor named [SIESTAGRAPH](https://thehackernews.com/2023/03/new-naplistener-malware-used-by-ref2924.html).

The communication mechanism entails parsing the commands stored in the mailbox's drafts folder and writing the results of the execution into new draft emails for each command. FINALDRAFT registers 37 command handlers that are designed around process injection, file manipulation, and network proxy capabilities.

[![CIS Build Kits](data:image/png;base64...)](https://thehackernews.uk/platform-shield-d)

It's also engineered to start new processes with [stolen NTLM hashes](https://thehackernews.com/2024/11/russian-hackers-exploit-new-ntlm-flaw.html) and execute PowerShell commands in a manner such that it does not invoke the "powershell.exe" binary. Instead, it patches several APIs to evade event tracing for Windows ([ETW](https://thehackernews.com/2023/04/ransomware-hackers-using-aukill-tool-to.html)) and launches [PowerPick](https://github.com/PowerShellEmpire/PowerTools/tree/master), a [legitimate utility](https://medium.com/%40polygonben/unmasking-defence-evasion-unmanaged-powershell-c-net-process-injection-88d1f1a180d5) that's part of the Empire post-exploitation toolkit.

ELF binary artifacts uploaded to VirusTotal from Brazil and the United States indicate the presence of a Linux variant of FINALDRAFT that features similar C2 functionality. The Linux version, for its part, can execute shell commands via [popen](https://www.man7.org/linux/man-pages/man3/popen.3.html) and delete itself from the system.

"The completeness of the tools and the level of engineering involved suggest that the developers are well-organized," the researchers said. "The extended time frame of the operation and evidence from our telemetry suggest it's likely an espionage-oriented campaign."

### Update

Palo Alto Networks Unit 42, which is tracking REF7707 under the moniker CL-STA-0049, said the suspected Chinese activity cluster has targeted governments, defense, telecommunication, education and aviation sectors in Southeast Asia and South America since at least March 2023.

"The observed activity includes collecting sensitive information from compromised organizations, as well as obtaining information about high-ranking officials and individuals at those organizations," security researchers Lior Rochberger and Tom Fakterman [said](https://unit42.paloaltonetworks.com/advanced-backdoor-squidoor/).

The attack chains are known to weaponize vulnerabilities in Internet Information Services (IIS) servers to drop web shells, allowing the threat actors to remotely access and deploy a sophisticated backdoor dubbed FINALDRAFT (aka Squidoor) that's capable of infecting both Windows and Linux systems.

It's capable of maintaining access, lateral movement, creating cov...