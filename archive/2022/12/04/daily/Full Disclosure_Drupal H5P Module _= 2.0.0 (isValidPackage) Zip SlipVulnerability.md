---
title: Drupal H5P Module <= 2.0.0 (isValidPackage) Zip Slip	Vulnerability
url: https://seclists.org/fulldisclosure/2022/Dec/0
source: Full Disclosure
date: 2022-12-04
fetch_date: 2025-10-04T00:29:46.076542
---

# Drupal H5P Module <= 2.0.0 (isValidPackage) Zip Slip	Vulnerability

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)

[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)

## [Full Disclosure](/fulldisclosure/) mailing list archives

![Previous](/images/left-icon-16x16.png)
[By Date](date.html#0)
[![Next](/images/right-icon-16x16.png)](1)

![Previous](/images/left-icon-16x16.png)
[By Thread](index.html#0)
[![Next](/images/right-icon-16x16.png)](1)

![](/shared/images/nst-icons.svg#search)

# Drupal H5P Module <= 2.0.0 (isValidPackage) Zip Slip Vulnerability

---

*From*: Egidio Romano <research () karmainsecurity com>
*Date*: Sat, 03 Dec 2022 15:31:55 +0100

---

```
------------------------------------------------------------------
Drupal H5P Module <= 2.0.0 (isValidPackage) Zip Slip Vulnerability
------------------------------------------------------------------

[-] Software Link:

https://www.drupal.org/project/h5p

[-] Affected Versions:

Version 2.0.0-alpha2 and prior versions.
Version 7.x-1.50 and prior versions.

[-] Vulnerability Description:
```

The vulnerability is located within the H5PValidator::isValidPackage()
method. This implements the following check in order to skip any file or
folder starting with a dot or underscore within the uploaded h5p
archive:

```
891.    $fileName = $zip->statIndex($i)['name'];
892.
893.    if (preg_match('/(^[\._]|\/[\._])/', $fileName) !== 0) {
894.      continue; // Skip any file or folder starting with a . or _
894.    }
```

This regex check should be enough to prevent path traversal attacks
through zipped filenames (Zip Slip attacks), because it checks for the
string “/.” within the filename, thus preventing directory traversal
attacks. However, the vulnerability exists if Drupal is running on a
Windows server, because in this case the attacker can provide a
malicious h5p archive containing a filename with path traversal
sequences like “..\..\..”, which would bypass the above regex check.
This can be exploited to write (or overwrite) semi-arbitrary files in
the file system via directory traversal sequences, potentially leading
to Stored Cross-Site Scripting (XSS) and other kind of attacks.

```
[-] Solution:

No official solution is currently available.

[-] Disclosure Timeline:

[22/11/2021] - Vendor notified
[28/02/2022] - Vendor proposed a possible patch
```

[28/02/2022] - Vendor notified about the ineffective patch, provided a
fix suggestion

```
[01/03/2022] - Vendor fixed the previous patch
```

[30/03/2022] - Asked update about the public disclosure and release of a
patch, no response

```
[22/11/2022] - After one year still no official solution available
[03/12/2022] - Public disclosure

[-] CVE Reference:

The Common Vulnerabilities and Exposures project (cve.mitre.org)
has not assigned a CVE identifier for this vulnerability.

[-] Credits:

Vulnerability discovered by Egidio Romano.

[-] Other References:

https://security.drupal.org/node/175968

[-] Original Advisory:

http://karmainsecurity.com/KIS-2022-06

_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: https://seclists.org/fulldisclosure/
```

---

![Previous](/images/left-icon-16x16.png)
[By Date](date.html#0)
[![Next](/images/right-icon-16x16.png)](1)

![Previous](/images/left-icon-16x16.png)
[By Thread](index.html#0)
[![Next](/images/right-icon-16x16.png)](1)

### Current thread:

* **Drupal H5P Module <= 2.0.0 (isValidPackage) Zip Slip Vulnerability** *Egidio Romano (Dec 03)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")