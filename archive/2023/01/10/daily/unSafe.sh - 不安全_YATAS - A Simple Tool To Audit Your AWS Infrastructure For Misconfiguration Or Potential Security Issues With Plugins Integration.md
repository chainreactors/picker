---
title: YATAS - A Simple Tool To Audit Your AWS Infrastructure For Misconfiguration Or Potential Security Issues With Plugins Integration
url: https://buaq.net/go-144816.html
source: unSafe.sh - 不安全
date: 2023-01-10
fetch_date: 2025-10-04T03:22:56.801598
---

# YATAS - A Simple Tool To Audit Your AWS Infrastructure For Misconfiguration Or Potential Security Issues With Plugins Integration

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/acd785b93318314e8929c2b050dcefd9.jpg)

YATAS - A Simple Tool To Audit Your AWS Infrastructure For Misconfiguration Or Potential Security Issues With Plugins Integration

Yet Another Testing & Auditing Solution The goal of YATAS is to help you create a secure AW
*2023-1-9 19:30:0
Author: [www.kitploit.com(查看原文)](/jump-144816.htm)
阅读量:56
收藏*

---

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhq0kdY68KN0eLA32TY_se4mdqhpiGwWAY3YISwU2SvIP5Kinsax9MQKY_ADXHJ0KbNk_05dSXWvOfqDOMGD6ByNRX6qLsJV37g58qoIZ2bUG9qG02jl0jwhzkzymuiZbJE4QbQ3W6qh3YvOhXXZV33YPICF8Yc0F37eJXkpUxMBqZj6hEP4E1lbbH1AQ/s320/YATAS_1_auditory.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhq0kdY68KN0eLA32TY_se4mdqhpiGwWAY3YISwU2SvIP5Kinsax9MQKY_ADXHJ0KbNk_05dSXWvOfqDOMGD6ByNRX6qLsJV37g58qoIZ2bUG9qG02jl0jwhzkzymuiZbJE4QbQ3W6qh3YvOhXXZV33YPICF8Yc0F37eJXkpUxMBqZj6hEP4E1lbbH1AQ/s500/YATAS_1_auditory.png)

Yet Another Testing & Auditing Solution

The goal of YATAS is to help you create a secure AWS environment without too much hassle. It won't check for all best practices but only for the ones that are important for you based on my experience. Please feel free to tell me if you find something that is not covered.

## Features

YATAS is a simple and [easy to use](https://www.kitploit.com/search/label/Easy%20To%20Use "easy to use") tool to audit your [infrastructure](https://www.kitploit.com/search/label/Infrastructure "infrastructure") for [misconfiguration](https://www.kitploit.com/search/label/Misconfiguration "misconfiguration") or potential security issues.

[![](https://blogger.googleusercontent.com/img/a/AVvXsEijdeVVF48QLdcUUYZA2OkUrsAgNqF_K4zqP5k1llwa77PTNe7MkaK-5652rtpWw5ezVSUSomKqRrJ-i4QSFbBBbX75-JBqabaKCHCGTlShu5-0WmeJPpKXO3N16fTrFb7wj2O4eS82k0vmQqfRCsQ5gtVgKcUHeitY77ySiApXQ4Km22lNpDf6sTmkCg=w640-h444)](https://blogger.googleusercontent.com/img/a/AVvXsEijdeVVF48QLdcUUYZA2OkUrsAgNqF_K4zqP5k1llwa77PTNe7MkaK-5652rtpWw5ezVSUSomKqRrJ-i4QSFbBBbX75-JBqabaKCHCGTlShu5-0WmeJPpKXO3N16fTrFb7wj2O4eS82k0vmQqfRCsQ5gtVgKcUHeitY77ySiApXQ4Km22lNpDf6sTmkCg)

| No details | Details |
| --- | --- |
| [![](https://blogger.googleusercontent.com/img/a/AVvXsEga5pVn5AEon5Bnsoc7qtzM_Y1-X5TdmN8Tywl-Goup3TYGLDC8ePJxoVubDg-9PaqZBPPVnqde0pWZbFG1efh9yS5MUYGneF7EsJDMIDmUye_Pry3YUsl7Ieh_Q1perVezRupnNHmFY_lbgawmn1fbW18raTN7w9alh46PjZu7lDOIScnIxq4c0CW3Kw=s320)](https://blogger.googleusercontent.com/img/a/AVvXsEga5pVn5AEon5Bnsoc7qtzM_Y1-X5TdmN8Tywl-Goup3TYGLDC8ePJxoVubDg-9PaqZBPPVnqde0pWZbFG1efh9yS5MUYGneF7EsJDMIDmUye_Pry3YUsl7Ieh_Q1perVezRupnNHmFY_lbgawmn1fbW18raTN7w9alh46PjZu7lDOIScnIxq4c0CW3Kw) | [![](https://blogger.googleusercontent.com/img/a/AVvXsEi3XKWCBtVNxbhZsF3T44IEtmuZiS-kFd094UWPx0rrJwlOMb3JgpcXhDf1vLag7b_ojMQp_7eeS2erHlRkdQGdiZ9zVftm184QZtJyyUo5dTC9huPzYBzyh_kr_7eXOy8Q0qaBfcGKI-h4IdgY6XKMeKgzatFmWjF9H48djndSFp1cLwviN7KRwoWPvw=s320)](https://blogger.googleusercontent.com/img/a/AVvXsEi3XKWCBtVNxbhZsF3T44IEtmuZiS-kFd094UWPx0rrJwlOMb3JgpcXhDf1vLag7b_ojMQp_7eeS2erHlRkdQGdiZ9zVftm184QZtJyyUo5dTC9huPzYBzyh_kr_7eXOy8Q0qaBfcGKI-h4IdgY6XKMeKgzatFmWjF9H48djndSFp1cLwviN7KRwoWPvw) |

## Installation

```
brew tap padok-team/tap
```

Modify .yatas.yml to your needs.

Installs the plugins you need.

## Usage

Flags:

* `--details`: Show details of the issues found.
* `--compare`: Compare the results of the previous run with the current run and show the differences.
* `--ci`: Exit code 1 if there are issues found, 0 otherwise.
* `--resume`: Only shows the number of tests passing and failing.
* `--time`: Shows the time each test took to run in order to help you find bottlenecks.
* `--init`: Creates a .yatas.yml file in the current directory.
* `--install`: Installs the plugins you need.
* `--only-failure`: Only show the tests that failed.

## Plugins

| Plugins | Description | Checks |
| --- | --- | --- |
| [*AWS Audit*](https://github.com/padok-team/yatas-aws "<g-emoji alias=owl class=g-emoji fallback-src=https://github.githubassets.com/images/icons/emoji/unicode/1f989.png>&#129417;</g-emoji><g-emoji alias=mag_right class=g-emoji fallback-src=https://github.githubassets.com/images/icons/emoji/unicode/1f50e.png>&#128270;</g-emoji> A simple tool to audit your AWS infrastructure for misconfiguration or potential security issues with plugins integration (10)") | AWS checks | Good practices and security checks |
| [*Markdown Reports*](https://github.com/padok-team/yatas-markdown "<g-emoji alias=owl class=g-emoji fallback-src=https://github.githubassets.com/images/icons/emoji/unicode/1f989.png>&#129417;</g-emoji><g-emoji alias=mag_right class=g-emoji fallback-src=https://github.githubassets.com/images/icons/emoji/unicode/1f50e.png>&#128270;</g-emoji> A simple tool to audit your AWS infrastructure for misconfiguration or potential security issues with plugins integration (11)") | Reporting | Generates a markdown report |

## Checks

### Ignore results for known issues

You can ignore results of checks by adding the following to your `.yatas.yml` file:

```
ignore:
  - id: "AWS_VPC_004"
    regex: true
    values:
      - "VPC Flow Logs are not enabled on vpc-.*"
  - id: "AWS_VPC_003"
    regex: false
    values:
      - "VPC has only one gateway on vpc-08ffec87e034a8953"
```

### Exclude a test

You can exclude a test by adding the following to your `.yatas.yml` file:

```
plugins:
  - name: "aws"
    enabled: true
    description: "Check for AWS good practices"
    exclude:
      - AWS_S3_001
```

### Specify which tests to run

To only run a specific test, add the following to your `.yatas.yml` file:

```
plugins:
  - name: "aws"
    enabled: true
    description: "Check for AWS good practices"
    include:
      - "AWS_VPC_003"
      - "AWS_VPC_004"
```

### Get error logs

You can get the error logs by adding the following to your env variables:

```
export YATAS_LOG_LEVEL=debug
```

The available log levels are: `debug`, `info`, `warn`, `error`, `fatal`, `panic` and `off` by default

## AWS - 63 Checks

### AWS Certificate Manager

* AWS\_ACM\_001 ACM [certificates](https://www.kitploit.com/search/label/Certificates "certificates") are valid
* AWS\_ACM\_002 ACM certificate expires in more than 90 days
* AWS\_ACM\_003 ACM certificates are used

### APIGateway

* AWS\_APG\_001 ApiGateways logs are sent to Cloudwatch
* AWS\_APG\_002 ApiGateways are protected by an ACL
* AWS\_APG\_003 ApiGateways have tracing enabled

### AutoScaling

* AWS\_ASG\_001 Autoscaling maximum capacity is below 80%
* AWS\_ASG\_002 Autoscaling group are in two availability zones

### Backup

* AWS\_BAK\_001 EC2's Snapshots are encrypted
* AWS\_BAK\_002 EC2's snapshots are younger than a day old

### Cloudfront

* AWS\_CFT\_001 Cloudfronts enforce TLS 1.2 at least
* AWS\_CFT\_002 Cloudfronts only allow HTTPS or redirect to HTTPS
* AWS\_CFT\_003 Cloudfronts queries are logged
* AWS\_CFT\_004 Cloudfronts are logging Cookies
* AWS\_CFT\_005 Cloudfronts are protected by an ACL

### CloudTrail

* AWS\_CLD\_001 Cloudtrails are encrypted
* AWS\_CLD\_002 Cloudtrails have Global Service Events Activated
* AWS\_CLD\_003 Cloudtrails are in multiple regions

### COG

* AWS\_COG\_001 Cognito allows unauthenticated users

### DynamoDB

* AWS\_DYN\_001 Dynamodbs are encrypted
* AWS\_DYN\_002 Dynamodb have continuous backup enabled with PITR

### EC2

* AWS\_EC2\_001 EC2s don't have a public IP
* AWS\_EC2\_002 EC2s have the monitoring option enabled

### ECR

* AWS\_ECR\_001 ECRs image are scanned on push
* AWS\_ECR\_002 ECRs are encrypted
* AWS\_ECR\_003 ECRs tags are immutable

### EKS

* AWS\_EKS\_001 EKS clusters have logging enabled
* AWS\_EKS\_002 EKS clus...