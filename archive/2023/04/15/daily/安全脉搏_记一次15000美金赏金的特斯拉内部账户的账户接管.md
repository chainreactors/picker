---
title: 记一次15000美金赏金的特斯拉内部账户的账户接管
url: https://www.secpulse.com/archives/198986.html
source: 安全脉搏
date: 2023-04-15
fetch_date: 2025-10-04T11:31:38.909919
---

# 记一次15000美金赏金的特斯拉内部账户的账户接管

[![](https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo-header.png)](https://www.secpulse.com "安全脉搏")

* [首页](https://www.secpulse.com/)
* [分类阅读](https://www.secpulse.com/archives/category/category)

  #### 脉搏文库

  - [内网渗透](https://www.secpulse.com/archives/category/articles/intranet-penetration)
  - |
  - [代码审计](https://www.secpulse.com/archives/category/articles/code-audit)
  - |
  - [安全文献](https://www.secpulse.com/archives/category/articles/sec-doc)
  - |
  - [Web安全](https://www.secpulse.com/archives/category/articles/web)
  - |
  - [移动安全](https://www.secpulse.com/archives/category/articles/mobile-security)
  - |
  - [系统安全](https://www.secpulse.com/archives/category/articles/system)
  - |
  - [工控安全](https://www.secpulse.com/archives/category/articles/industrial-safety)
  - |
  - [CTF](https://www.secpulse.com/archives/category/exclusive/ctf-writeup)
  - |
  - [IOT安全](https://www.secpulse.com/archives/category/iot-security)
  - |

#### 安全建设

+ [业务安全](https://www.secpulse.com/archives/category/construction/businesssecurity)
+ |
+ [安全管理](https://www.secpulse.com/archives/category/construction/securityissue)
+ |
+ [数据分析](https://www.secpulse.com/archives/category/construction/bigdata)
+ |

#### 其他

+ [资讯](https://www.secpulse.com/archives/category/news)
+ |
+ [漏洞](https://www.secpulse.com/archives/category/vul)
+ |
+ [工具](https://www.secpulse.com/archives/category/tools)
+ |
+ [人物志](https://www.secpulse.com/archives/category/people)
+ |
+ [区块链安全](https://www.secpulse.com/archives/category/exclusive/block_chain_security)
+ |
+ [安全招聘](https://www.secpulse.com/archives/category/hiring)
+ |

- [安全问答](https://www.secpulse.com/newpage/question_list)
- [金币商城](https://www.secpulse.com/shop?donotcachepage=c010349fd98847cb9d6e07d3cbc19288)
- [安全招聘](https://www.secpulse.com/archives/category/hiring)
- [活动日程](https://www.secpulse.com/newpage/activity)
- [live课程](https://www.secpulse.com/live)
- [企业服务](https://duoyinsu.com/service.html)
- [插件社区](https://x.secpulse.com/)

小程序

![脉搏小程序](https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg)
[登录](https://www.secpulse.com/user_login)
|
[注册](https://www.secpulse.com/user-register)

# 记一次15000美金赏金的特斯拉内部账户的账户接管

[资讯](https://www.secpulse.com/archives/category/news)

[HACK\_Learn](https://www.secpulse.com/newpage/author?author_id=8971)
![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng0.png)

2023-04-14

10,477

# 记一次15000美金赏金的特斯拉内部账户的账户接管

在作为Tesla Bug Bounty Program 的一部分测试各种 Tesla 网络应用程序时，我创建了许多 Tesla 用户帐户。

有一次，在创建新帐户时，我很好奇是否可以使用 Tesla 电子邮件地址注册一个帐户。

对于后台，Tesla 有许多网络应用程序。

对于所有这些应用程序的 SSO，Tesla 有两个主要的身份提供者 (IDP)，用于外部用户的 auth.tesla.com 和用于员工的 sso.telsa.com。

我的安全测试涉及 auth.tesla.com。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198986-1681456932.jpeg)

我发现外部 auth.tesla.com 允许用户使用 @tesla.com 和 @teslamotors.com 电子邮件地址注册新帐户。

此外，没有电子邮件验证，这意味着可以使用我无权访问的电子邮件地址创建一个帐户。

通过进一步测试，任何使用有效内部 Tesla 电子邮件地址注册外部帐户的尝试都会报告该电子邮件地址已被占用。因此，充其量，我的想法是，在适当的条件下，这可能会被用于账户前接管，这是一个影响相当小的问题。

# 我们如何才能增加它的影响或以其他方式利用它呢？

那么，本质上与账户前接管相反的情况又如何呢？如果我能够注册一个过去使用过的帐户，而不是使用我希望将来使用的电子邮件地址创建一个帐户，该帐户不再在特斯拉的内部 IDP 上处于活动状态，但可能仍具有内部分配的特权，那该怎么办各种网络应用程序？帐户后接管，如果你愿意的话。

由于我之前发现的一个漏洞，我对 Tesla Retail Tool (TRT) 相当熟悉。

TRT 存储机密的 IT 和商业信息，例如网络电路信息、本地设备登录、ISP 和公用事业帐户的网络登录、财务信息以及有关当前、即将到来和以前的 Tesla 位置的详细信息，例如租赁条款、内部和外部联系信息、特斯拉物业限制区域的建筑平面图和内部照片。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198986-1681456933.jpeg)

我知道 TRT 允许从内部和外部帐户访问。

对于身份验证

它使用了一个 JWT，它指定了一个电子邮件地址，该电子邮件地址是根据应用程序中手动定义的用户列表进行身份验证的。以特斯拉的规模，每次员工离职时都很难手动更新该列表。

从理论上讲，如果过去的员工在网络应用程序中定义了访问权限应该没问题，因为他们的 IDP 帐户将被禁用或删除，因此无法通过特斯拉的内部 IDP 登录该应用程序。

但是，如果可以使用特斯拉前员工的内部电子邮件地址注册外部帐户，该电子邮件地址可以访问 TRT 并获得对 Web 应用程序的访问权限，而特权仍然分配给现已失效的电子邮件地址呢？这会给我一个有效的 JWT 和受害者的电子邮件地址，就像我通过内部 IDP 登录一样吗？

我使用 Google Dorks 搜索了前特斯拉员工的 LinkedIn 个人资料，这些员工担任的职位本应有权访问 TRT，尤其是有权访问敏感信息。

例如，

```
site:linkedin.com inurl:/in “field systems” “tesla motors” -intitle:tesla -inurl:posts
```

这找到了应该有权访问网络信息的前现场 IT 人员。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198986-1681456934.png)

# 关键时刻

在测试中，可以使用前特斯拉员工的电子邮件在 auth.tesla.com（外部 IDP）上注册一个帐户，该电子邮件仍然在 TRT 中分配了特权。

然后，我可以使用内部 IDP 帐户可能已被清除的前雇员的身份和权限访问 Tesla Retail Tool，方法是在公共 IDP 上使用相同的电子邮件地址创建一个帐户。这对前雇员的多个电子邮件地址进行了多次尝试。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198986-1681456936.jpeg)

TL;DR Tesla 有两个身份提供者 (IDP)，用于外部用户的 auth.tesla.com 和用于员工的 sso.telsa.com。

Tesla Retail Tool (TRT) 允许从两者登录，但不检查用户登录的 IDP（auth.tesla.com 与 sso.tesla.com）。这是为了通过 Google Dorks，我能够识别姓名并推断出前特斯拉员工的电子邮件地址，然后使用其帐户已在内部 IDP 上被禁用的前雇员的电子邮件地址向外部 IDP 注册帐户，但谁他们仍然拥有 TRT 内部 Tesla 电子邮件地址所定义的特权，并最终以这些用户的特权登录 TRT。

# 时间线

2022 年 11 月 19 日——提交漏洞报告

2022 年 11 月 20 日——特斯拉验证了漏洞并开始修复过程

2022 年 11 月 21 日——我通知特斯拉，我可以确认我在报告中创建的账户无法再访问 TRT

2022 年 11 月 29 日——特斯拉被标记为已解决并获得赏金

漏洞披露地址：https://bugcrowd.com/disclosures/4d9d22af-3a9f-45ce-8eef-8d4fba06a205/auth-tesla-com-account-takeover-of-internal-tesla-accounts

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198986-1681456937.png)

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198986-1681456938.png)

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-198986-1681456939.png)

**本文作者：[HACK\_Learn](newpage/author?author_id=8971)**

**本文为安全脉搏专栏作者发布，转载请注明：**[**https://www.secpulse.com/archives/198986.html**](https://www.secpulse.com/archives/198986.html)

Tags: [sso](https://www.secpulse.com/archives/tag/sso)、[Tesla](https://www.secpulse.com/archives/tag/tesla)、[特斯拉](https://www.secpulse.com/archives/tag/%E7%89%B9%E6%96%AF%E6%8B%89)

点赞：
7
[评论：0](#goComment)
收藏：
0

*新浪微博
QQ空间
微信扫一扫*

### 相关文章

* [![绕过认证的五种方式](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/04/1680597489861-300x202.png)

  绕过认证的五种方式](https://www.secpulse.com/archives/198619.html "详细阅读 绕过认证的五种方式")
* [![安全快报 | 特斯拉进入系统存风险：窃贼可偷走你的汽车](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-181448-1655701635-300x200.jpeg)

  安全快报 | 特斯拉进入系统存风险：窃贼…](https://www.secpulse.com/archives/181448.html "详细阅读 安全快报 | 特斯拉进入系统存风险：窃贼可偷走你的汽车")
* [![花式注入那点事儿（下） | 技术精选0118](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2021/12/16403273211-300x222.png)

  花式注入那点事儿（下） | 技术精选01…](https://www.secpulse.com/archives/171991.html "详细阅读 花式注入那点事儿（下） | 技术精选0118")

评论  (0)

昵称

必填
您当前尚未登录。
[登录？](https://www.secpulse.com/user_login "登录")
[注册](https://www.secpulse.com/user-register)

邮箱

必填（保密）

快来写下你的想法吧！

upload

|  |  |  |
| --- | --- | --- |
| [![]( https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1ca91da9312f04fadf4ab539bb3cb881.png)](https://www.secpulse.com/newpage/author?author_id=8971aaa) | [HACK\_Learn ![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng0.png)](https://www.secpulse.com/newpage/author?author_id=8971) | |
| 文章数：142 | 积分： 323 |
| 微信公众号：HACK学习呀 | |

* [![阿波罗主机安全管理](/wp-content/themes/secpulse2017/img/product-agent.png)](https://linkage.duoyinsu.com)
* [![伏特漏洞扫描云平台](/wp-content/themes/secpulse2017/img/product-fute.png)](https://v.duoyinsu.com)

### 安全问答社区

![安全问答社区](https://www.secpulse.com/wp-content/themes/secpulse2017/img/xcx.png)

### 脉搏官方公众号

![脉搏公众号](https://www.secpulse.com/wp-content/themes/secpulse2017/img/SecPulse.png)

### 活动日程

[显示更多](https://www.secpulse.com/newpage/activity)

#### 2022-06-17

[Gdevops 全球敏捷运维峰会](https://www.bagevent.com/event/8022600?bag_track=AQMB)

#### 2022-05-12

[Mastering the Challenge！——来自The 3rd AutoCS 2022智能汽车信息安全大会的邀请函](https://autocs2022.artisan-event.com/)

#### 2021-11-18

[AutoSW 2021智能汽车软件开发大会](https://autosw2021.artisan-event.com)

#### 2021-06-27

[2021中国国际网络安全博览会暨高峰论坛](http://www.sins-expo.com)

#### 2021-05-27

[The 2nd AutoCS 2021智能汽车信息安全大会](https://artisan-event.com/AutoCS2021/)

#### 2020-12-18

[...