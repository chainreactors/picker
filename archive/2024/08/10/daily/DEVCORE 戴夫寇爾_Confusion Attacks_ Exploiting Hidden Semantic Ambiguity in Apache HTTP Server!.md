---
title: Confusion Attacks: Exploiting Hidden Semantic Ambiguity in Apache HTTP Server!
url: https://devco.re/blog/2024/08/09/confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server-en/
source: DEVCORE 戴夫寇爾
date: 2024-08-10
fetch_date: 2025-10-06T18:05:13.223165
---

# Confusion Attacks: Exploiting Hidden Semantic Ambiguity in Apache HTTP Server!

[![](/images/logo.svg)](/en/)

* Services

  [## Red Team Assessment

  Simulation of real-world attacks to identify vulnerabilities and achieve objectives without disrupting business operations.](/en/services/red-team/)
  [## Penetration Testing

  Infiltration of designated enterprise systems to uncover potential vulnerabilities and assess the risks or damages.](/en/services/penetration-test/)
  [## Security Consulting

  Consultation of resource distribution and long-term defensive strategies from the attacker’s perspective.](/en/services/security-consulting/)
  [## Security Training

  Instruction on defending and preventing incidents with the hacker mindset, also the response procedures and analysis of attacks when incidents happen.](/en/services/security-training/)
  [## OffSec Advanced Training

  Structured in-person (OffSec Live Training) and online training, featuring up-to-date offensive security skills with OffSec certification and resources.](https://training.devco.re/)
* Research

  [## Overview

  Research of updated cybersecurity techniques and trends, assess the security of products, and evolve the red team with broad experience.](/en/research/overview/)
  [## Competitions and Awards

  Awards from international cybersecurity competitions.](/en/research/awards/)
  [## Enterprise Vulnerability Reports

  Research of the risk of enterprise systems, identification of potential weaknesses, and report to vendors.](/en/research/bug-bounty/)
  [## International Conferences

  Sharing vulnerability research and security knowledge at international cybersecurity conferences.](/en/research/talks/)
  [## CVE List

  Discovery of critical vulnerabilities in leading international products and services.](/en/research/cve/)
* Company

  [## Company Overview

  Founded by a world-class white hat hacker team, providing cybersecurity services including Red Team Assessment, Penetration Testing, Security Consulting, and Security Training.](/en/company/about/)
  [## Team Members

  Composed of cybersecurity experts with the hacker mindset, exploring innovative exploitation techniques with high morality and extreme caution.](/en/company/our-team/)
  [## Achievements

  DEVCORE has been invited to leading cybersecurity conferences, has uncovered hundreds of critical product vulnerabilities, and helped enterprises improve their defensive capabilities.](/en/company/history/)
  [## Corporate Social Responsibility

  We provide diverse internship channels and programs to nurture the next generation and promote cybersecurity awareness.](/en/company/csr/)
  [## Job Opportunities

  Join us to secure the world and improve the cybersecurity industry together.](/en/company/jobs/)
  [## DEVCORE CONFERENCE

  DEVCORE’s annual technical conference focused on offensive security research, red team insights, and novel attack vectors from real-world operations.](https://conf.devco.re/)
* News

  [## BLOG

  Latest news](/en/blog/)
  [## Media Resources

  Media Kit, Logo and Usage Guideline](/en/media-kit/)
* [Search](/en/search/)
* [Contact](/en/contact/)

* Services

  [## Red Team Assessment](/en/services/red-team/)
  [## Penetration Testing](/en/services/penetration-test/)
  [## Security Consulting](/en/services/security-consulting/)
  [## Security Training](/en/services/security-training/)
* Research

  [## Overview](/en/research/overview/)
  [## Competitions and Awards](/en/research/awards/)
  [## Enterprise Vulnerability Reports](/en/research/bug-bounty/)
  [## International Conferences](/en/research/talks/)
  [## CVE List](/en/research/cve/)
* Company

  [## Company Overview](/en/company/about/)
  [## Team Members](/en/company/our-team/)
  [## Achievements](/en/company/history/)
  [## Corporate Social Responsibility](/en/company/csr/)
  [## Job Opportunities](/en/company/jobs/)
  [## DEVCORE CONFERENCE](https://conf.devco.re/)
* News

  [## BLOG](/en/blog/)
  [## Media Resources](/en/media-kit/)
* [## Search](/en/search/)
  [## Contact](/en/contact/)
* Language

  [## 中文](/)
  [## English](/en)

# BLOG

* [All Articles](/en/blog/)
* [Tech Editorials](/en/blog/category/Tech%20Editorials/)
* [Media Resources](/en/media-kit/)

[Tech Editorials](/en/blog/category/Tech%20Editorials)

[#CVE](/en/blog/tag/CVE/) [#Vulnerability](/en/blog/tag/Vulnerability/) [#RCE](/en/blog/tag/RCE/) [#Advisory](/en/blog/tag/Advisory/) [#Apache](/en/blog/tag/Apache/)

# Confusion Attacks: Exploiting Hidden Semantic Ambiguity in Apache HTTP Server!

[Orange Tsai](/en/blog/author/orange)
2024-08-09

![](https://devco.re/assets/img/blog/20240809/cover.png)

---

###### Orange Tsai ([@orange\_8361](https://x.com/orange_8361))  |  [繁體中文版本](/blog/2024/08/09/confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server/)  |  [English Version](/blog/2024/08/09/confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server-en/)

Hey there! This is my research on Apache HTTP Server presented at [Black Hat USA 2024](https://www.blackhat.com/us-24/briefings/schedule/index.html#confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server-pre-recorded-40227). Additionally, this research will also be presented at [HITCON](https://hitcon.org/2024/CMT/agenda/eff94e55-3f1d-4229-a65a-65ade9524421/) and [OrangeCon](https://orangecon.nl/). If you’re interested in getting a preview, you can check the slides here:

> [Confusion Attacks: Exploiting Hidden Semantic Ambiguity in Apache HTTP Server!](https://i.blackhat.com/BH-US-24/Presentations/US24-Orange-Confusion-Attacks-Exploiting-Hidden-Semantic-Thursday.pdf)

Also, I would like to thank Akamai for their friendly outreach! They released mitigation measures immediately after this research was published (details can be found on [Akamai’s blog](https://www.akamai.com/blog/security-research/2024-august-apache-waf-proactive-collaboration-orange-tsai-devcore)).

## TL;DR

This article explores architectural issues within the Apache HTTP Server, highlighting several technical debts within Httpd, **including 3 types of Confusion Attacks, 9 new vulnerabilities, 20 exploitation techniques, and over 30 case studies**. The content includes, but is not limited to:

1. How a single `?` can bypass Httpd’s built-in access control and authentication.
2. How unsafe `RewriteRules` can escape the Web Root and access the entire filesystem.
3. How to leverage a piece of code from 1996 to transform an XSS into RCE.

## Outline

* [Before the Story](#before-the-story)
* [How Did the Story Begin?](#how-did-the-story-begin)
* [Why Apache HTTP Server Smells Bad?](#why-apache-http-server-smells-bad)
* [A Whole New Attack — Confusion Attack](#a-whole-new-attack--confusion-attack)
  + [1. Filename Confusion](#-1-filename-confusion)
    - [Primitive 1-1. Truncation](#%ef%b8%8f-primitive-1-1-truncation)
      * [1-1-1. Path Truncation](#%ef%b8%8f-1-1-1-path-truncation)
      * [1-1-2. Mislead RewriteFlag Assignment](#%ef%b8%8f-1-1-2-mislead-rewriteflag-assignment)
    - [Primitive 1-2. ACL Bypass](#%ef%b8%8f-primitive-1-2-acl-bypass)
  + [2. DocumentRoot Confusion](#-2-documentroot-confusion)
    - [Primitive 2-1. Server-Side Source Code Disclosure](#%ef%b8%8f-primitive-2-1-server-side-source-code-disclosure)
      * [2-1-1. Disclose CGI Source Code](#%ef%b8%8f-2-1-1-disclose-cgi-source-code)
      * [2-1-2. Disclose PHP Source Code](#%ef%b8%8f-2-1-2-disclose-php-source-code)
    - [Primitive 2-2. Local Gadgets Manipulation!](#%ef%b8%8f-primitive-2-2-local-gadgets-manipulation)
      * [2-2-1. Local Gadget to Information Disclosure](#%ef%b8%8f-2-2-1-local-gadget-to-information-disclosure)
      * [2-2-2. Local Gadget to XSS](#%ef%b8%8f-2-2-2-local-gadget-to-xss)
      * [2-2-3. Local Gadget to LFI](#%ef%b8%8f-2-2-3-local-gadget-to-lfi)
      * [2-2-4. Local Gadget to SSRF](#%ef%b8%8f-2-2-4-local-gadget-to-ssrf)
      * [2-2-5. Local Gadget to RCE](#%ef%b8%8f-2-2-5-local-gadget-to-rce)
    - [Primitive 2-3. Jailbreak from Local Gadgets](#%ef%b8%8f...