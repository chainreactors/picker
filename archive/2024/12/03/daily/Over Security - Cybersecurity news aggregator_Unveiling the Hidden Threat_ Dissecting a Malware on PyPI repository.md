---
title: Unveiling the Hidden Threat: Dissecting a Malware on PyPI repository
url: https://www.hacktivesecurity.com/index.php/2023/08/02/unveiling-the-hidden-threat-dissecting-a-malware-on-pypi-repository/
source: Over Security - Cybersecurity news aggregator
date: 2024-12-03
fetch_date: 2025-10-06T19:41:09.002229
---

# Unveiling the Hidden Threat: Dissecting a Malware on PyPI repository

* info@hacktivesecurity.com
* Mon - Fri: 9.00 am - 6.00 pm

Advanced Security Solutions to protect the Cyberspace.

[Twitter](https://x.com/hacktivesec)

[Facebook-f](https://www.facebook.com/hacktivesec)

[Linkedin-in](https://www.linkedin.com/company/hacktive-security/)

[Instagram](https://www.instagram.com/hacktivesec/)

[![Hacktive Security](https://www.hacktivesecurity.com/wp-content/uploads/2024/10/logo_hs-1.png)](https://www.hacktivesecurity.com/)

* [Home](https://www.hacktivesecurity.com/)
* [About Us](https://www.hacktivesecurity.com/about-us/)
* Services
  + [Penetration Testing](https://www.hacktivesecurity.com/penetration-testing/)
  + [Red Teaming](https://www.hacktivesecurity.com/red-teaming/)
  + [Secure Code Review](https://www.hacktivesecurity.com/secure-code-review/)
  + [Training](https://www.hacktivesecurity.com/training/)
  + [Compliance](https://www.hacktivesecurity.com/compliance/)
* [Blog](https://www.hacktivesecurity.com/blog/)
* [Careers](https://www.hacktivesecurity.com/careers/)
* [Contacts](https://www.hacktivesecurity.com/contacts/)

Search for:

### Have Any Questions?

+39-06-8773-8747

[free quote](https://www.hacktivesecurity.com/index.php/contacts/)

[![Hacktive Security](https://www.hacktivesecurity.com/wp-content/uploads/2024/10/logo_hs-1.png)](https://www.hacktivesecurity.com/)

Search for:

* [Home](https://www.hacktivesecurity.com/)
* [About Us](https://www.hacktivesecurity.com/about-us/)
* Services
  + [Penetration Testing](https://www.hacktivesecurity.com/penetration-testing/)
  + [Red Teaming](https://www.hacktivesecurity.com/red-teaming/)
  + [Secure Code Review](https://www.hacktivesecurity.com/secure-code-review/)
  + [Training](https://www.hacktivesecurity.com/training/)
  + [Compliance](https://www.hacktivesecurity.com/compliance/)
* [Blog](https://www.hacktivesecurity.com/blog/)
* [Careers](https://www.hacktivesecurity.com/careers/)
* [Contacts](https://www.hacktivesecurity.com/contacts/)

[![Hacktive Security](http://176.31.202.211/wp-content/uploads/2024/10/logo_hs-1.png)](https://www.hacktivesecurity.com/)

Over 10 years we help companies reach their financial and branding goals. Engitech is a values-driven technology agency dedicated.

#### Gallery

[![](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project11-720x720.jpg)](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project11.jpg)

[![](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project10-720x720.jpg)](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project10.jpg)

[![](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project4-720x720.jpg)](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project4.jpg)

[![](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project6-720x720.jpg)](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project6.jpg)

[![](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project2-720x720.jpg)](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project2.jpg)

[![](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project1-720x720.jpg)](https://www.hacktivesecurity.com/wp-content/uploads/2019/11/project1.jpg)

#### Contacts

Via Giosuè Carducci, 21 - Pomigliano d'Arco (Italy)
Paseo Montjuic, número 30 - Barcelona (Spain)

info@hacktivesecurity.com

+39 06 8773 8747

[Twitter](#hacktivesec)

Facebook-f

Pinterest-p

Instagram

# Hacktive Blog

* [Home](https://www.hacktivesecurity.com)
* [Blog](https://www.hacktivesecurity.com/blog/)
* [Active Directory](https://www.hacktivesecurity.com/blog/category/active-directory/)
* Unveiling the Hidden Threat: Dissecting a Malware on PyPI repository

[Active Directory](https://www.hacktivesecurity.com/blog/category/active-directory/)

![](https://www.hacktivesecurity.com/wp-content/uploads/2023/07/images.jpeg)

\_ [August 2, 2023](https://www.hacktivesecurity.com/blog/2023/08/02/unveiling-the-hidden-threat-dissecting-a-malware-on-pypi-repository/)\_ [calfcrusher](https://www.hacktivesecurity.com/blog/author/calfcrusher/)\_ [0 Comments](https://www.hacktivesecurity.com/blog/2023/08/02/unveiling-the-hidden-threat-dissecting-a-malware-on-pypi-repository/#respond)

### Unveiling the Hidden Threat: Dissecting a Malware on PyPI repository

> In the vast realm of software development, the **Python Package Index** has long been a trusted repository for **Python** packages. However, even the most reliable platforms are not immune to the ever-evolving landscape of cyber threats. My recent investigation led me to stumble upon a malicious package lurking within **PyPI**, disguised as a seemingly “*innocent* ***ETH** drainer*” utility.
>
> This article aims to shed light on this lurking danger, uncovering its inner workings and exposing the potential risks it poses. Those who seek to download malware with the intention to harm others deserve no rights indeed; however, it remains our duty to thwart the expansion of such destructive threats.

![](http://176.31.202.211/wp-content/uploads/2023/07/SCR-20230704-lxua.jpeg)

## The Discovery

Uncovering a hidden menace often requires keen observation and a knack for identifying unusual patterns. However, this time was different. A few days ago, a user on a **Discord** channel posted, just before being banned, a link to an **ETH** **drainer** **tool** on **GitHub**. An **ETH** **drainer** is a malicious tool designed to drain **Ethereum** **(ETH)** cryptocurrency from unsuspecting victims’ wallets.

Its nefarious purpose is to siphon off funds without the owners’ knowledge or consent, potentially resulting in significant financial losses.

![](http://176.31.202.211/wp-content/uploads/2023/07/SCR-20230702-unjt.png)

Of course if these tools are publicly accessible, they are undoubtedly **malicious**.

Sometimes they indeed work; however, they **stealthily swap** the destination ETH address with that of the **creator** of the ETH drainer.

In this case, the attacker opted for a heavy approach by inserting a full malware with numerous functionalities, some of which we will explore together: in fact our focus will be on understanding the techniques utilized by the attacker.

![](http://176.31.202.211/wp-content/uploads/2023/07/SCR-20230702-upen.png)

The usage of adorable cat images by threat actors adds an intriguing element to their tactics!

Leveraging **PyPI** as a repository for **hosting** **malware** has become an alarming trend in recent times. Malicious actors recognize the immense popularity of PyPI as the go-to source for Python packages and have seized this opportunity to propagate their malware. This abuse of trust poses a significant threat to developers, organizations and users who rely on PyPI for secure and reliable software components.

In this case, identifying the presence of a malicious script in the Github repository was not difficult; the attacker had uploaded a deceptive repository onto PyPI.

![](http://176.31.202.211/wp-content/uploads/2023/07/malicious.png)

The “pip install” command is a widely used method for installing external libraries or dependencies into a Python environment. In this case, the **pythoncryptolibraryV2** is a counterfeit repository that was intentionally designed to contain backdoors or other forms of malicious code, posing a significant threat to unsuspecting users.

![](http://176.31.202.211/wp-content/uploads/2023/07/SCR-20230702-umuc.png)

We can spot immediately that it is a malicious repository just from the name of the repository itself.

## Deconstructing the Malware

When examining the contents of the **\_\_init\_\_.py** file, in the first part of the code, we can see how threat actors install other third-party PyPI packages, like **pyperclip** or **pypiwin32**. It’s possible that the threat actors have uploaded and are requesting other malicious repositories.

We can observe the implementation of the **Fernet** algorithm, which is used for a minor level of obfuscation: th...