---
title: Hacking CSRF: Bypassing of CSRF token
url: https://infosecwriteups.com/hacking-csrf-bypassing-of-csrf-token-f03b51c36d31?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2023-06-12
fetch_date: 2025-10-04T11:45:08.596123
---

# Hacking CSRF: Bypassing of CSRF token

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff03b51c36d31&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fhacking-csrf-bypassing-of-csrf-token-f03b51c36d31&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fhacking-csrf-bypassing-of-csrf-token-f03b51c36d31&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-f03b51c36d31---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-f03b51c36d31---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# Hacking CSRF: Bypassing of CSRF token

## CSRF ( Cross-site Request Forgery )

[![Vignesh](https://miro.medium.com/v2/resize:fill:64:64/1*_mX7FdsItcAllcM0GMI_tg.jpeg)](https://evilox.medium.com/?source=post_page---byline--f03b51c36d31---------------------------------------)

[Vignesh](https://evilox.medium.com/?source=post_page---byline--f03b51c36d31---------------------------------------)

5 min read

·

Jun 5, 2023

--

Listen

Share

Press enter or click to view image in full size

![]()

Hey guys welcome to my blog so today we are going to discuss about CSRF protection bypass and in previous I discussed about CSRF attacks and finding CSRF vulnerability so please check out the below article

What is CSRF: <https://evilox.medium.com/explanation-of-csrf-cross-site-request-forgery-bc6a5042bcbf>

Finding CSRF: <https://evilox.medium.com/unmasking-basic-csrf-bug-hunter-5003dbe44466>

As websites implement stronger security measures to combat CSRF attacks, the need for understanding the techniques used to bypass these protections becomes crucial. This article delves into the evolving web security landscape, shedding light on the ongoing efforts to break through modern CSRF defenses. Furthermore, it goes beyond theory by providing practical demonstrations using PortSwigger’s lab environment. By exploring the challenges faced by both attackers and defenders, we can gain valuable insights into CSRF protection bypass and fortify our defenses against this persistent threat.

### What is a CSRF token?

CSRF token is nothing but a unique secrete key generated by the server-side application and shared with the client to protect from the CSRF attack

And if the client does not provide the CSRF token correctly it will reject the request

> CSRF\_Token=80FassfjkddmmOhi9M9wyna8tadnsaak3ODOR8d6u

If the implementation is Correct it will protect from CSRF attacks but if it is not it can be bypassed using some of the techniques so let us discuss

Here we are solving the portswigger lab

## Validation of CSRF token depends on the request method

Some of the applications correctly valid the token based on request if it POST it is valid but when we change it to GET it is not valid it one of the common flaws in the many application

So first go to the lab and sign up with credentials and there you can able to see the Change email ID functionality

So update the email ID and capture that request and next send to the repeater

Press enter or click to view image in full size

![]()

Next change the request method from POST to GET in burpsuite

Press enter or click to view image in full size

![]()

Press enter or click to view image in full size

![]()

Using the CSRF POC generator you can able to draft the payload or try to draft the payload manually using the [previous article](https://evilox.medium.com/unmasking-basic-csrf-bug-hunter-5003dbe44466)

Next, remove the CSRF token (but it is not necessary for this challenge)

Press enter or click to view image in full size

![]()

In real time you need to load this HTML file on the browser for the report but for this challenge, there is an exploit server so open that server and paste it into the body section

Next store that exploits and deliver to the victim

Press enter or click to view image in full size

![]()

Now the lab get solved

Press enter or click to view image in full size

![]()

> Lab: CSRF where token validation depends on token being present

In this lab, the application has a proper CSRF token but it not validating when the user removes that token

Press enter or click to view image in full size

![]()

Here you can able to see the CSRF token so just remove that token

Press enter or click to view image in full size

![]()

Next draft the payload for CSRF using the CSRF POC generator and copy and paste that onto the exploit server

Press enter or click to view image in full size

![]()

Now Store that exploit and deliver that exploit to the victim

Press enter or click to view image in full size

![]()

And Lab gets solved………….

> CSRF where token is not tied to user session

In this lab, they have given the two accounts to bypass the CSRF protection but here you can able to use the CSRF token for one time only, and the same email id will not accept

First login to the two accounts in the normal window

Press enter or click to view image in full size

![]()

Incognito window

Press enter or click to view image in full size

![]()

In any account Update the email and capture the request with the CSRF token

Press enter or click to view image in full size

![]()

Next, generate the CSRF POC using Burp and copy and paste it into your local file

Press enter or click to view image in full size

![]()

Open with incognito with another account and now you can able to notice that email-id will get changed

Press enter or click to view image in full size

![]()

Using this you can able to confirm that there is CSRF vulnerability exist

so to solve this the Lab copy and paste the payload into the exploit server and store and deliver the exploit to the victim

Note: you need to use the fresh CSRF token and Mail ID which is not already used (if want this do the process again)

Press enter or click to view image in full size

![]()

So now your lab gets solved…………………………

I hope you will understand this article if you like this please give applause to this article which will motivate me lot and follow up evilox for more updates

[Csrf](https://medium.com/tag/csrf?source=post_page-----f03b51c36d31---------------------------------------)

[Hacker](https://medium.com/tag/hacker?source=post_page-----f03b51c36d31---------------------------------------)

[Bug Bounty](https://medium.com/tag/bug-bounty?source=post_page-----f03b51c36d31---------------------------------------)

[Csrf Protection](https://medium.com/tag/csrf-protection?source=post_page-----f03b51c36d31---------------------------------------)

[Csrf Attack](https://medium.com/tag/csrf-attack?s...