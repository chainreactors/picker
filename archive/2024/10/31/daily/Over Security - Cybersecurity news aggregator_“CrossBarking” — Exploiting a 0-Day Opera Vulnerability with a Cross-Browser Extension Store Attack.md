---
title: “CrossBarking” — Exploiting a 0-Day Opera Vulnerability with a Cross-Browser Extension Store Attack
url: https://medium.com/@guardiosecurity/crossbarking-exploiting-a-0-day-opera-vulnerability-with-a-cross-browser-extension-store-attack-db3e6d6e6aa8
source: Over Security - Cybersecurity news aggregator
date: 2024-10-31
fetch_date: 2025-10-06T18:56:55.852789
---

# “CrossBarking” — Exploiting a 0-Day Opera Vulnerability with a Cross-Browser Extension Store Attack

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdb3e6d6e6aa8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40guardiosecurity%2Fcrossbarking-exploiting-a-0-day-opera-vulnerability-with-a-cross-browser-extension-store-attack-db3e6d6e6aa8&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40guardiosecurity%2Fcrossbarking-exploiting-a-0-day-opera-vulnerability-with-a-cross-browser-extension-store-attack-db3e6d6e6aa8&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

# “CrossBarking” — Exploiting a 0-Day Opera Vulnerability with a Cross-Browser Extension Store Attack

[![Guardio](https://miro.medium.com/v2/resize:fill:64:64/1*s7SJaF9dODo7rWqa2rFQ6Q.png)](/%40guardiosecurity?source=post_page---byline--db3e6d6e6aa8---------------------------------------)

[Guardio](/%40guardiosecurity?source=post_page---byline--db3e6d6e6aa8---------------------------------------)

14 min read

·

Oct 30, 2024

--

Listen

Share

By [**Nati Tal**](https://www.linkedin.com/in/natital/)(Head of [Guardio Labs](http://www.guard.io/))

> [Guardio Labs](https://labs.guard.io) has uncovered and fully disclosed a serious vulnerability in the Opera browser that allows malicious extensions to gain full access to permissive Private APIs, enabling actions like **screen capturing, browser setting modifications, and account hijacking**. Following our earlier discovery of [MyFlaw](/%40guardiosecurity/myflaw-cross-platform-0-day-rce-vulnerability-discovered-in-operas-browsers-099361a808ab), this revelation further underscores the ongoing challenges in modern browser security.
>
> To illustrate the unfortunate ease of bypassing extension store security measures, our research team adopted a ‘black hat’ approach, demonstrating how, with just a free email account and AI-generated content, a fully operational malicious extension exploiting this vulnerability can be created and placed in the official Chrome Store — creating a **cross-browser-store attack**. From there, it could potentially reach millions of unsuspecting users worldwide. This case study not only highlights the perennial clash between productivity and security but also provides **a** **fascinating glimpse into the tactics used by modern threat actors operating just below the radar**.

Press enter or click to view image in full size

![]()

A Puppy-Themed extension on Chrome’s store, crossing the line to Opera and exploiting a 0-Day

## Intro — Browser Sandboxing Conception

Modern websites function like fully-fledged applications, running code directly in your browser. To ensure security, your browsing context must be completely sandboxed — isolated from the rest of your system. This approach is a fundamental aspect of Chromium’s design. There are specific APIs, driven by Chromium, that website code uses to interact with your browser and system — outside of that sandbox. These APIs, mostly open-source and rigorously reviewed, provide a controlled and secure environment to activate permissive features such as autocomplete, cookie management, and secure payments.

But what happens when a custom web app or browser feature needs new or unique capabilities? This is where **Private APIs** come into play, bringing productivity and security, once again, into an inevitable clash!

## Customizing Browsers via Private APIs

The above is true also for the Opera Browser. To support its diverse features, such as Opera Flow, Opera Wallet, Pinboard, and other unique services, the Opera Browser employs special web apps under specific domains endowed with unique privileges. This allows web apps under those unique domains, and only those, to access special Private APIs embedded into the Opera Browser’s native code.

The list of domains that Opera granted special privileges is extensive and varied. It includes Opera’s primary domain `opera.com` along with its subdomains. Additionally, several third-party domains, included for toolbar integrations, also receive higher privileges. Concerningly, even Opera’s internal development domains, such as `op-test.net` are included in the production version of the browser — and are publicly reachable:

Press enter or click to view image in full size

![]()

Sample of permissive and exploitable domains and their correspondent APIs and attack use-cases

As an example of this method, consider Opera's [pinboard](https://www.opera.com/features/pinboards) feature. It lets users quickly “pin” websites and other shareable items into virtual boards. For convenience, the browser takes screenshots of that pinned website and saves them under the new element in your pinboard. Taking screenshots? Sounds quite permissive—and indeed, this is done using the special Private API created intentionally for this unique feature:

Press enter or click to view image in full size

![]()

Demonstraing how the pinboards feature uses PrivateAPIs available to the application dedicated domain

Product-wise, this is the go-to method for Chromium-based products to deliver advanced user experiences, thus creating unique selling points. As such, it is used by all browser vendors building their products on top of the Chromium framework—Opera is just one example.

But let’s go back to **security** for a moment. Hard-coded domains with over-permissive access? Is this secure enough? Well, far from it…

## Breaking the Private API Bearier — With Extensions

Let’s put on a “Black Hat” for a moment and try to gain access to those powerful Private APIs. The first thing a security researcher will think of would probably be an XSS (Cross-Site Scripting) vulnerability that could enable injecting custom code to pages behind permissive domains and calling those APIs. Might we also find “left-over” domains we can grab, still granted permissions yet not in use, and their owner [forgot to renew them](https://labs.guard.io/subdomailing-thousands-of-hijacked-major-brand-subdomains-found-bombarding-users-with-millions-a5e5fb892935)? And what about more advanced techniques of forcefully taking over domains like [Sitting Ducks](https://blogs.infoblox.com/threat-intelligence/who-knew-domain-hijacking-is-so-easy/)?

While the above methods are conceivable, they typically involve significant vulnerabilities and require converging complex conditions — almost like a cosmic alignment. But what if there was a more straightforward way, one that flies under the radar and might even involve **cute puppies**?

Press enter or click to view image in full size

![]()

Overview of how an extension injects code to a permissive domain’s context to activate Private APIs

**Yes. Browser Extensions**. These add-ons are inherently very powerful—you automatically grant them special permissions upon installation, and from there, they can monitor and modify every website you see or network activity you create. Even simple utilities like all those “Dark Mode” extensions use content scripting capabilities to inject JavaScript code into every page you visit and dynamically scan and change style configurations. Well, at least the [benign Dark Mode](https://labs.guard.io/dormant-colors-live-campaign-with-over-1m-data-stealing-extensions-i...