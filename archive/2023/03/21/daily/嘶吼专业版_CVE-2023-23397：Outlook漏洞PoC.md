---
title: CVE-2023-23397：Outlook漏洞PoC
url: https://mp.weixin.qq.com/s?__biz=MzI0MDY1MDU4MQ==&mid=2247558912&idx=3&sn=2974d3b7e3b10e340a9183be3a571f67&chksm=e914373ade63be2c9dc48816f1a04e92f2d3bc6cde4aa819adaecfe104641d2cae2388fdd9f6&scene=58&subscene=0#rd
source: 嘶吼专业版
date: 2023-03-21
fetch_date: 2025-10-04T10:10:06.273395
---

# CVE-2023-23397：Outlook漏洞PoC

![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/wpkib3J60o28Y7G6cy8jBedEHRZuNdjrjQOlicabL7S934Mxh2IkhsrmHibic7zNGZUhOR5EPgHkWf5GRXFwNl0dGQ/0?wx_fmt=jpeg)

# CVE-2023-23397：Outlook漏洞PoC

ang010ela

嘶吼专业版

![](https://mmbiz.qpic.cn/mmbiz_gif/wpkib3J60o297rwgIksvLibPOwR24tqI8dGRUah80YoBLjTBJgws2n0ibdvfvv3CCm0MIOHTAgKicmOB4UHUJ1hH5g/640?wx_fmt=gif)

俄罗斯黑客利用Outlook漏洞窃取NTLM哈希。

3月14日，微软补丁日修复了一个Outlook安全漏洞，微软对该漏洞的描述中的是：微软Office Outlook中包含一个权限提升漏洞，攻击者利用该漏洞可以发起NTLM（New technology LAN Manager，新技术LAN管理器）中继攻击，但未公开该漏洞的其他细节。该漏洞CVE编号为CVE-2023-23397，CVSS评分为9.8分，影响所有的Windows outlook版本。微软虽然发布了该漏洞的补丁，但该漏洞早在2022年3月-4月就作为0 day漏洞被用于NTLM中继攻击了。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o28Y7G6cy8jBedEHRZuNdjrjhQN1Gyqwh4IJ0ReOgicwpZbiaWG4jKd7yItgjkro6696d091WrLhuHvQ/640?wx_fmt=png)
   漏洞利用

具体来说攻击者只需要通过一封邮件就远程窃取用户密码（哈希后的结果），整个过程不需要用户交互，只需要用户打开outlook即可。

NTLM是一种认证方法，用于使用哈希的登录凭证来登入Windows域。工作原理为：客户端尝试访问共享的资源时，服务器可以接收和验证来自客户端的密码哈希。如果哈希的用户密码被窃，窃取的哈希可以用于在网络上进行身份认证。虽然NTLM认证存在已知风险，但为了兼容老版本系统，许多新系统仍然支持NTLM认证。

微软解释称，攻击者可以通过发送一个精心构造的消息来利用该漏洞来获取NTLM哈希值。具体来说，该消息包含扩展的MAPI属性，其中UNC路径为攻击者控制的服务器上的SMB（TCP 445端口）。到远程SMB服务器的连接发送用户NTLM 协商消息，然后攻击者就可以中继该消息来实现对支持NTLM认证的其他系统的认证。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o28Y7G6cy8jBedEHRZuNdjrj9vbl47B1m7pbFEhwyrnZstDCKLIDSM2CdNe7icgca6ajich68Yhjribicw/640?wx_fmt=png)

MDSec安全研究人员Chell 分析微软检查Exchange消息的脚本发现，该脚本会在接收到的邮件中寻找“PidLidReminderFileParameter”属性，如果存在的话就移除。而该特征可以让发送者定义outlook客户端在消息提醒触发时应该播放的音乐的文件名。但邮件发送者并不应该能够配置接收者系统的消息提醒音乐。

研究人员发现PidLidReminderOverride特征可以用来使微软outlook分析PidLidReminderFileParameter特征中的远程恶意UNC路径。研究人员利用该信息可以创建一个包含日历约会的恶意outlook邮件（.MSG），可以触发该漏洞并发送目标的NTLM哈希给任意服务器。

然后，被窃的NTLM哈希值可以被用于执行NTLM中继攻击，以访问其他内部网络。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o28Y7G6cy8jBedEHRZuNdjrjERDm5mx7WK7N36X8FTuAicWI6snXjAqyQ3wkcbqDuw6L1yq923y7VXA/640?wx_fmt=png)

图 通过outlook的恶意日历约会窃取NTLM哈希值

除了日历约会外，攻击者也可以使用Outlook Tasks、Notes或者邮件信息来窃取NTLM哈希值。

MDSec也分享了该漏洞的PoC视频：https://player.vimeo.com/video/808160973

![](https://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o28Y7G6cy8jBedEHRZuNdjrjhQN1Gyqwh4IJ0ReOgicwpZbiaWG4jKd7yItgjkro6696d091WrLhuHvQ/640?wx_fmt=png)
   漏洞在野利用

该漏洞是由乌克兰计算机应急响应组发现并报告给微软的。微软称，与俄罗斯有关的黑客组织已经利用了该漏洞用于攻击多个欧洲政府、交通、能源、军事组织。在2022年12月的攻击中，有15个组织成为攻击的目标。攻击活动的背后是与俄罗斯相关的黑客组织——ATP28。

在获取访问权限后，黑客会使用Impacket 和 PowerShell Empire开源框架进一步入侵网络中的其他系统。研究人员建议管理员尽快修复CVE-2023-23397漏洞，并使用微软提供的脚本检查是否有漏洞被利用的迹象。

MDSec的技术分析参见：https://www.mdsec.co.uk/2023/03/exploiting-cve-2023-23397-microsoft-outlook-elevation-of-privilege-vulnerability/

参考及来源：https://www.bleepingcomputer.com/news/security/critical-microsoft-outlook-bug-poc-shows-how-easy-it-is-to-exploit/

![](https://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o28Y7G6cy8jBedEHRZuNdjrjaPVBCmneyuD8lNyRw2xDCxyDl5gzApsIos0kupkx8nI0EKg5Rriaicmg/640?wx_fmt=png)![](https://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o2icEjy5ZrpCcgr4BicXicPv08DSsrgibDcJQpvwkZoO4OqdIpJNhj6TO5xV0ic0AnVf7f2kcPnNevQlTtQ/640?wx_fmt=png)

预览时标签不可点

阅读原文

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o29QZSgjKMjM7j822AuVv1iaicmoBhDlvJq1s41w5yIxoicDK9AsOGHLnQYkqq95ibWgq3OqvvXEO1qBVg/0?wx_fmt=png)

嘶吼专业版

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o29QZSgjKMjM7j822AuVv1iaicmoBhDlvJq1s41w5yIxoicDK9AsOGHLnQYkqq95ibWgq3OqvvXEO1qBVg/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过