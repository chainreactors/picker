---
title: Researchers Reveal ConfusedFunction Vulnerability in Google Cloud Platform
url: https://thehackernews.com/2024/07/experts-expose-confusedfunction.html
source: The Hacker News
date: 2024-07-26
fetch_date: 2025-10-06T17:52:04.555234
---

# Researchers Reveal ConfusedFunction Vulnerability in Google Cloud Platform

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [Researchers Reveal ConfusedFunction Vulnerability in Google Cloud Platform](https://thehackernews.com/2024/07/experts-expose-confusedfunction.html)

**Jul 25, 2024**Ravie LakshmananCloud Security / Vulnerability

[![ConfusedFunction Vulnerability](data:image/png;base64... "ConfusedFunction Vulnerability")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg7HhHko45XBTpWMKyyC94Vjpn_56Nzol_MqFoc77JzpCtxvEqEd1cScv4LyIbDWLAKPtei6ysFI-PiYGfTvqelPxnk2ETmCCMdsxdDpId1q-M7MfkP9W17KudVIv70uTm2XI14G4OAGGMQxDG5lNpZwniFmITFE02YWZ0Z43EAcwt_ZtPYZv3YgxmZPCay/s790-rw-e365/PrivilegeEscalationVulnerability.gif)

Cybersecurity researchers have disclosed a privilege escalation vulnerability impacting Google Cloud Platform's Cloud Functions service that an attacker could exploit to access other services and sensitive data in an unauthorized manner.

Tenable has [given](https://www.tenable.com/blog/confusedfunction-a-privilege-escalation-vulnerability-impacting-gcp-cloud-functions) the vulnerability the name ConfusedFunction.

"An attacker could escalate their privileges to the Default Cloud Build Service Account and access numerous services such as Cloud Build, storage (including the source code of other functions), artifact registry and container registry," the exposure management company said in a statement.

"This access allows for lateral movement and privilege escalation in a victim's project, to access unauthorized data and even update or delete it."

Cloud Functions [refers](https://cloud.google.com/functions/docs/concepts/overview) to a serverless execution environment that allows developers to create single-purpose functions that are triggered in response to specific Cloud events without the need to manage a server or update frameworks.

[![DFIR Retainer Services](data:image/png;base64...)](https://thehackernews.uk/cloud-insight-d)

The problem discovered by Tenable has to do with the fact that a Cloud Build service account is created in the background and linked to a Cloud Build instance by default when a Cloud Function is created or updated.

This service account opens the door for potential malicious activity owing to its excessive permissions, thereby permitting an attacker with access to create or update a Cloud Function to leverage this loophole and escalate their privileges to the service account.

This permission could then be abused to access other Google Cloud services that are also created in tandem with the Cloud Function, including Cloud Storage, Artifact Registry, and Container Registry. In a hypothetical attack scenario, ConfusedFunction could be exploited to leak the Cloud Build service account token via a webhook.

[![ConfusedFunction Vulnerability](data:image/png;base64... "ConfusedFunction Vulnerability")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjvB_3mFO6rm7A9eb1H7Lb5Z2eLXtXn_9Dbw1lD1OA40aesM1O-46FbS82zZsYJcoICCEMADt0rQL9345x3iMa0N0GvXoNBn4aJ_emrz_-ZBN2k9pG0B_Rv-u2UYaabpOy-ZvAU7VpVFgU5KnaFN_tO5HMYoJq3AboiVUXg8JP-KGRrZ94Ek1tQGJfDT46g/s790-rw-e365/attack.png)

Following responsible disclosure, Google has [updated](https://cloud.google.com/build/docs/cloud-build-service-account-updates) the default behavior such that Cloud Build uses the [Compute Engine default service account](https://cloud.google.com/compute/docs/access/service-accounts#default_service_account) to prevent misuse. However, it's worth noting that these changes do not apply to existing instances.

"The ConfusedFunction vulnerability highlights the problematic scenarios that may arise due to software complexity and inter-service communication in a cloud provider's services," Tenable researcher Liv Matan said.

"While the GCP fix has reduced the severity of the problem for future deployments, it didn't completely eliminate it. That's because the deployment of a Cloud Function still triggers the creation of the aforementioned GCP services. As a result, users must still assign minimum but still relatively broad permissions to the Cloud Build service account as part of a function's deployment."

The development comes as Outpost24 detailed a medium-severity cross-site scripting (XSS) flaw in the Oracle Integration Cloud Platform that could be weaponized to inject malicious code into the application.

The flaw, which is rooted in the handling of the "consumer\_url" parameter, was [resolved](https://www.oracle.com/security-alerts/cpujul2024.html) by Oracle in its Critical Patch Update (CPU) released earlier this month.

[![CIS Build Kits](data:image/png;base64...)](https://thehackernews.uk/platform-shield-d)

"The page for creating a new integration, found at https://<instanceid>.integration.ocp.oraclecloud.com/ic/integration/home/faces/link?page=integration&consumer\_url=<payload>, did not require any other parameters," security researcher Filip Nyquist [said](https://outpost24.com/blog/xss-vulnerability-oracle-integration-cloud/).

[![ConfusedFunction Vulnerability](data:image/png;base64... "ConfusedFunction Vulnerability")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjj4VL2dQ7N_ukqomnJsACq5TtJN6O96mLV_4mTFQHdsIxCjAs5SbsSvEFRtiH7lpJA7citDkOeOsfDhlCklNvJg4ThGfgT46c1s1d98xaakXyvF7-NwYYQmD77ChYU13jr7y2I0pXcnzB_A2JqtOhnkiSJQqydhqVgzzspX9eiB7ajHnHB7dTWIUKr8Jlx/s790-rw-e365/oracle.png)

"This meant that an attacker would only need to identify the instance-id of the specific integration platform to send a functional payload to any user of the platform. Consequently, the attacker could bypass the requirement of knowing a specific integration ID, which is typically accessible only to logged-in users."

It also follows Assetnote's [discovery](https://www.assetnote.io/resources/research/chaining-three-bugs-to-access-all-your-servicenow-data) of three security vulnerabilities in the ServiceNow cloud computing platform (CVE-2024-4879, CVE-2024-5178, and CVE-2024-5217) that could be fashioned into an exploit chain in order to gain full database access and execute arbitrary code on the within the context of the Now Platform.

The Ser...