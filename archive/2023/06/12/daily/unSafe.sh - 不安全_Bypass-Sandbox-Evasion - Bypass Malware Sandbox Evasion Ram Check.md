---
title: Bypass-Sandbox-Evasion - Bypass Malware Sandbox Evasion Ram Check
url: https://buaq.net/go-168232.html
source: unSafe.sh - 不安全
date: 2023-06-12
fetch_date: 2025-10-04T11:44:43.514987
---

# Bypass-Sandbox-Evasion - Bypass Malware Sandbox Evasion Ram Check

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/c9c17bcab6f927b387ac865961fc22d3.jpg)

Bypass-Sandbox-Evasion - Bypass Malware Sandbox Evasion Ram Check

Sandboxes are commonly used to analyze malware. They provide a temporary, isolated, and secu
*2023-6-11 20:30:0
Author: [www.kitploit.com(查看原文)](/jump-168232.htm)
阅读量:31
收藏*

---

[![](https://blogger.googleusercontent.com/img/a/AVvXsEj2tTiSJYVtHsUsygJcmPjh3RYf3xCxgCF9EaaiX9IcIgqsA_I3qYMjVXn2O3hn18zl9GGT_iW7xxkZPuKceVqfOW0g5_dNFvUOgfsc5WsJTt0daGBfqflGsy_Uiao2regl1a2weZpHuk1kWnZAsK7nZdmHRjoM1zV-EvEVkSnU3QBv44I91ixPZALk6w=w640-h460)](https://blogger.googleusercontent.com/img/a/AVvXsEj2tTiSJYVtHsUsygJcmPjh3RYf3xCxgCF9EaaiX9IcIgqsA_I3qYMjVXn2O3hn18zl9GGT_iW7xxkZPuKceVqfOW0g5_dNFvUOgfsc5WsJTt0daGBfqflGsy_Uiao2regl1a2weZpHuk1kWnZAsK7nZdmHRjoM1zV-EvEVkSnU3QBv44I91ixPZALk6w)

Sandboxes are commonly used to analyze malware. They provide a temporary, isolated, and secure environment in which to observe whether a suspicious file exhibits any malicious behavior. However, [malware](https://www.kitploit.com/search/label/Malware "malware") developers have also developed methods to evade sandboxes and [analysis](https://www.kitploit.com/search/label/Analysis "analysis") environments. One such method is to perform checks to determine whether the machine the malware is being executed on is being operated by a real user. One such check is the RAM size. If the RAM size is unrealistically small (e.g., 1GB), it may indicate that the machine is a sandbox. If the malware detects a sandbox, it will not execute its true malicious behavior and may appear to be a benign file

* The `GetPhysicallyInstalledSystemMemory` API retrieves the amount of RAM that is physically installed on the computer from the SMBIOS [firmware](https://www.kitploit.com/search/label/Firmware "firmware") tables. It takes a `PULONGLONG` parameter and returns `TRUE` if the function succeeds, setting the `TotalMemoryInKilobytes` to a nonzero value. If the function fails, it returns `FALSE`.

  [![](https://blogger.googleusercontent.com/img/a/AVvXsEg5vI7Z0oucFnnHM4-_xudw4m9YZPbJJ-8mNE_yAeCFcjelE3TkvYQONPUEN3VwTdjsoxlZQ_V7UmoQ-bgdVqIGPmQvIwWlPijUJ-BzleZ5TSAjUdqh_BjmY6l652wHxYr6ddsTTW4705SiUpXuY2IdWEY6UjOZrvbpPk4k9lJEkpyxfIV0v_w8WNGk-w=w640-h272)](https://blogger.googleusercontent.com/img/a/AVvXsEg5vI7Z0oucFnnHM4-_xudw4m9YZPbJJ-8mNE_yAeCFcjelE3TkvYQONPUEN3VwTdjsoxlZQ_V7UmoQ-bgdVqIGPmQvIwWlPijUJ-BzleZ5TSAjUdqh_BjmY6l652wHxYr6ddsTTW4705SiUpXuY2IdWEY6UjOZrvbpPk4k9lJEkpyxfIV0v_w8WNGk-w)   [![](https://blogger.googleusercontent.com/img/a/AVvXsEgcafjbV6NQJzSaDkmFTghhONeojDcPhUx_LaPUtXH6PrLutHh9kPNG_u9lK6WJ2aeSdsQO1HXeJw60ZqCjABa7Wlc7_Bjxg0f77v1odA8oYmXn8t9onMVDWdl4UrEuZGYcCHZtqbeXobS-tgYL12EE1wOeR17wAsSfFCOJLZOzvKFhWk5Q-TnAT7zjSA=w640-h54)](https://blogger.googleusercontent.com/img/a/AVvXsEgcafjbV6NQJzSaDkmFTghhONeojDcPhUx_LaPUtXH6PrLutHh9kPNG_u9lK6WJ2aeSdsQO1HXeJw60ZqCjABa7Wlc7_Bjxg0f77v1odA8oYmXn8t9onMVDWdl4UrEuZGYcCHZtqbeXobS-tgYL12EE1wOeR17wAsSfFCOJLZOzvKFhWk5Q-TnAT7zjSA)
* The amount of physical [memory](https://www.kitploit.com/search/label/Memory "memory") retrieved by the `GetPhysicallyInstalledSystemMemory` function must be equal to or greater than the amount reported by the `GlobalMemoryStatusEx` function; if it is less, the SMBIOS data is malformed and the function fails with `ERROR_INVALID_DATA`, [Malformed](https://www.kitploit.com/search/label/Malformed "Malformed") SMBIOS data may indicate a problem with the user's computer .

  [![](https://blogger.googleusercontent.com/img/a/AVvXsEj2tTiSJYVtHsUsygJcmPjh3RYf3xCxgCF9EaaiX9IcIgqsA_I3qYMjVXn2O3hn18zl9GGT_iW7xxkZPuKceVqfOW0g5_dNFvUOgfsc5WsJTt0daGBfqflGsy_Uiao2regl1a2weZpHuk1kWnZAsK7nZdmHRjoM1zV-EvEVkSnU3QBv44I91ixPZALk6w=w640-h460)](https://blogger.googleusercontent.com/img/a/AVvXsEj2tTiSJYVtHsUsygJcmPjh3RYf3xCxgCF9EaaiX9IcIgqsA_I3qYMjVXn2O3hn18zl9GGT_iW7xxkZPuKceVqfOW0g5_dNFvUOgfsc5WsJTt0daGBfqflGsy_Uiao2regl1a2weZpHuk1kWnZAsK7nZdmHRjoM1zV-EvEVkSnU3QBv44I91ixPZALk6w)
* The register `rcx` holds the parameter `TotalMemoryInKilobytes`. To overwrite the jump address of `GetPhysicallyInstalledSystemMemory`, I use the following opcodes: `mov qword ptr ss:[rcx],4193B840`. This moves the value `4193B840` (or 1.1 TB) to `rcx`. Then, the ret instruction is used to pop the return address off the stack and jump to it, Therefore, whenever `GetPhysicallyInstalledSystemMemory` is called, it will set `rcx` to the custom value."

  [![](https://blogger.googleusercontent.com/img/a/AVvXsEjUhpzwPkRmSwutRlx_6rOZsVbBlkN2yKAy-BWAbnMazAipzlhVWgkACZ5i9g9KUIuMVxRRyOBNP1N86mJSDJYRtvZ8m7JAmNxgimzmci7FueIlnJp89233CBYROeZJWmkhqbd-NGCto-rICdO3DaTAGkPfnREs6n5sHX16c-SLZjOq5jvsqKWtDn9UXg=w640-h38)](https://blogger.googleusercontent.com/img/a/AVvXsEjUhpzwPkRmSwutRlx_6rOZsVbBlkN2yKAy-BWAbnMazAipzlhVWgkACZ5i9g9KUIuMVxRRyOBNP1N86mJSDJYRtvZ8m7JAmNxgimzmci7FueIlnJp89233CBYROeZJWmkhqbd-NGCto-rICdO3DaTAGkPfnREs6n5sHX16c-SLZjOq5jvsqKWtDn9UXg)

Bypass-Sandbox-Evasion - Bypass Malware Sandbox Evasion Ram Check
![Bypass-Sandbox-Evasion - Bypass Malware Sandbox Evasion Ram Check](https://blogger.googleusercontent.com/img/a/AVvXsEj2tTiSJYVtHsUsygJcmPjh3RYf3xCxgCF9EaaiX9IcIgqsA_I3qYMjVXn2O3hn18zl9GGT_iW7xxkZPuKceVqfOW0g5_dNFvUOgfsc5WsJTt0daGBfqflGsy_Uiao2regl1a2weZpHuk1kWnZAsK7nZdmHRjoM1zV-EvEVkSnU3QBv44I91ixPZALk6w=s72-w640-c-h460)
Reviewed by Zion3R
on
8:30 AM
Rating: 5

文章来源: http://www.kitploit.com/2023/06/bypass-sandbox-evasion-bypass-malware.html
 如有侵权请联系:admin#unsafe.sh

© [unSafe.sh - 不安全](https://unsafe.sh) Powered By [PaperCache](https://github.com/code-scan/PaperCache)

* admin#unsafe.sh
* [安全马克](https://aq.mk)
* [星际黑客](https://xj.hk)
* [T00ls](https://t00ls.net)