---
title: 好用但难用的Excel
url: https://blog.xlab.app/p/98e8b0f5/
source: 明天的乌云
date: 2023-03-28
fetch_date: 2025-10-04T10:52:46.357832
---

# 好用但难用的Excel

[明天的乌云](/)

透明人博客

* [首页](/)
* [分类](/categories/)
* [归档](/archives/)
* [日报专栏](https://daily.xlab.app/)
* [我的推荐](/links/)
* [友情链接](/friends/)
* [关于](/about/)
* 搜索

* 文章目录
* 站点概览

1. [1. 统计场景](#%E7%BB%9F%E8%AE%A1%E5%9C%BA%E6%99%AF)
2. [2. 自己尝试](#%E8%87%AA%E5%B7%B1%E5%B0%9D%E8%AF%95)
3. [3. GPT带带我](#GPT%E5%B8%A6%E5%B8%A6%E6%88%91)
4. [4. 好用与难用](#%E5%A5%BD%E7%94%A8%E4%B8%8E%E9%9A%BE%E7%94%A8)
5. 5. 相关文章

![透明人](/images/logo.png)

透明人

Tmr Blog

[197
日志](/archives/)

[33
分类](/categories/)

[159
标签](/tags/)

0%

链接

* [透明日报](https://daily.xlab.app/ "https://daily.xlab.app")

# 好用但难用的Excel

发表于
2023-03-27

分类于

[其他](/categories/%E5%85%B6%E4%BB%96/)

阅读次数：

本文字数：
956

阅读时长 ≈
1 分钟

上次用Excel还是在几年前，当时觉得还挺好用的，但现在面对略微复杂的场景，Excel似乎有点智障了

## 统计场景

首先有一组随机数字，值在[0,50]之间，一共有200个

现在想统计出以10为间隔，值的分布情况，并把分布统计结果画在一个图表上

也就是值在[0,10]、[10,20]、[20,30]、[30,40]、[40,50]这5个区间内，出现个数占整体的百分比，然后画一个图

## 自己尝试

选中这一列数据，然后点击`插入`->`图表`，我选了一个直方图

默认的横坐标间隔不合适，双击横坐标，在右侧可以调整间隔（叫箱宽度），手动改为10

默认的纵坐标是统计的个数，而我想要的是百分比，也就是个数/总数，到处找到处尝试，没有发现哪里可以改成我想要的结果

## GPT带带我

网上搜了一圈没找到办法，离谱的是还有教程教你，直接把纵坐标的类型改成百分比，然后就完事了，配图显示从几十变成了百分之几千…

在ChatGPT的帮助下，学习使用Excel函数，先统计出每个区间内的个数，然后再计算百分比

最后得到一个复杂的函数公式，实现统计个数

|  |  |
| --- | --- |
| ``` 1 ``` | ``` =COUNTIF(C2:C201,"<="&(ROW()-1)*10)-SUM(OFFSET(D$1,0,0,ROW()-1,1)) ``` |

解释以下这个公式，我这里数字在C列，从第二行开始，统计结果放在D列

`COUNTIF`统计在指定条件下的个数，条件就是`<=10`，`<=20`这样

为了避免手动输入10，20，30这样的数，使用`ROW()*10`来表达

然后这个统计数还需要减去前面统计数的和，也就是`<=30`的统计数，需要减去`<=20`的统计数，来实现`20<=x<30`，用的是`SUM(OFFSET(D$1,0,0,ROW()-1,1))`，不深究了，因为这是直接复制ChatGPT的

然后再在E列中计算百分比

最后用E列生成一个图表

## 好用与难用

Excel的一键制作图表，确实好用，相当于把上面的复制公式省略了

但只要稍微偏离一点点，Excel就无能为力了

其实我觉得挺简单的，原本的纵坐标是个数，只要再除以总数就完事了，但Excel好像没有这个功能，只能手动实现

我不是Excel大师，我只觉得Excel难用

Excel集成GPT应该就能解决这个问题了吧，等发布了再来试试

## 相关文章

* [从Office诱饵到鸡肋RCE](https://blog.xlab.app/p/8fbece25/)

欢迎关注我的其它发布渠道

[Twitter](https://twitter.com/tmr11235)

[Telegram](https://t.me/tm_daily)

[RSS](/atom.xml)

[Office](/tags/Office/)

[Sqlite安全研究瞎想](/p/37eba095/ "Sqlite安全研究瞎想")

[RSSHub规则化架构设计](/p/9c76cef/ "RSSHub规则化架构设计")

[地球ICP备42号](https://beian.miit.gov.cn/)

© 2016 –
2025

透明人

站点总字数：
343k

Theme NexT works best with JavaScript enabled