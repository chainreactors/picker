---
title: 2024 闽盾杯-黑盾赛道WP - 渗透测试中心
url: https://www.cnblogs.com/backlion/p/18450997
source: 博客园 - 渗透测试中心
date: 2024-10-09
fetch_date: 2025-10-06T18:53:37.254409
---

# 2024 闽盾杯-黑盾赛道WP - 渗透测试中心

[![](https://img2024.cnblogs.com/blog/35695/202509/35695-20250929100304557-587378723.jpg)](https://qoder.com/)

* [![博客园logo](//assets.cnblogs.com/logo.svg)](https://www.cnblogs.com/ "开发者的网上家园")
* [会员](https://cnblogs.vip/)
* [众包](https://www.cnblogs.com/cmt/p/18500368)
* [新闻](https://news.cnblogs.com/)
* [博问](https://q.cnblogs.com/)
* [闪存](https://ing.cnblogs.com/)
* [赞助商](https://www.cnblogs.com/cmt/p/19081960)
* [HarmonyOS](https://harmonyos.cnblogs.com/)
* [Chat2DB](https://chat2db-ai.com/)

* ![搜索](//assets.cnblogs.com/icons/search.svg)
  ![搜索](//assets.cnblogs.com/icons/enter.svg)
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    所有博客
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    当前博客
* [![写随笔](//assets.cnblogs.com/icons/newpost.svg)](https://i.cnblogs.com/EditPosts.aspx?opt=1 "写随笔")
  [![我的博客](//assets.cnblogs.com/icons/myblog.svg)](https://passport.cnblogs.com/GetBlogApplyStatus.aspx "我的博客")
  [![短消息](//assets.cnblogs.com/icons/message.svg)](https://msg.cnblogs.com/ "短消息")
  ![简洁模式](//assets.cnblogs.com/icons/lite-mode-on.svg)

  [![用户头像](//assets.cnblogs.com/icons/avatar-default.svg)](https://home.cnblogs.com/)

  [我的博客](https://passport.cnblogs.com/GetBlogApplyStatus.aspx)
  [我的园子](https://home.cnblogs.com/)
  [账号设置](https://account.cnblogs.com/settings/account)
  [会员中心](https://vip.cnblogs.com/my)
  简洁模式 ...
  退出登录

  [注册](https://account.cnblogs.com/signup)
  登录

[![返回主页](/skins/custom/images/logo.gif)](https://www.cnblogs.com/backlion/)

# [渗透测试中心](https://www.cnblogs.com/backlion)

##

* [博客园](https://www.cnblogs.com/)
* [首页](https://www.cnblogs.com/backlion/)
* [新随笔](https://i.cnblogs.com/EditPosts.aspx?opt=1)
* [联系](https://msg.cnblogs.com/send/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83)
* [管理](https://i.cnblogs.com/)
* 订阅
  [![订阅](/skins/coffee/images/xml.gif)](https://www.cnblogs.com/backlion/rss/)

# [2024 闽盾杯-黑盾赛道WP](https://www.cnblogs.com/backlion/p/18450997 "发布于 2024-10-08 09:16")

## CRYPTO

### 签到题-学会SM

https://www.json.cn/encrypt/sm3

![在这里插入图片描述](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091543494-35429586.png)

题目要求小写所以需要转换一下

![在这里插入图片描述](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091544260-1260138321.png)

或者脚本：

import hashlib

message = "heidun2024"

hash\_object = hashlib.new('sm3')

hash\_object.update(message.encode('utf-8'))

hash\_value = hash\_object.hexdigest()

print(hash\_value)

###

## **源码和数据都要保护**

利用php在线解密工具解密php

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091545084-1544516962.jpg)

得到php源代码

<?php

function my\_encode($str,$key) {

$re='';

$len=strlen($str);

for ($i=0;$i<$len;$i++) {

$c=substr($str,$i,1);

$k=substr($key,($i%strlen($key)),1);

$num=ord($c)+ord($k);

if($num>255) $num-=256;

$re.=chr($num);

}

return $re;

}

function my\_decode($str,$key) {

return 'Something missed.';

}

$data=@$\_GET['data'];

$key=@$\_GET['key'];

if($key=='') $key='hdhd4321';

if($data!='') {

$mi=my\_encode($data,$key);

file\_put\_contents('data\_encoded.txt',$mi);

echo 'Saved to data\_encoded.txt';

}

?>

编写脚本后得到flag

```
<?php
```

```
 function my_encode($str,$key) {
```

```
  $re='';
```

```
  $len=strlen($str);
```

```
  for ($i=0;$i<$len;$i++) {
```

```
    $c=substr($str,$i,1);
```

```
    $k=substr($key,($i%strlen($key)),1);
```

```
    $num=ord($c)+ord($k);
```

```
    if($num>255) $num-=256;
```

```
    $re.=chr($num);
```

```
  }
```

```
  return $re;
```

```
}
```

```
function my_decode($str,$key) {
```

```
  return 'Something missed.';
```

```
}
```

```
$data=@$_GET['data'];
```

```
$key=@$_GET['key'];
```

```
if($key=='') $key='hdhd4321';
```

```
if($data!='') {
```

```
  $mi=my_encode($data,$key);
```

```
  file_put_contents('data_encoded.txt',$mi);
```

```
  echo 'Saved to data_encoded.txt';
```

```
}
```

```
?><?php
```

```
 function my_encode($str,$key) {
```

```
  $re='';
```

```
  $len=strlen($str);
```

```
  for ($i=0;$i<$len;$i++) {
```

```
    $c=substr($str,$i,1);
```

```
    $k=substr($key,($i%strlen($key)),1);
```

```
    $num=ord($c)+ord($k);
```

```
    if($num>255) $num-=256;
```

```
    $re.=chr($num);
```

```
  }
```

```
  return $re;
```

```
}
```

```
function my_decode($str,$key) {
```

```
  return 'Something missed.';
```

```
}
```

```
$data=@$_GET['data'];
```

```
$key=@$_GET['key'];
```

```
if($key=='') $key='hdhd4321';
```

```
if($data!='') {
```

```
  $mi=my_encode($data,$key);
```

```
  file_put_contents('data_encoded.txt',$mi);
```

```
  echo 'Saved to data_encoded.txt';
```

```
}
```

```
?>
```

## **我的进制我做主**

题目给了数据

```
ergdgjboglfpgcbpbofmgafhfngpfoflfpfkgjgccndcfqfpgcgofofpdadadagr
```

题目提示是自定义进制，因此首先先查看字符串用到的符号，有如下17个符号。

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091545733-1752718154.jpg)

大致为a到r的字母顺序，少了一个i。因此推测实际为18进制，a到r对应0-9\a-h，其中i未使用到。

最后经测试，为每个字母单独编码一个2位18进制，解得flag。

```
from Crypto.Util.number import *
```

```
with open("我的进制我做主.txt") as file:
```

```
    dat = file.readline()
```

```
print(dat.encode().hex())
```

```
print(dat)
```

```
print(len(dat))
```

```

```

```
co = 0
```

```
for i in [chr(i) for i in range(ord('a'), ord('z')+1)]:
```

```
    if i in dat:
```

```
        print(i, end='')
```

```
        co+=1
```

```
print()
```

```
print(co)
```

```

```

```
chls = 'abcdefghijklmnopqr'
```

```
myO  = '0123456789abcdefgh'
```

```
ct = dict(zip(chls,myO))
```

```
print(ct)
```

```
decDat = ''.join([str(ct[i]) for i in dat])
```

```

```

```
flag = ''
```

```
jinzhi = 18
```

```
for i in range(0, len(decDat),2):
```

```
    tmp = decDat[i: i+2]
```

```
    res = int(tmp, jinzhi)
```

```

```

```
    flag += chr(res)
```

```
    print(f'{tmp}, {res}, {chr(res)}')
```

```

```

```
print(decDat)
```

```
print(flag)
```

```

```

```

```

```
flag2 = int(decDat, jinzhi)
```

```
print(flag2)
```

```
print(long_to_bytes(flag2)) s
```

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091546391-954442558.jpg)

`flag{heidun18jinzhi666}`

### 源码和数据都要保护

题目描述：难懂的PHP，难懂的flag。

附件中的PHP文件经过加密，需要破解。可以用一些在线破解平台，如：http://www.zhaoyuanma.com/zym.html ，也可以自己搭建PHP环境，安装php-beast扩展模块，以debug模式把PHP源码还原出来。（模块用默认密钥即可）

源代码写了加密函数，没写解密函数：

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091547075-918034358.jpg)

要自己写出解密函数来对txt文件解密才能得到明文flag，参考解密代码：

![](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091547925-1102002824.jpg)

## MISC

### 一个Logo

考察的lsb隐写，直接zsteg梭哈了

![在这里插入图片描述](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091549448-550954098.png)

用Stegsolve一样可以，b0通道

![在这里插入图片描述](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091551343-1557060540.png)

我变个样就不认识我

题目是变样，我猜测还是lsb，用zsteg跑

![在这里插入图片描述](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091552636-83805511.png)

发现是存在冗余数据

看着这个直接能想到base64换表

![在这里插入图片描述](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091553688-1438875412.png)

发现编码表不正确，可能是表不全的原因， 因为是xyz开头，所以补充上abcdefghijklmnopqrstuvw

![在这里插入图片描述](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091554846-1519318242.png)

### 学会Office

看到是xls就知道是excel表格

用wps打开看看，发现可以取消隐藏

![在这里插入图片描述](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091556215-414821723.png)

看到了flag列，提示了宏加密，因为我的wps不能够进行宏操作，我就换了windows的office

在视图中可以找到宏

![在这里插入图片描述](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091557502-938103659.png)

但是看上去flag的字符顺序并不对

利用筛选功能进行排序，筛选计算机成绩降序

![在这里插入图片描述](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091558993-216507804.png)

提取flag字符

![image-20240622123941465](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091559688-800847852.png)

### 我不是二维码

![在这里插入图片描述](https://img2023.cnblogs.com/blog/1049983/202410/1049983-20241008091600662-625123007.png)

看着像二维码，然后还是0000000111111这种类型的，直接上Byxs20 b神的工具puzzlesolver，想购买工具的可以联系 企鹅97766819

![](https://img2023.cnblogs.com/...