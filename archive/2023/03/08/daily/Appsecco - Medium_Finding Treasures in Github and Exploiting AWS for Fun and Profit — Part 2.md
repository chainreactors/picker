---
title: Finding Treasures in Github and Exploiting AWS for Fun and Profit — Part 2
url: https://blog.appsecco.com/finding-treasures-in-github-and-exploiting-aws-for-fun-and-profit-part-2-8ffefa995439?source=rss----e2adb3957733---4
source: Appsecco - Medium
date: 2023-03-08
fetch_date: 2025-10-04T08:57:34.667582
---

# Finding Treasures in Github and Exploiting AWS for Fun and Profit — Part 2

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8ffefa995439&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblog.appsecco.com%2Ffinding-treasures-in-github-and-exploiting-aws-for-fun-and-profit-part-2-8ffefa995439&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblog.appsecco.com%2Ffinding-treasures-in-github-and-exploiting-aws-for-fun-and-profit-part-2-8ffefa995439&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## Appsecco](https://blog.appsecco.com/?source=post_page---publication_nav-e2adb3957733-8ffefa995439---------------------------------------)

·

Follow publication

[![Appsecco](https://miro.medium.com/v2/resize:fill:76:76/1*-ERVMgF2P005dtPsm5nIqw.jpeg)](https://blog.appsecco.com/?source=post_page---post_publication_sidebar-e2adb3957733-8ffefa995439---------------------------------------)

Blog posts from the Security Testing Teams and DevSecOps Teams at Appsecco. Covering security around applications, Cloud environments like AWS, Azure, GCP, Kubernetes, Docker. Covering DevSecOps topics such as Secrets Management, Secure CI/CD Pipelines and more

Follow publication

# Finding Treasures in Github and Exploiting AWS for Fun and Profit — Part 2

[![Bhagavan Bollina](https://miro.medium.com/v2/resize:fill:64:64/1*KBLwUEM9IQdhQc_3X72iEQ.jpeg)](https://medium.com/%40XCriminal?source=post_page---byline--8ffefa995439---------------------------------------)

[Bhagavan Bollina](https://medium.com/%40XCriminal?source=post_page---byline--8ffefa995439---------------------------------------)

5 min read

·

Mar 7, 2023

--

1

Listen

Share

Press enter or click to view image in full size

![]()

Photo by [Bjorn Pierre](https://unsplash.com/%40bjornpierre) on [Unsplash](https://unsplash.com/photos/lLRm3S-7Kfw?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

*Disclaimer: This article is written for educational purposes, the author and Appsecco does not encourage readers to do engage in questionable practices without the permission of the repository owner. Please note a personal snapshot was used for the demo.*

In our journey from Part 1, we found AWS credentials and used them to enumerate and discover an AWS EBS snapshot which turned out to be public. This post continues our journey of what to do next.

To read Part 1 of this post, go to [https://blog.appsecco.com/finding-treasures-in-github-and-exploiting-aws-for-fun-and-profit-part-1-be5cfadf942](/finding-treasures-in-github-and-exploiting-aws-for-fun-and-profit-part-1-be5cfadf942)

## Table of Contents

1. Introduction
2. Where can you find public snapshots?
3. What to do after finding these snapshots?
4. How do you protect your snapshots?
5. References

## Introduction

Amazon Elastic Block Store (Amazon EBS) provides block-level storage volumes for use with EC2 instances. EBS volumes behave like raw, unformatted block devices. You can mount these volumes as devices on your instances.

Press enter or click to view image in full size

![]()

EBS volumes that are attached to an instance are exposed as storage volumes that persist independently from the life of the instance. This document shows how can you detect these public snapshots and exploit them to gain sensitive information.

## Where can you find public snapshots?

AWS allows you to configure EBS snapshots to have public visibility. This is so that you can wantingly make your snapshots public as part of the wider community or if you wanted to distribute the snapshot to a wider audience as part of your business offerings. However, more often than not, AWS users accidentally expose these snapshots to all AWS users.

A quick way to check if a snapshot id you have obtained is public or not is to run the following command

`aws ec2 describe-snapshots --snapshot-ids <snapshot-id-here>`

If you see an output, the snapshot is public.

AWS has over 20,000+ public snapshots in US East 1 region alone! You can see them in your console [here](https://us-east-1.console.aws.amazon.com/ec2/home?region=us-east-1#Snapshots:visibility=public).

Press enter or click to view image in full size

![]()

Public snapshots in AWS in us-east-1

## What to do after finding these snapshots?

To quickly work with a public snapshot (best results with a non encrypted snapshot), you can create a volume out of them and attach the volume to an EC2 instance and browse the filesystem.

Using the snapshot-id obtained from the credentials discovered in [Part 1 of the post](/finding-treasures-in-github-and-exploiting-aws-for-fun-and-profit-part-1-be5cfadf942), we can create a volume and attach the volume to an Ubuntu instance.

Press enter or click to view image in full size

![]()

Attaching EBS to EC2 Instance

Once attached, we can, mount the filesystem to check through the disk. After attaching the volume, ssh into the instance which is launched

```
ssh -i "YOURS.pem" ubuntu@<ip>
```

Run the command to view the filesystem - `lsblk`

![]()

filesystem sysfs list

Now, let's mount the partition`xvdf1` to `/mnt` using the `mount` command.

```
mount /dev/xvdf1 /mnt
```

Once you mount you can browse the files and folders, hunting for credentials gets you some quick wins. A good place to check is the `/mnt/root/.ssh` directory which contains SSH keys if default paths are used when creating them.

Press enter or click to view image in full size

![]()

Found SSH keys

Looking at the ~/.bash\_history file should give you some IP addresses that could potentially be accessible using the SSH keys.

Press enter or click to view image in full size

![]()

SSH into a machine discovered using bash history

Additional discovery can be performed on this machine. We found the`/opt` folder to contain some interesting stuff.

Press enter or click to view image in full size

![]()

Found folders related to the development

I saw that the `dev` folder had a git repository.

Press enter or click to view image in full size

![]()

Exploring .git folder

To view the git commits on the repo, we can use `git log` . After checking the commits, one commit caught my attention. The commit message read `Remove env config` which I thought was interesting.

Press enter or click to view image in full size

![]()

I copied the commit ID of the commit and ran `git show <COMMIT-ID>` This showed me the credentials of an instance including some other sensitive information. This is a good example of what a post exploitation scenario would like.

Press enter or click to view image in full size

![]()

Found additional AWS credentials

## How do you protect your snapshots?

A good way to secure your EBS snapshots is to ensure their visibility is set to private AND they are encrypted.

We can automate this using Service Control Policies as well. Create an SCP that blocks “ec2:ModifySnapshotAttribute” which is responsible for modifying snapshot permissions to make it public. This prevents making snapshots public (available to all AWS accounts). We will write about this in a future post.

In the AWS console, look at the Permissions tab for any snapshot and make sure it s...