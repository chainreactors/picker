---
title: 生产网云负载防护如何落地？来自字节跳动的实践分享
url: https://www.anquanke.com/post/id/283780
source: 安全客-有思想的安全新媒体
date: 2022-11-30
fetch_date: 2025-10-04T00:02:16.620894
---

# 生产网云负载防护如何落地？来自字节跳动的实践分享

首页

阅读

* [安全资讯](https://www.anquanke.com/news)
* [安全知识](https://www.anquanke.com/knowledge)
* [安全工具](https://www.anquanke.com/tool)

活动

社区

学院

安全导航

内容精选

* [专栏](/column/index.html)
* [精选专题](https://www.anquanke.com/subject-list)
* [安全KER季刊](https://www.anquanke.com/discovery)
* [360网络安全周报](https://www.anquanke.com/week-list)

# 生产网云负载防护如何落地？来自字节跳动的实践分享

阅读量**406551**

发布时间 : 2022-11-29 17:00:18

**x**

##### 译文声明

本文是翻译文章

译文仅供参考，具体内容表达以及含义原文为准。

近期，在CIS2022大会上，字节跳动服务器安全效果负责人鹿恩哲做了《字节跳动云负载防护最佳实践》的主题分享，在分享中，鹿恩哲从字节跳动内部实践出发，分享字节跳动是如何面对复杂业务环境和部署环境进行全负载安全防护，并如何通过数据优化、告警归并和关联溯源等方式解决海量负载下的安全运营压力。

![]()

## 云负载防护面临的威胁

在字节跳动，有大量不同需求的业务部署在物理机、虚拟机、容器、Serverless等不同负载平台上。经研究发现，不同的负载存在特异化的安全威胁。针对物理机和虚拟机的以传统的反入侵、合规、风险感知为主，在容器部分的负载中，引入的镜像安全，集群层面反入侵也层出不穷，到了Serverless层，应用内的高权限API调用难以从主机/容器层进行区分，而较短的生命周期也带来事后溯源与排查的困难。

恩哲提到，安全所能支配的资源往往是有限的，企业不可能为了不同负载用不同的团队进行任务分化，而且入侵往往具有关联性，需要将多种不同的workload结合在一起处理和分析，所以面对上述不同方式的威胁，火山引擎结合字节跳动内部实践经验，研发了一体化的云负载防护平台CWPP。

据介绍，火山引擎CWPP源自字节跳动内部的主机安全解决方案Elkeid。Elkeid在字节跳动内部解决了千万级容器的反入侵与溯源需求，其采集能力模块已经对外开源（[https://github.com/bytedance/Elkeid）。](https://github.com/bytedance/Elkeid%EF%BC%89%E3%80%82)

CWPP从设计之初便遵循为物理机、虚拟机、容器和无服务器工作负载提供一致的保护和可见性的原则，将主机安全，容器安全，RASP，阻断与响应能力，追溯能力通过插件的方式整合在了一个agent上，同时字节内部跨地域跨云的部署需求，也催生了CWPP对多云和混合云下的支持能力。

![]()

火山引擎CWPP设计思路

如图所示，火山引擎CWPP将多种负载的保护能力集成在了一套原生架构上，并开发了专用的高速策略引擎和海量机器下的服务发现能力。这种整合降低了整体运维的压力。

## CWPP 数据收集

在针对不同负载按照需求采集不同方面和来源的数据方面，目前CWPP对主机/虚拟机/容器的采集均落在内核层。通过对比用户态的方案，内核层采集带来的好处不只是更丰富的数据采集能力，更低的性能开销，还对容器有天然支持。

同时，在应用层还是会遇到类似SSRF/RCE/SQL注入等针对应用层的入侵。因此我们开发了火山引擎Elkeid RASP，Elkeid RASP是火山引擎云安全团队自研的一种应用安全防御技术，通过对应用运行时植入探针来采集运行时的关键信息，并分析运行时行为产生及时告警。

通过下图可以看到左边是Elkeid RASP在端上数据采集时的生态位，针对应用层本身进行防护。从右边可以看到，Elkeid RASP是端上agent的一个插件，它会负责对选定的服务进行动态注入RASP probe，支持跨容器的服务监控和管理。而RASP probe则在运行时提供Hook信息上报，热补丁，阻断访问等操作。并且火山引擎 Elkeid RASP 同时支持在多种语言环境下的使用，基本可满足大部分公司内的后台服务。

![]()

在云原生时代，容器本身的利用是一方面，Kubenetes集群本身的利用是另一个新增的暴露面。Elkeid RASP因此利用Kubenetes原生的audit log数据，通过日志采集层接入策略引擎，来编写和分析出安全事件或者威胁风险，进而提供给安全工程师研判分析。

## CWPP 告警和策略

在收集数据之后，撰写对应的策略并对识别出的告警信息进行及时运营是下一步的重点：

1、首先是告警本身的上下文追加，也就是行为序列检测。如下图，三个信息本身都是不具备显著风险，但组合在一起，形成基于背景的行为序列，这个行为序列本身就具备一定风险，则需要告警。

![]()

2、针对长期驻留的二进制，CWPP构建了云查杀能力。通过可疑二进制扔到云端，利用多引擎进行静态检测并在动态沙箱内真实执行样本以观察分析行为，用更丰富的规则和数据来判断样本是否为恶意样本。目前云查杀在字节内部已经抓获多起来自内外隐蔽入口的恶意二进制。

3、火山引擎 CWPP 通过自研存储层实现对原始数据存储的低成本存储和高效查询，该方案可以支持PB级原始数据的秒级查询，当产生安全告警后，CWPP 溯源引擎会尝试通过将告警与原始数据关联查询以达到还原现场的能力。

## CWPP 告警案例

在今年的一起 Java RCE Alert 告警引起的应急中，攻击者从边缘机器进来，发现任意文件读取和ssrf漏洞可利用后，进行了盲打，找到了一个jenkins集群下马。在迅速的CWPP告警和阻断后依然不断更新方法和目标，进行了多次对抗和攻击尝试。在CWPP提供了精准的告警信息后，运营人员根据自动关联事件排查其它告警，迅速定损止损，并通过CWPP平台快速下发RASP防护，将捕获的运行时告警实时上报，通过CWPP强大的告警溯源能力和处置能力有效解决以上问题。

![]()

火山引擎CWPP是为物理机、虚拟机、容器和无服务器工作负载提供一致的保护和可见性的安全产品。在未来， CWPP 将持续结合整体网络环境，和字节跳动内部实践、技术创新，为企业用户提供更为全面的主机安全解决方案。

火山引擎长期关注并重视用户的信息安全，通过结合字节跳动多年积累的网络安全建设经验，将持续为企业用户提供全面的网络安全解决方案。

![]()

本文翻译自 原文链接。如若转载请注明出处。

商务合作，文章发布请联系 anquanke@360.cn

本文由**火山引擎云安全**原创发布

转载，请参考[转载声明](https://www.anquanke.com/note/repost)，注明出处： [https://www.anquanke.com/post/id/283780](/post/id/283780)

安全KER - 有思想的安全新媒体

本文转载自:

如若转载,请注明出处：

安全KER - 有思想的安全新媒体

分享到：![微信](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

* [主机安全](/tag/%E4%B8%BB%E6%9C%BA%E5%AE%89%E5%85%A8)
* [容器安全](/tag/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8)
* [云负载保护](/tag/%E4%BA%91%E8%B4%9F%E8%BD%BD%E4%BF%9D%E6%8A%A4)

**+1**2赞

收藏

![](https://p3.ssl.qhimg.com/t01d7c5cb6fdb04a6cc.png)火山引擎云安全

分享到：![微信](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

## 发表评论

您还未登录，请先登录。

[登录](/login/index.html)

![](https://p3.ssl.qhimg.com/t014757b72460d855bf.png)

[![](https://p3.ssl.qhimg.com/t01d7c5cb6fdb04a6cc.png)](/member.html?memberId=165382)

[火山引擎云安全](/member.html?memberId=165382)

火山引擎云安全产品是字节跳动旗下的企业级安全技术服务产品

* 文章
* **40**

* 粉丝
* **4**

### TA的文章

* ##### [为AI Agent行为立“规矩”——字节跳动提出Jeddak AgentArmor智能体安全框架](/post/id/312426)

  2025-09-28 13:43:32
* ##### [教你打造一款AI安全助手 | 安全MCP的实践指南](/post/id/311884)

  2025-09-05 10:40:51
* ##### [当数字世界的“万能钥匙”被滥用，谁来守护核心资产？火山的 MCP 安全授权新范式](/post/id/311597)

  2025-08-28 09:50:41
* ##### [广汽集团×火山引擎：出海合规助力企业新增长](/post/id/311498)

  2025-08-26 10:17:09
* ##### [智能体防御 | 一文了解3种系统提示词加固方法](/post/id/311279)

  2025-08-18 16:34:50

### 相关文章

* ##### [Kubernetes RBAC 最佳安全实践](/post/id/300925)

  2024-10-15 21:29:20
* ##### [一个未公开的容器逃逸方式](/post/id/290540)

  2023-09-07 18:22:32
* ##### [BlackHat Asia 2023 武器库| 开源工作负载解决方案Elkeid](/post/id/288765)

  2023-05-23 17:17:41
* ##### [云原生安全2.X 进化论系列|云原生安全2.X未来展望（4）](/post/id/287247)

  2023-03-28 15:22:31
* ##### [云原生安全2.X 进化论系列|云原生安全2.X落地实操（3）](/post/id/286819)

  2023-02-28 17:30:23
* ##### [浅析容器运行时安全加固](/post/id/284713)

  2023-01-03 12:00:53
* ##### [字节开源 | 云工作负载保护平台Elkeid 社区版 v1.9.1 正式发布](/post/id/284075)

  2022-12-06 15:30:33

### 热门推荐

文章目录

* [云负载防护面临的威胁](#h2-0)
* [CWPP 数据收集](#h2-1)
* [CWPP 告警和策略](#h2-2)
* [CWPP 告警案例](#h2-3)

![](https://p0.qhimg.com/t11098f6bcd5614af4bf21ef9b5.png)

安全KER

* [关于我们](/about)
* [联系我们](/note/contact)
* [用户协议](/note/protocol)
* [隐私协议](/note/privacy)

商务合作

* [合作内容](/note/business)
* [联系方式](/note/contact)
* [友情链接](/link)

内容需知

* [投稿须知](https://www.anquanke.com/contribute/tips)
* [转载须知](/note/repost)
* 官网QQ群：568681302

合作单位

* [![安全KER](https://p0.ssl.qhimg.com/t01592a959354157bc0.png)](http://www.cert.org.cn/)
* [![安全KER](https://p0.ssl.qhimg.com/t014f76fcea94035e47.png)](http://www.cnnvd.org.cn/)

Copyright © 北京奇虎科技有限公司 三六零数字安全科技集团有限公司 安全KER All Rights Reserved [京ICP备08010314号-66](https://beian.miit.gov.cn/)[![](https://icon.cnzz.com/img/pic.gif)](https://www.cnzz.com/stat/website.php?web_id=1271278035 "站长统计")

微信二维码

**X**![安全KER](https://p0.ssl.qhimg.com/t0151209205b47f2270.jpg)