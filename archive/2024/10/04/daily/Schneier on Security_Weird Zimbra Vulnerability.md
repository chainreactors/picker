---
title: Weird Zimbra Vulnerability
url: https://www.schneier.com/blog/archives/2024/10/weird-zimbra-vulnerability.html
source: Schneier on Security
date: 2024-10-04
fetch_date: 2025-10-06T18:54:36.027716
---

# Weird Zimbra Vulnerability

# [Schneier on Security](https://www.schneier.com/)

Menu

* [Blog](https://www.schneier.com)
* [Newsletter](https://www.schneier.com/crypto-gram/)
* [Books](https://www.schneier.com/books/)
* [Essays](https://www.schneier.com/essays/)
* [News](https://www.schneier.com/news/)
* [Talks](https://www.schneier.com/talks/)
* [Academic](https://www.schneier.com/academic/)
* [About Me](https://www.schneier.com/blog/about/)

### Search

*Powered by [DuckDuckGo](https://duckduckgo.com/)*

Blog

Essays

Whole site

### Subscribe

[![Atom](https://www.schneier.com/wp-content/uploads/2019/10/rss-32px.png)](https://www.schneier.com/feed/atom/)[![Facebook](https://www.schneier.com/wp-content/uploads/2019/10/facebook-32px.png)](https://www.facebook.com/bruce.schneier)[![Twitter](https://www.schneier.com/wp-content/uploads/2019/10/twitter-32px.png)](https://twitter.com/schneierblog)[![Email](https://www.schneier.com/wp-content/uploads/2019/10/email-32px.png)](https://www.schneier.com/crypto-gram)

[Home](https://www.schneier.com)[Blog](https://www.schneier.com/blog/archives/)

## Weird Zimbra Vulnerability

Hackers can execute commands on a remote computer by sending [malformed emails](https://arstechnica.com/security/2024/10/attackers-exploit-critical-vulnerability-recently-patched-in-zimbra-servers/) to a Zimbra mail server. It’s critical, but difficult to exploit reliably.

> In an email sent Wednesday afternoon, Proofpoint researcher Greg Lesnewich seemed to largely concur that the attacks weren’t likely to lead to mass infections that could install ransomware or espionage malware. The researcher provided the following details:
>
> * While the exploitation attempts we have observed were indiscriminate in targeting, we haven’t seen a large volume of exploitation attempts* Based on what we have researched and observed, exploitation of this vulnerability is very easy, but we do not have any information about how reliable the exploitation is* Exploitation has remained about the same since we first spotted it on Sept. 28th* There is a PoC available, and the exploit attempts appear opportunistic* Exploitation is geographically diverse and appears indiscriminate* The fact that the attacker is using the same server to send the exploit emails and host second-stage payloads indicates the actor does not have a distributed set of infrastructure to send exploit emails and handle infections after successful exploitation. We would expect the email server and payload servers to be different entities in a more mature operation.* Defenders protecting Zimbra appliances should look out for odd CC or To addresses that look malformed or contain suspicious strings, as well as logs from the Zimbra server indicating outbound connections to remote IP addresses.

Tags: [backdoors](https://www.schneier.com/tag/backdoors/), [hacking](https://www.schneier.com/tag/hacking/), [ransomware](https://www.schneier.com/tag/ransomware/)

[Posted on October 3, 2024 at 7:04 AM](https://www.schneier.com/blog/archives/2024/10/weird-zimbra-vulnerability.html) •
[11 Comments](https://www.schneier.com/blog/archives/2024/10/weird-zimbra-vulnerability.html#comments)

### Comments

SocraticGadfly •
[October 3, 2024 11:07 AM](https://www.schneier.com/blog/archives/2024/10/weird-zimbra-vulnerability.html/#comment-440906)

Very interesting. And personal.

The internet company for the email accounts for my two newspapers is on Zimbra. I am going to pass this on.

Clive Robinson •
[October 3, 2024 11:50 AM](https://www.schneier.com/blog/archives/2024/10/weird-zimbra-vulnerability.html/#comment-440907)

@ Bruce,

You say,

> “It’s critical, **but difficult** to exploit.”

And in the 2nd point in the quote from the researcher,

> *“exploitation of this vulnerability is **very easy**,”*

Which would appear to be at odds with each other.

bud •
[October 3, 2024 2:12 PM](https://www.schneier.com/blog/archives/2024/10/weird-zimbra-vulnerability.html/#comment-440910)

> In the patched version, execvp is used, and user input is passed as an array, which prevents direct command injection. Additionally, we noticed the introduction of an is\_safe\_input function that sanitizes the input before it’s passed to execvp. We examined this function to identify any special characters that might lead to command injection.

That’s one hell of a bad-design shibboleth, and that’s in the supposedly “fixed” version.

Any time one “enumerates badness”, one is liable to miss something. But even doing the opposite—enumerating acceptable characters—is generally a bad idea. In this case, the “correct” (and still bad) thing would be to re-encode from “arbitrary octets” to “shell-encoded data”; certain octet values, notably 0, would be non-encodable and would either have to be rejected, or have some beyond-shell encoding defined for them. (The decompilation shows that Zimbra is working with null-terminated C strings, using the C string functions to do so, and using raw pointer math on the strings; so null bytes won’t matter, but these are all bad ideas themselves.)

Really, any time user-provided data is being passed to a shell, it should be done via environment variables (which allow all non-zero octets without further encoding); or something else such as a file, but then an encoding has to be defined for that. The whole idea of involving a shell, though, ought to be questioned.

My not-so-humble opinion is to stop using Zimbra; it needs re-writing, not patching. Also, sand-box your servers as heavily as possible. Mail-receiving code probably doesn’t need the ability to connect to non-local addresses, for example—for things like forwarding and reputation-list checking, a differently-restricted process could be made accessible on a local socket. This applies even to software written in memory-safe languages; after all, this bug was nothing relating to memory-safety (and finding it involved little more than searching for some functions we knew to be dangerous 30 years ago).

Clive Robinson •
[October 4, 2024 6:24 AM](https://www.schneier.com/blog/archives/2024/10/weird-zimbra-vulnerability.html/#comment-440916)

My gut feeling from how this is being reported, is that the person behind this attack has a fair degree of familiarity with some asspects of the server side code, but this is their first step into active exploitation.

Thus do not be surprised if they get identified/caught, it turns out they were once developing the code or an employee or similar with access to the companies internal systems.

I’ll be honest and say that with so many commercial organisations taking and using PubDomain or FOSS code in violation of licences or not paying back into the community we have not seen more of this sort of attack.

Uaf •
[October 4, 2024 5:42 PM](https://www.schneier.com/blog/archives/2024/10/weird-zimbra-vulnerability.html/#comment-440919)

No physical access required for this one

<https://www.abc.net.au/news/2024-10-04/robot-vacuum-hacked-photos-camera-audio/104414020?utm_source=abc_news_app&utm_medium=content_shared&utm_campaign=abc_news_app&utm_content=other>

Blue •
[October 4, 2024 11:26 PM](https://www.schneier.com/blog/archives/2024/10/weird-zimbra-vulnerability.html/#comment-440922)

@Uaf

Either some details have been omitted or altered, or there is some wider bluetooth vulnerability being exploited as well.

What $300 phone has a bluetooth tx range of 140 meters?

B. D. Johnson •
[October 6, 2024 9:01 AM](https://www.schneier.com/blog/archives/2024/10/weird-zimbra-vulnerability.html/#comment-440943)

I read this headline as “Weird Zebra Vulnerability” and ended up disappointed.

ResearcherZero •
[October 8, 2024 1:38 AM](https://www.schneier.com/blog/archives/2024/10/weird-zimbra-vulnerability.html/#comment-440979)

Got backdoor running in your environment and huge quantities of customer data?

‘https://arstechnica.com/tech-policy/2024/10/reports-china-hacked-verizon-and-att-may-have-accessed-us-wiretap-systems/

–

cyberespionage

“We...