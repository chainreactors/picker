---
title: APT29 Exploited a Windows Feature to Compromise European Diplomatic Entity Network
url: https://thehackernews.com/2022/11/apt29-exploited-windows-feature-to.html
source: The Hacker News
date: 2022-11-10
fetch_date: 2025-10-03T22:19:15.807016
---

# APT29 Exploited a Windows Feature to Compromise European Diplomatic Entity Network

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [APT29 Exploited a Windows Feature to Compromise European Diplomatic Entity Network](https://thehackernews.com/2022/11/apt29-exploited-windows-feature-to.html)

**Nov 09, 2022**Ravie Lakshmanan

[![Hacking European Diplomatic](data:image/png;base64... "Hacking European Diplomatic")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiZxKv9loOhiE5QvtIiqCZhItBKYYIkzjnp5LKg1GuDHZvHpaOqkOB3hKIc0BEJwTjLK61VSBPiLid4u8M5_MZJSf1lUSHifMpbgWcIhCHd31qtUAq3TnxIjqj-SKsDulWpYpfYDiuHseo_lm7iJljFKj78hVTWzUJHNfK4twMgtKAZnVTaEbQMpQUN/s790-rw-e365/code.jpg)

The Russia-linked APT29 nation-state actor has been found leveraging a "lesser-known" Windows feature called Credential Roaming following a successful phishing attack against an unnamed European diplomatic entity.

"The diplomatic-centric targeting is consistent with Russian strategic priorities as well as historic APT29 targeting," Mandiant researcher Thibault Van Geluwe de Berlaere [said](https://www.mandiant.com/resources/blog/apt29-windows-credential-roaming) in a technical write-up.

APT29, a Russian espionage group also called Cozy Bear, Iron Hemlock, and The Dukes, is [known](https://malpedia.caad.fkie.fraunhofer.de/actor/apt29) for its intrusions aimed at collecting intelligence that align with the country's strategic objectives. It's believed to be sponsored by the Foreign Intelligence Service (SVR).

[![DFIR Retainer Services](data:image/png;base64...)](https://thehackernews.uk/cloud-insight-d)

Some of the adversarial collective's cyber activities are tracked publicly under the moniker [Nobelium](https://thehackernews.com/2022/08/microsoft-uncovers-new-post-compromise.html), a threat cluster responsible for the widespread supply chain compromise through SolarWinds software in December 2020.

The Google-owned threat intelligence and incident response firm said it identified the use of Credential Roaming during the time APT29 was present inside the victim network in early 2022, at which point "numerous [LDAP](https://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol) queries with atypical properties" were performed against the Active Directory system.

[![Hacking European Diplomatic](data:image/png;base64... "Hacking European Diplomatic")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTwhFkQktj5c6f9Wnidp-3xvmYp6tHaS4zuMa5m02YNVk7n4WqbJvdlPTPJ8aHEF1QzdFHAmtuSyoQ_S5wFXx7cmkihs2fzY2kuV9kWps4VwIo3Ym54q6T8WNevHyPz4r_1QKDtFqm8PcOrPegJrrRUi9FXRRguIneDONfjcelVHSk28ZqvSo1UCP3/s790-rw-e365/windows.jpg)

Introduced in Windows Server 2003 Service Pack 1 (SP1), Credential Roaming is a [mechanism](https://techcommunity.microsoft.com/t5/ask-the-directory-services-team/certs-on-wheels-understanding-credential-roaming/ba-p/395897) that allows users to [access their credentials](https://social.technet.microsoft.com/wiki/contents/articles/11483.windows-credential-roaming.aspx) (i.e., private keys and certificates) in a secure manner across different workstations in a Windows domain.

According to Microsoft, "Credential Roaming is storing user credentials in the ms-PKI-DPAPIMasterKeys and ms-PKI-AccountCredentials attributes in the user object," with the latter described as a multi-valued LDAP property containing binary large objects (BLOBs) of encrypted credential objects.

One of the [LDAP attributes](https://learn.microsoft.com/en-us/windows/win32/adschema/r-private-information) queried by APT29, per the Google subsidiary, concerned ms-PKI-Credential-Roaming-Tokens, which handles the "storage of encrypted user credential token BLOBs for roaming."

[![CIS Build Kits](data:image/png;base64...)](https://thehackernews.uk/platform-shield-d)

Investigating its inner workings further, Mandiant highlighted the discovery of an arbitrary file write vulnerability that could be weaponized by a threat actor to achieve remote code execution in the context of the logged-in victim.

The shortcoming, tracked as [CVE-2022-30170](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-30170) (CVSS score 7.3), was addressed by Microsoft as part of [Patch Tuesday updates](https://thehackernews.com/2022/09/microsofts-latest-security-update-fixes.html) shipped on September 13, 2022, with the company emphasizing that exploitation requires a user to log in to Windows.

"An attacker who successfully exploited the vulnerability could gain remote interactive logon rights to a machine where the victim's account would not normally hold such privilege," it noted.

Mandiant said the research "offers insight into why APT29 is actively querying the related LDAP attributes in Active Directory," urging organizations to apply the September 2022 patches to secure against the flaw.

Found this article interesting? Follow us on [Google News](https://news.google.com/publications/CAAqLQgKIidDQklTRndnTWFoTUtFWFJvWldoaFkydGxjbTVsZDNNdVkyOXRLQUFQAQ), [Twitter](https://twitter.com/thehackersnews) and [LinkedIn](https://www.linkedin.com/company/thehackernews/) to read more exclusive content we post.

SHARE
[**](#link_share)
[**](#link_share)
[**](#link_share)
**

[**Tweet](#link_share)

[**Share](#link_share)

[**Share](#link_share)

**Share

**
[**Share on Facebook](#link_share)
[**Share on Twitter](#link_share)
[**Share on Linkedin](#link_share)
[**Share on Reddit](#link_share)
[**Share on Hacker News](#link_share)
[**Share on Email](#link_share)
[**Share on WhatsApp](#link_share)
[![Facebook Messenger](data:image/png;base64...)Share on Facebook Messenger](#link_share)
[**Share on Telegram](#link_share)

SHARE **

[Cyber Attack](https://thehackernews.com/search/label/Cyber%20Attack)[hacking news](https://thehackernews.com/search/label/hacking%20news)[Mandiant](https://thehackernews.com/search/label/Mandiant)[russian hacker](https://thehackernews.com/search/label/russian%20hacker)[supply chain attack](https://thehackernews.com/search/label/supply%20chain%20attack)

[![c](data:image/svg+xml;base64...)](https://thehackernews.uk/cloud-defense)

Trending News

[![SolarWinds Releases Hotfix ...