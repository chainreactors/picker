---
title: Secrets and Shadows: Leveraging Big Data for Vulnerability Discovery at Scale
url: https://billdemirkapi.me/leveraging-big-data-for-vulnerability-discovery-at-scale/
source: Bill Demirkapi's Blog
date: 2024-09-28
fetch_date: 2025-10-06T18:34:41.062114
---

# Secrets and Shadows: Leveraging Big Data for Vulnerability Discovery at Scale

[Bill Demirkapi's Blog](https://billdemirkapi.me)

* [Home](https://billdemirkapi.me/)
* [About](https://billdemirkapi.me/about/)

[Subscribe](#/portal/signup)

[Security Research](https://billdemirkapi.me/tag/security-research/)

# Secrets and Shadows: Leveraging Big Data for Vulnerability Discovery at Scale

Modern technologies like the cloud have made rapidly developing scalable software more accessible than ever. What risks has cloud computing introduced for the sake of convenience?

* [![Bill Demirkapi](/content/images/size/w100/2021/02/lrVO7WoC_400x400-1.jpg)](/author/bill/)

#### [Bill Demirkapi](/author/bill/)

Sep 27, 2024
• 36 min read

![Secrets and Shadows: Leveraging Big Data for Vulnerability Discovery at Scale](/content/images/size/w2000/2024/09/blogpresentation_banner3.png)

***Disclaimer:** This research was conducted strictly independent of my employer (excluded from scope). All opinions and views in this article are my own. When citing, please call me an Independent Security Researcher.*

Modern technologies like the cloud have made rapidly developing scalable software more accessible than ever. What used to require thousands of dollars in investment is now accessible through a free trial. We've optimized infrastructure-as-a-service (IaaS) providers to reduce friction to entry, but what happens when security clashes with productivity? What risks have we introduced for the sake of convenience?

For the last three years, I've investigated how the insecure defaults built into cloud services have led to widespread & systemic weaknesses in tens of thousands of organizations, including some of the world's largest like Samsung, CrowdStrike, NVIDIA, HP, Google, Amazon, the NY Times, and more! I focused on two categories: [dangling DNS records](https://www.paloaltonetworks.com/cyberpedia/what-is-a-dangling-dns) and [hardcoded secrets](https://www.synopsys.com/blogs/software-security/finding-hard-coded-secrets-before-you-suffer-a-breach.html). The former is well-traversed and will be an intuitive introduction to finding bugs using unconventional data sources. Work towards the latter, however, has often been limited in scope & diversity.

![](https://billdemirkapi.me/content/images/2024/09/b4a75f9f54200bc8ebcd3f47d19cd28c5dc7fce2.png)

Fake Article Demonstration on a New York Times Domain

Unfortunately, both vulnerability classes run rampant in production cloud environments. Dangling DNS records occur when a website has a DNS record pointing at a cloud host that is no longer in control. This project applied a variant of historical approaches to discover **66,000+ unique top-level domains** (TLDs) that still host dangling records. Leveraging a similar "big data" approach for hardcoded secrets revealed **15,000+ unique, verified secrets** for various API services.

While we will review the findings later, the key idea is simple: cloud providers are not doing enough to protect customers against misconfigurations *they incentivize*. The customer creates these vulnerabilities, but how platforms are designed directly controls whether such issues can exist at all.

Instead of taking accountability and enforcing secure defaults, most providers expect that a few documentation warnings that most will never read will mitigate their liability. This research demonstrates how this is far from enough and the compounding risk of abuse with hardcoded secrets.

# Background

Cloud computing lets you create infrastructure on demand, including servers, websites, storage, and so on. Under the hood, they're just an abstracted version of what many internet-facing businesses had to do a few decades ago. What makes it work are high margins and more importantly, the fact that **everything is shared**.

## Cloud Environments & Network Identifiers

A cloud resource is **dangling** if it is deallocated from your environment while still referenced by a DNS record. For example, let's say I create an AWS EC2 instance and an A record, `project1.example.com`, pointing at its public IP. I use the subdomain for some projects and, a few months later, deallocate the EC2 instance while cleaning up old servers I'm not using.

Remember, you paid to borrow someone else's infrastructure. Once you're done, the IP address assigned to your EC2 instance simply goes back into the shared pool for use by any other customer. Since DNS records are not bound to their targets by default, unless you remember that `project1.example.com` needs to be deleted, the moment the public IP is released is the moment it is **dangling**. These DNS records are problematic because if an attacker can capture the IP you released, they can now host anything at `project1.example.com`.

A/AAAA records are not the only type at risk. A\* records are relevant when your cloud resource is assigned a dedicated IP address. Not all managed cloud services involve a dedicated IP, however. For example, when using a managed storage service like AWS S3 or Google Cloud (GCP) Storage, you're assigned a dedicated hostname like `example.s3.amazonaws.com`. Under the hood, these hostnames point at IP addresses shared across many customers.

![](https://billdemirkapi.me/content/images/2024/09/Pasted-image-20240927140814.png)

CNAME Subdomain Takeover [Example](https://learn.microsoft.com/en-us/azure/security/fundamentals/subdomain-takeover)

DNS record types like CNAME, which accept hostnames, can similarly become dangling if the hostname is released (e.g., you delete a bucket, allowing an attacker to recreate with same name). Unlike dedicated endpoints, it is easier to guard shared endpoints against attacks because the provider can prohibit the registration of a deallocated identifier. Reserving IP addresses, however, is far less feasible.

### Why Care?

Why should you care about dangling DNS records? Unfortunately, if an attacker can control a trusted subdomain, there is a substantial risk of abuse:

* Enables phishing, scams, and malware distribution.
* Session Hijacking via Cross-Site Scripting (XSS)
* If `example.com` does not restrict access to session cookies from subdomains, an attacker may be able to execute malicious JavaScript to impersonate a logged in user.
* Context-specific impact, like…
* Bypass trusted hostname checks in software (e.g., when downloading updates).
* Abuse brand trust & reputation for misinformation.

According to RIPE's article, *[Dangling Resource Abuse on Cloud Platforms](https://labs.ripe.net/author/haya-shulman/cloudy-with-a-chance-of-cyberattacks-dangling-resource-abuse-on-cloud-platforms/)*:

> The main abuse (75%) of hijacked, dangling resources is to generate traffic to adversarial services. The attackers target domains with established reputation and exploit that reputation to increase the ranking of their malicious content by search engines and as a result to generate page impressions to the content they control. The content is mostly gambling and other adult content.
> ...
> The other categories of abuse included malware distribution, cookie theft and fraudulent certificates. Overall, we find that the hacking groups successfully attacked domains in 31% of the Fortune 500 companies and 25.4% of the Global 500 companies, some over long periods of time.

Dangling DNS records are most commonly exploited en masse, but targeted attacks still exist. Fortunately, to achieve a high impact beyond trivial search engine optimization, an attacker would need to investigate your organization's relationship with the domain they've compromised. Unfortunately, while trivial abuse like search engine optimization matters less in isolated incidents, it becomes a major problem when scaled.

## Cloud Environments & Authentication

Cloud environments, including any API service, are managed over the Internet. Even if you use dedicated resources where possible, you're still forced to manage them through a shared gateway. How do we secure this access?

![](https://billdemirkapi.me/content/images/2024/09/aws_access...