---
title: How Capabilities actually Work ? | Exploitation | Privilege Escalation
url: https://infosecwriteups.com/how-capabilities-actually-work-exploitation-privilege-escalation-536afee917ad?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2022-12-30
fetch_date: 2025-10-04T02:44:00.200449
---

# How Capabilities actually Work ? | Exploitation | Privilege Escalation

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F536afee917ad&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fhow-capabilities-actually-work-exploitation-privilege-escalation-536afee917ad&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fhow-capabilities-actually-work-exploitation-privilege-escalation-536afee917ad&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-536afee917ad---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-536afee917ad---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# How Capabilities actually Work ? | Exploitation | Privilege Escalation

[![Medusa](https://miro.medium.com/v2/resize:fill:64:64/1*f2U6mEKEJfzwHgsgrqFAXw.jpeg)](https://medusa0xf.medium.com/?source=post_page---byline--536afee917ad---------------------------------------)

[Medusa](https://medusa0xf.medium.com/?source=post_page---byline--536afee917ad---------------------------------------)

5 min read

·

Dec 20, 2022

--

2

Listen

Share

Press enter or click to view image in full size

![]()

## SUID : The Traditional Linux Way

Sometimes a user with low privileges needs to perform specific tasks with higher privileges and for that Linux has functionality for setting SUID bit on particular binaries.

The SUID (Set User ID) bit is a special permission that can be set on executable files in the Linux operating system. This allows the non-privileged user to run the program with the permissions of the owner of the file.

For example, if a non-root user wants to execute a program with the SUID bit set of the **root user**, he/she will be given root permission throughout the execution of the program.

## Why Capabilities?

SUID works fine but it has a high-security risk because it gives full permissions to the non-root user even though only certain actions were required to be executed with root privileges.

> Attackers exploit the SUID bit to perform privilege escalation on the system.

That’s where **Capabilities** jump in, capabilities also allow the user to run certain executables with the privileges of the root user. but it is more secure, **How?** Capabilities don’t give full permissions rather **it divides the privileges and permissions into smaller, more specific units or threads that can be selectively enabled or disabled.**

> **Note:** Capabilities grant privileges to processes rather than user.

Each capability corresponds to a specific permission or privilege, such as the ability to bind to a network port, the ability to change system time, or the ability to send signals to other processes.

```
Some Linux Capabilities and their functions are:-

CAP_DAC_OVERRIDE: The ability to override file permissions.

CAP_DAC_READ_SEARCH: The ability to read and search directories and files that
the process does not have permission to access.

CAP_KILL: The ability to send signals to other processes.

CAP_NET_BIND_SERVICE: The ability to bind to a network port below 1024.

CAP_SYS_BOOT: The ability to reboot the system.

CAP_CHOWN: The ability to change the owner and group of a file.
```

Read more here..

[## capabilities(7) - Linux manual page

### CAPABILITIES(7) Linux Programmer's Manual CAPABILITIES(7) capabilities - overview of Linux capabilities For the purpose…

man7.org](https://man7.org/linux/man-pages/man7/capabilities.7.html?source=post_page-----536afee917ad---------------------------------------)

## Inside the Linux Kernel

Capabilities are stored as **bitmask** in a separate file in the **/proc** filesystem for each process, A bitmask is a data structure that represents a set of flags or options as individual bits in a single value. Each bit in the bitmask corresponds to a particular capability, and the value of the bit (either 0 or 1) indicates whether the capability is enabled or disabled.

They can be manipulated using the setcap command and the capsh command. When a process makes a system call that requires a particular capability, the kernel checks the process's capabilities to see if the necessary permission is granted. If the permission is not granted, the system call is denied and the process is given an error code.

1. **Permitted capabilities**: These are the privileges that a process is allowed to have, regardless of whether it is currently executing with those privileges.
2. **Effective capabilities:** These capabilities are checked by the Linux kernel to see if it’s effective or not. These are the privileges that a process is currently executing. A process can only exercise a privilege if it is both permitted and effective.

### Example:

These two are like functions in programming, first compiler checks if a function exists or not, and if it does then it will execute that function. Here compiler is **the Linux kernel**, permitted capability is the **declared** function and effective capability is the defined function which is being executed. Hope that gives you a little idea of how it works.

The `setcap` command takes a capability name and a value as arguments, and it updates the corresponding bit in the process's bitmask accordingly.

```
setcap cap_chown=+ep myprogram
```

The above command sets the `CAP_CHOWN` bit in the `myprogram` process's bitmask to 1, indicating that the capability is enabled. Notice the + sign before the filename, in case if it’s minus(-) then it indicates that the capability is disabled.

[## TryHackMe | Linux Privilege Escalation

### Learn the fundamentals of Linux privilege escalation. From enumeration to exploitation, get hands-on with over 8…

tryhackme.com](https://tryhackme.com/room/linprivesc?source=post_page-----536afee917ad---------------------------------------)

## **The Hacker Mind: How it can be exploited?**

In the target machine, we can see enabled capability using **getcap** command. When run as an unprivileged user, `getcap -r /` will generate a huge amount of errors, so it is good practice to redirect the error messages to /dev/null.

> **cap\_setuid** capability can be dangerous if it is not used carefully because it allows a process to change the effective user ID and group ID of the process which can lead to privilege escalation.

![]()

Command: `getcap -r / 2>/dev/null`

There is a python binary with **cap\_setuid+ep** enabled, thisallows a program to gain the setuid (set user ID upon execution) and effective (ep) privileges needed to execute with the permissions of the owner of the file, rather than the permissions of the user who executes it.

Pr...