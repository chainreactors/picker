---
title: 小心你的加密货币，针对加密货币的窃密样本详细分析
url: https://mp.weixin.qq.com/s?__biz=MzA4ODEyODA3MQ==&mid=2247489082&idx=1&sn=75b72879dc3e57459d2e585d868e4b94&chksm=902fb912a7583004e1fb6c34e2ad08de906f905769bb3074ed00aa21197e64a37b8855c125e7&scene=58&subscene=0#rd
source: 安全分析与研究
date: 2024-10-16
fetch_date: 2025-10-06T18:53:55.764100
---

# 小心你的加密货币，针对加密货币的窃密样本详细分析

![cover_image](http://mmbiz.qpic.cn/mmbiz_jpg/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpCMg1Vey3c4uVtjJaicUjeAcaYog2yibnpGhnV2xm5Iy41x2lZNAdiavYw/0?wx_fmt=jpeg)

# 小心你的加密货币，针对加密货币的窃密样本详细分析

原创

pandazhengzheng

安全分析与研究

**安全分析与研究**

专注于全球恶意软件的分析与研究

前言概述

原文首发出处：

https://xz.aliyun.com/t/15811

先知社区 作者：熊猫正正

前几天慢雾科技的公众号发布了一篇关于加密货币被盗的文章《慢雾：2024 Q3 MistTrack 被盗表单分析》，笔者注意到加密货币被盗的三个主要的原因之一就是被黑客钓鱼攻击，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpFb1USdAMyicKnm5Qe2bqMaCQC3RbicLtK8AsQUVDGyW0qjKAb1ibXqBOw/640?wx_fmt=png)

文章中有提到一个伪装的钓鱼网站，受害者在骗子的诱导下，下载恶意应用程序，导致数据和权限被盗，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpeOFRRRKZj74PDL5R8ajxUGa3XmdM7r7dS9icasO6vZB5c14bjNazsHA/640?wx_fmt=png)

原文链接:https://mp.weixin.qq.com/s/gP3sScmA87e05zx-Ta\_uDA，全球著名的APT组织Lazarus APT一直在通过这种钓鱼方式盗取加密货币，笔者后面有空的时候，再给大家分享笔者此前研究Lazarus APT组织的一些攻击活动。

针对文章中提到的钓鱼网站，笔者去该钓鱼网站下载了相关的攻击样本，对该攻击样本进行了详细分析，分享出来供大家参考学习。

详细分析

1.访问钓鱼网站partychaos[.]space，与官方网站partychaos[.]fun界面基本一模一样，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpoV3fehN7QIOWap4YjqqnfvoOH08DVGKvQKHhE7C40iaGAXLlp51qksA/640?wx_fmt=png)

2.点击开始按钮之后，会弹出下载页面，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8Cp555YicepuQaJssHgT8JLVXasz6NmFxHtbUzOhpxR1Pm3JibEJLQwLRGQ/640?wx_fmt=png)

3.不管你是点击下载Windows，还是Mac都一样，会下载一个压缩包文件Installer.zip，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpH2kRoc69knz5U5SuyZs4UAdX1Sor2wWQPWwB6KPNKicrDdHuKN8eUMA/640?wx_fmt=png)

4.压缩包解压缩之后，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpibWUY63QwzsSs4LJSgQQrl8D0icEt8yFcKGjOpR1DPqTAc9pyVL6LJPA/640?wx_fmt=png)

5.采用白+黑的方式加载恶意模块，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8Cps6L8PMVCmwSIeh71YNNcWpyiaXqicLRYZmZDtJfcia2iavypAUBxhaB72w/640?wx_fmt=png)

6.恶意模块在VT上的检出率非常低，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CppzjGF3SQ59BZttdoibNSDR6VuYWB5SulQGibNgzhbxDEbxic9W4mvpXWQ/640?wx_fmt=png)

7.对比原文件发现代码被大量修改，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpaScicDKEA3JDQYWVALVe6iba95B6dicnesMfowicpWcUcY9Pknjtc6lqDg/640?wx_fmt=png)

8.读取同目录下的加密数据文件pnyb，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpWKoPZwKBxMwJibCuNrdCPWG0LgF50iajnBicJNvc639DxQvtLBRrII0kw/640?wx_fmt=png)

9.读取加密数据到内存，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpcRQGFwShdAia6xAichR5NucHuibjRRh02oViar7fE14BkyuCxJZ5ibDdOnQ/640?wx_fmt=png)

10.通过LoadLibrary加载dbghelp.dll模块，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpWA6SPsTp7YQxzBXN0WZ5DBbfPq3pf9FB4AicM1Z4b0Js148xFlor5mQ/640?wx_fmt=png)

11.修改dbghelp.dll模块的代码段属性，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpS4uDcaWkndNr7etEejmAv3UmIYORBIhAmib4tzNJHzkg6GJSDZpVFVA/640?wx_fmt=png)

12.将ShellCode数据写入到dbghelp.dll模块的代码段，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpAerQq3L5CmlvmENDIUcDoYiabAEvudkn127pyMVoQAFuK1BClJuL1wg/640?wx_fmt=png)

13.写入之后，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpQQKqobHjsxQN4eiaTwwTXQQAHqs39GJo0ibTRbZhn2cOD4Ua7iaQM4BbA/640?wx_fmt=png)

14.还原dbghelp.dll模块代码段属性，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8Cp2K5FjSO8s8dksiaBoQhF6Ljyp2bvibvtMmog558OJq9NA3yOoeQmeBEw/640?wx_fmt=png)

15.跳转执行dbghelp.dll模块的ShellCode代码，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpA5w3uZGF9LoSEsIqLYXDreR76M7AoWbJCwvGpeiaubm3dr3syVMpZkw/640?wx_fmt=png)

16.读取同目录下的加密数据文件owjxug，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpzgvrQ8eYiaTPCFRd0r1mRcM2L7V5kAbVxMpAMrUtjHMYlb9m7qejktw/640?wx_fmt=png)

17.读取到内存当中，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpSofcf4DLD9sKAIH0D11qnAOKttxQ6YbbytDafH4HcmKkINjUVE8Ccw/640?wx_fmt=png)

18.拷贝指定加密数据到分配的内存当中，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpjSl8qS35yrZvkbMzAKxrmeGHrZFNCZiaRriaeO1KrNMXxZxM6RibOxRzw/640?wx_fmt=png)

19.拷贝完成之后，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpCu1BEfpFnVjq12ibHibibeyFRrJDk9x8VpvJXz0q22XLOIjh34xCtxXwg/640?wx_fmt=png)

20.解密加密的数据，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpPK17xBf48G3zSc8wkrX7ox1ZaeqKXD7OT9b1dsJic2aBXjcw2icn1vpg/640?wx_fmt=png)

21.解密之后，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpibP7JdZEBUmyakYWv4lv8tlLmuw6q4sYrrIgnftZokEJyb5NTyiaB8nQ/640?wx_fmt=png)

22.通过LoadLibrary加载pla.dll模块，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpjStMhkhS5FJNVPrBbD1X3TmWyKcM9YwlQwbNVicZOmySPxOYg5HwElQ/640?wx_fmt=png)

23.修改pla.dll模块代码段属性，然后将ShellCode代码写入到代码段，并执行ShellCode代码，与上面的手法一样，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpRRlTSdKpRXQmYPTicib22nKuJq2LwToxZiahLRxAHicJOAZUW9HngkaRew/640?wx_fmt=png)

24.跳转执行到pla.dll模块代码段的ShellCode代码，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpvWicjTbwkngicHnNic22oibNe7DfYwZXM4zm6xqUlHKRONEVRzhb3qkOcw/640?wx_fmt=png)

25.相关的函数采用HASH值存储，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpOTYQ4JBRMMYoGKy8r3ianxPxqgwgGQggia7Qy2vMt0TmelIKBgYbHgSw/640?wx_fmt=png)

26.在%appdata%目录下创建目录，并拷贝生成恶意软件复本，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpmyHNrNJJO56kw2sIiaCia7pgdEBnFqZRcX9DntmKNQPBL9RjGmXiagLGg/640?wx_fmt=png)

27.启动cmd.exe程序，然后将shellcode代码注入到cmd.exe进程，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CptUEXm7yPoLEkoDXicS8FZoWgfBpxuDdwwYibibjLamibGQahHTnjrfWbuA/640?wx_fmt=png)

28.注入到cmd.exe进程中的shellcode代码，函数全部加密，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpC0mQlQphB1ia0ZHyJtuPiaybbhXZX6GlGdgubsGp0M0zEX6fjGyt4aog/640?wx_fmt=png)

29.获取主机HWID、网络信息、系统相关信息，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpYwS4Gfp5iaF4I2RMEgTBnSFCpDW4FAar38ffEtAy2CJD17vIhlIkaRw/640?wx_fmt=png)

30.获取主机相关应用信息，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpiavCLIHGYDtMCHVaTenLGVay7JPK7NPhejbD5wZ1cbJz2A6y0XRcDFg/640?wx_fmt=png)

31.获取主机stream帐号信息，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8Cpxxod3lLuaD9WibIlYmJYoxZg5dzlw4xHjkWu62eLtsw0B6xcicxK7uRA/640?wx_fmt=png)

32.获取主机相关浏览器数据，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpjbDvmUUhAAriaGVvyLpicjuExMB1Np1uSmXp0Uyibaf88CItRMqtfBKOw/640?wx_fmt=png)

33.获取主机浏览器插件中保存的相关数据，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8Cpg0OYMKnibibAI1ibP2PxmMmZuMkJ1yM7S31uKguaO3kCanibM9PQSTVia8w/640?wx_fmt=png)

34.获取主机加密货币私钥信息等，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpkFyXdRHT7VIsaDefJv7E1FTSO5xmBicuAb6jLouAIR1XgrswbPmMzmA/640?wx_fmt=png)

35.与远程服务器通信，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CprPVUIP0o6bbRMicL6SH7BPU2m0sibFoMw7hlYKEeUAMFaAd3z3Op3Kfw/640?wx_fmt=png)

36.将恶意代码注入到explorer.exe进程，注入 shellcode代码，同样会获取浏览器相关信息，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpaOo2GHRSGBLEzp2LcjpbtYjyXCrnyoFkhVMgN7hia3avyOjCpPKt5BQ/640?wx_fmt=png)

37.获取Cookies信息，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpKRxEawnuRkibWHerBudibVbJ2HJ7CZuOBlNKI8I90SicWLZUXufhCpCAg/640?wx_fmt=png)

到此该攻击活动使用的窃密样本基本功能分析完毕，有兴趣的朋友可以自行下载研究。

威胁情报

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpvpgfBTVysVEPDjzGVMfW1WblEmbUFK3cDSfujHXDmLcOuAQASqqLzA/640?wx_fmt=png)

总结结尾

最近几年随着WEB3流行，各种区块链加密货币层出不穷，只要有利益的地方，就有黑客的存在，全球几大黑客组织早就盯上了WEB3加密货币这块，开发出很多盗取WEB3加密货币的恶意软件，这些恶意软件在VT上的检出率都比较低，大家要提前做好相应的防护，不要随意安装和使用一些加密货币软件，以及访问一些WEB3相关的项目，以防自己的加密货币被盗。

安全分析与研究，专注于全球恶意软件的分析与研究，追踪全球黑客组织攻击活动，欢迎大家关注，获取全球最新的黑客组织攻击事件威胁情报。

![](https://mmbiz.qpic.cn/mmbiz_jpg/oibWJqH5OVmUhMH31lHL5cAbC7FmAV8CpZXC7f6VQtQZNhJbCRRv6YeGO31wpHol0276ydPN5FNd9icELbHl5sdQ/640?wx_fmt=jpeg)

王正

笔名：熊猫正正

恶意软件研究员...