---
title: HTTP request smuggling Explained and Exploited Part 0x2
url: https://infosecwriteups.com/http-request-smuggling-explained-and-exploited-part-0x2-7768d04883fb?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2022-10-21
fetch_date: 2025-10-03T20:28:52.490423
---

# HTTP request smuggling Explained and Exploited Part 0x2

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7768d04883fb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fhttp-request-smuggling-explained-and-exploited-part-0x2-7768d04883fb&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fhttp-request-smuggling-explained-and-exploited-part-0x2-7768d04883fb&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-7768d04883fb---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-7768d04883fb---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# HTTP request smuggling Explained and Exploited Part 0x2

[![Hashar Mujahid](https://miro.medium.com/v2/da:true/resize:fill:64:64/1*eIN8F1x85V9OMBf50NuoLg.gif)](https://hasharmujahid.medium.com/?source=post_page---byline--7768d04883fb---------------------------------------)

[Hashar Mujahid](https://hasharmujahid.medium.com/?source=post_page---byline--7768d04883fb---------------------------------------)

6 min read

·

Oct 20, 2022

--

Listen

Share

Hi! My name is Hashar Mujahid, and today we will continue to discuss what HTTP request smuggling vulnerabilities are and how we can exploit them.

![]()

Image from [Brightsec](https://brightsec.com/)

If you want to learn what HTTP REQUEST SMUGGLING is, I would recommend reading Part 1 of this series.

[## HTTP request smuggling Explained and Exploited Part 0x1

### Hi! My name is Hashar Mujahid and today we will sneak a peek into Request Smuggling Vulnerabilities.

infosecwriteups.com](/http-request-smuggling-explained-and-exploited-part-0x1-89ce2956534f?source=post_page-----7768d04883fb---------------------------------------)

Now we will continue where we left off in the previous blog.

## TE.TE behavior: obfuscating the TE header.

In this scenario, both the frontend and the backend have the ability to process the `Transfer-Encoding: Chunked` header, but we will trick one of the sides into not processing the header as it normally would by tempering the header in some way.

Example:

Now we will see some examples of how you can temper with the `Transfer-Encoding: Chunked` header,

```
Transfer-Encoding: xchunked
Transfer-Encoding : chunked
Transfer-Encoding: chunked
Transfer-Encoding: x
Transfer-Encoding:[tab]chunked
[space]Transfer-Encoding: chunked
X: X[\n]Transfer-Encoding: chunked
Transfer-Encoding : chunked
```

We can see this by adding `x` in front of the chunk or extra space in front of the `Transfer-Encoding` header. We could obfuscate the header.

Each technique will produce different results depending on how it is implemented in the backend; some will work, while others will not.

To detect **TE.TE** vulnerabilities, we just need to find a variation in the header that one server will ignore and the other will process.

### [Lab: HTTP request smuggling, obfuscating the TE header](https://portswigger.net/web-security/request-smuggling/lab-obfuscating-te-header)

This lab involves a front-end and back-end server, and the two servers handle duplicate HTTP request headers in different ways. The front-end server rejects requests that aren’t using the GET or POST method.

To solve the lab, smuggle a request to the back-end server so that the next request processed by the back-end server appears to use the method `GPOST`.

**EXPLOITATION:**

Access the lab and capture the request to the burp repeater.

Press enter or click to view image in full size

![]()

Only GET and POST are ALLOWED

Now uncheck the updated content length in the repeater.

Step 2: Change the request method to "POST."

Step3: Remove the unnecessary headers.

Step4: Change the content length to 4.

Now for the tricky part, we need to add our transfer encoding headers and find a way so that our backend server may process them and the front end will ignore them.

```
POST / HTTP/1.1
Host: 0ab8008b037606dfc05d2f1700b60097.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked
Transfer-EncodinG: c\] ===> Obsufcated  header.5c ===> repersent the size of chunk in hex == 92 bytes
GPOST / HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 15 ===> Request that will be smuggled to be part of the next requestx=1
0
```

Send this request two times and you should receive an error.

Press enter or click to view image in full size

![]()

These are all introductory attacks. Now we will look into how we can use this vulnerability to execute some high-severity attacks against a web application.

## Using HTTP request smuggling to bypass front-end security controls

The security controls can be implemented on both the front end and the back end of the application. Let’s consider a scenario where the application’s front end prevents the user from accessing some directories `/admin` due to this validation. The developer didn’t put any validation in the backend, so if the attacker is somehow able to bypass the front-end security, the backend will respond to him with the response to the request.

```
POST /home HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 62
Transfer-Encoding: chunked  0
GET /admin HTTP/1.1
Host: vulnerable-website.com
Foo: xGET /home HTTP/1.1
Host: vulnerable-website.com
```

The front-end server sees two requests here, both for `/home`, and so the requests are forwarded to the backend server. However, the back-end server sees one request for `/home` and one request for `/admin`. It assumes (as always) that the requests have passed through the front-end controls, and so grants access to the restricted URL.

### [Lab: Exploiting HTTP request smuggling to bypass front-end security controls, CL.TE vulnerability](https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-cl-te).

This lab involves a front-end and back-end server, and the front-end server doesn’t support chunked encoding. There’s an admin panel`/admin`, but the front-end server blocks access to it.

To solve the lab, smuggle a request to the back-end server that accesses the admin panel and deletes the user `carlos`.

SOLUTION:

As we know, the front end doesn't support chunked encoding. So we can try to bypass the front-end security controls by using a CL.TE attack.

Access the lab and send the request to the burp repeater.

Change the request method to POST and remove the excess headers.

O...