---
title: Control-flow unflattening in the wild
url: https://www.pnfsoftware.com/blog/control-flow-unflattening-in-the-wild/
source: JEB in Action
date: 2023-04-16
fetch_date: 2025-10-04T11:31:54.315337
---

# Control-flow unflattening in the wild

[Skip to content](#content)

[![JEB in Action](https://www.pnfsoftware.com/blog/wp-content/uploads/2018/12/icon-jeb-128-newlogo-transparent.png)](https://www.pnfsoftware.com/blog/)

[JEB in Action](https://www.pnfsoftware.com/blog/)

JEB Decompiler Blog

Menu and widgets

* [PNF Software (Main)](https://www.pnfsoftware.com)

Search for:

## Last Posts

* [Reversing with VIBRE AI Assistant](https://www.pnfsoftware.com/blog/vibe-reversing-with-vibre-ai-assistant/)
* [Reversing Nvidia GPU’s SASS code](https://www.pnfsoftware.com/blog/reversing-nvidia-cuda-sass-code/)
* [Deobfuscation ratings, inlining “fat” functions, and breaking opaque predicates](https://www.pnfsoftware.com/blog/deobfuscation-ratings-inlining-fat-functions-and-breaking-opaque-predicates/)
* [Generic Unpacking for APK](https://www.pnfsoftware.com/blog/generic-unpacking-for-apk/)
* [How To Use JEB – Auto-decrypt strings in protected binary code](https://www.pnfsoftware.com/blog/how-to-use-jeb-auto-decrypt-strings-in-protected-binary-code/)
* [How To Use JEB – Analyze an obfuscated win32 crypto clipper](https://www.pnfsoftware.com/blog/how-to-use-jeb-to-analyze-an-obfuscated-win32-crypto-clipper/)
* [JEB Assistant (legacy)](https://www.pnfsoftware.com/blog/jeb-assistant/)
* [Control-flow unflattening in the wild](https://www.pnfsoftware.com/blog/control-flow-unflattening-in-the-wild/)
* [Recovering JNI registered natives, recovering protected string constants](https://www.pnfsoftware.com/blog/recovering-jni-registered-natives/)
* [Android JNI and Native Code Emulation](https://www.pnfsoftware.com/blog/android-jni-and-native-code-emulation/)

## Categories

* [Android](https://www.pnfsoftware.com/blog/category/android/)
* [API (JEB1)](https://www.pnfsoftware.com/blog/category/api-jeb1/)
* [API (JEB2)](https://www.pnfsoftware.com/blog/category/api-jeb2/)
* [API (JEB3)](https://www.pnfsoftware.com/blog/category/api-jeb3/)
* [Assistant](https://www.pnfsoftware.com/blog/category/assistant/)
* [Collaboration](https://www.pnfsoftware.com/blog/category/collaboration/)
* [CUDA](https://www.pnfsoftware.com/blog/category/cuda/)
* [Dart](https://www.pnfsoftware.com/blog/category/dart/)
* [Debugging](https://www.pnfsoftware.com/blog/category/debugging/)
* [Decompilation](https://www.pnfsoftware.com/blog/category/decompilation/)
* [Ethereum](https://www.pnfsoftware.com/blog/category/ethereum/)
* [Flutter](https://www.pnfsoftware.com/blog/category/dart/flutter/)
* [JEB2](https://www.pnfsoftware.com/blog/category/jeb2/)
* [JEB3](https://www.pnfsoftware.com/blog/category/jeb3/)
* [JEB4](https://www.pnfsoftware.com/blog/category/jeb4/)
* [JEB5](https://www.pnfsoftware.com/blog/category/jeb5/)
* [Malware](https://www.pnfsoftware.com/blog/category/malware/)
* [Native Code](https://www.pnfsoftware.com/blog/category/native-code/)
* [Obfuscation](https://www.pnfsoftware.com/blog/category/obfuscation/)
* [PDF](https://www.pnfsoftware.com/blog/category/pdf/)
* [PLC](https://www.pnfsoftware.com/blog/category/plc/)
* [Tutorial](https://www.pnfsoftware.com/blog/category/tutorial/)
* [WebAssembly](https://www.pnfsoftware.com/blog/category/webassembly/)

## Archives

* [September 2025](https://www.pnfsoftware.com/blog/2025/09/)
* [August 2025](https://www.pnfsoftware.com/blog/2025/08/)
* [October 2024](https://www.pnfsoftware.com/blog/2024/10/)
* [February 2024](https://www.pnfsoftware.com/blog/2024/02/)
* [January 2024](https://www.pnfsoftware.com/blog/2024/01/)
* [December 2023](https://www.pnfsoftware.com/blog/2023/12/)
* [August 2023](https://www.pnfsoftware.com/blog/2023/08/)
* [April 2023](https://www.pnfsoftware.com/blog/2023/04/)
* [December 2022](https://www.pnfsoftware.com/blog/2022/12/)
* [November 2022](https://www.pnfsoftware.com/blog/2022/11/)
* [June 2022](https://www.pnfsoftware.com/blog/2022/06/)
* [May 2022](https://www.pnfsoftware.com/blog/2022/05/)
* [June 2021](https://www.pnfsoftware.com/blog/2021/06/)
* [March 2021](https://www.pnfsoftware.com/blog/2021/03/)
* [February 2021](https://www.pnfsoftware.com/blog/2021/02/)
* [July 2020](https://www.pnfsoftware.com/blog/2020/07/)
* [June 2020](https://www.pnfsoftware.com/blog/2020/06/)
* [April 2020](https://www.pnfsoftware.com/blog/2020/04/)
* [February 2020](https://www.pnfsoftware.com/blog/2020/02/)
* [October 2019](https://www.pnfsoftware.com/blog/2019/10/)
* [July 2019](https://www.pnfsoftware.com/blog/2019/07/)
* [May 2019](https://www.pnfsoftware.com/blog/2019/05/)
* [April 2019](https://www.pnfsoftware.com/blog/2019/04/)
* [March 2019](https://www.pnfsoftware.com/blog/2019/03/)
* [January 2019](https://www.pnfsoftware.com/blog/2019/01/)
* [November 2018](https://www.pnfsoftware.com/blog/2018/11/)
* [October 2018](https://www.pnfsoftware.com/blog/2018/10/)
* [September 2018](https://www.pnfsoftware.com/blog/2018/09/)
* [July 2018](https://www.pnfsoftware.com/blog/2018/07/)
* [May 2018](https://www.pnfsoftware.com/blog/2018/05/)
* [February 2018](https://www.pnfsoftware.com/blog/2018/02/)
* [November 2017](https://www.pnfsoftware.com/blog/2017/11/)
* [October 2017](https://www.pnfsoftware.com/blog/2017/10/)
* [August 2017](https://www.pnfsoftware.com/blog/2017/08/)
* [June 2017](https://www.pnfsoftware.com/blog/2017/06/)
* [May 2017](https://www.pnfsoftware.com/blog/2017/05/)
* [April 2017](https://www.pnfsoftware.com/blog/2017/04/)
* [October 2016](https://www.pnfsoftware.com/blog/2016/10/)
* [September 2016](https://www.pnfsoftware.com/blog/2016/09/)
* [June 2016](https://www.pnfsoftware.com/blog/2016/06/)
* [April 2016](https://www.pnfsoftware.com/blog/2016/04/)
* [March 2016](https://www.pnfsoftware.com/blog/2016/03/)
* [February 2016](https://www.pnfsoftware.com/blog/2016/02/)
* [December 2015](https://www.pnfsoftware.com/blog/2015/12/)
* [November 2015](https://www.pnfsoftware.com/blog/2015/11/)
* [October 2015](https://www.pnfsoftware.com/blog/2015/10/)
* [September 2015](https://www.pnfsoftware.com/blog/2015/09/)
* [August 2015](https://www.pnfsoftware.com/blog/2015/08/)
* [July 2015](https://www.pnfsoftware.com/blog/2015/07/)
* [June 2015](https://www.pnfsoftware.com/blog/2015/06/)
* [December 2014](https://www.pnfsoftware.com/blog/2014/12/)
* [August 2014](https://www.pnfsoftware.com/blog/2014/08/)
* [April 2014](https://www.pnfsoftware.com/blog/2014/04/)
* [March 2014](https://www.pnfsoftware.com/blog/2014/03/)
* [December 2013](https://www.pnfsoftware.com/blog/2013/12/)
* [September 2013](https://www.pnfsoftware.com/blog/2013/09/)
* [August 2013](https://www.pnfsoftware.com/blog/2013/08/)
* [July 2013](https://www.pnfsoftware.com/blog/2013/07/)
* [June 2013](https://www.pnfsoftware.com/blog/2013/06/)
* [May 2013](https://www.pnfsoftware.com/blog/2013/05/)
* [April 2013](https://www.pnfsoftware.com/blog/2013/04/)
* [March 2013](https://www.pnfsoftware.com/blog/2013/03/)

## [Main Website](https://www.pnfsoftware.com)

# Control-flow unflattening in the wild

Both JEB decompiler engines [1](#fn-4143-1) ship with code optimizers capable of rebuilding methods whose control-flow was transformed by flattening obfuscators.

[![](https://www.pnfsoftware.com/blog/wp-content/uploads/2023/04/image-11-1024x511.png)](https://www.pnfsoftware.com/blog/wp-content/uploads/2023/04/image-11.png)

Image © [Tigress](http://tigress.cs.arizona.edu/transformPage/docs/flatten/index.html) (University of Arizona)

Control-flow flattening, sometimes referred to as *chenxification*[2](#fn-4143-2), is an obfuscation technique employed to destructure a routine control-flow. While a compiled routine is typically composed of a number of basic blocks having low ingress and egress counts, a flattened routine may exhibit an outlier node having high input and high output edge counts, and generally, a very high centrality in the graph (in terms of vertex betweenness). Practically speaking, the original method M is reduced to a many-way conditional block H evaluating an expression VPC, dispatching the flow of execution to units of code, each one performing a part of M...