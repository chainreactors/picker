---
title: é™Œé™Œå®‰å…¨è·Appleè‡´è°¢ï¼šCVE-2022-42837 - iTunes Store ä¹‹æ®‡
url: https://www.4hou.com/posts/zl3q
source: å˜¶å¼ RoarTalk â€“ å›å½’æœ€æœ¬è´¨çš„ä¿¡æ¯å®‰å…¨,äº’è”ç½‘å®‰å…¨æ–°åª’ä½“,4hou.com
date: 2022-12-20
fetch_date: 2025-10-04T01:58:12.050102
---

# é™Œé™Œå®‰å…¨è·Appleè‡´è°¢ï¼šCVE-2022-42837 - iTunes Store ä¹‹æ®‡

é™Œé™Œå®‰å…¨è·Appleè‡´è°¢ï¼šCVE-2022-42837 - iTunes Store ä¹‹æ®‡ - å˜¶å¼ RoarTalk â€“ ç½‘ç»œå®‰å…¨è¡Œä¸šç»¼åˆæœåŠ¡å¹³å°,4hou.com

[![](https://www.4hou.com/sihou/images/new4hou/newlogoss.png)](https://www.4hou.com)

* [é¦–é¡µ](https://www.4hou.com)
* [ä¼ä¸šä¸­å¿ƒ](https://www.4hou.com/corp/newindex)
* [äº§ä¸šç ”ç©¶é™¢](https://www.4hou.com/real-time)

![](https://www.4hou.com/sihou/images/new4hou/search-icon.png)

[æŠ•ç¨¿](https://www.4hou.com/contribute)

[ç™»å½•](https://www.4hou.com/login)
Â Â |
[æ³¨å†Œ](https://www.4hou.com/register)

* å¯¼è¯»Â â–¾
* [æ´»åŠ¨](https://www.4hou.com/newticket)
* [ä¸“é¢˜](https://www.4hou.com/category/special)
* [å›¾è°±](https://www.4hou.com/atlas/index)
* [æŠ¥å‘Š](https://www.4hou.com/new-report-info)
* [å˜¶ç¥¨](https://www.4hou.com/tickets)
* [å˜¶è´§](https://www.4hou.com/shop)
* [ä¼ä¸šæŸ¥è¯¢](https://www.4hou.com/corp/new-search-company)
* [æ‹›è˜](https://www.4hou.com/recruit)![](https://www.4hou.com/sihou/images/1561626446625934.png)

* [æ–°é—»](https://www.4hou.com/category/news)
* [è¡Œä¸š](https://www.4hou.com/category/industry)
* [è¶‹åŠ¿](https://www.4hou.com/category/observation)
* [è®¿è°ˆ](https://www.4hou.com/category/people)
* [æ¼æ´](https://www.4hou.com/category/vulnerable)
* [WEBå®‰å…¨](https://www.4hou.com/category/web)
* [ä¸šåŠ¡å®‰å…¨](https://www.4hou.com/category/business)
* [ç³»ç»Ÿå®‰å…¨](https://www.4hou.com/category/system)
* [å†…ç½‘æ¸—é€](https://www.4hou.com/category/penetration)
* [å‹’ç´¢è½¯ä»¶](https://www.4hou.com/category/typ)
* [å®‰å…¨å·¥å…·](https://www.4hou.com/category/tools)

# é™Œé™Œå®‰å…¨è·Appleè‡´è°¢ï¼šCVE-2022-42837 - iTunes Store ä¹‹æ®‡

é™Œé™Œå®‰å…¨
[è¡Œä¸š](https://www.4hou.com/category/industry)
2022-12-19 17:56:32

![](https://img.4hou.com/article/%E6%B5%8F%E8%A7%88.png)147439

æ”¶è—

å¯¼è¯­ï¼šé™Œé™Œå®‰å…¨è·Appleè‡´è°¢ï¼›iOS

å…ˆä¸ºæˆ‘ä»¬çš„åŒå­¦@dwj1210é¼“é¼“æŒğŸ‘ã€‚ä½œä¸ºå›´è§‚äº†æ•´ä¸ªæ¼æ´ä»å‘ç°åˆ°æœ€ç»ˆå½¢æˆæœ¬ç¯‡æ–‡ç« çš„åŒå­¦ã€‚å°ç¼–å‰é¢å…ˆè¯´ä¸€å¥ï¼šæœ¬æ¬¡æ¼æ´å‘ç°éå¸¸å·§åˆï¼Œå‰äº›å¤©ç»™WMCTFå‡ºé¢˜çš„æ—¶å€™ï¼ŒdwjåŒå­¦çªç„¶å°å£°å¿µå¨å¥½åƒæŒ–åˆ°äº†ä¸€ä¸ªRCEã€‚äºæ˜¯åœ¨å‡ºå®Œé¢˜åï¼Œæˆ‘ä»¬å¼€å§‹äº†ç»™Appleæäº¤æ¼æ´å¸®åŠ©Appleä¿®å¤çš„æ¼«é•¿ä¹‹è·¯ï¼Œä¹Ÿå°±æœ‰äº†dwjè¿™ç¯‡æ–‡ç« ã€‚ä»¥ä¸‹å°±æ˜¯dwjåŒå­¦çš„è‡ªè¿°ï¼š

ä¸ºä»€ä¹ˆè¿™é‡Œå«åš iTunes Store ä¹‹æ®‡ï¼Œæ˜¯å› ä¸º iTunes Store App ä»»æ„ javascript ä»£ç æ‰§è¡Œçš„æ¼æ´å·²ç»è¢«ä¿®äº†å¥½å‡ æ¬¡äº†ã€‚

è¯¥æ¼æ´ç”± Safari æµè§ˆå™¨ ä¸­çš„ä¸€ä¸ªæ¶æ„é¡µé¢å¼•å…¥ï¼Œå½“ä½ ç‚¹å‡»ä¸€ä¸ª URL Schemes æˆ– Universal Links çš„é“¾æ¥æ—¶ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªç‰¹æ®Šçš„ URL è°ƒèµ·æŒ‡å®š App å¹¶ä¼ å…¥æ”»å‡»è·è½½ã€‚å¦‚æœåœ¨ Safariæµè§ˆå™¨ä¸­è¾“å…¥sms://å¯ä»¥è°ƒèµ·ä¿¡æ¯ Appï¼Œæ­¤æ—¶ä¼šæœ‰ä¸€ä¸ªå¼¹æ¡†è¯¢é—®æ˜¯å¦å…è®¸æ‰“å¼€ã€‚

![02.jpg](https://img.4hou.com/uploads/ueditor/php/upload/image/20221220/1671525690147799.jpeg "1671525690147799.jpeg")

ä½†æ˜¯ä¸€äº›å†…ç½®çš„ Apple åº”ç”¨ç¨‹åºæ˜¯è¢« Safari æµè§ˆå™¨ä¿¡ä»»çš„ï¼Œä¸ä¼šè¯¢é—®ç”¨æˆ·ç›´æ¥æ‹‰èµ·ï¼Œè¿™äº›åº”ç”¨ç¨‹åºè¢«ç¡¬ç¼–ç åœ¨ç³»ç»Ÿä»£ç ä¸­ï¼š

![03.jpg](https://img.4hou.com/uploads/ueditor/php/upload/image/20221220/1671525713112390.jpeg "1671525713112390.jpeg")

æ—©åœ¨ Pwn2Own 2014 å¹´éŸ©å›½é»‘å®¢ lokihardt é€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„ URL åœ¨ iTunes Store æ‰“å¼€äº†ä»»æ„çš„ç½‘é¡µï¼š

![image.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20221219/1671443711179082.png "1671443506286533.png")

è€ŒÂ itms://Â å°±æ˜¯ iTunes Store æ³¨å†Œçš„ URL Schemeï¼Œç”±äºåº”ç”¨ç¨‹åºç™½åå•çš„ç¼˜æ•…ä¸éœ€è¦å‘ç”¨æˆ·è¯¢é—®å°±å¯ä»¥ç›´æ¥åœ¨ iTunes Store ä¸­æ‰“å¼€æ¶æ„çš„ç½‘é¡µã€‚

![04.jpg](https://img.4hou.com/uploads/ueditor/php/upload/image/20221220/1671525733775989.jpeg "1671525733775989.jpeg")

æ­¤æ—¶ç»“åˆä¸€ä¸ª UAF å°±å®Œæˆäº†æ²™ç®±é€ƒé€¸åŠ ä»»æ„ä»£ç æ‰§è¡Œã€‚

åé¢è‹¹æœåŠ å…¥äº†åŸŸåé™åˆ¶ï¼Œåªæœ‰åŸŸååç¼€æ»¡è¶³ trustedDomains åŸŸååˆ—è¡¨æ—¶æ‰ä¼šæ‰“å¼€ï¼Œä½†æ˜¯ lokihardt åˆæ‰¾åˆ°äº†ä¸€ä¸ªä¿¡ä»»åŸŸçš„ DOM xss åˆæ‰“äº†ä¸€æ¬¡ã€‚

ä¹‹åæ²‰å¯‚å¤šå¹´ï¼Œåœ¨ 2020 å¹´å¤©åºœæ¯ä¸Šï¼Œcc å¸ˆå‚…å‡­å€Ÿå®Œæ•´çš„ full chain exploit è¿œç¨‹ç ´è§£äº†æ­è½½ iOS14.2 çš„ iPhone11 è®¾å¤‡ã€‚

è€Œè¯¥æ¼æ´åˆ©ç”¨é“¾çš„ç¬¬ä¸€æ­¥ä¾ç„¶æ˜¯ä» Safari åˆ° iTunes Storeï¼Œä¸åˆ©ç”¨å†…å­˜ç ´åï¼Œä¸æ‰§è¡Œ shellcodeï¼Œé€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„ URL å¯ä»¥ç»•è¿‡åŸŸåç™½åå•çš„æ ¡éªŒæ‰§è¡Œä»»æ„çš„ javascript ä»£ç ï¼Œè§¦å‘ xss å¼¹è®¡ç®—å™¨ã€‚

![05.jpg](https://img.4hou.com/uploads/ueditor/php/upload/image/20221220/1671525743128741.jpeg "1671525743128741.jpeg")

æ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥ç›´æ¥ç ”è¯» cc å¸ˆå‚…çš„æ–‡ç« ï¼šã€ŠCVE-2021-1748ï¼šä»å®¢æˆ·ç«¯ XSS åˆ°å¼¹è®¡ç®—å™¨ã€‹Â https://codecolor.ist/2021/08/04/mistuned-part-i/

è€Œä»Šå¤©è¦ä»‹ç»çš„ä¾ç„¶æ˜¯ iTunes Store çš„ä»»æ„ javascript ä»£ç æ‰§è¡Œã€‚

iTunes Store ä¸­æœ‰ä¸€æ®µé€»è¾‘ï¼Œå½“ä¼ å…¥çš„ URL Scheme ä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å‚æ•°æ—¶ï¼Œåº”ç”¨å°±ä¼šå¿½ç•¥ URL çš„ hostï¼Œç›´æ¥åŠ è½½ URL Scheme å‚æ•°ä¸­çš„ URL è¿›è¡ŒåŠ è½½ï¼Œæ¯”å¦‚ï¼š

![image.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20221219/1671443713157287.png "1671443654630915.png")

iTunes Store åœ¨å¯åŠ¨çš„æ—¶å€™ä¼šä»è¿™ä¸ªURLæ‹‰å–ä¸€ä¸ª XML æ–‡ä»¶ï¼ŒXML æ–‡ä»¶ä¸­çš„ trustedDomains å­—æ®µä¸­é¢„ç½®äº† Apple çš„å¯ä¿¡åŸŸåï¼š

![06.jpg](https://img.4hou.com/uploads/ueditor/php/upload/image/20221220/1671525752999043.jpeg "1671525752999043.jpeg")

åªæœ‰é¡µé¢çš„ä¸»æœºåå’Œ trustedDomains å­—æ®µçš„åç¼€åŒ¹é…ï¼Œè¯¥é¡µé¢æ‰ä¼šè¢«å…è®¸åœ¨ iTunes Store ä¸­æ‰“å¼€ã€‚

åŸŸåæ ¡éªŒåœ¨-[ISURLBag urlIsTrusted:]å‡½æ•°ä¸­ï¼Œä½†æ˜¯è¯¥å‡½æ•°çš„åŸŸåæ ¡éªŒå­˜åœ¨ç¼ºé™·ã€‚å½“ä½ ä¼ å…¥çš„ URL ä¸ºhttp://@www.apple.com:@www.hacker.comÂ æ—¶ï¼ŒiOS ç³»ç»Ÿåœ¨é€šè¿‡Â -[NSURL host]å‡½æ•°å– host æ—¶ä¼šå–åˆ°www.apple.comï¼Œä½†æ˜¯å®é™…æ‰“å¼€çš„é¡µé¢å´æ˜¯Â www.hacker.comã€‚æ®äº†è§£åœ¨ Android å¹³å°åŒæ ·å­˜åœ¨ç±»ä¼¼çš„é—®é¢˜ã€‚

![07.jpg](https://img.4hou.com/uploads/ueditor/php/upload/image/20221220/1671525766779808.jpeg "1671525766779808.jpeg")

æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æ„é€ ä¸€ä¸ªè¿™æ ·çš„ URL Scheme æ¥ç»•è¿‡åŸŸåæ ¡éªŒæ‰“å¼€ä¸€ä¸ªä»»æ„çš„ç½‘é¡µï¼š

![image.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20221219/1671443709171258.png "1671443709171258.png")

è¯¥æ¼æ´ç›®å‰å·²äº iOS16.2 ä¿®å¤ï¼Œä¸æ¸…æ¥šå¯ç”¨æœ€ä½ç‰ˆæœ¬ï¼Œä½†æ˜¯ iOS9 - iOS16.1.2 åº”è¯¥éƒ½æ˜¯å¯ç”¨çš„ã€‚ç”±äºå½±å“èŒƒå›´æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥æä¾›çš„ PoC éšå»äº†éƒ¨åˆ†å…³é”®å‚æ•°ã€‚

iTunes Store æ‰“å¼€ç½‘é¡µä½¿ç”¨çš„ SUWebView é€šè¿‡Â  JavaScript bridge æ³¨å…¥äº†è®¸å¤šåŠŸèƒ½ï¼›SUWebView å°† SUScriptInterface ç±»çš„æ–¹æ³•å¯¼å‡ºåˆ° js ä¸Šä¸‹æ–‡ä¸­ã€‚è¿™äº› API è¢«æ”¾åœ¨å…¨å±€ä½œç”¨åŸŸçš„ iTunes å‘½åç©ºé—´é‡Œã€‚

![08.jpg](https://img.4hou.com/uploads/ueditor/php/upload/image/20221220/1671525780457171.jpeg "1671525780457171.jpeg")

å¦å¤–åœ¨è¿™ä¸ª WebView ä¸­å‘ä»»æ„åŸŸåå‘é€è¯·æ±‚ï¼Œéƒ½ä¼šå¸¦ä¸Šéƒ¨åˆ† iTunes Store cookie ä¿¡æ¯:

![09.jpg](https://img.4hou.com/uploads/ueditor/php/upload/image/20221220/1671525793846478.jpeg "1671525793846478.jpeg")

ä¾‹è¡Œå¼¹è®¡ç®—å™¨ï¼š

![10.GIF](https://img.4hou.com/uploads/ueditor/php/upload/image/20221220/1671525809405413.gif "1671525809405413.gif")

å¦‚è‹¥è½¬è½½ï¼Œè¯·æ³¨æ˜åŸæ–‡åœ°å€

* åˆ†äº«è‡³

![å–æ¶ˆ](https://www.4hou.com/sihou/images/close.jpg)
![å˜¶å¼](https://www.4hou.com/sihou/images/logo.png)

æ„Ÿè°¢æ‚¨çš„æ”¯æŒï¼Œæˆ‘ä¼šç»§ç»­åŠªåŠ›çš„!

![æ‰«ç æ”¯æŒ]( "æ‰«ä¸€æ‰«")

æ‰“å¼€å¾®ä¿¡æ‰«ä¸€æ‰«åç‚¹å‡»å³ä¸Šè§’å³å¯åˆ†äº«å“Ÿ

### å‘è¡¨è¯„è®º

è¯„è®º

![](https://www.4hou.com/captcha/flat?zXJ7y3XU)

#### ä½ å¯èƒ½æ„Ÿå…´è¶£çš„

* [![]()

  Exchange/M365æœ€æ–°é˜²èŒƒæ”»ç•¥ï¼CACTERä¸‰æ­¥è¡¥é½åŸç”Ÿé˜²æŠ¤çŸ­æ¿](https://www.4hou.com/posts/l03l)
* [![]()

  ã€é™„ä¸‹è½½ã€‘2025æˆ‘ä»¬èº«è¾¹çš„ ç½‘ä¿¡å®‰å…¨ å…¸å‹æ¡ˆä¾‹ç­‰ å®˜æ–¹è§†é¢‘æ±‡ç¼–](https://www.4hou.com/posts/kg3x)
* [![]()

  è‰è”è£èª‰ï¼æ¢†æ¢†å®‰å…¨å†åº¦è·é€‰ â€œåŒ—äº¬å¸‚å§”ç½‘ä¿¡åŠç¬¬äºŒå±Šç½‘ç»œå®‰å…¨æŠ€æœ¯æ”¯æ’‘å•ä½â€](https://www.4hou.com/posts/9jKP)
* [![]()

  èšç„¦å¯ä¿¡AIå®‰å…¨ï¼SDC2025 è®®é¢˜é‡ç£…æ­æ™“](https://www.4hou.com/posts/gy39)
* [![]()

  2025ç¬¬äº”å±Šå¤ªåŸç½‘ç»œå®‰å…¨é«˜å³°è®ºå›æˆåŠŸä¸¾åŠ](https://www.4hou.com/posts/8gJl)
* [![]()

  ç‰¹å‹¤å±€æ‰‹å†Œ | ç›‘å¬åŠå…¬å®¤](https://www.4hou.com/posts/42B2)

![](https://img.4hou.com/uploads/20171229/1514527089616635.gif)

# [é™Œé™Œå®‰å…¨](https://www.4hou.com/member/JN3P)

é™Œé™Œå®‰å…¨çš„å®˜æ–¹è´¦å·

#### æœ€æ–°æ–‡ç« 

* [Exchange/M365æœ€æ–°é˜²èŒƒæ”»ç•¥ï¼CACTERä¸‰æ­¥è¡¥é½åŸç”Ÿé˜²æŠ¤çŸ­æ¿](https://www.4hou.com/posts/l03l)
  2025-09-29 17:48:04
* [ã€é™„ä¸‹è½½ã€‘2025æˆ‘ä»¬èº«è¾¹çš„ ç½‘ä¿¡å®‰å…¨ å…¸å‹æ¡ˆä¾‹ç­‰ å®˜æ–¹è§†é¢‘æ±‡ç¼–](https://www.4hou.com/posts/kg3x)
  2025-09-29 14:55:37
* [è‰è”è£èª‰ï¼æ¢†æ¢†å®‰å…¨å†åº¦è·é€‰ â€œåŒ—äº¬å¸‚å§”ç½‘ä¿¡åŠç¬¬äºŒå±Šç½‘ç»œå®‰å…¨æŠ€æœ¯æ”¯æ’‘å•ä½â€](https://www.4hou.com/posts/9jKP)
  2025-09-29 14:23:50
* [èšç„¦å¯ä¿¡AIå®‰å…¨ï¼SDC2025 è®®é¢˜é‡ç£…æ­æ™“](https://www.4hou.com/posts/gy39)
  2025-09-28 17:20:40

[æŸ¥çœ‹æ›´å¤š](https://www.4hou.com/member/JN3P)

# ç›¸å…³çƒ­æ–‡

* [Exchange/M365æœ€æ–°é˜²èŒƒæ”»ç•¥ï¼CACTERä¸‰æ­¥è¡¥é½åŸç”Ÿé˜²æŠ¤çŸ­æ¿](https://www.4hou.com/posts/l03l)

  CACTER
* [ã€é™„ä¸‹è½½ã€‘2025æˆ‘ä»¬èº«è¾¹çš„ ç½‘ä¿¡å®‰å…¨ å…¸å‹æ¡ˆä¾‹ç­‰ å®˜æ–¹è§†é¢‘æ±‡ç¼–](https://www.4hou.com/posts/kg3x)

  ç½‘ç»œä¼è±ª
* [è‰è”è£èª‰ï¼æ¢†æ¢†å®‰å…¨å†åº¦è·é€‰ â€œåŒ—äº¬å¸‚å§”ç½‘ä¿¡åŠç¬¬äºŒå±Šç½‘ç»œå®‰å…¨æŠ€æœ¯æ”¯æ’‘å•ä½â€](https://www.4hou.com/posts/9jKP)

  æ¢†æ¢†å®‰å…¨
* [èšç„¦å¯ä¿¡AIå®‰å…¨ï¼SDC2025 è®®é¢˜é‡ç£…æ­æ™“](https://www.4hou.com/posts/gy39)

  ä¼ä¸šèµ„è®¯
* [2025ç¬¬äº”å±Šå¤ªåŸç½‘ç»œå®‰å…¨é«˜å³°è®ºå›æˆåŠŸä¸¾åŠ](https://www.4hou.com/posts/8gJl)

  ä¼ä¸šèµ„è®¯
* [ç‰¹å‹¤å±€æ‰‹å†Œ | ç›‘å¬åŠå…¬å®¤](https://www.4hou.com/posts/42B2)

  RC2åçªƒå¯†å®éªŒå®¤

![]()

[å…¬å¸ç®€ä»‹](https://www.4hou.com/about?title=å…¬å¸ç®€ä»‹)
|
[æˆ‘è¦æŠ•ç¨¿](https://www.4hou.com/about?title=æˆ‘è¦æŠ•ç¨¿)
|
[æ›´æ–°æ—¥å¿—](https://www.4hou.com/about?title=æ›´æ–°æ—¥å¿—)
|
[å‹æƒ…é“¾æ¥](https://www.4hou.com/about?title=å‹æƒ…é“¾æ¥)
|
[éšç§æ”¿ç­–](https://www.4hou.com/about?title=éšç§æ”¿ç­–)
|

[![](https://www.4hou.com/sihou/images/new4hou/weibo.png)](http://weibo.com/u/6069423878)
![](https://www.4hou.com/sihou/images/new4hou/wechat.png)

æœ¬ç«™4hou.comï¼Œæ‰€ä½¿ç”¨çš„å­—ä½“å’Œå›¾ç‰‡æ–‡å­—ç­‰ç´ æéƒ¨åˆ†æ¥æºäºåŸä½œè€…æˆ–äº’è”ç½‘å…±äº«å¹³å°ã€‚å¦‚ä½¿ç”¨ä»»ä½•å­—ä½“å’Œå›¾ç‰‡æ–‡å­—æœ‰ä¾µçŠ¯å…¶ç‰ˆæƒæ‰€æœ‰æ–¹çš„ï¼Œå˜¶å¼å°†é…åˆè”ç³»åŸä½œè€…æ ¸å®ï¼Œå¹¶åšå‡ºåˆ é™¤å¤„ç†ã€‚

[Â©2024 åŒ—äº¬å˜¶å¼æ–‡åŒ–ä¼ åª’æœ‰é™å…¬å¸ äº¬ICPå¤‡16063439å·-1](https://beian.miit.gov.cn/)
æœ¬ç«™ç”± ![](https://www.4hou.com/sihou/images/new4hou/txcloud.png) ![](https://www.4hou.com/sihou/images/new4hou/bdcloud.png) ![](https://www.4hou.com/sihou/images/new4hou/ucloud.png) æä¾›äº‘è®¡ç®—æœåŠ¡

å¾®ä¿¡

[å¾®åš](http://weibo.com/u/6069423878)
[RSS](https://www.4hou.com/feed)
[çŸ¥ä¹](https://zhuanlan.zhihu.com/roartalk)