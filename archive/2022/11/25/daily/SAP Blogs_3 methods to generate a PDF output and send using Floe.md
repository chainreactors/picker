---
title: 3 methods to generate a PDF output and send using Floe
url: https://blogs.sap.com/2022/11/24/3-methods-to-generate-a-pdf-output-and-send-using-floe/
source: SAP Blogs
date: 2022-11-25
fetch_date: 2025-10-03T23:43:49.271135
---

# 3 methods to generate a PDF output and send using Floe

* [SAP Community](/)
* [Products and Technology](/t5/products-and-technology/ct-p/products)
* [Enterprise Resource Planning](/t5/enterprise-resource-planning/ct-p/erp)
* [ERP Blog Posts by Members](/t5/enterprise-resource-planning-blog-posts-by-members/bg-p/erp-blog-members)
* 3 methods to generate a PDF output and send using ...

Enterprise Resource Planning Blog Posts by Members

All communityThis categoryBlogKnowledge baseUsersManaged tags

cancel

[Turn on suggestions](https://community.sap.com/t5/blogs/v2/blogarticlepage.enableautocomplete%3Aenableautocomplete?t:ac=blog-id/erp-blog-members/article-id/67624&t:cp=action/contributions/searchactions)

Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type.

Showing results for

Search instead for

Did you mean:

We have just launched our new Developer forums! Check out more in
[this What's New post](https://community.sap.com/t5/what-s-new/new-developer-forums/ba-p/14230147) (This banner is now dismissible.)

Read only

## [3 methods to generate a PDF output and send using Floe](/t5/enterprise-resource-planning-blog-posts-by-members/3-methods-to-generate-a-pdf-output-and-send-using-floe/ba-p/13558092)

![chris_scott](https://avatars.profile.sap.com/c/e/idcec83e3a17dbe5c19a5f236f040f74629cf1a47dd13796d7364b53328abe7dd3_small.jpeg "chris_scott")

[chris\_scott](https://community.sap.com/t5/user/viewprofilepage/user-id/184054)

Active Participant

Options

* [Subscribe to RSS Feed](/khhcw49343/rss/message?board.id=erp-blog-members&message.id=67624)
* Mark as New
* Mark as Read
* Bookmark
* Subscribe
* [Printer Friendly Page](/t5/blogs/blogarticleprintpage/blog-id/erp-blog-members/article-id/67624)
* [Report Inappropriate Content](/t5/notifications/notifymoderatorpage/message-uid/13558092)

‎2022 Nov 24
6:54 PM

[1
Kudo](/t5/kudos/messagepage/board-id/erp-blog-members/message-id/67624/tab/all-users "Click here to see who gave kudos to this post.")

2,658

* SAP Managed Tags
* [SAP ERP](https://community.sap.com/t5/c-khhcw49343/SAP%2520ERP/pd-p/01200615320800000659)
* [SAP S/4HANA](https://community.sap.com/t5/c-khhcw49343/SAP%2520S%252F4HANA/pd-p/73554900100800000266)
* [SAP Interactive Forms by Adobe](https://community.sap.com/t5/c-khhcw49343/SAP%2520Interactive%2520Forms%2520by%2520Adobe/pd-p/582573882271271216439685697820265)

* [SAP ERP

  SAP ERP](/t5/c-khhcw49343/SAP%2BERP/pd-p/01200615320800000659)
* [SAP S/4HANA

  SAP S/4HANA](/t5/c-khhcw49343/SAP%2BS%25252F4HANA/pd-p/73554900100800000266)
* [SAP Interactive Forms by Adobe

  Software Product Function](/t5/c-khhcw49343/SAP%2BInteractive%2BForms%2Bby%2BAdobe/pd-p/582573882271271216439685697820265)

View products (3)

It's never been easier to generate powerful dynamic emails from SAP using Floe.  In many cases, the email can replace old PDF outputs generated by SAPScript, Smartforms or Adobe forms.  But in some scenarios there is still a valid business need to include an attachment with the outbound email.

There are multiple ways to generate the PDF and attach it to the email.  Here are three methods, rising in complexity...

## 1) Floe

By far the easiest method is to build the output template in Floe Designer.

![](/legacyfs/online/storage/blog_attachments/2022/11/floe-designer.jpg)

The process is exactly the same as designing a dynamic email template in Floe, but you can add PDF options:

![](/legacyfs/online/storage/blog_attachments/2022/11/pdf-options.jpg)

Then simply reference the template type as an attachment in the outbound email settings:

![](/legacyfs/online/storage/blog_attachments/2022/11/email-attachment-settings.jpg)

Then, in your output program, simply call the Floe API and the PDF will be automatically generated and added to the email:

```
  CALL FUNCTION '/FLOE/EMAIL_OUT'

    EXPORTING

      im_etype            = gv_etype

      im_elang            = gv_language

      im_document         = l_im_doc

      im_rec_emails       = gt_rec_emails

      im_variables        = gt_vars

      im_send_immediately = 'X'

      im_attachments      = lt_attach

      im_preview          = gv_screen_display

      im_no_commit        = lv_no_commit

    IMPORTING

      ex_subrc            = <gv_returncode>

      ex_ebody            = ev_ebody

      ex_mess             = lt_mess

      ex_rec_emails       = et_rec_emails

      ex_attachments      = et_attachments

      ex_esubject_long    = ev_esubject_long.
```

Check out the full code example [here](http://support.arch-global.com/default.asp?W801)

This method requires a subscription to Renda.io, which integrates seamlessly with Floe for PDF generation.

## 2) Floe and Varo

If you already have Varo and skills in Adobe Designer, then you may prefer this option to generate your PDF.  This method requires no subscription to Renda.io, but you do need some Floe Designer expertise.

The form field design is handled by Varo, and the fields arranged in Adobe Designer.

Then when you call the output program, you need to pass in two template types - one for the Floe email template and the other for the Varo form template:

![](/legacyfs/online/storage/blog_attachments/2022/11/varo-and-floe.jpg)

Then in the output program you need to call the Varo function to return the PDF:

```
      CALL FUNCTION '/FLM/OUTPUT_PDF_PDL_OUT'

        EXPORTING

          im_ftype     = lv_ftype

          im_fid       = lv_fid

          im_fver      = lv_fver

          im_toption   = lv_template

          im_document  = lv_doc

          im_variables = lt_variables

          im_no_print  = 'X'

*         IM_PDLTYPE   =

*         IM_XDCNAME   =

        IMPORTING

          ex_pdf       = lv_pdf

*         EX_PDL       =

*         EX_PAGECOUNT =

*         EX_JOB_ID    =

          ex_subrc     = <gv_returncode>

          ex_mess      = ls_mess.
```

And then add this to the Floe attachments import parameter before calling the Floe API:

```
*-------------------------------------------------------------------

* Fill attachment

*

      CONCATENATE 'Order_' lv_order '.pdf' INTO ls_attach-att_filename.

      ls_attach-att_description = 'Order_output'.

      ls_attach-att_data = lv_pdf.

      APPEND ls_attach TO lt_attach.

    ENDIF.

  ENDIF.

*

*-------------------------------------------------------------------
```

```
  CALL FUNCTION '/FLOE/EMAIL_OUT'

    EXPORTING

      im_etype            = gv_etype

      im_elang            = gv_language

      im_document         = l_im_doc

      im_rec_emails       = gt_rec_emails

      im_variables        = gt_vars

      im_send_immediately = 'X'

      im_attachments      = lt_attach

      im_preview          = gv_screen_display

      im_no_commit        = lv_no_commit

    IMPORTING

      ex_subrc            = <gv_returncode>

      ex_ebody            = ev_ebody

      ex_mess             = lt_mess

      ex_rec_emails       = et_rec_emails

      ex_attachments      = et_attachments

      ex_esubject_long    = ev_esubject_long.
```

See the full code example [here](http://support.arch-global.com/default.asp?pg=pgDownload&pgType=pgWikiAttachment&ixAttachment=34819&sFileName=ZSD_SALESDOC_FLOE.txt).

## **3) Floe and IfBA**

In scenarios where you already have a PDF template defined using Interactive Forms by Adobe, then you can generate the PDF, then add it to the Floe attachments table as above.

In order to generate the PDF you first need to set output settings:

```
 ls_outputparams-nodialog   = abap_true.

 ls_outputparams-connection = 'ADS'.

 ls_outputparams-getpdf   = abap_true.

 ls_outputparams-preview  = abap_false.
```

Then follow the process to call ADS to print the PDF, but the output settings will return the PDF file rather than send to the SAP Spool.

```
…

PERFORM get_output_params

…

CALL FUNCTION 'FP_JOB_OPEN'

…

CALL FUNCTION 'FP_FUNCTION_MODULE_NAME'

…

CALL FUNCTION lv_fm_name

…

CALL FUNCTION 'FP_JOB_CLOSE'

…
```

Note that the function call returns paramet...