---
title: é™Œé™Œå®‰å…¨è·Appleè‡´è°¢ï¼šCVE-2022-42837 - iTunes Store ä¹‹æ®‡
url: https://buaq.net/go-140601.html
source: unSafe.sh - ä¸å®‰å…¨
date: 2022-12-20
fetch_date: 2025-10-04T01:58:06.707200
---

# é™Œé™Œå®‰å…¨è·Appleè‡´è°¢ï¼šCVE-2022-42837 - iTunes Store ä¹‹æ®‡

* [unSafe.sh - ä¸å®‰å…¨](https://unsafe.sh)
* [æˆ‘çš„æ”¶è—](/user/collects)
* [ä»Šæ—¥çƒ­æ¦œ](/?hot=true)
* [å…¬ä¼—å·æ–‡ç« ](/?gzh=true)
* [å¯¼èˆª](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [ç¼–ç /è§£ç ](/encode)
* [æ–‡ä»¶ä¼ è¾“](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
é»‘å¤œæ¨¡å¼

![](https://8aqnet.cdn.bcebos.com/7dc56a8faa275b8bf3c0689edd06ab4e.jpg)

é™Œé™Œå®‰å…¨è·Appleè‡´è°¢ï¼šCVE-2022-42837 - iTunes Store ä¹‹æ®‡

å¯¼è¯­ï¼šé™Œé™Œå®‰å…¨è·Appleè‡´è°¢ï¼›iOS
*2022-12-19 17:56:32
Author: [www.4hou.com(æŸ¥çœ‹åŸæ–‡)](/jump-140601.htm)
é˜…è¯»é‡:53
æ”¶è—*

---

å¯¼è¯­ï¼šé™Œé™Œå®‰å…¨è·Appleè‡´è°¢ï¼›iOS

å…ˆä¸ºæˆ‘ä»¬çš„åŒå­¦@dwj1210é¼“é¼“æŒğŸ‘ã€‚ä½œä¸ºå›´è§‚äº†æ•´ä¸ªæ¼æ´ä»å‘ç°åˆ°æœ€ç»ˆå½¢æˆæœ¬ç¯‡æ–‡ç« çš„åŒå­¦ã€‚å°ç¼–å‰é¢å…ˆè¯´ä¸€å¥ï¼šæœ¬æ¬¡æ¼æ´å‘ç°éå¸¸å·§åˆï¼Œå‰äº›å¤©ç»™WMCTFå‡ºé¢˜çš„æ—¶å€™ï¼ŒdwjåŒå­¦çªç„¶å°å£°å¿µå¨å¥½åƒæŒ–åˆ°äº†ä¸€ä¸ªRCEã€‚äºæ˜¯åœ¨å‡ºå®Œé¢˜åï¼Œæˆ‘ä»¬å¼€å§‹äº†ç»™Appleæäº¤æ¼æ´å¸®åŠ©Appleä¿®å¤çš„æ¼«é•¿ä¹‹è·¯ï¼Œä¹Ÿå°±æœ‰äº†dwjè¿™ç¯‡æ–‡ç« ã€‚ä»¥ä¸‹å°±æ˜¯dwjåŒå­¦çš„è‡ªè¿°ï¼š

ä¸ºä»€ä¹ˆè¿™é‡Œå«åš iTunes Store ä¹‹æ®‡ï¼Œæ˜¯å› ä¸º iTunes Store App ä»»æ„ javascript ä»£ç æ‰§è¡Œçš„æ¼æ´å·²ç»è¢«ä¿®äº†å¥½å‡ æ¬¡äº†ã€‚

è¯¥æ¼æ´ç”± Safari æµè§ˆå™¨ ä¸­çš„ä¸€ä¸ªæ¶æ„é¡µé¢å¼•å…¥ï¼Œå½“ä½ ç‚¹å‡»ä¸€ä¸ª URL Schemes æˆ– Universal Links çš„é“¾æ¥æ—¶ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªç‰¹æ®Šçš„ URL è°ƒèµ·æŒ‡å®š App å¹¶ä¼ å…¥æ”»å‡»è·è½½ã€‚å¦‚æœåœ¨ Safariæµè§ˆå™¨ä¸­è¾“å…¥sms://å¯ä»¥è°ƒèµ·ä¿¡æ¯ Appï¼Œæ­¤æ—¶ä¼šæœ‰ä¸€ä¸ªå¼¹æ¡†è¯¢é—®æ˜¯å¦å…è®¸æ‰“å¼€ã€‚

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_jpg/1YLJUhm0ZtmleLCxRHiaDhUeuOFZ4YqIFXzwLwicLFXSv4Jr0ibnvquianRcMLXLvJicpha1LVTLekv85f8eaFqMoMg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

ä½†æ˜¯ä¸€äº›å†…ç½®çš„ Apple åº”ç”¨ç¨‹åºæ˜¯è¢« Safari æµè§ˆå™¨ä¿¡ä»»çš„ï¼Œä¸ä¼šè¯¢é—®ç”¨æˆ·ç›´æ¥æ‹‰èµ·ï¼Œè¿™äº›åº”ç”¨ç¨‹åºè¢«ç¡¬ç¼–ç åœ¨ç³»ç»Ÿä»£ç ä¸­ï¼š

![image.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20221219/1671443711134266.png "1671442395180672.png")

æ—©åœ¨ Pwn2Own 2014 å¹´éŸ©å›½é»‘å®¢ lokihardt é€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„ URL åœ¨ iTunes Store æ‰“å¼€äº†ä»»æ„çš„ç½‘é¡µï¼š

![image.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20221219/1671443711179082.png "1671443506286533.png")

è€ŒÂ itms://Â å°±æ˜¯ iTunes Store æ³¨å†Œçš„ URL Schemeï¼Œç”±äºåº”ç”¨ç¨‹åºç™½åå•çš„ç¼˜æ•…ä¸éœ€è¦å‘ç”¨æˆ·è¯¢é—®å°±å¯ä»¥ç›´æ¥åœ¨ iTunes Store ä¸­æ‰“å¼€æ¶æ„çš„ç½‘é¡µã€‚

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_jpg/1YLJUhm0ZtmleLCxRHiaDhUeuOFZ4YqIFh07akaUb4lGdTZEeoMHHbrko3kDXTkKLLicPIqIzplSdumR1sNiboUFA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

æ­¤æ—¶ç»“åˆä¸€ä¸ª UAF å°±å®Œæˆäº†æ²™ç®±é€ƒé€¸åŠ ä»»æ„ä»£ç æ‰§è¡Œã€‚

åé¢è‹¹æœåŠ å…¥äº†åŸŸåé™åˆ¶ï¼Œåªæœ‰åŸŸååç¼€æ»¡è¶³ trustedDomains åŸŸååˆ—è¡¨æ—¶æ‰ä¼šæ‰“å¼€ï¼Œä½†æ˜¯ lokihardt åˆæ‰¾åˆ°äº†ä¸€ä¸ªä¿¡ä»»åŸŸçš„ DOM xss åˆæ‰“äº†ä¸€æ¬¡ã€‚

ä¹‹åæ²‰å¯‚å¤šå¹´ï¼Œåœ¨ 2020 å¹´å¤©åºœæ¯ä¸Šï¼Œcc å¸ˆå‚…å‡­å€Ÿå®Œæ•´çš„ full chain exploit è¿œç¨‹ç ´è§£äº†æ­è½½ iOS14.2 çš„ iPhone11 è®¾å¤‡ã€‚

è€Œè¯¥æ¼æ´åˆ©ç”¨é“¾çš„ç¬¬ä¸€æ­¥ä¾ç„¶æ˜¯ä» Safari åˆ° iTunes Storeï¼Œä¸åˆ©ç”¨å†…å­˜ç ´åï¼Œä¸æ‰§è¡Œ shellcodeï¼Œé€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„ URL å¯ä»¥ç»•è¿‡åŸŸåç™½åå•çš„æ ¡éªŒæ‰§è¡Œä»»æ„çš„ javascript ä»£ç ï¼Œè§¦å‘ xss å¼¹è®¡ç®—å™¨ã€‚

![image.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20221219/1671443713198130.png "1671442479170011.png")

æ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥ç›´æ¥ç ”è¯» cc å¸ˆå‚…çš„æ–‡ç« ï¼šã€ŠCVE-2021-1748ï¼šä»å®¢æˆ·ç«¯ XSS åˆ°å¼¹è®¡ç®—å™¨ã€‹Â https://codecolor.ist/2021/08/04/mistuned-part-i/

è€Œä»Šå¤©è¦ä»‹ç»çš„ä¾ç„¶æ˜¯ iTunes Store çš„ä»»æ„ javascript ä»£ç æ‰§è¡Œã€‚

iTunes Store ä¸­æœ‰ä¸€æ®µé€»è¾‘ï¼Œå½“ä¼ å…¥çš„ URL Scheme ä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å‚æ•°æ—¶ï¼Œåº”ç”¨å°±ä¼šå¿½ç•¥ URL çš„ hostï¼Œç›´æ¥åŠ è½½ URL Scheme å‚æ•°ä¸­çš„ URL è¿›è¡ŒåŠ è½½ï¼Œæ¯”å¦‚ï¼š

![image.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20221219/1671443713157287.png "1671443654630915.png")

iTunes Store åœ¨å¯åŠ¨çš„æ—¶å€™ä¼šä»è¿™ä¸ªURLæ‹‰å–ä¸€ä¸ª XML æ–‡ä»¶ï¼ŒXML æ–‡ä»¶ä¸­çš„ trustedDomains å­—æ®µä¸­é¢„ç½®äº† Apple çš„å¯ä¿¡åŸŸåï¼š

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_jpg/1YLJUhm0ZtmleLCxRHiaDhUeuOFZ4YqIF1aViaWRsqWtia80nH8rtdN48FPkmEibPOBP3NyzzpC9UdHHSm7vo5Q2cQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

åªæœ‰é¡µé¢çš„ä¸»æœºåå’Œ trustedDomains å­—æ®µçš„åç¼€åŒ¹é…ï¼Œè¯¥é¡µé¢æ‰ä¼šè¢«å…è®¸åœ¨ iTunes Store ä¸­æ‰“å¼€ã€‚

åŸŸåæ ¡éªŒåœ¨-[ISURLBag urlIsTrusted:]å‡½æ•°ä¸­ï¼Œä½†æ˜¯è¯¥å‡½æ•°çš„åŸŸåæ ¡éªŒå­˜åœ¨ç¼ºé™·ã€‚å½“ä½ ä¼ å…¥çš„ URL ä¸ºhttp://@www.apple.com:@www.hacker.comÂ æ—¶ï¼ŒiOS ç³»ç»Ÿåœ¨é€šè¿‡Â -[NSURL host]å‡½æ•°å– host æ—¶ä¼šå–åˆ°www.apple.comï¼Œä½†æ˜¯å®é™…æ‰“å¼€çš„é¡µé¢å´æ˜¯Â www.hacker.comã€‚æ®äº†è§£åœ¨ Android å¹³å°åŒæ ·å­˜åœ¨ç±»ä¼¼çš„é—®é¢˜ã€‚

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_jpg/1YLJUhm0ZtmleLCxRHiaDhUeuOFZ4YqIF0dzbStibRa7m3WN7ARZ1G4shDmf3lUFADMlMXZl8sAXYqNm0YhBDEOw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æ„é€ ä¸€ä¸ªè¿™æ ·çš„ URL Scheme æ¥ç»•è¿‡åŸŸåæ ¡éªŒæ‰“å¼€ä¸€ä¸ªä»»æ„çš„ç½‘é¡µï¼š

![image.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20221219/1671443709171258.png "1671443709171258.png")

è¯¥æ¼æ´ç›®å‰å·²äº iOS16.2 ä¿®å¤ï¼Œä¸æ¸…æ¥šå¯ç”¨æœ€ä½ç‰ˆæœ¬ï¼Œä½†æ˜¯ iOS9 - iOS16.1.2 åº”è¯¥éƒ½æ˜¯å¯ç”¨çš„ã€‚ç”±äºå½±å“èŒƒå›´æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥æä¾›çš„ PoC éšå»äº†éƒ¨åˆ†å…³é”®å‚æ•°ã€‚

iTunes Store æ‰“å¼€ç½‘é¡µä½¿ç”¨çš„ SUWebView é€šè¿‡Â  JavaScript bridge æ³¨å…¥äº†è®¸å¤šåŠŸèƒ½ï¼›SUWebView å°† SUScriptInterface ç±»çš„æ–¹æ³•å¯¼å‡ºåˆ° js ä¸Šä¸‹æ–‡ä¸­ã€‚è¿™äº› API è¢«æ”¾åœ¨å…¨å±€ä½œç”¨åŸŸçš„ iTunes å‘½åç©ºé—´é‡Œã€‚

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_jpg/1YLJUhm0ZtmleLCxRHiaDhUeuOFZ4YqIFdwibdN0c0MxdJj534EungVJsAu2P8TibOsgBto3DYkoHNZmZBRT1nOpw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

å¦å¤–åœ¨è¿™ä¸ª WebView ä¸­å‘ä»»æ„åŸŸåå‘é€è¯·æ±‚ï¼Œéƒ½ä¼šå¸¦ä¸Šéƒ¨åˆ† iTunes Store cookie ä¿¡æ¯:

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_jpg/1YLJUhm0ZtmleLCxRHiaDhUeuOFZ4YqIFddvracZHPtD1o2fMIHoKt6gboHIEu4qycmwgwuZ8I3X0qh6vzOA8hQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

ä¾‹è¡Œå¼¹è®¡ç®—å™¨ï¼š

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_gif/1YLJUhm0ZtmleLCxRHiaDhUeuOFZ4YqIFcGXOsAsBSfiaiaNxvpU03u3C8ljm2O2aVYo0ibSVTHQKNTKcDFuwsBV6w/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

å¦‚è‹¥è½¬è½½ï¼Œè¯·æ³¨æ˜åŸæ–‡åœ°å€

* åˆ†äº«è‡³

![å–æ¶ˆ](https://www.4hou.com/sihou/images/close.jpg)
![å˜¶å¼](https://www.4hou.com/sihou/images/logo.png)

æ„Ÿè°¢æ‚¨çš„æ”¯æŒï¼Œæˆ‘ä¼šç»§ç»­åŠªåŠ›çš„!

![æ‰«ç æ”¯æŒ]( "æ‰«ä¸€æ‰«")

æ‰“å¼€å¾®ä¿¡æ‰«ä¸€æ‰«åç‚¹å‡»å³ä¸Šè§’å³å¯åˆ†äº«å“Ÿ

![](https://www.4hou.com/captcha/flat?WhkUP0e5)

#### ä½ å¯èƒ½æ„Ÿå…´è¶£çš„

* [![](https://img.4hou.com/images/å¾®ä¿¡å›¾ç‰‡_20221219175558.jpg)

  é™Œé™Œå®‰å…¨è·Appleè‡´è°¢ï¼šCVE-2022-42837 - iTunes Store ä¹‹æ®‡](https://www.4hou.com/posts/zl3q)
* [![](https://img.4hou.com/images/SecureHashAltogirthm23_Released_960x600_v4_A.png)

  NISTå¼ƒç”¨SHA-1ï¼Œè½¬ç”¨SHA-2å’ŒSHA-3](https://www.4hou.com/posts/nJ35)
* [![](https://img.4hou.com/images/1671417227497434.png)

  å¤–åª’ï¼šå›½é™…ä¹’è”æœåŠ¡å™¨å‡ºé—®é¢˜ï¼Œé©¬é¾™æ¨ŠæŒ¯ä¸œç­‰ä¸ªäººä¿¡æ¯é­æ³„éœ²](https://www.4hou.com/posts/r732)
* [![](https://img.4hou.com/images/15d17847575af4fad158b335efd1fee9.png)

  ç½‘ç»œæ”»å‡»å‘ç”Ÿååº”ç«‹é©¬é‡‡å–çš„äº”ä¸ªæ­¥éª¤](https://www.4hou.com/posts/YXwW)
* [![](https://img.4hou.com/images/242192f892fd0ce563064d62db453ebc.png)

  PRootæ¼æ´å¯åŠ«æŒLinuxè®¾å¤‡](https://www.4hou.com/posts/l6w1)
* [![](https://img.4hou.com/images/1670286541136741.png)

  å‹’ç´¢è½¯ä»¶æ”»å‡»è¿«ä½¿æ³•å›½åŒ»é™¢è½¬ç§»ç—…äºº](https://www.4hou.com/posts/2JZA)

![]()

æ–‡ç« æ¥æº: https://www.4hou.com/posts/zl3q
 å¦‚æœ‰ä¾µæƒè¯·è”ç³»:admin#unsafe.sh

Â© [unSafe.sh - ä¸å®‰å…¨](https://unsafe.sh) Powered By [PaperCache](https://github.com/code-scan/PaperCache)

* admin#unsafe.sh
* [å®‰å…¨é©¬å…‹](https://aq.mk)
* [æ˜Ÿé™…é»‘å®¢](https://xj.hk)
* [T00ls](https://t00ls.net)