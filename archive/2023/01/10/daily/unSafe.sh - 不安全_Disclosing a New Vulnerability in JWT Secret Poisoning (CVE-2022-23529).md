---
title: Disclosing a New Vulnerability in JWT Secret Poisoning (CVE-2022-23529)
url: https://buaq.net/go-144828.html
source: unSafe.sh - 不安全
date: 2023-01-10
fetch_date: 2025-10-04T03:22:52.146251
---

# Disclosing a New Vulnerability in JWT Secret Poisoning (CVE-2022-23529)

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/a79c2a192a379970f3e49433794c3955.jpg)

Disclosing a New Vulnerability in JWT Secret Poisoning (CVE-2022-23529)

Executive SummaryUnit 42 res
*2023-1-9 22:0:49
Author: [unit42.paloaltonetworks.com(查看原文)](/jump-144828.htm)
阅读量:111
收藏*

---

![A pictorial representation of the JsonWebToken vulnerability.](https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/Cloud-providers.png)

## Executive Summary

Unit 42 researchers discovered a new vulnerability in the popular JsonWebToken open source project. The vulnerability is identified as [CVE-2022-23529](https://github.com/advisories/GHSA-27h2-hvpr-p74q), rated high severity (CVSS 7.6).

By exploiting this vulnerability, attackers could achieve remote code execution (RCE) on a server verifying a maliciously crafted JSON web token (JWT) request. If you are using JsonWebToken package version **8.5.1** or an earlier version, please update to JsonWebToken package version **9.0.0**, which includes a patch for this vulnerability.

[JsonWebToken](https://www.npmjs.com/package/jsonwebtoken) is an open source JavaScript package that allows you to verify/sign JWTs, which are mainly used for authorization and authentication purposes. Developed and maintained by Auth0, the package had over 9 million weekly downloads at the time of writing, and over 20,000 dependents (according to the JsonWebToken page). This package plays a big role in the authentication and authorization functionality for many applications.

Palo Alto Networks customers can identify assets that are running vulnerable versions of the JsonWebToken package with Prisma Cloud, and they can identify the relevant CVE within scan results.

| **Related Unit 42 Topics** | [CVE-2022-23529](https://unit42.paloaltonetworks.com/tag/CVE-2022-23529), [remote code execution](https://unit42.paloaltonetworks.com/tag/remote-code-execution/), [open source](https://unit42.paloaltonetworks.com/tag/open-source/), [cloud](https://unit42.paloaltonetworks.com/category/cloud/) |
| --- | --- |

[JWT 101](#post-126421-_k4j78og9alry)

## JWT 101

JWT (pronounced “jot”) is an [open standard](https://www.rfc-editor.org/rfc/rfc7519) that defines a method of transferring information securely by encoding and signing JSON data. JWTs have a string structure that consists of 3 parts separated by a dot (.):

Header.Payload.Signature

JWTs are used to transmit different types of information, but are mainly used to deliver “claims,” which are pieces of information about some subject. In practice, this will most likely contain useful information about a user.

The most common use case of JWTs is for authorization and authentication. Let’s quickly go over the JWT structure.

### **JWT Header**

As shown in Figure 1, the header consists mostly of two parameters that indicate the type of the token and the signing algorithm.

![Image 1 is a screenshot of two lines of code enclosed in curly brackets. The first line is “alg: HS256” and the second line is “top” JWT.”](https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/JSON-F1.png)

Figure 1. JWT header.

### **JWT Payload**

The payload (shown in Figure 2) is the second part of the token, which will contain the claims. In most cases, this will provide useful information about a user.

![Image 2 is a screenshot of two lines of code enclosed in curly brackets. The first line is “user_name: John Doe” and the second line is “admin: true.”](https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/JSON-F2.png)

Figure 2. JWT payload.

There are three different types of claims: registered, public and private. You can find more information about them in [RFC 7519](https://www.rfc-editor.org/rfc/rfc7519).

The header and payload are each Base64Url encoded to form the first and second parts of a JWT string:

eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9 and eyJ1c2VyX25hbWUiOiJKb2huIERvZSIsImFkbWluIjp0cnVlfQ.

The third part of the JWT, the signature, is then computed (signed) by the following formula using a secret key. A signature is used to verify that the token isn’t forged or manipulated. Because it is signed with a secret key, we can validate the authenticity of the sender:

base64Url(HMACSHA256( base64Url(header) + ”.” + base64Url(payload), secret\_key)) = epQym-1JoN9eep458VBZw4-cVhwfmsI1cfaGa6PE818

Putting it all together, we will get a JWT in its complete form, as shown in Figure 3.

![Image 3 is a screenshot of a JSON web token string with the different parts, header, payload and signature red, green and cyan respectively. ](https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/JSON-F3.png)

Figure 3. Full JSON web token.

## How Does the Authentication Process Work?

Let’s take a look at a simple authentication process using a JSON web token (also shown in Figure 4):

1. To access a protected resource, the user will log in using credentials, usually username and password.
2. A request containing this information will be sent to the authentication endpoint.
3. An authentication server will validate the information sent within a request and issue a JWT signed with a secret key, which can be stored on a server or in a different location using a secret manager.
4. From now on, each user request will contain a JWT in the authorization header. This way, users with the right permissions can receive access to protected resources.
5. When a user requests access to a protected resource, a request containing a JWT will be generated from the application to the JWT authentication endpoint.
6. Before the user receives access to a requested resource, the JWT that was sent in the authorization header will be verified using the secret key. This is done to verify it was not tampered with along the way and that the user has the right permissions to view the requested information. If secret keys are not stored securely, an attacker who can control the secret key will be able to execute code on a host verifying JWT.

![Image 4 is a diagram showing the process of JWT authentication, starting with the user and their credentials. After access is granted and the gateway authenticates the JWT, a secret key is fetched for verification from the key manger and the poisoned secret is present. ](https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/word-image-126421-1.jpeg)

Figure 4. Diagram of the process of authentication with JWT.

## JWT and Open Source

Open source projects help a lot of organizations to save time and other resources. At times, this can serve as an elegant and quick problem solver. JWTs became a very popular technology that many organizations rely on, and this is one of the reasons that some of the open source projects implementing JWTs have become a great success.

One such project is a well-known JavaScript solution for signing, verifying and decoding JWTs named [JsonWebToken](https://www.npmjs.com/package/jsonwebtoken). This tool is developed and maintained by Auth0, part of Okta.

## The Vulnerability (CVE-2022-23529)

Typically, attacks on JWTs will involve different forgery techniques abusing buggy JWT implementations. These kinds of attacks have severe consequences because, in most cases, a successful attack allows an attacker to bypass authentication and authorization mechanisms to access confidential information or steal and/or modify data.

One of the methods provided by the JsonWebToken package is [verify](https://github.com/auth0/node-jsonwebtoken#jwtverifytoken-secretorpublickey-options-callback). The verify method receives three parameters: token, secretOrPublicKey and options. This function verifies the validity of the JWT and...