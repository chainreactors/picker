---
title: Help! My Email Server Got B0rked & I Have Problems After Malware Infection!
url: https://blog.sucuri.net/2023/02/help-my-email-server-got-b0rked-i-have-problems-after-malware-infection.html
source: Sucuri Blog
date: 2023-02-15
fetch_date: 2025-10-04T06:36:01.582438
---

# Help! My Email Server Got B0rked & I Have Problems After Malware Infection!

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)

[Login](https://dashboard.sucuri.net/login/)

[Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)

Search for:

Search

* [Security Education](https://blog.sucuri.net/category/security-education)
* [Sucuri](https://blog.sucuri.net/category/sucuri)

# Help! My Email Server Got B0rked & I Have Problems After Malware Infection!

[![](https://secure.gravatar.com/avatar/a4279e88699c65065bb98c4cdfe5a2b6d92871222bf48497bb57af68b2ef6019?s=60&d=mm&r=g)](https://blog.sucuri.net/author/marc2)

[Marc Kranat](https://blog.sucuri.net/author/marc2)

* February 14, 2023

![Problems with Email Server after Malware Infection](https://blog.sucuri.net/wp-content/uploads/2023/02/23-BlogPost_Feature-Image_1490x700_Email-WAF-820x386.jpg)

The Sucuri Firewall functions as a reverse proxy. A simple change to your DNS settings is all it takes to thoroughly filter incoming traffic to sniff and parse out bad requests from the good ones. However, these DNS changes *can* affect connectivity to your mail service if not properly implemented.

In fact, this is a very common issue that is regularly raised with our support team. The Sucuri WAF is not designed to support or filter your email — and many users either intentionally or accidentally try to send email to the firewall for filtering, resulting in [various problems](https://docs.sucuri.net/website-firewall/troubleshooting/ftp-sftp-ssh-mail-cpanel-whm-plesk-or-websockets-not-working/).

For example, one very common scenario we see is this:

A website owner comes to us with an infected website. We clean the malware and enable the WAF to harden their environment and avoid re-infection. Suddenly, issues occur with inbound or outbound email delivery and troubleshooting ensues.

In this post, we’ll explain why mail server issues can arise after malware remediation and/or enabling the Sucuri WAF. We’ll also outline how to properly implement the web application firewall to resolve issues with your email.

## Inbound email not getting through

The most common cause of inbound traffic not getting through is seen for domains using cPanel or Plesk and hosting email boxes alongside the webservice.

In these cases, the following DNS setup would be typical, with the MX record directive sending email to the website’s IP address:

```
example.com A 192.168.0.1 # where the IP is the website host IP
example.com MX example.com
```

When malware cleanup is complete and the firewall is enabled to filter malicious traffic, block known vulnerabilities, and prevent re-infection, DNS setup might look something like this.

```
example.com A 192.124.249.1 # where the IP is the WAF IP
example.com MX example.com
```

This scenario creates a conundrum for email, however. With this configuration, inbound email will now bounce back to the sender immediately.

To prevent issues, best practice dictates to always use a separate DNS A record for the server listed as the target in the MX record. So instead, the additional A record and corresponding MX record should look like this:

```
mail.example.com A 192.168.0.1 # where the IP is the host and email server IP
example.com MX mail.example.com
```

It is always a good practice to maintain separate hosting server services on separate A records — that includes FTP, IMAP, cPanel, and other services you may be using. Additionally, these should not be defined as CNAME records, and is in fact [strongly discouraged for MX records in rfc1912 2.4](https://www.ietf.org/rfc/rfc1912.txt).

### Other reasons for inbound email issues

I have rarely encountered inbound email issues following infection caused by anything other than a DNS misconfiguration.  Although, I *have* seen hosts block all ports to an infected server as part of their mitigation, you can test for connectivity issues using one of the following commands.

You can check if port 25 (inbound email) is open from a Mac terminal (Command + Space Bar or F4 then type terminal):

```
nc -vz mail.example.com 25
```

On Windows, use a command prompt (Windows +X) with the following command::

```
telnet mail.example.com 25
```

If at any point you see **Connection refused** as an output response, the mail service itself on the server is down. You’ll need to speak to your hosting provider to troubleshoot this issue further.

#### Enabling Telnet in Windows 11

Telnet is disabled by default for Windows 11 environments. You’ll need to enable this client application manually from the control panel to proceed.

* Click **Start** and launch the Control Panel.
* Click **Programs**.
* Select **Turns Windows features on or off.**
* Scroll down to the Telnet Client and tick the box.
* Click **OK** to save your changes.

## How to fix issues with outbound emails

Issues with outbound email can be far more complex to debug, but we’ll break down a couple of important steps you can follow to troubleshoot the problem.
...