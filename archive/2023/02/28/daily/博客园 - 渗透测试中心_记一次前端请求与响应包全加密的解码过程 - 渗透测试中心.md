---
title: 记一次前端请求与响应包全加密的解码过程 - 渗透测试中心
url: https://www.cnblogs.com/backlion/p/17159598.html
source: 博客园 - 渗透测试中心
date: 2023-02-28
fetch_date: 2025-10-04T08:15:04.625180
---

# 记一次前端请求与响应包全加密的解码过程 - 渗透测试中心

[![](https://img2024.cnblogs.com/blog/35695/202509/35695-20250929100304557-587378723.jpg)](https://qoder.com/)

* [![博客园logo](//assets.cnblogs.com/logo.svg)](https://www.cnblogs.com/ "开发者的网上家园")
* [会员](https://cnblogs.vip/)
* [众包](https://www.cnblogs.com/cmt/p/18500368)
* [新闻](https://news.cnblogs.com/)
* [博问](https://q.cnblogs.com/)
* [闪存](https://ing.cnblogs.com/)
* [赞助商](https://www.cnblogs.com/cmt/p/19081960)
* [HarmonyOS](https://harmonyos.cnblogs.com/)
* [Chat2DB](https://chat2db-ai.com/)

* ![搜索](//assets.cnblogs.com/icons/search.svg)
  ![搜索](//assets.cnblogs.com/icons/enter.svg)
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    所有博客
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    当前博客
* [![写随笔](//assets.cnblogs.com/icons/newpost.svg)](https://i.cnblogs.com/EditPosts.aspx?opt=1 "写随笔")
  [![我的博客](//assets.cnblogs.com/icons/myblog.svg)](https://passport.cnblogs.com/GetBlogApplyStatus.aspx "我的博客")
  [![短消息](//assets.cnblogs.com/icons/message.svg)](https://msg.cnblogs.com/ "短消息")
  ![简洁模式](//assets.cnblogs.com/icons/lite-mode-on.svg)

  [![用户头像](//assets.cnblogs.com/icons/avatar-default.svg)](https://home.cnblogs.com/)

  [我的博客](https://passport.cnblogs.com/GetBlogApplyStatus.aspx)
  [我的园子](https://home.cnblogs.com/)
  [账号设置](https://account.cnblogs.com/settings/account)
  [会员中心](https://vip.cnblogs.com/my)
  简洁模式 ...
  退出登录

  [注册](https://account.cnblogs.com/signup)
  登录

[![返回主页](/skins/custom/images/logo.gif)](https://www.cnblogs.com/backlion/)

# [渗透测试中心](https://www.cnblogs.com/backlion)

##

* [博客园](https://www.cnblogs.com/)
* [首页](https://www.cnblogs.com/backlion/)
* [新随笔](https://i.cnblogs.com/EditPosts.aspx?opt=1)
* [联系](https://msg.cnblogs.com/send/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83)
* [管理](https://i.cnblogs.com/)
* 订阅
  [![订阅](/skins/coffee/images/xml.gif)](https://www.cnblogs.com/backlion/rss/)

# [记一次前端请求与响应包全加密的解码过程](https://www.cnblogs.com/backlion/p/17159598.html "发布于 2023-02-27 14:37")

即上次解密后，开发不死心，过了几个月，给返回包也进行了加密。并对前端js进行了压缩混淆

![](https://img2023.cnblogs.com/blog/1049983/202302/1049983-20230227143853807-1800305571.png)

根据观察，初步认为服务端也进行了相同的rsa+aes加密，然后把rsa加密后的key和iv以及aes加密的data字段一起发送回来。但是这样其实对于我们来说，反而是画蛇添足，让系统安全性下降了。因为这样会让前端去进行rsa+aes的解密，**所以****rsa****私钥一定会存在前端**！

**开始操作**

1.老规矩搜索encryptIv字段，找到了疑似解密的部分，打上断点后提交登录请求

![](https://img2023.cnblogs.com/blog/1049983/202302/1049983-20230227143913230-220994266.png)

Burp抓包返回包，提取data字段

![](https://img2023.cnblogs.com/blog/1049983/202302/1049983-20230227143955127-1383575031.png)

断点处提取rsa解密后的aes的key和iv值

![](https://img2023.cnblogs.com/blog/1049983/202302/1049983-20230227143940919-1559702161.png)

把从前端断点处的n和a作为key和iv放入鬼鬼js调试工具尝试解密，解密成功，说明思路没有问题，就是该处代码对服务器传来的encryptIv，encryptKey进行解密为aes原本的密钥和偏移量

![](https://img2023.cnblogs.com/blog/1049983/202302/1049983-20230227144026387-664025891.png)

2.    根据解密代码，找到rsa私钥（p.d），显示不全，复制一段ctrl+f搜索到完整的rsa私钥

![](https://img2023.cnblogs.com/blog/1049983/202302/1049983-20230227144049506-222460964.png)

使用jsencrypt.js脚本进行解密发现报错，原因是原版js调用了浏览器的window和navigator方法，这两个是获取浏览器窗口信息和鼠标位置信息之类的，用以生成随机数

![](https://img2023.cnblogs.com/blog/1049983/202302/1049983-20230227144138321-1100189390.png)

![](https://img2023.cnblogs.com/blog/1049983/202302/1049983-20230227144156872-133407132.png)

通过搜索，发现有人先做过更改原版JSEncrypt，去掉window和navigator方法使用，帖子地址：<https://bbs.125.la/forum.php?mod=viewthread&tid=14113049>

![](https://img2023.cnblogs.com/blog/1049983/202302/1049983-20230227144225215-2004925920.png)

使用鬼鬼js调试成功

![](https://img2023.cnblogs.com/blog/1049983/202302/1049983-20230227144241304-516203370.png)

3.    最后一步，完善编写自动化加解密脚本，老规矩，还是mitmweb+burp的组合，浏览器先代理到burp，然后burp二级代理到mitmweb执行python脚本，然后再发送给服务器，大致思路如

![](https://img2023.cnblogs.com/blog/1049983/202302/1049983-20230227144320233-129921233.png)

其实当时以为已经完成了90%了，剩下10%是编写自动化脚本，结果这10%反而花了几天时间，因为调用js解密不成功的原因。后面解决了，大体来说和aes算法以及js，python有关系。我们可以下期具体来讲讲这块大坑！今天就先跳过这部分。

最后再上次的脚本上面，加上了注销前端解密的代码，以及mitmweb帮助解密response的代码就行了。

![](https://img2023.cnblogs.com/blog/1049983/202302/1049983-20230227143700492-387396060.jpg)

调试成功，burp已经舒舒服服，全程操作明文了。

![](https://img2023.cnblogs.com/blog/1049983/202302/1049983-20230227143701198-922955987.jpg)

顺便，恩？发现有一个验证码返回前端的高危漏洞哈哈哈。但是我心善，既然这个加解密一时半会搞不出来的，现在都周五了，就下周一再来叫开发修复漏洞吧。具体的新增代码部分我们留到下次，和aes解密这个大坑的时候一起讲。

posted @
2023-02-27 14:37
[渗透测试中心](https://www.cnblogs.com/backlion)
阅读(1362)
评论(0)

收藏
举报

刷新页面[返回顶部](#top)

[![](https://img2024.cnblogs.com/blog/35695/202508/35695-20250830121216742-1062949948.jpg)](https://developer.huawei.com/consumer/cn/activity/digixActivity/digixcmsdetail/101750143863263087?ha_source=BKYQ3&ha_sourceId=89000408)

### 公告

[![](https://img2024.cnblogs.com/blog/35695/202509/35695-20250923174722171-270282128.jpg)](https://qoder.com/)

[博客园](https://www.cnblogs.com/)
  ©  2004-2025

[![](//assets.cnblogs.com/images/ghs.png)](http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33010602011771)
[浙ICP备2021040463号-3](https://beian.miit.gov.cn)