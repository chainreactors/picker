---
title: 实战 | 记一次解析漏洞渗透经历
url: https://www.secpulse.com/archives/191026.html
source: 安全脉搏
date: 2022-11-16
fetch_date: 2025-10-03T22:51:47.890565
---

# 实战 | 记一次解析漏洞渗透经历

[![](https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo-header.png)](https://www.secpulse.com "安全脉搏")

* [首页](https://www.secpulse.com/)
* [分类阅读](https://www.secpulse.com/archives/category/category)

  #### 脉搏文库

  - [内网渗透](https://www.secpulse.com/archives/category/articles/intranet-penetration)
  - |
  - [代码审计](https://www.secpulse.com/archives/category/articles/code-audit)
  - |
  - [安全文献](https://www.secpulse.com/archives/category/articles/sec-doc)
  - |
  - [Web安全](https://www.secpulse.com/archives/category/articles/web)
  - |
  - [移动安全](https://www.secpulse.com/archives/category/articles/mobile-security)
  - |
  - [系统安全](https://www.secpulse.com/archives/category/articles/system)
  - |
  - [工控安全](https://www.secpulse.com/archives/category/articles/industrial-safety)
  - |
  - [CTF](https://www.secpulse.com/archives/category/exclusive/ctf-writeup)
  - |
  - [IOT安全](https://www.secpulse.com/archives/category/iot-security)
  - |

#### 安全建设

+ [业务安全](https://www.secpulse.com/archives/category/construction/businesssecurity)
+ |
+ [安全管理](https://www.secpulse.com/archives/category/construction/securityissue)
+ |
+ [数据分析](https://www.secpulse.com/archives/category/construction/bigdata)
+ |

#### 其他

+ [资讯](https://www.secpulse.com/archives/category/news)
+ |
+ [漏洞](https://www.secpulse.com/archives/category/vul)
+ |
+ [工具](https://www.secpulse.com/archives/category/tools)
+ |
+ [人物志](https://www.secpulse.com/archives/category/people)
+ |
+ [区块链安全](https://www.secpulse.com/archives/category/exclusive/block_chain_security)
+ |
+ [安全招聘](https://www.secpulse.com/archives/category/hiring)
+ |

- [安全问答](https://www.secpulse.com/newpage/question_list)
- [金币商城](https://www.secpulse.com/shop?donotcachepage=c010349fd98847cb9d6e07d3cbc19288)
- [安全招聘](https://www.secpulse.com/archives/category/hiring)
- [活动日程](https://www.secpulse.com/newpage/activity)
- [live课程](https://www.secpulse.com/live)
- [企业服务](https://duoyinsu.com/service.html)
- [插件社区](https://x.secpulse.com/)

小程序

![脉搏小程序](https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg)
[登录](https://www.secpulse.com/user_login)
|
[注册](https://www.secpulse.com/user-register)

# 实战 | 记一次解析漏洞渗透经历

[Web安全](https://www.secpulse.com/archives/category/articles/web)

[HACK\_Learn](https://www.secpulse.com/newpage/author?author_id=8971)
![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng0.png)

2022-11-15

15,416

## 目标

信息如下

环境:windows iis7.5 PHP/5.3.28

看到 iis7.5+php 第一时间就想到了 Fast-CGI 解析漏洞

## 解析漏洞

页面是一个登入页面,一个二级域名

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494227.png)

这里随便找一个图片链接地址然后在链接后面加上/.php 成功解析

```
/.php
```

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494228.png)

现在已经确认有解析漏洞,只需要找到上传的地方就可以了

## kindeditor

翻 js 文件的时候在里面发现了 kindeditor,也得到了路径
![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494231.png "53614-9eitnx6o3ya.png")

现在来构造一个上传的 html

```
<html>
 <head></head>
 <body>
  <form name= enctype= method= action=>
   <input = name= />
   <input = value= />
  </form>
 </body>
</html>
```

准备好一句话木马将后缀名改为.docx,然后选择上传,成功上传得到地址!
![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-16684942311.png "81828-btway758609.png")

执行命令

现在拿出我们的蚁剑,添加连接,只有 www 目录的访问权无法跨目录

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494232.png "56436-kf2ac3fdcgi.png")

接下来试试看执行命令,无法执行命令,得到系统 2008

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494233.png "46621-aciolo6pbsb.png")

看了一下 phpinfo 被 disable\_functions 了

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494234.png "11325-8kg8er0kiq6.png")

然后我去看了一下他主站是一个 asp 的站,跟这个域名同一台,然后上传了一个 asp 一句话,成功执行了命令

! 一个 iis 权限,现在也可以看整个 D 盘不再是 www 目录

也支持 aspx 试了一下跟 asp 一样权限也只能看 d 盘

## FileZilla\_server

## 翻了翻文件夹找到了个 FileZilla\_server

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494236.png)

看了下端口 14147 也开放,看了 FileZilla Server Interface.xml 文件我们可以看到它的连接地址：127.0.0.1 及端口：14147，密码这里为空。

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494239.png)

reDuh 转发 14147

reDuh 工具可以把内网服务器的端口通过 httptps 隧道转发到本机，形成一个连通回路。用于目标服务器在内网或做了端口策略的情况下连接目标服务器内部开放端口。

本机——-客户端———（http 隧道）———–服务端——————内网服务器

服务端是个 webshell（针对不同服务器有 aspx,php,jsp 三个版本），客户端是 java 写的，本机执行最好装上 JDK。

把服务端的 webshell 上传到目标服务器,然后访问,我这里是用的 aspx 的

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494240.png "02454-lulqp2h952d.png")

命令行下用客户端连接服务端

```
java -jar reDuhClient.jar http:
```

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494241.png "42560-32kdjz8ji0e.png")

使用 nc 本地连接 1010 端口

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494242.png "11339-0fsjnxr1iqnr.png")

连接成功会有欢迎提示，之后输入命令

```
[createTunnel]:.0.0.1:
```

前面的 1234 是本机连接用的端口，中间的 ip 地址是目标服务器的（可以是 webshell 所在服务器也可以是和它同内网的服务器），后面的 14147 是欲连接目标服务器的端口。
![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494243.png "15493-kknyf5o6k.png")

成功将 14147 转发出来了!

## 连接 FileZilla

打开 FileZilla,连接本地的 1234，密码为空

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494245.png "46087-0rcngvk403en.png")

成功登入

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-16684942451.png "08714-dunqv0liim.png")

添加个用户

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494246.png "83106-9ajhuxeykt.png")

权限都点满

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-16684942461.png "66176-me1j3plwivo.png")

然后使用 winscp 连接,可以读取 C 盘文件了

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494247.png "01359-0mprc1y5zfvd.png")

这里替换了粘贴键为 cmd 然后开启 3389 去，然后使用即可

**![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-191026-1668494248.png)**

作者：Jun

文章来源：blog.mo60.cn

如有侵权，请联系删除

**本文作者：[HACK\_Learn](newpage/author?author_id=8971)**

**本文为安全脉搏专栏作者发布，转载请注明：**[**https://www.secpulse.com/archives/191026.html**](https://www.secpulse.com/archives/191026.html)

Tags: [FileZilla](https://www.secpulse.com/archives/tag/filezilla)、[KindEditor](https://www.secpulse.com/archives/tag/KindEditor)、[reDuh](https://www.secpulse.com/archives/tag/reduh)、[渗透](https://www.secpulse.com/archives/tag/%E6%B8%97%E9%80%8F)、[漏洞](https://www.secpulse.com/archives/tag/%E6%BC%8F%E6%B4%9E)

点赞：
0
[评论：0](#goComment)
收藏：
0

*新浪微博
QQ空间
微信扫一扫*

### 相关文章

* [![代码审计 | 同源策略的绕过](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/09/a799223d33bd92e8b0620d8ad38ecd2.jpg)

  代码审计 | 同源策略的绕过](https://www.secpulse.com/archives/203439.html "详细阅读 代码审计 | 同源策略的绕过")
* [![云原生安全联防联抗策略玩转微隔离](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/09/1694157547520-300x155.png)

  云原生安全联防联抗策略玩转微隔离](https://www.secpulse.com/archives/203414.html "详细阅读 云原生安全联防联抗策略玩转微隔离")
* [![从2023蓝帽杯0解题heapSpary入门堆喷](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/08/1693450185258-300x157.png)

  从2023蓝帽杯0解题heapSpary…](https://www.secpulse.com/archives/203218.html "详细阅读 从2023蓝帽杯0解题heapSpary入门堆喷")

评论  (0)

昵称

必填
您当前尚未登录。
[登录？](https://www.secpulse.com/user_login "登录")
[注册](https://www.secpulse.com/user-register)

邮箱

必填（保密）

快来写下你的想法吧！

upload

|  |  |  |
| --- | --- | --- |
| [![]( https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-conten...