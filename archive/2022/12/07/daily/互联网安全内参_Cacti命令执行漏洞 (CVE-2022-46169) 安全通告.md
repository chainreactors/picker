---
title: Cacti命令执行漏洞 (CVE-2022-46169) 安全通告
url: https://mp.weixin.qq.com/s?__biz=MzI4NDY2MDMwMw==&mid=2247507000&idx=3&sn=a34992b3108b2b846bc685ecb1742aca&chksm=ebfa9b18dc8d120e9b3222c33e188c204237930dc44b065d83a7f987ed07f38a7bb91214095e&scene=58&subscene=0#rd
source: 互联网安全内参
date: 2022-12-07
fetch_date: 2025-10-04T00:41:30.741061
---

# Cacti命令执行漏洞 (CVE-2022-46169) 安全通告

![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/FzZb53e8g7s2urY8Ar1U8TXEv4XlWK8nFEeuXft3S7ibUvxBN0QI6XwkndF6kLRIvDhDwftonY1jPnf4ia5192UA/0?wx_fmt=jpeg)

# Cacti命令执行漏洞 (CVE-2022-46169) 安全通告

安全内参

编者荐语：

攻击者可通过构造恶意请求在无需登录的情况下向函数中注入命令，达到命令执行的目的。

以下文章来源于奇安信 CERT
，作者QAX CERT

![](http://wx.qlogo.cn/mmhead/Q3auHgzwzM6XPxB5kkgQy0RWNKZLKRRmvVAb4XjaNGHgJxezpMHdibg/0)

**奇安信 CERT**
.

为企业级用户提供高危漏洞、重大安全事件安全风险通告和相关产品解决方案。

Cacti项目是一个开源平台，可为用户提供强大且可扩展的操作监控和故障管理框架。

近日，奇安信CERT监测到Cacti存在命令执行漏洞(CVE-2022-46169)，攻击者可通过构造恶意请求在无需登录的情况下向函数中注入命令，达到命令执行的目的。**鉴于此漏洞影响范围较大，建议客户尽快做好自查，及时更新至最新版本。**

|  |  |  |  |
| --- | --- | --- | --- |
| **漏洞名称** | **Cacti命令执行漏洞** | | |
| **公开时间** | 2022-12-05 | **更新时间** | 2022-12-06 |
| **CVE编号** | CVE-2022-46169 | **其他编号** | QVD-2022-45075 |
| **威胁类型** | 命令执行 | **技术类型** | 命令注入  数据过滤不恰当 |
| **厂商** | Cacti | **产品** | Cacti |
| **风险等级** | | | |
| **奇安信CERT风险评级** | | **风险等级** | |
| **高危** | | **蓝色（一般事件）** | |
| **现时威胁状态** | | | |
| **POC状态** | **EXP状态** | **在野利用状态** | **技术细节状态** |
| 未发现 | 未发现 | 未发现 | **已公开** |
| **漏洞描述** | 攻击者可通过控制由get\_nfilter\_request\_var()函数检索的参数$poller\_id，来满足poller\_item =POLLER\_ACTION\_SCRIPT\_PHP条件，触发proc\_open()函数，从而导致命令执行。 | | |
| **影响版本** | Cacti == 1.2.22 | | |
| **不受影响版本** | Cacti == 1.2.23  Cacti == 1.3.0 | | |
| **其他受影响组件** | 无 | | |

威胁评估

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **漏洞名称** | **Cacti****命令执行****漏洞** | | | |
| **CVE****编号** | CVE-2022-46169 | **其他编号** | | QVD-2022-45075 |
| **CVSS 3.1****评级** | 高危 | **CVSS 3.1****分数** | | 9.8 |
| **CVSS****向量** | **访问途径（****AV****）** | | **攻击复杂度（****AC****）** | |
| 网络 | | 低 | |
| **所需权限（****PR****）** | | **用户交互（****UI****）** | |
| 不需要 | | 不需要 | |
| **影响范围（****S****）** | | **机密性影响（****C****）** | |
| 不改变 | | 高 | |
| **完整性影响（****I****）** | | **可用性影响（****A****）** | |
| 高 | | 高 | |
| **危害描述** | 未经授权的远程攻击者可构造恶意请求在目标服务器上执行任意命令。 | | | |

处置建议

**1、安全升级**

目前Cacti官方已发布安全补丁，但暂未发布版本更新，建议受影响用户关注官方更新或参考官方补丁代码进行修复：

https://github.com/Cacti/cacti/commit/7f0e16312dd5ce20f93744ef8b9c3b0f1ece2216

https://github.com/Cacti/cacti/commit/b43f13ae7f1e6bfe4e8e56a80a7cd867cf2db52b

**注意：**对于在 PHP < 7.0 下运行的 1.2.x 实例，还需要进一步更改：

https://github.com/Cacti/cacti/commit/a8d59e8fa5f0054aa9c6981b1cbe30ef0e2a0ec9

**2、缓解方案**

(1) 通过更新 lib/functions.php 中 get\_client\_addr 函数防止授权绕过，可参考官方补丁代码；

(2) 通过更改remote\_agent.php文件防止命令注入，检索$poller\_id参数时使用get\_filter\_request\_var函数代替get\_nfilter\_request\_var：

```
$poller_id = get_filter_request_var('poller_id');
```

(3) 在参数$poller\_id传入proc\_open()函数之前通过escapeshellarg()函数进行转义：

```
$cactiphp = proc_open(read_config_option('path_php_binary').'-q'.$config['base_path'].'/script_server.php realtime'.escapeshellarg($poller_id),$cactides,$pipes);
```

参考资料

[1]https://github.com/Cacti/cacti/security/advisories/GHSA-6p93-p743-35gf

**推荐阅读**

* [网安智库平台长期招聘兼职研究员](http://mp.weixin.qq.com/s?__biz=MzI4NDY2MDMwMw==&mid=2247499450&idx=2&sn=2da3ca2e0b4d4f9f56ea7f7579afc378&chksm=ebfab99adc8d308c3ba6e7a74bd41beadf39f1b0e38a39f7235db4c305c06caa49ff63a0cc1d&scene=21#wechat_redirect)
* [欢迎加入“安全内参热点讨论群”](https://mp.weixin.qq.com/s?__biz=MzI4NDY2MDMwMw==&mid=2247501251&idx=1&sn=8b6ebecbe80c1c72317948494f87b489&chksm=ebfa82e3dc8d0bf595d039e75b446e14ab96bf63cf8ffc5d553b58248dde3424fb18e6947440&token=525430415&lang=zh_CN&scene=21#wechat_redirect)

---

文章来源：奇安信 CERT

点击下方卡片关注我们，

带你一起读懂网络安全 ↓

预览时标签不可点

阅读原文

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/FzZb53e8g7u3766XzHf0XHoQ1HkzDV0M7wC5zTyTO6daqAZ6LMD0Lykps2WumsWj2KMQJAGhwOYDcb3E8AicxSw/0?wx_fmt=png)

安全内参

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/FzZb53e8g7u3766XzHf0XHoQ1HkzDV0M7wC5zTyTO6daqAZ6LMD0Lykps2WumsWj2KMQJAGhwOYDcb3E8AicxSw/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过