---
title: 针对日本网络钓鱼活动溯源分析
url: https://www.secpulse.com/archives/193932.html
source: 安全脉搏
date: 2022-12-23
fetch_date: 2025-10-04T02:18:09.073325
---

# 针对日本网络钓鱼活动溯源分析

[![](https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo-header.png)](https://www.secpulse.com "安全脉搏")

* [首页](https://www.secpulse.com/)
* [分类阅读](https://www.secpulse.com/archives/category/category)

  #### 脉搏文库

  - [内网渗透](https://www.secpulse.com/archives/category/articles/intranet-penetration)
  - |
  - [代码审计](https://www.secpulse.com/archives/category/articles/code-audit)
  - |
  - [安全文献](https://www.secpulse.com/archives/category/articles/sec-doc)
  - |
  - [Web安全](https://www.secpulse.com/archives/category/articles/web)
  - |
  - [移动安全](https://www.secpulse.com/archives/category/articles/mobile-security)
  - |
  - [系统安全](https://www.secpulse.com/archives/category/articles/system)
  - |
  - [工控安全](https://www.secpulse.com/archives/category/articles/industrial-safety)
  - |
  - [CTF](https://www.secpulse.com/archives/category/exclusive/ctf-writeup)
  - |
  - [IOT安全](https://www.secpulse.com/archives/category/iot-security)
  - |

#### 安全建设

+ [业务安全](https://www.secpulse.com/archives/category/construction/businesssecurity)
+ |
+ [安全管理](https://www.secpulse.com/archives/category/construction/securityissue)
+ |
+ [数据分析](https://www.secpulse.com/archives/category/construction/bigdata)
+ |

#### 其他

+ [资讯](https://www.secpulse.com/archives/category/news)
+ |
+ [漏洞](https://www.secpulse.com/archives/category/vul)
+ |
+ [工具](https://www.secpulse.com/archives/category/tools)
+ |
+ [人物志](https://www.secpulse.com/archives/category/people)
+ |
+ [区块链安全](https://www.secpulse.com/archives/category/exclusive/block_chain_security)
+ |
+ [安全招聘](https://www.secpulse.com/archives/category/hiring)
+ |

- [安全问答](https://www.secpulse.com/newpage/question_list)
- [金币商城](https://www.secpulse.com/shop?donotcachepage=c010349fd98847cb9d6e07d3cbc19288)
- [安全招聘](https://www.secpulse.com/archives/category/hiring)
- [活动日程](https://www.secpulse.com/newpage/activity)
- [live课程](https://www.secpulse.com/live)
- [企业服务](https://duoyinsu.com/service.html)
- [插件社区](https://x.secpulse.com/)

小程序

![脉搏小程序](https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg)
[登录](https://www.secpulse.com/user_login)
|
[注册](https://www.secpulse.com/user-register)

# 针对日本网络钓鱼活动溯源分析

[Web安全](https://www.secpulse.com/archives/category/articles/web)

[ChaMd5安全团队](https://www.secpulse.com/newpage/author?author_id=3747)
![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng0.png)

2022-12-22

22,553

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-193932-1671691150.png)

# 原文信息提取:

## 攻击方式:

攻击者冒充日本国家税务局针对日本用户分发钓鱼短信,包含诱导欺骗的文字以及指向恶意网站的短链接,后续会根据不同的设备类型去重定向到不同的钓鱼页面

* iphone:重定向到克隆日本国家税务局的网站,通过伪造的弹窗提示,诱导用户填写个人身份信息和V-Preca卡详细信息
* Android:重定向到虚假的"AU"(日本移动运营商)网站,诱导用户下载安装恶意apk从而达到进一步窃取信息的目的

差异在于Android比较容易从网页下载安装恶意程序,而iphone上如果直接使用网页安装软件比较麻烦且需要获得签名,成本更高,所以直接伪造钓鱼网站窃取个人信息

## IOC:

```
手机号:09061661959
短链接:https://cutt.ly/YXZfAMP
apk:8b6c4fea9e4a6d8761c1c53525a91374
代理服务器:220105.top
C&C:192.186.11.120:6666
钓鱼网站:ntagoi-jp.qgvvtoq.cn
```

同时文章中也披露了很多针对东京国税局官网域名https://www.nta.go.jp的钓鱼网站,URL均以"ntagoi-jp"为子域名,通用格式为:"ntagoi-jp.[a-zA-Z0-9]{5,7}.cn"

# 威胁检测情报(IP和域名扩线):

## 从已知攻击行动中提取信息:

从已知IOC入手进一步挖掘/复现攻击链,以提取更多钓鱼网站相关信息

### 短链接(cutt.ly/YXZfAMP):

该短链接由cuttly生成,使用短链接的优势在于攻击者可以隐藏真实域名并且短链接的URL可以随时更改以规避静态检测,同时短链接后台可以统计链接的点击量,方便查看钓鱼效果,以短链接为出发点,尝试还原一下攻击者整条攻击链![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-193932-1671691152.png)首先需要确定的是短链接解析重定向到的真实域名地址,可以直接在浏览器中查看网络日志,或者可以直接通过攻击者生成短链接的平台cuttly的官方网站去解析![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-193932-1671691153.png)

### 重定向的域名:

#### (myffdvfuom.duckdns.org)

查看重定向到的第一个域名页面的代码,直接在前端使用Javascript再次进行重定向跳转到另一个页面![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-193932-16716911531.png)

#### (ufjxfdxtbv.duckdns.org)

跳转到的这个新页面主要是对不同的手机设备类型做一个判断,根据http请求"UserAgent"中包含的"iPhone"或者是"Android"字段去进行匹配并分别跳转到不同的钓鱼页面,iphone设备将会跳转到一个新的域名,而安卓设备则直接跳转到当前域名的"78.html"页面 如果是使用电脑浏览器访问则因为无法在"UserAgent"中匹配到指定的字符串而无法继续重定向跳转,所以显示为空白页面,因为攻击者目标仅为Android和iPhone设备,所以仅有这2种设备类型会继续按照既定的流程访问攻击者设置的钓鱼页面,Windows平台访问页面被非主观的规避了

```
<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
</head>
<body>

    <script>
        if(navigator.userAgent.match(/(iPhone)/i)){
    document.location.href = "http://pkpmwlyrvz.duckdns.org";
        } else if (navigator.userAgent.match(/(Android)/i)) {

            document.location.href = "78.html";
        }
    </script>
</body>
</html>
```

后续的钓鱼网站跳转都由这个"分设备重定向页面"控制,猜测攻击者可能需要定期对该页面进行代码更新维护从而变换重定向到的钓鱼页面链接,到目前为止,攻击者总共使用了三种类型的域名,"跳转重定向域名","iPhone钓鱼域名"和"Android钓鱼域名",据此根据具体域名和ip的关系及进一步情报挖掘和分析

| 类型 | 域名 | IP |
| --- | --- | --- |
| 重定向页面 | myffdvfuom.duckdns.org | 103.80.134.89 |
| 分设备重定向页面/Android钓鱼页面 | ufjxfdxtbv.duckdns.org | 103.80.134.91 |
| iphone钓鱼页面 | pkpmwlyrvz.duckdns.org | 185.212.68.4 |

### python提取攻击链中所有重定向域名:

目前来看,攻击者在此条攻击链中暴露的域名资产以及具体流程大致为:![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-193932-1671691156.jpeg)一般来说为了规避检测和黑名单,此类钓鱼域名数量大且存活时间不长,会经常更换域名,并且通过搜索域名解析到的IP发现大量类似攻击活动 以做威胁情报的目的来说,应该通过Python等自动化工具,编写出可以自动获取其重定向域名并储存的流程,方便后续提取关联相同类型的攻击活动,直接一步到位将重定向域名以及后续钓鱼域名全部保存下来

#### 脚本逻辑:

1. 按行读取指定文件中的url
2. 发送请求并判断是否成功访问页面

1. 直接重定向页面,提取10行的重定向链接并再次请求网页,重复上面的操作
2. 分设备重定向页面,提取11行和14行的iphone钓鱼域名&Android钓鱼域名
3. 不是已知的特定格式页面,将网页代码保存下来进行人工分析
4. (根据攻击者改动而增加的功能)安卓重定向跳转的页面还会再有一次重定向跳转,将其域名也记录下来
5. 是,分别去判断属于 **直接重定向页面**(第10行是否包含重定向)/**分设备重定向页面**(第11行和14行是否包含重定向)
6. 否,属于无法访问页面的情况,将无法访问的域名保存下来

#### python代码:

```
import re
import pandas as pd
import time
import threading
import requests

# 请求网站判断是否访问成功
def access_request(urls):
    headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:23.0) Gecko/20100101 Firefox/23.0'}
    try:
        req = requests.get(url=urls, headers=headers)
        print(req.url+"访问成功 "+str(req.status_code))
        return req
    except Exception as e:
        print(e)
        print(str(urls)+"无法访问")
        return False;

# 正则匹配重定向的URL字符串
def match_href(line):
    matchObj = re.findall(r'(?<=document.location.href = ").*?(?=")', line,re.S)
    return matchObj

# 将数据按照指定格式保存到execl
def write2Execl(path, redirectiondomain, selectdomain, iphonedomain, androiddomain,androidre_Url):
    original_data = pd.read_excel(path)
    data1 = {"直接重定向域名": [redirectiondomain],"重定向到的域名":[selectdomain],"iphone钓鱼域名":[iphonedomain],"Android钓鱼域名":[androiddomain],"Android重定向域名":[androidre_Url]}
    data1 = pd.DataFrame(data1)
    # 将新数据与旧数据合并起来
    save_data = original_data.append(data1,ignore_index=True)
    save_data.to_excel(path, index=False)

# 判断是不是直接重定向的页面
def redirection_Page(html1, url):
    # 判断第10行是否包含重定向语句
    try:
        url1 = match_href(html1[10])
    # 如果没有第十行则异常,说明不是特定页面
    except:
        return False
    if url1:
        print("特定直接重定向的页面")
        redirectionurl = str(url)
        print("重定向域名:" + str(url1[0]))
        selectdomain = url1[0]
        return url1[0], redirectionurl, selectdomain
    return False

# 判断是不是分设备重定向的页面
def select_Page(html2, url):
    # 判断指定的行是否包含重定向语句
    try:
        iphoneurls = match_href(html2[11])
        Androidurls = match_href(html2[14])
    except:
        return False
    if Androidurls:
        print("特定分设备重定向的页面")
        print("iphone钓鱼域名:" + str(iphoneurls[0]))
        print("Android钓鱼域名:" + str(url) +str(Androidurls[0]))
        iphoneurl = iphoneurls[0]
        androidurl = str(url) + str(Androidurls[0])
        return iphoneurl, androidurl
    return False

# 线程
def scan(url):
    print("----------")
    redirection_Url = select_Url = iphone_Url = android_Url = androidre_Url ="X"
    # 发送请求
    reqObject = access_request(url)
    # 进入循环判断
    if not reqObject:
        redirection_Url = url
    while reqObject:
        repage = ""
        sepage = ""
        list_html = reqObject.text.split('n')
        redomain = reqObject.url
        sepage = select_Page(list_html, redomain)
        repage = redirec...