---
title: 快被加密流量检测整死了……
url: https://mp.weixin.qq.com/s?__biz=MzI5NjA0NjI5MQ==&mid=2650182808&idx=1&sn=6a0ca0adbc29200db4fc411cac68040d&chksm=f4486f24c33fe63205a737c4f33294d47e7ba4fe6d63224c8a66eb60ecd21b872d2aa356900c&scene=58&subscene=0#rd
source: 微步在线
date: 2024-12-24
fetch_date: 2025-10-06T19:40:34.993133
---

# 快被加密流量检测整死了……

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/Yv6ic9zgr5hTrpUu0qgibLyic1reMzoGKQoiax421n61ujTcb4mS5QeEvc1fz07eJzcFYxkWmW2ibgkuqzzYJvqKzgQ/0?wx_fmt=jpeg)

# 快被加密流量检测整死了……

原创

ThreatBook

微步在线

又被黑了！就因为业务区加密流量没解密，检测设备没反应。老王被领导劈头盖脸的骂，还要求追溯全过程。他突然想起防火墙是自带解密功能的，结果一测性能掉得跟自由落体似的，业务卡顿，客户投诉，老王焦头烂额。听说市面上还有很多加密流量检测方案，老王决定寻摸一下。

**第1位**

**不解密检测误报太多了**

老王一开始就准备选择不解密的方法检测加密流量，该技术主要通过对会话特征、时空特征等进行分析，不对核心加密内容进行深度拆包，因此非常节省性能。

![](https://mmbiz.qpic.cn/mmbiz_jpg/Yv6ic9zgr5hS18GlVPdlR0ah9ib1MIJYIxNbupI0dQkRR53Fh46tfvzOFAiavC9kqNw0fLrs1bcB1ue3fgosu6gzg/640?wx_fmt=jpeg&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/Yv6ic9zgr5hS18GlVPdlR0ah9ib1MIJYIxdzK1vRdeMUU6TfNX3teiaMaIVRcngFKA8xnFDhOyyDCQXtpxMNAiam9w/640?wx_fmt=jpeg&from=appmsg)

但在测过之后……

![](https://mmbiz.qpic.cn/mmbiz_jpg/Yv6ic9zgr5hS18GlVPdlR0ah9ib1MIJYIxOzowSnOGiaricBibco3C9ZbEJMUrTtDU0DnW8IaSViaJwNQ2CiaQMxu6tsQ/640?wx_fmt=jpeg&from=appmsg)

老王发现，在实际环境中误报率达到10%以上，而且也不能很好的解释为什么产生告警。

**第2位**

**旁路解密不支持TLS1.3**

这样不行，不解密实在不靠谱。突然，老王看到有NDR宣称可以旁路解密。

![](https://mmbiz.qpic.cn/mmbiz_png/Yv6ic9zgr5hS18GlVPdlR0ah9ib1MIJYIx6KgqufsaRyazxN7bomx8Fib3j9fusu0GKM6aPnXKcTRy1JLjq8RvRCg/640?wx_fmt=png&from=appmsg)

乍一看，这很强啊，可以抓取秘钥，还不用串进去，不会影响整个网络。

但实际上，如果是椭圆曲线秘钥交换算法ECDHE，秘钥是本地随机生成的，并不在流量中传输，NDR就抓不到了，自然就无法解密。现在主流的TLS1.3基本都是用的ECDHE，防的就是旁路流量监听。

![](https://mmbiz.qpic.cn/mmbiz_jpg/Yv6ic9zgr5hS18GlVPdlR0ah9ib1MIJYIxfFGe4S8s1bRYKZNTcDWW6asPXGEFlhTTqvE39hDVq5umrgicAkwBJgg/640?wx_fmt=jpeg&from=appmsg)

**第3位**

**SSLO太贵了**

####

####

#### 既然不解密误报太高，旁路又解不了，这不老王开始研究SSLO了。

#### SSLO不做检测、不做拦截，专门做解密，而且是SSL/TLS统一卸载，再通过流量编排技术将明文流量分配给不同的检测设备。

![](https://mmbiz.qpic.cn/mmbiz_jpg/Yv6ic9zgr5hS18GlVPdlR0ah9ib1MIJYIxnMd3kKhcicbRwOfxR2DG6RqICxwmJqwRLmtBJvawbE1z2uHaOicMliaicg/640?wx_fmt=jpeg&from=appmsg)

说实话，老王有点心动。但现实很快给他浇了一盆冷水，这东西太贵了。

如果每一个网络出口都部署一套SSLO，这得买多少台？而且解密编排性能消耗较大，必须要把硬件性能堆上去，这些都是钱。

老王看了看手里的预算，想想还是算了。

**第4位**

**旁路解密支持TLS1.3**

“老板，我家也能旁路解密，TLS1.3也能解，只需要在主机上部署轻量化Agent……”

![](https://mmbiz.qpic.cn/mmbiz_jpg/Yv6ic9zgr5hS18GlVPdlR0ah9ib1MIJYIxS8gdOyBIibiacnGMxibd3lk6yUc9tJwF5r866ZxzRUZv76KUlM6uOdZ5Q/640?wx_fmt=jpeg&from=appmsg)

老王心想：“这谁家NDR这么会玩？Agent可以抓取服务端随机生成的秘钥并传送给NDR，这样就能解密了，不受TLS1.2还是TLS1.3的影响。让我测一测。“

![](https://mmbiz.qpic.cn/mmbiz_png/Yv6ic9zgr5hS18GlVPdlR0ah9ib1MIJYIxHaWyWAjUmB3D63Ck0yNSqLWLgvuqhMznR0gwGCQWiceVCUXZ2IDqC2Q/640?wx_fmt=png&from=appmsg)

哦，原来是微步威胁感知平台TDP啊！解密覆盖全、性能开销小、误报率低，以后搞加密流量检测，就靠TDP了。

![](https://mmbiz.qpic.cn/mmbiz_gif/Yv6ic9zgr5hS18GlVPdlR0ah9ib1MIJYIxOSibk3qibib9HJcxxlOyL0TdByHmyWfTEoicwKKVoAAqJfvV8mM7oo2b0Q/640?wx_fmt=gif&from=appmsg)

· END ·

![](https://mmbiz.qpic.cn/mmbiz_png/Yv6ic9zgr5hSA5A4iaspRVClFku4KVwkOUriclTaohLibE2oQKMTrQ8hvSFFHevq88eibd7mstuZbeNLm5U1tPJT3xQ/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

预览时标签不可点

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/Yv6ic9zgr5hTHHXF0GLtxEgadu9UKHf9JTdE1CrfxkZCYbPIbkQu1Xz1ia8YKicACMrHQkq7rTll3LKJGRhyibGpcA/0?wx_fmt=png)

微步在线

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/Yv6ic9zgr5hTHHXF0GLtxEgadu9UKHf9JTdE1CrfxkZCYbPIbkQu1Xz1ia8YKicACMrHQkq7rTll3LKJGRhyibGpcA/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过