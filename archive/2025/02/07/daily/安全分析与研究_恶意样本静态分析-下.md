---
title: 恶意样本静态分析-下
url: https://mp.weixin.qq.com/s?__biz=MzA4ODEyODA3MQ==&mid=2247490352&idx=1&sn=7a485e1264bc2f1a221a0822e46ac1c3&chksm=902fb418a7583d0e021ea3afdf35da7f40f854e0da47ef6a24f9439945d149739776e4429fc3&scene=58&subscene=0#rd
source: 安全分析与研究
date: 2025-02-07
fetch_date: 2025-10-06T20:37:11.917940
---

# 恶意样本静态分析-下

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/oibWJqH5OVmXR4Bp8L9hSJXr8XT0Me3yqJoQicXqSGESPKpl3Lmcria5xRhTiaufx8dNPNeYZicicU3SGgyqAczyhAGg/0?wx_fmt=jpeg)

# 恶意样本静态分析-下

原创

pandazhengzheng

安全分析与研究

前言

介绍使用IDA对样本进行简单的静态分析必知必会的一些知识点。
恶意软件分析基础教程
1.汇编语言基础知识必备
2.恶意样本分析环境搭建
3.恶意样本静态分析-上
4.恶意样本静态分析-下
5.恶意样本动态分析-上
6.恶意样本动态分析-下
7.恶意样本反调试反分析
学完上面的这些基础课程差不多可以入门恶意样本分析了，有不懂的地方再找我交流。

**安全分析与研究**

专注于全球恶意软件的分析与研究

上一节课，我讲了一些基础的静态分析方法，主要是分析文件的结构和一些基本信息，这一节课开始学习如何使用IDA对文件进行静态分析

在学习使用IDA分析样本之前，我们再复习一下汇编的一些概念和基础知识

熟悉汇编语言对恶意样本分析是非常重要的，不管是静态分析，还是后面的动态调试，都需要了解汇编语言

现在平台越来越多，汇编语言一般分析X86、X64、ARM、MIPS、PowerPC等，我们如果是做Window/Linux两个平台上的样本分析，只需要熟悉X86、X64汇编即可，其他汇编主要用于移动平台或IOT平台等

根据位数的不同，我们来介绍一个32位的寄存器对应的结构，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmXR4Bp8L9hSJXr8XT0Me3yqyfmhP8RUTdVBCxtjVjiboGBgW5VRDqnspWWo0CicZAlCxYaS8cWEQ0Iw/640?wx_fmt=png)

EAX、AX、AH、AL

AX是EAX的低16位

AH是AX的高8位

AL是AX的低8位

二进制文件栈结构，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmXR4Bp8L9hSJXr8XT0Me3yq9NT0f3a4vHT9NfDyFMouVGJzmOw48BLD3kulsapsjnLSXOZicwTyicicg/640?wx_fmt=png)

分析样本的时候，一般会遇到的汇编的基础指令，如下：

mov dword ptr ds:[0x7CB2E0],eax

mov esp,dword ptr ss:[ebp-0x18]

mov ecx,dword ptr ds:[eax]

test byte ptr ss:[ebp-0x3c],bl

and dword ptr ss:[ebp-0x4],0x0

lea eax,[ebp+0x1ch]

mov eax,0xFF

call 0x00401D91

jmp 0x00401650

cmp esi,ebx

jnz 0x00401650

je 0x00401478

add esp,0x14

sub esi,0x4

push ebx

xor eax,eax

inc eax

retn

如果你对上面的一些指令的含义还不熟悉的可以去复习之前的课程，里面都有讲解过的

预览时标签不可点

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmVcFgYKtoVnKR7h3pkl3AyxwS0l7iagicAJnYjEQhwIuZgR3RR65DLpJh2TGZS82DY7CjsBUmiaAl7BQ/0?wx_fmt=png)

安全分析与研究

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmVcFgYKtoVnKR7h3pkl3AyxwS0l7iagicAJnYjEQhwIuZgR3RR65DLpJh2TGZS82DY7CjsBUmiaAl7BQ/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过