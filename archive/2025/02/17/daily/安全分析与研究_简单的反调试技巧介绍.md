---
title: 简单的反调试技巧介绍
url: https://mp.weixin.qq.com/s?__biz=MzA4ODEyODA3MQ==&mid=2247490541&idx=1&sn=c69072f45da7f28ba4f9d3b1d36842f0&chksm=902fb4c5a7583dd31ea009e16ee6710d06ecf16bfb37fcdcf43a474442179e1d7f615a89a8c1&scene=58&subscene=0#rd
source: 安全分析与研究
date: 2025-02-17
fetch_date: 2025-10-06T20:34:25.108745
---

# 简单的反调试技巧介绍

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/oibWJqH5OVmXJVicq5cxzeou29uVBHz19Hk4l5QrzZBjCjPlS3aqkeib50vfMajb6ozDsFMicibnrlFpia1oiaPNp3QkQ/0?wx_fmt=jpeg)

# 简单的反调试技巧介绍

原创

pandazhengzheng

安全分析与研究

前言

关于反调试与反反调试的一些技术，很多人喜欢面试的时候拿来问别人，在文章最后笔者分享了自己总结的几十种不同的反调试反虚拟机的方法，可以对照去学习。
恶意软件分析基础教程
1.汇编语言基础知识必备
2.恶意样本分析环境搭建
3.恶意样本静态分析-上
4.恶意样本静态分析-下
5.恶意样本动态分析-上
6.恶意样本动态分析-下
7.恶意样本反调试反分析
学完上面的这些基础课程差不多可以入门恶意样本分析了，有不懂的地方再找我交流。

**安全分析与研究**

专注于全球恶意软件的分析与研究

关于反调试与反反调试的一些技术，很多人喜欢面试的时候拿来问别人，我这里给大家总结一下，供大家参考学习，多调试多实战分析一些样本就慢慢理解了。

PEB

PEB包含了进程调试相关信息，通过PEB结构体中的标志位，实现反调试，PEB结构中有两个标志位：BeingDebugged和NtGlobalFlag，反调试代码，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmXJVicq5cxzeou29uVBHz19HEJ7dXb4QYg1QUjwCb9cYommdgQPIXfdu5ibTRPUZ9c0kn2Lcvfmxriag/640?wx_fmt=png)

如果进程被调试，则BeingDebugged值为0x1，NtGlobalFlag值为0x70，如果进程没有被调试，则这两个值为0x0

如何获取PEB结构信息，可以通过windbg，打开windbg调试程序，然后使用命令!peb，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmXJVicq5cxzeou29uVBHz19Huw4tSbqU2o3ExTDjxgpBKrbL6wZyNeqXSMamsAFYrPGJibZQwhiax49w/640?wx_fmt=png)

使用命令：dt nt!\_PEB 000000c63a87c000（PEB地址），就可以得到PEB结构，如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmXJVicq5cxzeou29uVBHz19HZLIWzGnsqgppC1jQXZaickmwicn6Kibjg1CvNPIKy2zR4HFbyde0eGUjw/640?wx_fmt=png)

可以看到被调试的这个进程的PEB中BeingDebugged的值为0x1，NtGlobalFlag的值为0x70

预览时标签不可点

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmVcFgYKtoVnKR7h3pkl3AyxwS0l7iagicAJnYjEQhwIuZgR3RR65DLpJh2TGZS82DY7CjsBUmiaAl7BQ/0?wx_fmt=png)

安全分析与研究

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/oibWJqH5OVmVcFgYKtoVnKR7h3pkl3AyxwS0l7iagicAJnYjEQhwIuZgR3RR65DLpJh2TGZS82DY7CjsBUmiaAl7BQ/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过