---
title: Bropper - An Automatic Blind ROP Exploitation Tool
url: https://buaq.net/go-170960.html
source: unSafe.sh - 不安全
date: 2023-07-02
fetch_date: 2025-10-04T11:51:06.212618
---

# Bropper - An Automatic Blind ROP Exploitation Tool

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/fc1d30053515e4e9eddfbbec634ad791.jpg)

Bropper - An Automatic Blind ROP Exploitation Tool

Abstract BROP (Blind ROP) was a technique found by Andrew Bittau from Stanford in 2014.
*2023-7-1 20:30:0
Author: [www.kitploit.com(查看原文)](/jump-170960.htm)
阅读量:35
收藏*

---

[![](https://blogger.googleusercontent.com/img/a/AVvXsEg_saxiPkPZF-vm4ozEqDtqpqw6W4OWCpLsk8bJ7s3dYm_FFSf-YnmuXm1yy9KDT1sjLWyNrHT0wky7KZj0ZcYwaw1zwm8Cub7USf8qx3KadjFvgfKwuMu7GPTX5pN9PLdtQGhIl4DqieSwtloATOnmDyYoJKpayW1kWD0ISjbMVf9DE0QJKb612p-qyQ=w640-h336)](https://blogger.googleusercontent.com/img/a/AVvXsEg_saxiPkPZF-vm4ozEqDtqpqw6W4OWCpLsk8bJ7s3dYm_FFSf-YnmuXm1yy9KDT1sjLWyNrHT0wky7KZj0ZcYwaw1zwm8Cub7USf8qx3KadjFvgfKwuMu7GPTX5pN9PLdtQGhIl4DqieSwtloATOnmDyYoJKpayW1kWD0ISjbMVf9DE0QJKb612p-qyQ)

## Abstract

BROP (Blind ROP) was a technique found by Andrew Bittau from Stanford in 2014.

* [Original paper](https://www.scs.stanford.edu/brop/bittau-brop.pdf "Original paper")
* [Slides](https://www.scs.stanford.edu/brop/bittau-brop-slides.pdf "Slides")

Most servers like nginx, Apache, MySQL, forks then communicates with the client. This means canary and addresses stay the same even if there is ASLR and PIE. So we can use some educated [brute force](https://www.kitploit.com/search/label/Brute%20Force "brute force") to leak information and subsequently craft a working exploit.

## Flow of exploitation

1. Find [buffer overflow](https://www.kitploit.com/search/label/Buffer%20Overflow "buffer overflow") offset
2. Find canary
3. Find saved registers (RBP / RIP)
4. Find stop gadgets
5. Find brop gadgets
6. Find a Write function (write / dprintf / puts / ...)
7. Leak the binary

## Examples of Results

There is 3 customs vulnerable examples provided in this repository. You can run it directly or build the Dockerfile

[![](https://blogger.googleusercontent.com/img/a/AVvXsEg_saxiPkPZF-vm4ozEqDtqpqw6W4OWCpLsk8bJ7s3dYm_FFSf-YnmuXm1yy9KDT1sjLWyNrHT0wky7KZj0ZcYwaw1zwm8Cub7USf8qx3KadjFvgfKwuMu7GPTX5pN9PLdtQGhIl4DqieSwtloATOnmDyYoJKpayW1kWD0ISjbMVf9DE0QJKb612p-qyQ=w640-h336)](https://blogger.googleusercontent.com/img/a/AVvXsEg_saxiPkPZF-vm4ozEqDtqpqw6W4OWCpLsk8bJ7s3dYm_FFSf-YnmuXm1yy9KDT1sjLWyNrHT0wky7KZj0ZcYwaw1zwm8Cub7USf8qx3KadjFvgfKwuMu7GPTX5pN9PLdtQGhIl4DqieSwtloATOnmDyYoJKpayW1kWD0ISjbMVf9DE0QJKb612p-qyQ)

BROPPER will then dump the binary :

[![](https://blogger.googleusercontent.com/img/a/AVvXsEjBpjRg6A3R0k7-zcQAnL0oRD294yclo6ScoH_LVpyis52gLPMDoCx3VsIOB9HPesYGbrkUtztbOLtErynobpZkHwot2ybDCSPodGONmXOL8Cy7dJxqxMTFFj5sWpryrF2-BIeuGD02HXxjeDUxqnJstmzDK_8_R4Y-phsr7rE6V0udXEa26iiW3Dw8IQ=w640-h336)](https://blogger.googleusercontent.com/img/a/AVvXsEjBpjRg6A3R0k7-zcQAnL0oRD294yclo6ScoH_LVpyis52gLPMDoCx3VsIOB9HPesYGbrkUtztbOLtErynobpZkHwot2ybDCSPodGONmXOL8Cy7dJxqxMTFFj5sWpryrF2-BIeuGD02HXxjeDUxqnJstmzDK_8_R4Y-phsr7rE6V0udXEa26iiW3Dw8IQ)

It's then possible to extract all ROP gadgets from the dumped binary using ROPgadget for example :

```
$ ROPgadget --binary dump
```

## Script usage

To use this script:

```
python3 -m pip install -r requirements.txt
python3 bropper.py -t 127.0.0.1 -p 1337 --wait "Password :" --expected Bad --expected-stop Welcome -o dump
```

```
$ python3 bropper.py -h
usage: bropper.py [-h] -t TARGET -p PORT --expected-stop EXPECTED_STOP --expected EXPECTED --wait WAIT -o OUTPUT [--offset OFFSET] [--canary CANARY] [--no-canary] [--rbp RBP] [--rip RIP] [--stop STOP]
                  [--brop BROP] [--plt PLT] [--strcmp STRCMP] [--elf ELF]

Description message

options:
  -h, --help            show this help message and exit
  -t TARGET, --target TARGET
                        target url
  -p PORT, --port PORT  target port
  --expected-stop EXPECTED_STOP
                        Expected response for the stop gadget
  --expected EXPECTED   Expected normal response
  --wait WAIT           String to wait before sending payload
  -o OUTPUT, --output OUTPUT
                        File to write dumped remote binary
  --offset OFFSET       set a offset value
  --canary CANARY       set a canary valu   e
  --no-canary           Use this argument if there is no stack canary protection
  --rbp RBP             set rbp address
  --rip RIP             set rip address
  --stop STOP           set stop gadget address
  --brop BROP           set brop gadget address
  --plt PLT             set plt address
  --strcmp STRCMP       set strcmp entry value
  --elf ELF             set elf address
```

## Contributing

Pull requests are welcome. Feel free to open an issue if you want to add other features.

Bropper - An Automatic Blind ROP Exploitation Tool
![Bropper - An Automatic Blind ROP Exploitation Tool](https://blogger.googleusercontent.com/img/a/AVvXsEg_saxiPkPZF-vm4ozEqDtqpqw6W4OWCpLsk8bJ7s3dYm_FFSf-YnmuXm1yy9KDT1sjLWyNrHT0wky7KZj0ZcYwaw1zwm8Cub7USf8qx3KadjFvgfKwuMu7GPTX5pN9PLdtQGhIl4DqieSwtloATOnmDyYoJKpayW1kWD0ISjbMVf9DE0QJKb612p-qyQ=s72-w640-c-h336)
Reviewed by Zion3R
on
8:30 AM
Rating: 5

文章来源: http://www.kitploit.com/2023/07/bropper-automatic-blind-rop.html
 如有侵权请联系:admin#unsafe.sh

© [unSafe.sh - 不安全](https://unsafe.sh) Powered By [PaperCache](https://github.com/code-scan/PaperCache)

* admin#unsafe.sh
* [安全马克](https://aq.mk)
* [星际黑客](https://xj.hk)
* [T00ls](https://t00ls.net)