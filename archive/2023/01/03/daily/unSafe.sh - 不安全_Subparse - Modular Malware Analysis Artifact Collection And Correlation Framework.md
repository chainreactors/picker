---
title: Subparse - Modular Malware Analysis Artifact Collection And Correlation Framework
url: https://buaq.net/go-143779.html
source: unSafe.sh - 不安全
date: 2023-01-03
fetch_date: 2025-10-04T02:54:34.553173
---

# Subparse - Modular Malware Analysis Artifact Collection And Correlation Framework

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/47c86208ea56e33abc51e1a949b3a41f.jpg)

Subparse - Modular Malware Analysis Artifact Collection And Correlation Framework

Subparse, is a modular framework developed by Josh Strochein, Aaron Baker, and Odin Bernstein.
*2023-1-2 19:30:0
Author: [www.kitploit.com(查看原文)](/jump-143779.htm)
阅读量:41
收藏*

---

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiKgHd3mLpI5SVd34YjUJqaXNXH084xRkLeELzfsmQoQSrXORyku_0OFhPMEPaFNjId_UZFWv2ftQdnGTeQCiOwQzwBzmmmFdpL_zfW0kCKix9TFClkDdDd3R8Yeqdpa_Po7uUu6v6BWX4O5aXlNe01IXUNvlxh-vwueGr56wPwic_wpeiOqfbak40XVg/w640-h334/malware.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiKgHd3mLpI5SVd34YjUJqaXNXH084xRkLeELzfsmQoQSrXORyku_0OFhPMEPaFNjId_UZFWv2ftQdnGTeQCiOwQzwBzmmmFdpL_zfW0kCKix9TFClkDdDd3R8Yeqdpa_Po7uUu6v6BWX4O5aXlNe01IXUNvlxh-vwueGr56wPwic_wpeiOqfbak40XVg/s830/malware.png)

Subparse, is a modular framework developed by Josh Strochein, Aaron Baker, and Odin Bernstein. The framework is designed to parse and index malware files and present the information found during the parsing in a searchable web-viewer. The framework is modular, making use of a core parsing engine, parsing modules, and a variety of enrichers that add additional information to the malware indices. The main input values for the framework are directories of malware files, which the core parsing engine or a user-specified parsing engine parses before adding additional information from any user-specified enrichment engine all before indexing the information parsed into an elasticsearch index. The information gathered can then be searched and viewed via a web-viewer, which also allows for filtering on any value gathered from any file. There are currently 3 parsing engine, the default parsing modules (ELFParser, OLEParser and PEParser), and 4 enrichment modules (ABUSEEnricher, C APEEnricher, STRINGEnricher and YARAEnricher).

## Software Requirements

To get started using Subparse there are a few requrired/recommened programs that need to be installed and setup before trying to work with our software.

| Software | Status | Link |
| --- | --- | --- |
| Docker | Required | [Installation Guide](https://docs.docker.com/get-docker/ "Installation Guide") |
| Python3.8.1 | Required | [Installation Guide](https://www.python.org/downloads/release/python-381/ "Installation Guide") |
| Pyenv | Recommended | [Installation Guide](https://github.com/pyenv/pyenv "Installation Guide") |

## Additional Requirements

After getting the required/recommended software installed to your system there are a few other steps that need to be taken to get Subparse installed.

**Python Requirements**

```
sudo get apt install build-essential
pip3 install -r ./requirements.txt
```

**Docker Requirements**
 Since Subparse uses Docker for its backend and web interface, the set up of the Docker [containers](https://www.kitploit.com/search/label/Containers "containers") needs to be completed before being able to use the program. To do this navigate to the root directory of the Subparse installation location, and use the following command to set up the docker instances:

```
docker-compose up
```

Note: This might take a little time due to downloading the images and setting up the containers that will be needed by Subparse.

## Installation steps

* [Installation Steps](https://github.com/jstrosch/subparse/blob/main/INSTALL.md "Installation Steps")

## Command Line Options

Command line options that are available for *subparse/parser/subparse.py*:

| Argument | Alternative | Required | Description |
| --- | --- | --- | --- |
| -h | --help | No | Shows help menu |
| -d SAMPLES\_DIR | --directory SAMPLES\_DIR | Yes | Directory of samples to parse |
| -e ENRICHER\_MODULES | --enrichers ENRICHER\_MODULES | No | Enricher modules to use for additional parsing |
| -r | --reset | No | Reset/delete all data in the configured [Elasticsearch](https://www.kitploit.com/search/label/Elasticsearch "Elasticsearch") cluster |
| -v | --verbose | No | Display verbose [commandline](https://www.kitploit.com/search/label/Commandline "commandline") output |
| -s | --service-mode | No | Enters service mode allowing for mode samples to be added to the SAMPLES\_DIR while processing |

## Viewing Results

To view the results from Subparse's parsers, navigate to localhost:8080. If you are having trouble viewing the site, make sure that you have the container started up in Docker and that there is not another process running on port 8080 that could cause the site to not be available.

Before any parser is executed general information is collected about the sample regardless of the underlying file type. This information includes:

* MD5 hash of the sample
* SHA256 hash of the sample
* Sample name
* Sample size
* Extension of sample
* Derived extension of sample

Parsers are ONLY executed on samples that match the file type. For example, PE files will by default have the PEParser executed against them due to the file type corresponding with those the PEParser is able to examine.

## Default Modules

**ELFParser**
 This is the default parsing module that will be executed against ELF files. Information that is collected:

* General Information
* Program Headers
* Section Headers
* Notes
* Architecture Specific Data
* Version Information
* Arm Unwind Information
* Relocation Data
* Dynamic Tags

**OLEParser**
 This is the default parsing module that will be executed against OLE and RTF formatted files, this uses the OLETools package to obtain data. The information that is collected:

* Meta Data
* MRaptor
* RTF
* Times
* Indicators
* VBA / VBA Macros
* OLE Objects

**PEParser**
 This is the default parsing module that will be executed against PE files that match or include the file types: PE32 and MS-Dos. Information that is collected:

* Section code and count
* Entry point
* Image base
* Signature
* Imports
* Exports

These modules are optional modules that will ONLY get executed if specified via the -e | --enrichers flag on the command line.

## Default Modules

**ABUSEEnricher**
 This enrichers uses the [Abuse.ch]([https://abuse.ch/](https://abuse.ch/ "https://abuse.ch/")) API and [Malware Bazaar]([https://bazaar.abuse.ch](https://bazaar.abuse.ch "https://bazaar.abuse.ch")) to collect more information about the sample(s) subparse is analyzing, the information is then aggregated and stored in the Elastic database.
**CAPEEnricher**
 This enrichers is used to communicate with a CAPEv2 Sandbox instance, to collect more information about the sample(s) through dynamic analysis, the information is then aggregated and stored in the Elastic database utilizing the Kafka Messaging Service for background processing.
**STRINGEnricher**
 This enricher is a smart string enricher, that will parse the sample for potentially interesting strings. The categories of strings that this enricher looks for include: Audio, Images, Executable Files, Code Calls, Compressed Files, Work (Office Docs.), IP Addresses, IP Address + Port, Website URLs, [Command Line](https://www.kitploit.com/search/label/Command%20Line "Command Line") Arguments.
**YARAEnricher**
 This ericher uses a pre-compiled yara file located at: parser/src/enrichers/yara\_rules. This pre-compiled file includes rules from [VirusTotal](https://github.com/virustotal/yara "VirusTotal") and [YaraRulesProject](https://yara-rules.github.io/blog/ "YaraRulesProject")

Subparse's web view was built using *Bootstrap* for its CSS, this allows for any built in Bootstrap CSS to be used when developing your own custom Parser/Enricher Vue.js files. We have also provided an example for each...