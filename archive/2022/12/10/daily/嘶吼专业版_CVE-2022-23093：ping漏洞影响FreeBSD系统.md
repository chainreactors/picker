---
title: CVE-2022-23093：ping漏洞影响FreeBSD系统
url: https://mp.weixin.qq.com/s?__biz=MzI0MDY1MDU4MQ==&mid=2247554835&idx=1&sn=aa14159337001f1d807d64f69660a760&chksm=e915c729de624e3f5dfeb9d3e95242df04a030c39b809f4942fb1d944f16bcbeada489173390&scene=58&subscene=0#rd
source: 嘶吼专业版
date: 2022-12-10
fetch_date: 2025-10-04T01:07:14.464319
---

# CVE-2022-23093：ping漏洞影响FreeBSD系统

![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/wpkib3J60o28QzTg93PCzKTfyn81YDCR2RC2dsspNnprztzJJRkuP52rqorqmXzrVhialNyGJeKKRbDkeIMsZricw/0?wx_fmt=jpeg)

# CVE-2022-23093：ping漏洞影响FreeBSD系统

ang010ela

嘶吼专业版

![](https://mmbiz.qpic.cn/mmbiz_gif/wpkib3J60o297rwgIksvLibPOwR24tqI8dGRUah80YoBLjTBJgws2n0ibdvfvv3CCm0MIOHTAgKicmOB4UHUJ1hH5g/640?wx_fmt=gif)

研究人员在Ping服务中发现一个栈缓存溢出漏洞，攻击者利用该漏洞可接管FreeBSD操作系统。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o28QzTg93PCzKTfyn81YDCR2m7Ay9BvjPYUD6GRUr5E9zEFfUHHEm12HAIJs0YFibtkZTUjbibPl0SKQ/640?wx_fmt=png)

Ping是使用ICMP消息测试远程主机可达性的程序。为发送ICMP消息，ping使用原始socket，因此需要较高的权限。为使非特权用户能够使用ping功能，安装了setuid bit集。Ping运行后，会创建一个原始socket，然后撤销其特权。

# ![](https://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o28QzTg93PCzKTfyn81YDCR2FgNgqlQibz2ugzfMfD72BVyBRWYOqibibKSJmEiaQicqp5oaNYeJcQ0icia1w/640?wx_fmt=png)漏洞概述

研究人员在Ping服务模块中发现一个基于栈的缓存溢出漏洞，漏洞CVE编号为CVE-2022-23093，影响所有FreeBSD操作系统版本。

Ping模块会从网络中读取原始的IP报文以处理pr\_pack() 函数中的响应。为处理该响应，ping必须重构IP header、ICMP header、以及"quoted packet"。quoted packet表示产生了ICMP 错误，quoted packet也有IP header和 ICMP header。

pr\_pack() 会复制接收到的IP和ICMP header到栈缓存中，用于下一步处理。但是没有考虑到响应和quoted packet中的IP header中存在IP option header的问题。如果存在IP option，那么pr\_pack() 就会产生溢出，最大40字节。

# ![](https://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o28QzTg93PCzKTfyn81YDCR2FgNgqlQibz2ugzfMfD72BVyBRWYOqibibKSJmEiaQicqp5oaNYeJcQ0icia1w/640?wx_fmt=png)漏洞影响

该漏洞可以被远程主机触发，引发ping 服务奔溃。恶意主机也可能在ping 中触发远程代码执行。攻击者利用该漏洞通过远程代码执行最终可以实现接管操作系统的目的。

漏洞影响所有FreeBSD 系统版本。目前，FreeBSD操作系统维护者已发布了安全更新。

更多参见：https://www.freebsd.org/security/advisories/FreeBSD-SA-22:15.ping.asc

参考及来源：https://thehackernews.com/2022/12/critical-ping-vulnerability-allows.html

![](https://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o28QzTg93PCzKTfyn81YDCR2cDw6sxkz5gia6GibCeJicPZF0pdBMmxibWX9SqJjCfE2YCFtXkueCic4mKQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o28QzTg93PCzKTfyn81YDCR2RMwWK1HtkcMGcVqeib2CANWDHg3OGicUY8WFV6FGjQz1QzKn8FFvV2kA/640?wx_fmt=png)

预览时标签不可点

阅读原文

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o29QZSgjKMjM7j822AuVv1iaicmoBhDlvJq1s41w5yIxoicDK9AsOGHLnQYkqq95ibWgq3OqvvXEO1qBVg/0?wx_fmt=png)

嘶吼专业版

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/sz_mmbiz_png/wpkib3J60o29QZSgjKMjM7j822AuVv1iaicmoBhDlvJq1s41w5yIxoicDK9AsOGHLnQYkqq95ibWgq3OqvvXEO1qBVg/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过