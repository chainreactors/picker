---
title: 点の位数を整えるテク
url: https://furutsuki.hatenablog.com/entry/2022/12/13/131802
source: ふるつき
date: 2022-12-14
fetch_date: 2025-10-04T01:24:10.087328
---

# 点の位数を整えるテク

[![ふるつき](https://cdn.image.st-hatena.com/image/square/22d94d91fe8214e59637e6fa6173edbe2edc56c6/backend=imagemagick;height=128;version=1;width=128/https%3A%2F%2Fcdn.user.blog.st-hatena.com%2Fblog_custom_icon%2F96439929%2F1745809789466802)](https://furutsuki.hatenablog.com/)

[ふるつき](https://furutsuki.hatenablog.com/)

[読者になる](https://blog.hatena.ne.jp/Furutsuki/furutsuki.hatenablog.com/subscribe?utm_campaign=subscribe_blog&utm_medium=button&utm_source=blogs_topright_button)

# [ふるつき](https://furutsuki.hatenablog.com/)

## v(\*'='\*)v 記事がよかったらスターつけていってください

[2022-12-13](https://furutsuki.hatenablog.com/archive/2022/12/13)

# [点の位数を整えるテク](https://furutsuki.hatenablog.com/entry/2022/12/13/131802)

この記事は[CTF tools/tips Advent Calendar 2022 - Adventar](https://adventar.org/calendars/8316)の13日目の記事です

数学の話ですけど、群の要素![ e](https://chart.apis.google.com/chart?cht=tx&chl=%20e)には位数というパラメータがあって、それはその要素![ e](https://chart.apis.google.com/chart?cht=tx&chl=%20e)自身を![ n](https://chart.apis.google.com/chart?cht=tx&chl=%20n)回演算した時に[単位元](http://d.hatena.ne.jp/keyword/%C3%B1%EF%BF%BD%CC%B8%EF%BF%BD)になるような最小の値です。

具体例を出すと、ある有限体上の[楕円曲線](http://d.hatena.ne.jp/keyword/%EF%BF%BD%CA%B1%DF%B6%EF%BF%BD%EF%BF%BD%EF%BF%BD)![ E](https://chart.apis.google.com/chart?cht=tx&chl=%20E)の点![ P \in E](https://chart.apis.google.com/chart?cht=tx&chl=%20P%20%5Cin%20E)について![ nP = \mathcal{O}](https://chart.apis.google.com/chart?cht=tx&chl=%20nP%20%3D%20%5Cmathcal%7BO%7D)となるような最小の![ n](https://chart.apis.google.com/chart?cht=tx&chl=%20n)が位数です。

CTFの文脈では（それ以外でも）特定の位数を持った点が欲しくなることがあります。典型的には[Invalid Curve Attack](https://furutsuki.hatenablog.com/entry/2021/03/16/095021#%E6%A5%95%E5%86%86%E6%9B%B2%E7%B7%9A%E4%B8%8A%E3%81%AB%E5%AD%98%E5%9C%A8%E3%81%97%E3%81%AA%E3%81%84%E7%82%B9%E3%81%AE%E6%BC%94%E7%AE%97%E3%81%8C%E3%81%A7%E3%81%8D%E3%82%8BInvalid-Curve-Attack)やSmall Subgroup Attackと呼ばれる攻撃を試みるときや、同種[写像](http://d.hatena.ne.jp/keyword/%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD)を求めたいので![ l-](https://chart.apis.google.com/chart?cht=tx&chl=%20l-)torsion pointを求めたいと言った場合です。

こういう場合に特定の位数を持つ点を生成するの方法の一つに、適当に点を生成して後から位数がいい感じになるように調整する、というテクがあるので紹介します。

適当な有限体上の[楕円曲線](http://d.hatena.ne.jp/keyword/%EF%BF%BD%CA%B1%DF%B6%EF%BF%BD%EF%BF%BD%EF%BF%BD)![ E](https://chart.apis.google.com/chart?cht=tx&chl=%20E)の、位数が![ l](https://chart.apis.google.com/chart?cht=tx&chl=%20l)であるような点が欲しいという例を考えてみます。

まず適当に点![ P \in E](https://chart.apis.google.com/chart?cht=tx&chl=%20P%20%5Cin%20E)を生成し、この点の位数を![ n = |P|](https://chart.apis.google.com/chart?cht=tx&chl=%20n%20%3D%20%7CP%7C)とします。
この時、![ l](https://chart.apis.google.com/chart?cht=tx&chl=%20l)が![ n](https://chart.apis.google.com/chart?cht=tx&chl=%20n)を割り切るなら、![ P' = \frac{n}{l}P](https://chart.apis.google.com/chart?cht=tx&chl=%20P%27%20%3D%20%5Cfrac%7Bn%7D%7Bl%7DP)の位数は![ l](https://chart.apis.google.com/chart?cht=tx&chl=%20l)になります。

これは![ lP' = (\frac{l}{l})nP = \mathcal{O}](https://chart.apis.google.com/chart?cht=tx&chl=%20lP%27%20%3D%20%28%5Cfrac%7Bl%7D%7Bl%7D%29nP%20%3D%20%5Cmathcal%7BO%7D)と計算することで確認できます。厳密にはこれが最小の[自然数](http://d.hatena.ne.jp/keyword/%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD)であるということまでちゃんと示したほうが良い気がしますが、テクとしてはこう計算できるよ、ということが言えれば十分かなと思います。

このようなテクはPohlig-Hellman attackなどでも計算量削減のために使われたりしています。例に挙げたのは[楕円曲線](http://d.hatena.ne.jp/keyword/%EF%BF%BD%CA%B1%DF%B6%EF%BF%BD%EF%BF%BD%EF%BF%BD)の場合ですが、単なる乗法群でも同じように位数を調整できます。

[楕円曲線](http://d.hatena.ne.jp/keyword/%EF%BF%BD%CA%B1%DF%B6%EF%BF%BD%EF%BF%BD%EF%BF%BD)の場合は他にもdivision polynomialの根から点を生成するなどとして欲しい位数の点を生成できますが、愚直で一番楽な方法をご紹介しました

Furutsuki
[2022-12-13 13:18](https://furutsuki.hatenablog.com/entry/2022/12/13/131802)

[読者になる](https://blog.hatena.ne.jp/Furutsuki/furutsuki.hatenablog.com/subscribe?utm_medium=button&utm_source=blogs_entry_footer&utm_campaign=subscribe_blog)

[![この記事をはてなブックマークに追加](https://b.st-hatena.com/images/entry-button/button-only.gif)](https://b.hatena.ne.jp/entry/s/furutsuki.hatenablog.com/entry/2022/12/13/131802 "この記事をはてなブックマークに追加")

関連記事

* [![AlpacaHack Round 3 (Crypto) writeup](https://cdn.image.st-hatena.com/image/square/6dd0742dd7e0e99b0ae271c9466436ab103498c0/backend=imagemagick;height=100;version=1;width=100/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2FF%2FFurutsuki%2F20240915%2F20240915182654.png "AlpacaHack Round 3 (Crypto) writeup")](https://furutsuki.hatenablog.com/entry/2024/09/15/201136)

  [2024-09-15](https://furutsuki.hatenablog.com/archive/2024/09/15)

  [AlpacaHack Round 3 (Crypto) writeup](https://furutsuki.hatenablog.com/entry/2024/09/15/201136)

  最近登場した個人戦CTFプラットフォームであるAlpacaHackで、Cr…
* [![SECCON Beginners CTF 2024 crypto writeup](https://cdn.image.st-hatena.com/image/square/298058b2bffe422918ac5e915861b0c0839ae26b/backend=imagemagick;height=100;version=1;width=100/https%3A%2F%2Fcdn.blog.st-hatena.com%2Fimages%2Ftheme%2Fog-image-1500.png "SECCON Beginners CTF 2024 crypto writeup")](https://furutsuki.hatenablog.com/entry/2024/06/16/170151)

  [2024-06-16](https://furutsuki.hatenablog.com/archive/2024/06/16)

  [SECCON Beginners CTF 2024 crypto writeup](https://furutsuki.hatenablog.com/entry/2024/06/16/170151)

  SECCON Beginners CTF 2024に顔をだして、cryptoの問題を解きま…
* [![楕円曲線上の複数の点からその曲線のパラメータを思考停止で求めるテク](https://cdn.image.st-hatena.com/image/square/298058b2bffe422918ac5e915861b0c0839ae26b/backend=imagemagick;height=100;version=1;width=100/https%3A%2F%2Fcdn.blog.st-hatena.com%2Fimages%2Ftheme%2Fog-image-1500.png "楕円曲線上の複数の点からその曲線のパラメータを思考停止で求めるテク")](https://furutsuki.hatenablog.com/entry/2023/01/18/144400)

  [2023-01-18](https://furutsuki.hatenablog.com/archive/2023/01/18)

  [楕円曲線上の複数の点からその曲線のパラメータを思考停止で求めるテク](https://furutsuki.hatenablog.com/entry/2023/01/18/144400)

  最近このテクを使う問題をいくつか解いたのでメモ。楕円曲線と…
* [![l-torsion pointを生成元としたカーネルを持つ同種写像がl-isogenyになることの説明](https://cdn.image.st-hatena.com/image/square/298058b2bffe422918ac5e915861b0c0839ae26b/backend=imagemagick;height=100;version=1;width=100/https%3A%2F%2Fcdn.blog.st-hatena.com%2Fimages%2Ftheme%2Fog-image-1500.png "l-torsion pointを生成元としたカーネルを持つ同種写像がl-isogenyになることの説明")](https://furutsuki.hatenablog.com/entry/2022/12/14/142139)

  [2022-12-14](https://furutsuki.hatenablog.com/archive/2022/12/14)

  [l-torsion pointを生成元としたカーネルを持つ同種写像がl-isogenyになることの説…](https://furutsuki.hatenablog.com/entry/2022/12/14/142139)

  伝わるようなタイトルを考えるのが難しすぎる！ 同種写像計算の…
* [![ある種のEdDSAの実装に対するDouble-PubKey Oracle Attack](https://cdn.image.st-hatena.com/image/square/298058b2bffe422918ac5e915861b0c0839ae26b/backend=imagemagick;height=100;version=1;width=100/https%3A%2F%2Fcdn.blog.st-hatena.com%2Fimages%2Ftheme%2Fog-image-1500.png "ある種のEdDSAの実装に対するDouble-PubKey Oracle Attack")](https://furutsuki.hatenablog.com/entry/2022/06/20/222434)

  [2022-06-20](https://furutsuki.hatenablog.com/archive/2022/06/20)

  [ある種のEdDSAの実装に対するDouble-PubKey Oracle Attack](https://furutsuki.hatenablog.com/entry/2022/06/20/222434)

  話題はこれ↓ www.reddit.com 詳しい話はこれ↓ blog.safeheron.c…

* もっと読む

コメントを書く

[«
l-torsion pointを生成元としたカーネルを…](https://furutsuki.hatenablog.com/entry/2022/12/14/142139)

[zer0pts秘伝のcrypto-writeupを公開します
 »](https://furutsuki.hatenablog.com/entry/2022/12/04/105458)

プロフィール

[![id:Furutsuki](https://cdn.profile-image.st-hatena.com/users/Furutsuki/profile.png?1503402472)](https://furutsuki.hatenablog.com/about)

[id:Furutsuki](https://furutsuki.hatenablog.com/about)
[*はてなブログPro*](https://blog.hatena.ne.jp/-/pro?plus_via=blog_plus_badge&utm_source=pro_badge&utm_medium=referral&utm_campaign=register_pro "はてなブログPro")

最終更新:
2025-07-27 22:32

株式会社はてなで働いています

読者です
読者をやめる

読者になる
読者になる

[このブログについて](https://furutsuki.hatenablog.com/about)

検索

ランダムに記事を表示

🔄

[最新記事](https://furutsuki.hatenablog.com/archive)

* [SECCON Beginners CTF 2025 writeup](https://furutsuki.hatenablog.com/entry/2025/07/27/223211)
* [AlpacaHack Round 12 (Crypto) - writeup](https://furutsuki.hatenablog.com/entry/2025/07/06/234110)
* [2024年に読み始めて面白かったWeb小説](https://furutsuki.hatenablog.com/entry/2024/12/28/190330)
* [AlpacaHack Round 3 (Crypto) writeup](https://furutsuki.hatenablog.com/entry...