---
title: PHP Reinfector and Backdoor Malware Target WordPress Sites
url: https://blog.sucuri.net/2024/11/php-reinfector-and-backdoor-malware-target-wordpress-sites.html
source: Sucuri Blog
date: 2024-11-14
fetch_date: 2025-10-06T19:17:04.575587
---

# PHP Reinfector and Backdoor Malware Target WordPress Sites

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)

[Login](https://dashboard.sucuri.net/login/)

[Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)

Search for:

Search

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

# PHP Reinfector and Backdoor Malware Target WordPress Sites

[![](https://secure.gravatar.com/avatar/3bb7fb42c6bf04c758d570c2f6bb217266c127e77766dc9d8e6754f15cdd5867?s=60&d=mm&r=g)](https://blog.sucuri.net/author/puja-srivastava)

[Puja Srivastava](https://blog.sucuri.net/author/puja-srivastava)

* November 13, 2024

![PHP Reinfector and Backdoor Malware Targeting WordPress Sites](https://blog.sucuri.net/wp-content/uploads/2024/11/PHP-Reinfector-and-Backdoor-Malware-Targeting-WordPress-Sites-Without-wpcode-Plugin-820x385.png)

We recently observed a surge in WordPress websites being infected by a sophisticated PHP reinfector and backdoor malware. While we initially believed that the infection was linked to the wpcode plugin, we found that several sites without this plugin were compromised as well. Upon deeper investigation, we discovered that this malware not only reinfects website files but also embeds malicious code into other plugins and database tables wp\_posts and wp\_options. One backdoor we uncovered revealed how attackers maintain unauthorized access to these sites, further spreading the infection.

This article dives into the infection mechanics and how the malware operates.

***Correction:** In a previous version of this post we mistakenly implied that the Imagify plugin was related to this infection. There are no known vulnerabilities associated with that plugin at this time.*

## Scope and type of the malware

This malware was found to be infecting WordPress sites. The code reinfects the plugin files and database tables. It uses a backdoor to execute arbitrary PHP code on the server by writing it directly to a file, and adds malicious WordPress admin users and uses WPCode PHP snippets in addition to infected plugins.

## Understanding malicious PHP code

While working on the infected site, I noticed that the site was experiencing persistent reinfections. Upon further investigation, I discovered that the reinfection was occurring in the wp\_options and wp\_posts database tables.

This discovery prompted me to dive deeper, as it indicated that the malware was not just residing in the plugin files, but also manipulating key database tables crucial to the site’s functionality.

## Infection mechanism: beyond WPCode

Initially, we thought that this malware was targeting WordPress sites using the popular WPCode plugin (formerly Insert Headers and Footers), which allows administrators to add custom code snippets to their site’s header and footer. However, during my research, I found an intriguing twist: some infected websites didn’t even have the WPCode plugin installed.

## The deeper investigation

My colleague, [Kaushal Bhavsar](https://blog.sucuri.net/author/kaushal), provided invaluable assistance in dissecting the code and analyzing this malware.

The malware makes sure to only execute once per page load, which makes sense given that the same code is injected into all active plugins.

## Stealing WordPress admin credentials

If a user submits a WordPress admin login form, the script captures these values and concatenates them. The combined string is then base64-encoded and written to a file. This function allows attackers to log user credentials, potentially leading to account compromises.

![stealing admin credentials](https://blog.sucuri.net/wp-content/uploads/2024/11/stealing-admin-credentials.png)

## Scheduled updates and VexTrio redirects

The attackers manipulate WordPress’s built-in cron system to ensure their malicious code runs regularly to maintain control over infected sites.

![scheduled updates](https://blog.sucuri.net/wp-content/uploads/2024/11/scheduled-updates.png)

Every 24 hours, the cron job scheduling feature retrieves a list of third-party scripts URLs that will be randomly injected into web pages of the compromised site. These scripts redirect to VexTrio scam sites.

This function begins by fetching an array of third-party URLs (nodes) and iterates over each node in an attempt to access a remote data.txt file.

![vextrio redirects](https://blog.sucuri.net/wp-content/uploads/2024/11/vextrio-redirects.png)

The code fetches specific option values stored in the WordPress database table wp\_options where option\_name contains a long hexadecimal value, for example, option\_name = 55e7183bded6e0fa810c47b04e65ea6e, that contains Base64 encoded data, to provide a list of third-party URLs (nodes).

![](https://blog.sucuri.net/wp-content/uploads/2024/11/vextrio-redirects-2.png)

![](https://blog.sucuri.net/wp-content/uploads/2024/11/vextrio-redirects-3.png)

![](https://bl...