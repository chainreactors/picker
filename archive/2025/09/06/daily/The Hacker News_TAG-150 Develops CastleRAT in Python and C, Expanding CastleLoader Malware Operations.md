---
title: TAG-150 Develops CastleRAT in Python and C, Expanding CastleLoader Malware Operations
url: https://thehackernews.com/2025/09/tag-150-develops-castlerat-in-python.html
source: The Hacker News
date: 2025-09-06
fetch_date: 2025-10-02T19:46:09.443063
---

# TAG-150 Develops CastleRAT in Python and C, Expanding CastleLoader Malware Operations

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [TAG-150 Develops CastleRAT in Python and C, Expanding CastleLoader Malware Operations](https://thehackernews.com/2025/09/tag-150-develops-castlerat-in-python.html)

**Sep 05, 2025**Ravie LakshmananBotnet / Malware

[![](data:image/png;base64...)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjv0-56UW-EiEFHgxdX3jsH_3G67Xg-SIgNWs9l0x044kY_ufHGm3xQNVJ4kc_1_GyXsyCWeDe4YCQdfV8aTzkYqWwq0k9-prUZwNrP1g7uvV4gxsTWWXGEGraE3A4Vfdd_vWPdNafYRhEEWwhEChooWjgjQLs0JVj7HU7m7wF84XEEySynZEdBTHPuCSBR/s790-rw-e365/malware-code.jpg)

The threat actor behind the malware-as-a-service (MaaS) framework and loader called CastleLoader has also developed a remote access trojan known as **CastleRAT**.

"Available in both Python and C variants, CastleRAT's core functionality consists of collecting system information, downloading and executing additional payloads, and executing commands via CMD and PowerShell," Recorded Future Insikt Group [said](https://www.recordedfuture.com/research/from-castleloader-to-castlerat-tag-150-advances-operations).

The cybersecurity company is tracking the threat actor behind the malware families as TAG-150. Believed to be active since at least March 2025, CastleLoader et al are seen as initial access vectors for a wide range of secondary payloads, including remote access trojans, information stealers, and even other loaders.

CastleLoader (aka CastleBot) was [first documented](https://thehackernews.com/2025/07/castleloader-malware-infects-469.html) by Swiss cybersecurity company PRODAFT in July 2025, as having been put to use in various campaigns distributing DeerStealer, RedLine, StealC, NetSupport RAT, SectopRAT, and Hijack Loader.

A subsequent analysis from IBM X-Force last month [found](https://thehackernews.com/2025/07/castleloader-malware-infects-469.html#update) that the malware has also served as a conduit for MonsterV2 and WARMCOOKIE through SEO poisoning and GitHub repositories impersonating legitimate software.

"Infections are most commonly initiated through Cloudflare-themed ['ClickFix'](https://thehackernews.com/2025/08/clickfix-malware-campaign-exploits.html) phishing attacks or fraudulent GitHub repositories masquerading as legitimate applications," Recorded Future said.

[![DFIR Retainer Services](data:image/png;base64...)](https://thehackernews.uk/cloud-insight-d)

"The operators employ the ClickFix technique by leveraging domains that imitate software development libraries, online meeting platforms, browser update alerts, and document verification systems."

Evidence indicates that TAG-150 has been working on CastleRAT since March 2025, with the threat actor leveraging a multi-tiered infrastructure comprising Tier 1 victim-facing command-and-control (C2) servers, as well as Tier 2 and Tier 3 servers that are mostly virtual private servers (VPSes), and Tier 4 backup servers.

CastleRAT, the newly discovered addition to TAG-150's arsenal, can download next-stage payloads, enable remote shell capabilities, and even delete itself. It also uses Steam Community profiles as dead drop resolvers to point to the actual C2 servers ("programsbookss[.]com").

Notably, CastleRAT comes in two versions, one written in C and the other, programmed in Python, with the latter also called PyNightshade. It's worth noting that eSentire is [tracking](https://www.esentire.com/blog/new-botnet-emerges-from-the-shadows-nightshadec2) the same malware under the name NightshadeC2.

The C variant of CastleRAT incorporates more functionality, allowing it to log keystrokes, capture screenshots, upload/download files, and function as a cryptocurrency clipper to substitute wallet addresses copied to the clipboard with an attacker-controlled one with the aim of redirecting transactions.

[![](data:image/png;base64...)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhhuj-Z-mMCNGcxMsk0C8tNpRwwLd1EBYw2GBkN7cpRgsaZUMPSn8i_fWshPp6MZlis5rzTgG0l1xaHuojeoPEeNXZ-Eca3cO8-k3TCYH4USJVS_7vTrGnwy8kl0nJ7hK7udZQ2mwhGEES2uwHTbTctvvZDE1qz81fYjl_IuyXr_ZG5KcOiSbOJ8qDBLXCh/s2600/vps.jpg)

"As with the Python variant, the C variant queries the widely abused IP geolocation service ip-api[.]com to collect information based on the infected host's public IP address," Recorded Future said. "However, the scope of data has been expanded to include the city, ZIP code, and indicators of whether the IP is associated with a VPN, proxy, or TOR node."

That said, recent iterations of the C variant of CastleRAT have removed querying of the city and ZIP code from ip-api[.]com, indicating active development. It remains to be seen if its Python counterpart will attain feature parity.

eSentire, in its own analysis of NightshadeC2, described it as a botnet that's deployed by means of a .NET loader, which, in turn, makes use of techniques like [UAC Prompt Bombing](https://github.com/esentire/iocs/tree/main/Nightshade/SandboxBypass/bin/Release) to sidestep security protections. The Canadian cybersecurity company said it also identified variants equipped with features to extract passwords and cookies from Chromium- and Gecko-based web browsers.

In a nutshell, the process involves running a PowerShell command in a loop that attempts to add an exclusion in Windows Defender for the final payload (i.e., NightshadeC2), after which the loader verifies the exit code of the PowerShell process to ascertain if it's 0 (meaning success).

If the exclusion is successfully added, the loader proceeds to deliver the malware. If any other exit code other than 0 is returned, the loop keeps executing repeatedly, forcing the user to approve the User Account Control (UAC) prompt.

"A particularly notable aspect of this approach is that systems with the WinDefend (Windows Defender) service disabled will generate non-zero exit codes, causing malware analysis sandboxes to become trapped in the execution loop," eSentire said, adding the method enables a bypass of multiple sandbox solutions.

Given the absence of any dark web advertisements related to TAG-150, it's currently not clea...