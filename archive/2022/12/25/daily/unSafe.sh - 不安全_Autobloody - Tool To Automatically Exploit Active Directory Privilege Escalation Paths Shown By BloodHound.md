---
title: Autobloody - Tool To Automatically Exploit Active Directory Privilege Escalation Paths Shown By BloodHound
url: https://buaq.net/go-141265.html
source: unSafe.sh - 不安全
date: 2022-12-25
fetch_date: 2025-10-04T02:29:04.398347
---

# Autobloody - Tool To Automatically Exploit Active Directory Privilege Escalation Paths Shown By BloodHound

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/0729b6e129713a3dfaf2e2ab73aa944d.jpg)

Autobloody - Tool To Automatically Exploit Active Directory Privilege Escalation Paths Shown By BloodHound

autobloody is a tool to automatically exploit Active Directory privilege escalation paths sh
*2022-12-24 19:30:0
Author: [www.kitploit.com(查看原文)](/jump-141265.htm)
阅读量:44
收藏*

---

[![](https://blogger.googleusercontent.com/img/a/AVvXsEhOvbBA3Kgax2YdiG7PVJksfJy4vLUAEvNGXYDcqnqo7pbWxhz2__9U1DETkKRC7Vg7gz9A7s6Lztrma9jTNh5ysdTpFbTbjf9gRfqDkWv8MH44Y4u6-hQDelX1Hm5b9MTMHl2M3NV9P7fCXw8I7ZMWLN1eycI1jib3wJHjpZF9sjtBwS3tcCo39C5Rlw=w640-h320)](https://blogger.googleusercontent.com/img/a/AVvXsEhOvbBA3Kgax2YdiG7PVJksfJy4vLUAEvNGXYDcqnqo7pbWxhz2__9U1DETkKRC7Vg7gz9A7s6Lztrma9jTNh5ysdTpFbTbjf9gRfqDkWv8MH44Y4u6-hQDelX1Hm5b9MTMHl2M3NV9P7fCXw8I7ZMWLN1eycI1jib3wJHjpZF9sjtBwS3tcCo39C5Rlw)

`autobloody` is a tool to automatically exploit [Active Directory](https://www.kitploit.com/search/label/Active%20Directory "Active Directory") [privilege escalation](https://www.kitploit.com/search/label/Privilege%20Escalation "privilege escalation") paths shown by BloodHound.

## Description

This tool automates the AD privesc between two AD objects, the source (the one we own) and the target (the one we want) if a privesc path exists in BloodHound database. The automation is composed of two steps:

* Finding the optimal path for privesc using bloodhound data and neo4j queries.
* Execute the path found using `bloodyAD` package

Because autobloody relies on [bloodyAD](https://github.com/CravateRouge/bloodyAD "bloodyAD"), it supports [authentication](https://www.kitploit.com/search/label/Authentication "authentication") using cleartext passwords, pass-the-hash, pass-the-ticket or certificates and binds to LDAP services of a [domain controller](https://www.kitploit.com/search/label/Domain%20Controller "domain controller") to perform AD privesc.

## Installation

First if you run it on Linux, you must have `libkrb5-dev` installed on your OS in order for kerberos to work:

```
# Debian/Ubuntu/Kali
```

A [python package](https://www.kitploit.com/search/label/Python%20Package "python package") is available:

Or you can clone the repo:

```
git clone --depth 1 https://github.com/CravateRouge/autobloody
pip install .
```

### Dependencies

* [bloodyAD](https://github.com/CravateRouge/bloodyAD "bloodyAD")
* Neo4j python driver
* Neo4j with the [GDS library](https://neo4j.com/docs/graph-data-science/current/installation/ "GDS library")
* BloodHound
* Python 3
* Gssapi (linux) or Winkerberos (Windows)

## How to use it

First data must be imported into BloodHound (e.g using SharpHound or BloodHound.py) and Neo4j must be running.

> ⚠️
>
> **-ds and -dt values are case sensitive**

Simple usage:

Full help:

```
[bloodyAD]$ ./autobloody.py -h
usage: autobloody.py [-h] [--dburi DBURI] [-du DBUSER] -dp DBPASSWORD -ds DBSOURCE -dt DBTARGET [-d DOMAIN] [-u USERNAME] [-p PASSWORD] [-k] [-c CERTIFICATE] [-s] --host HOST

AD Privesc Automation

options:
  -h, --help            show this help message and exit
  --dburi DBURI         The host neo4j is running on (default is "bolt://localhost:7687")
  -du DBUSER, --dbuser DBUSER
                        Neo4j username to use (default is "neo4j")
  -dp DBPASSWORD, --dbpassword DBPASSWORD
                        Neo4j password to use
  -ds DBSOURCE, --dbsource DBSOURCE
                        Case sensitive label of the source node (name property in bloodhound)
  -dt DBTARGET, --dbtarget DBTARGET
                        Case sensitive label of the target node (name property in bloodhound)
     -d DOMAIN, --domain DOMAIN
                        Domain used for NTLM authentication
  -u USERNAME, --username USERNAME
                        Username used for NTLM authentication
  -p PASSWORD, --password PASSWORD
                        Cleartext password or LMHASH:NTHASH for NTLM authentication
  -k, --kerberos
  -c CERTIFICATE, --certificate CERTIFICATE
                        Certificate authentication, e.g: "path/to/key:path/to/cert"
  -s, --secure          Try to use LDAP over TLS aka LDAPS (default is LDAP)
  --host HOST           Hostname or IP of the DC (ex: my.dc.local or 172.16.1.3)
```

## How it works

First a privesc path is found using the Dijkstra's algorithm implemented into the Neo4j's GDS library. The Dijkstra's algorithm allows to solve the shortest path problem on a weighted graph. By default the edges created by BloodHound don't have weight but a type (e.g MemberOf, WriteOwner). A weight is then added to each edge accordingly to the type of edge and the type of node reached (e.g user,group,domain).

Once a path is generated, `autobloody` will connect to the DC and execute the path and clean what is reversible (everything except `ForcePasswordChange` and `setOwner`).

## Limitations

For now, only the following BloodHound edges are currently supported for automatic exploitation:

* MemberOf
* ForceChangePassword
* AddMembers
* AddSelf
* DCSync
* GetChanges/GetChangesAll
* GenericAll
* WriteDacl
* GenericWrite
* WriteOwner
* Owns
* Contains
* AllExtendedRights

Autobloody - Tool To Automatically Exploit Active Directory Privilege Escalation Paths Shown By BloodHound
![Autobloody - Tool To Automatically Exploit Active Directory Privilege Escalation Paths Shown By BloodHound](https://blogger.googleusercontent.com/img/a/AVvXsEhOvbBA3Kgax2YdiG7PVJksfJy4vLUAEvNGXYDcqnqo7pbWxhz2__9U1DETkKRC7Vg7gz9A7s6Lztrma9jTNh5ysdTpFbTbjf9gRfqDkWv8MH44Y4u6-hQDelX1Hm5b9MTMHl2M3NV9P7fCXw8I7ZMWLN1eycI1jib3wJHjpZF9sjtBwS3tcCo39C5Rlw=s72-w640-c-h320)
Reviewed by Zion3R
on
8:30 AM
Rating: 5

文章来源: http://www.kitploit.com/2022/12/autobloody-tool-to-automatically.html
 如有侵权请联系:admin#unsafe.sh

© [unSafe.sh - 不安全](https://unsafe.sh) Powered By [PaperCache](https://github.com/code-scan/PaperCache)

* admin#unsafe.sh
* [安全马克](https://aq.mk)
* [星际黑客](https://xj.hk)
* [T00ls](https://t00ls.net)