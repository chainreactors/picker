---
title: 2023钓鱼攻击思路整理~
url: https://www.secpulse.com/archives/194290.html
source: 安全脉搏
date: 2022-12-30
fetch_date: 2025-10-04T02:43:53.070092
---

# 2023钓鱼攻击思路整理~

[![](https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo-header.png)](https://www.secpulse.com "安全脉搏")

* [首页](https://www.secpulse.com/)
* [分类阅读](https://www.secpulse.com/archives/category/category)

  #### 脉搏文库

  - [内网渗透](https://www.secpulse.com/archives/category/articles/intranet-penetration)
  - |
  - [代码审计](https://www.secpulse.com/archives/category/articles/code-audit)
  - |
  - [安全文献](https://www.secpulse.com/archives/category/articles/sec-doc)
  - |
  - [Web安全](https://www.secpulse.com/archives/category/articles/web)
  - |
  - [移动安全](https://www.secpulse.com/archives/category/articles/mobile-security)
  - |
  - [系统安全](https://www.secpulse.com/archives/category/articles/system)
  - |
  - [工控安全](https://www.secpulse.com/archives/category/articles/industrial-safety)
  - |
  - [CTF](https://www.secpulse.com/archives/category/exclusive/ctf-writeup)
  - |
  - [IOT安全](https://www.secpulse.com/archives/category/iot-security)
  - |

#### 安全建设

+ [业务安全](https://www.secpulse.com/archives/category/construction/businesssecurity)
+ |
+ [安全管理](https://www.secpulse.com/archives/category/construction/securityissue)
+ |
+ [数据分析](https://www.secpulse.com/archives/category/construction/bigdata)
+ |

#### 其他

+ [资讯](https://www.secpulse.com/archives/category/news)
+ |
+ [漏洞](https://www.secpulse.com/archives/category/vul)
+ |
+ [工具](https://www.secpulse.com/archives/category/tools)
+ |
+ [人物志](https://www.secpulse.com/archives/category/people)
+ |
+ [区块链安全](https://www.secpulse.com/archives/category/exclusive/block_chain_security)
+ |
+ [安全招聘](https://www.secpulse.com/archives/category/hiring)
+ |

- [安全问答](https://www.secpulse.com/newpage/question_list)
- [金币商城](https://www.secpulse.com/shop?donotcachepage=c010349fd98847cb9d6e07d3cbc19288)
- [安全招聘](https://www.secpulse.com/archives/category/hiring)
- [活动日程](https://www.secpulse.com/newpage/activity)
- [live课程](https://www.secpulse.com/live)
- [企业服务](https://duoyinsu.com/service.html)
- [插件社区](https://x.secpulse.com/)

小程序

![脉搏小程序](https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg)
[登录](https://www.secpulse.com/user_login)
|
[注册](https://www.secpulse.com/user-register)

# 2023钓鱼攻击思路整理~

[脉搏文库](https://www.secpulse.com/archives/category/category/secdocs)

[Ms08067安全实验室](https://www.secpulse.com/newpage/author?author_id=11195)
![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng0.png)

2022-12-29

10,591

********文章来源｜****************Ms08067安全实验室********

本文作者：**Taoing**

钓鱼思路整理
一、目标信息收集
二、目标环境
三、社交
四、基础设施
五、邮件
邮箱信息收集
六、钓鱼话术模板
案例一：
案例二：
案例三**：**钓鱼案例：Chrome漏洞一键修复

### **一、目标信息收集**

* 业务范围

+ 金融
+ 医疗
+ 卫生
+ IT

* 组织架构

+ 董事会
+ 高管
+ 财务
+ 采购
+ 运维

* 人员信息

+ 针对不同职位采用不同话术
+ 按照，部门、职务、难易程度分类，分批次投递
+ 姓名、职位、邮箱、手机

* 目标服务入口

+ VPN、webVPN
+ 邮服
+ SSO认证
+ OA认证
+ 其他内网入口
+ 帮助文档、使用手册文档信息泄露，收集弱口令

* 站内联系方式

+ 新闻投稿、投诉举报、站内信、业务反馈

* 目标新闻

+ 了解企业文化、工作动态、便于构造高质量文案，提高效率

* \*\*库

+ 根据收集到的信息进行猎魔查询

### **二、目标环境**

* 地区用户环境

+ 语言、常用邮箱、常用搜索引擎、常用运营商

* 时间、工作时间

+ 了解日常工作时间，节假日，尽可能工作日发信

### **三、社交**

* 大陆：微信、脉脉、领英、qq、钉钉
* 海外：领英、Facebook、Twitter、Line、ins、YouTube、TG
* 工作软件进行钓简历

### **四、基础设施**

* 目标地区匿名手机号
* 目标地区常用邮箱
* 目标近似域名

### **五、邮件**

* 话术

+ 落款信息、开头语、结束语、标题、发信人名称/部门名称

* 邮件格式

+ 仿正规邮件，无明显钓鱼邮件格式，邮件添加logo增加可信度

* 发信IP或服务

+ 优先选择第三方邮件服务，正规无拉黑

* 发信频率

+ 多批次，少投递，高精准

#### 邮箱信息收集

python3 .snov.py -u 注册时的邮箱 -p 注册时的密码 -t baidu.com

![](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-194290-1672287911.png)

```
# -*- coding: utf-8 -*-# @Time : 2021年08月04日:14时34分# @File : snov.pyimport requestsimport reimport jsonfrom urllib.parse import unquotefrom math import ceilfrom optparse import OptionParser #用于生成帮助文档from os.path import existsimport warningswarnings.filterwarnings('ignore')
class Snov:def __init__(self):self.domain="https://app.snov.io"self.headers={'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Safari/605.1.15'}self.session=requests.session()
def _login(self,username,password): #自动登录功能session=requests.session() #定义sessionurl=self.domain+"/login"response=session.get(url=url,headers=self.headers)data=response.content.decode()pattern="name=\"_token\"\s?value=\"(.*?)\"" #获取登录使用的tokenresult=re.findall(pattern,data)try:_token=result[0]except:return Falseparam={"email":username,"password":password,"_token":_token,"remember":"off"}response=session.post(url=url,data=param,headers=self.headers,verify=False)XSRF_TOKEN=session.cookies.get("XSRF-TOKEN")self.headers['X-XSRF-TOKEN']=unquote(XSRF_TOKEN) #将XSRF_TOKEN复制self.session=sessionreturn True
def _getDomainSearch(self,searchDomain):param={"domain":searchDomain,"isGreen":"true","lastId":0,"perPage":20}url=self.domain+"/domain-search"headers = self.headersheaders['Content-Type'] = "application/json"response=self.session.post(url=url,headers=headers,data=json.dumps(param),verify=False)data=response.content.decode()data=json.loads(data)try:id=data.get("companyInfo",None).get('id',None)return id #返回公司idexcept:return False
def _getTotal(self,id): #获取邮箱和联系人总个数url=self.domain+"/companies/"+str(id)headers = self.headersheaders['Content-Type'] = "application/json"response=self.session.post(url=url,data=None,headers=headers,verify=False)data=response.content.decode()data=json.loads(data)try:emailsTotal=data.get("emailsTotal",0)contactsTotal=data.get("contactsTotal",0)return (emailsTotal,contactsTotal)except:return (0,0)def _getMail(self,total,id,target): #获取全部邮箱url = self.domain + "/companies/" + str(id) + "/" + "emails"headers = self.headersheaders['Content-Type'] = "application/json"headers['Referer'] = "https://app.snov.io/domain-search?name={}&tab=emails".format(target)headers['X-Requested-With'] = "XMLHttpRequest"#total=452count=ceil(total/200)print("{}一个有{}个邮箱，分{}次获取".format(target,total,count))lastId=Nonefor i in range(1,count+1,1):if not lastId:param={"isGreen":True,"lastId":0,"perPage":200,"page":i}response=self.session.post(url=url,data=json.dumps(param),headers=headers,timeout=50,verify=False)data=response.content.decode()data=json.loads(data)lists=data.get("list",None)lastId=data.get("lastId",1)self._storeMail(lists,target)elif lastId:param={"isGreen":True,"lastId":lastId,"perPage":200,"domain":""}response = self.session.post(url=url, data=json.dumps(param), headers=headers, timeout=50, verify=False)data = response.content.decode()data = json.loads(data)lists = data.get("list", None)lastId = data.get("lastId", 1)self._storeMail(lists,target)
def _storeMail(self,lists,target):storage="./"+target+"_mails.txt"if lists:with open(storage,"a",encoding="utf-8") as fp:for list in lists:email=list.get('email',None)if email:fp.write(email)fp.write("\n")
def run(self,username,password,targets):if self._login(username=username,password=password):for target in targets:print("开始查询{}。".format(target))id=self._getDomainSearch(target.strip())emailsTotal, contactsTotal = self._getTotal(id)self._getMail(emailsTotal,id,target)else:exit("登录出错！")
if __name__ == '__main__':parser = OptionParser()parser.add_option("-u", "--user", dest="username", default=None, help="用户名")parser.add_option("-p", "--pass", dest="password", default=None, help="登录密码")parser.add_option("-t", "--target", dest="target", default=None, help="要查询的域名，多个目标使用,隔开")parser.add_option("-f", "--file", dest="file", default=None, help="可以使用文件输入目标，一行一个")(options, args) = parser.parse_args() # 取值并且存入optionsif (options.username and options.password):if options.target:targets=options.target.split(",")print(targets)elif exists(options.file):targets=list()with open(options.file,"r",encoding='utf-8') as fp:line=fp.readline()while line:line=line.strip()targets.append(line)line=fp.readline()else:targets=Noneif targets:snov=Snov()snov.run(options.username.strip(),options.password.strip(),targets)else:exit("输入有误，滚啊！！！")
```

### **六、钓鱼话术模板**

#### **案例一：**

**亲爱的同事们：**
近期，公司监控系统捕捉到某些VPN账号存在数次异常操作行为，根据我司(集团)网络安全规定，为确保账号安全，现需要所有具有VPN登录权限的同事配合(无VPN登录权限的同事可直接忽略此邮件)，尽快重新登录VPN系统以完成VPN账号安全检查，登录VPN系统自动检查账...