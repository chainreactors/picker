---
title: New Variation of WordFence Evasion Malware
url: https://blog.sucuri.net/2024/07/new-variation-of-wordfence-evasion-malware.html
source: Sucuri Blog
date: 2024-07-06
fetch_date: 2025-10-06T17:42:18.852538
---

# New Variation of WordFence Evasion Malware

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)

[Login](https://dashboard.sucuri.net/login/)

[Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)

Search for:

Search

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

# New Variation of WordFence Evasion Malware

[![](https://secure.gravatar.com/avatar/49a04d32074892dc04d9ed823aa114f8492a90e9c88852302b083c90aa322c21?s=60&d=mm&r=g)](https://blog.sucuri.net/author/benmartin)

[Ben Martin](https://blog.sucuri.net/author/benmartin)

* July 5, 2024

![Wordfence Evasion Malware Conceals Backdoors](https://blog.sucuri.net/wp-content/uploads/2022/10/BlogPost_Feature-Image_1490x700_Wordfence-Evasion-Malware-Conceals-Backdoors-820x386.png)

We recently came across an infected WordPress environment which contained a new variation of [WordFence evasion malware](https://blog.sucuri.net/2022/10/wordfence-evasion-malware-conceals-backdoors.html) using some sneaky tactics to conceal itself from view.

The site administrator was reporting some issues with potential credit card theft malware on their website, but they had already removed that themselves by the time we arrived at the scene. What we did find, though, was a very interesting component to the infection which tampered with an extremely popular open source WordPress security plugin. Let’s take a look!

**Contents:**

* [Malicious plugin files in compromised envionrments](#malicious-plugins)
* [WordFence plugin evasion](#wordfence)
* [False WordFence overlay](#overlay)
* [Mitigation steps](#mitigation)

## Malicious plugin files in compromised environments

One of the most popular methods that attackers use to lodge malware in WordPress websites is through the use of malicious plugins. Since **administrator users** are one of the most common attack vectors for WordPress environments, and the installation of plugins and themes is one of the primary abilities of these users, it only stands to reason that this functionality is abused if those users are compromised by threat actors. For example, malicious plugins are one of the most [common](https://sucuri.net/reports/2022-hacked-website-report/) variants of credit card skimming malware on ecommerce sites operating WooCommerce.

When [cleaning malware from a WordPress website](https://sucuri.net/guides/how-to-clean-hacked-wordpress/) it’s always prudent to take a glance at the plugin files within **./wp-content/plugins** — you never know what you’ll find! Attackers will often use suspiciously-generic names for their malware in order to try to “blend in” to the environment and not be noticed.

In this case, one such example stood out from the rest:

```
./wp-content/plugins/wp-engine-fast-action
```

This was suspicious not only because the popular hosting provider WPEngine doesn’t make a plugin with that name, but also this website was not hosted at WPEngine to begin with.

## WordFence plugin evasion

With over 5 million active installations, WordFence is without a doubt one of the most popular security solutions in use in the WordPress community. It’s an excellent piece of software and a very handy tool to employ on a website to keep malware at bay. Their vulnerability research [team](https://www.wordfence.com/blog/category/vulnerabilities/) is also outstanding, so big ups to them for helping to keep the WordPress world more secure.

That being said, no security solution is perfect, and websites can still become compromised despite taking measures to prevent it.

For example, while WordFence provides a two factor authentication service to prevent unauthorized access to the administrator panel, not everyone using the plugin will turn that on. The same is true for our firewall service: Even though compromised wp-admin panels are one of the most common attack vectors, not everyone using our firewall employs the usage of our [protected page](https://docs.sucuri.net/website-firewall/whitelist-and-blacklist/protected-page/) feature (which, if you’re a customer of our Sucuri firewall service, you should definitely enable it!).

Let’s turn our attention to the following file:

```
./wp-content/plugins/wp-engine-fast-action/wp-engine-fast-action.php
```

Peering inside we see the following:

![Contents of the wp-engine-fast-action.php file](https://blog.sucuri.net/wp-content/uploads/2024/07/wp-engine-fast-action-650x367.png)

We can see that some layers of obfuscation need to be removed before we can read this properly; namely, some **base64** encoding, concatenation as well as reversed strings.

Once we sort that out we see the following:

![Deofuscated contents reveal malicious wp-engine-fast-action plugin](https://blog.sucuri.net/wp-content/uploads/2024/07/wp-engine-deofuscated-650x372.png)

The malicious plugin can be triggered by using the request defined in the **license\_key...