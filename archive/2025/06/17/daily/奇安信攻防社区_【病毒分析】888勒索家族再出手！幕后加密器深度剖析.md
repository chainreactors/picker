---
title: 【病毒分析】888勒索家族再出手！幕后加密器深度剖析
url: https://forum.butian.net/share/4402
source: 奇安信攻防社区
date: 2025-06-17
fetch_date: 2025-10-06T22:47:49.052879
---

# 【病毒分析】888勒索家族再出手！幕后加密器深度剖析

#

[问答](https://forum.butian.net/questions)

*发起*

* [提问](https://forum.butian.net/question/create)
* [文章](https://forum.butian.net/share/create)

[攻防](https://forum.butian.net/community)
[活动](https://forum.butian.net/movable)

Toggle navigation

* [首页 (current)](https://forum.butian.net)
* [问答](https://forum.butian.net/questions)
* [商城](https://forum.butian.net/shop)
* [实战攻防技术](https://forum.butian.net/community)
* [漏洞分析与复现](https://forum.butian.net/articles)
  NEW
* [活动](https://forum.butian.net/movable)
* [摸鱼办](https://forum.butian.net/questions/Play)

搜索

* [登录](https://forum.butian.net/login)
* [注册](https://user.skyeye.qianxin.com/user/register?next=http://forum.butian.net/btlogin)

### 【病毒分析】888勒索家族再出手！幕后加密器深度剖析

* [漏洞分析](https://forum.butian.net/topic/48)

1.背景
2025年3月，Solar应急响应团队成功捕获了888勒索家族的加密器样本。实际上，我们最早接触该家族是在2024年10月，彼时888家族活跃度极高，频繁针对医疗行业发起攻击，受害对象以药店、医...

1.背景
====
2025年3月，Solar应急响应团队成功捕获了\*\*888勒索家族\*\*的加密器样本。实际上，我们最早接触该家族是在\*\*2024年10月\*\*，彼时888家族活跃度极高，频繁针对\*\*医疗行业\*\*发起攻击，受害对象以\*\*药店、医院等医疗机构\*\*为主。
在攻击方式上，888家族主要通过\*\*MSSQL数据库弱口令爆破\*\*实现初始入侵，成功获取权限后，将自制的加密器投放至服务器路径中的\*\*Music\\misc目录\*\*，以隐藏其恶意文件，随后迅速对服务器内的重要数据实施加密勒索。
\*\*1.1 加密器特征\*\*
-------------
该勒索家族较为狡猾，通过ping空地址绕过本地安全机制监测最终实现自删除。
![1.png](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2025/05/attach-23e366e8b0b12d89c7d22753d90cd7be689cf7ff.png)
加密器启动后运行的命令行指令
在成功加密后，桌面上会生成名为“!RESTORE\\_FILES!.txt”的勒索信，要求受害者将信内ID发到下方的邮箱中，以取得初步联系获得赎金报价。
![2.png](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2025/05/attach-f9c7b855de56fd49248f234babe4bc15d87f8116.png)
勒索信
![3.png](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2025/05/attach-893300f2410af08c56cb8c82c66844d32e3234cf.png)
被加密后的目录
\*\*1.2 攻击链路与IOC\*\*
----------------
888勒索家族惯用的手段是通过数据库对外暴露入口弱口令入侵数据库，并在数据执行提权操作，获取高权限账户或将木马加载到受害者设备，随后再进行加密器的加载运行。
![4.png](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2025/05/attach-859671f203bde43e6285daa1ba9f640b643eecc2.png)
\*\*1.3 IOC\*\*
-----------
| \*\*详细信息\*\* | \*\*类型\*\* | \*\*关联文件/主机/备注\*\* |
|---|---|---|
| d15ab1e89fc94d9b4dff7cb5b8d392eca74a0a65 | Sha1 | netpass64.exe |
| 7ab128659ad586761ea68009d59a1ccf1547a039 | Sha1 | netpass64.exe |
| 8b0e4650f1a7080b78066a61152e571ca8b6816b | Sha1 | svchost.exe |
| 86803bbc26ed08e863ab17c765577a74637afaa7 | Sha1 | svchost.exe |
| a0bdfac3ce1880b32ff9b696458327ce352e3b1d | Sha1 | processhacker.exe |
| 729fd507a1118b2d9008a097b7330c52760ceb9e | Sha1 | processhacker.exe |
| 31.43.176.57 | IP | 波兰 |
| 36.152.235.38 | IP | 中国 江苏省 徐州市 |
| 185.132.176.32 | IP | 荷兰 南荷兰省 纳尔德韦克 |
| 58.211.56.222 | IP | 中国 江苏省 苏州市 |
| <nemesis@888recover.4wrd.cc> | Mail\\_addr | 勒索邮箱 |
| <nemesissupport@firemail.cc> | Mail\\_addr | 勒索邮箱 |
| !RESTORE\\_FILES!.txt | File | 勒索信文件名 |
| .888 | Suffix | 勒索后缀名 |
\*\*2.恶意文件基础信息\*\*
==============
\*\*2.1 恶意文件基本信息\*\*
----------------
| 文件名 | svchost.exe |
|---|---|
| 编译器 | Microsoft Visual C/C++(19.36.33923)\[C++\] |
| 大小 | 2.43 MB |
| 操作系统 | Windows(Vista)\[AMD64, 64位, GUI\] |
| 模式 | 64 位 |
| 类型 | EXEC |
| 字节序 | LE |
| MD5 | 5315bdbf85ad2b3bb13ae8ee62489f7f |
| SHA1 | 8b0e4650f1a7080b78066a61152e571ca8b6816b |
| SHA256 | dee0fde2d096c79e138890f958b9440e87cce38504b654a97de50bb7969a9c98 |
\*\*2.2 勒索信\*\*
-----------
+----------------------------------------------------------------------------+
| !!!ALL YOUR FILES ARE ENCRYPTED, AS A RESULT OF A BREACH IN SECURITY!!! |
+----------------------------------------------------------------------------+
​
No worries - you can get them back!
It's impossible to decrypt without contacting us.
​
+----------------------------------------------------------------------------+
| !!!DON'T TRY TO CHANGE ENCRYPTED FILES!!! |
| !!!DON'T RENAME ENCRYPTED FILES!!! |
| !!!DON'T USE ADDITIONAL RECOVERY SOFTWARE!!! |
| !!!IT WILL MAKE THEM IMPOSSIBLE TO DECRYPT!!! |
+----------------------------------------------------------------------------+
​
How to return all your data back in safe:
​
1\. Copy and sent us your KEY.
2\. We can decrypt 2 small files, no databases (.jpg, .txt, .doc, ets.. (up to 3mb)) as your warranty.
3\. After payment, you will receive a special software for decryption.
​
\-----------------------------------------------------------------------------------------------------------------
KEY:
\-----------------------------------------------------------------------------------------------------------------
​
EMAILS:
nemesis@888recover.4wrd.cc
nemesissupport@firemail.cc
​
Zero cheats, all integrity.
\*\*3.加密后文件分析\*\*
=============
\*\*3.1威胁分析\*\*
-----------
| \*\*病毒家族\*\* | 888 |
|---|---|
| \*\*首次出现时间/捕获分析时间\*\* | 2024/10/19 \| 2025/03/27 |
| \*\*威胁类型\*\* | 勒索软件，加密病毒 |
| \*\*加密文件扩展名\*\* | .888 |
| \*\*勒索信文件名\*\* | !RESTORE\\_FILES!.txt |
| \*\*有无免费解密器？\*\* | 无 |
| \*\*联系邮箱\*\* | <nemesis@888recover.4wrd.cc> |
| \*\*感染症状\*\* | 无法打开存储在计算机上的文件，以前功能的文件现在具有不同的扩展名（例如，solar.docx.888）。桌面上会显示一条勒索要求消息。网络犯罪分子要求支付赎金（通常以比特币）来解锁您的文件。 |
| \*\*感染方式\*\* | 受感染的电子邮件附件（宏）、恶意广告、漏洞利用、恶意链接 |
| \*\*受灾影响\*\* | 所有文件都经过加密，如果不支付赎金就无法打开。其他密码窃取木马和恶意软件感染可以与勒索软件感染一起安装。 |
\*\*3.2 加密的测试文件\*\*
---------------
### \*\*文件名\*\*
sierting.txt
### \*\*具体内容：\*\*
![5.png](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2025/05/attach-124a015c006a5bd5da18b0f99242e4f0e28bee1e.png)
![6.png](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2025/05/attach-c98702b0d67e2ee6ed5a34cb479ac91687c6e230.png)
### \*\*加密文件名特征：\*\*
加密文件名 = 原始文件名+888 ，例如：sierting.txt.888
### \*\*加密文件数据特征：\*\*
![7.png](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2025/05/attach-d124cdc8c2bfb5ece8db3737ed461647f20ed941.png)
### \*\*加密算法：\*\*
#### \*\*AES密钥生成：\*\*
通过随机生成的两个guid来生成key和iv
### \*\*程序执行流程：\*\*
![8.png](https://cdn-yg-zzbm.yun.qianxin.com/attack-forum/2025/05/attach-c30bf596898f1ad7e56318c2c26e7c82b0d1e8a6.png)
\*\*4.逆向分析\*\*
==========
\*\*4.1加密器逆向分析\*\*
--------------
### \*\*勒索信密钥初始化\*\*
初始化了几个常量如下
5FC92AFFB28BE14BD3A8B1843E9F8E8BB394A50F7E3E599D0316E97D8B98BEDF
FC5A714EFBF1AE255D0071443A0D08FE70B2DE19F1F288115EDF3E6FA5263DBF
.888
AC11CD9E6DA7311B9804D8EB421DB7EFEC8ABB7EACC999CA64F3C7A99686E826
!RESTORE\\_FILES!.txt
9139F9BF04FB5ED3A8DF78E10110710C4134C2A37CBE912B6428B7FE19D22689
06FEECBAD923B75FA5B35A7A949C479AA67D838884BDA14963DC1903ACCD3E37
171C88018769B3D2B33D7065A162D3731ECEFB18A54054075A16614A468925B4
24AD21C4C3E2A430DF77EC0A190E2021976059732C696FADC61F62490E5EC202
B502B9C8546259BC27DAA82287C4ADA92A16B7A81665FAF9EFD20A4C3FD6233A
A9C3ED26735E74CC8939D5D7875BC9AEC04E5A91607BE48E6897CB7A96E1170D
45AB92864D45D54123C980CD245B31ED37A6EDDDF952A342CC5D9CB777B3942E
查找同路径下是否存在p.txt文件，如果有，则读取,并将读取到的内容进行sha256哈希计算之后再进行base64编码，然后再将此文件移动到`C:\Windows\Temp\!wwwGdddf#.txt`
\\_\\_int64 \\_\\_fastcall sub\\_7FF643B1AF70(\\_\\_int64 a1, \\_\\_int64 a2)
{
\\_\\_int64 v4; // rax
\\_\\_int64 v5; // rax
\\_\\_int64 v6; // rax
\\_\\_int64 v7; // rax
​
if ( !(unsignedint)S\\_P\\_CoreLib\\_System\\_IO\\_File\\_\\_Exists(a1) )
{
if ( (unsignedint)S\\_P\\_CoreLib\\_System\\_IO\\_File\\_\\_Exists(a2) )
{
if ( \\*(&amp;qword\\_7FF643BB5520 - 1) )
sub\\_7FF643A11806();
v6 = read\\_file(a2, \\*(\\_QWORD \\*)(qword\\_7FF643CDBB28 + 8));
v7 = sha256\\_base64(v6);
if ( v7 )
{
if ( \\*(\\_DWORD \\*)(v7 + 8) )
return v7;
}
}
return0i64;
}
if ( (unsignedint)S\\_P\\_CoreLib\\_System\\_IO\\_File\\_\\_Exists(a2) )
S\\_P\\_CoreLib\\_System\\_IO\\_File\\_\\_Delete(a2);
move\\_file(a1, a2, 0);
if ( \\*(&amp;qword\\_7FF643BB5520 - 1) )
sub\\_7FF643A11806();
v4 = read\\_file(a2, \\*(\\_QWORD \\*)(qword\\_7FF643CDBB28 + 8));
v5 = sha256\\_base64(v4);
if ( !v5 || !\\*(\\_DWORD \\*)(v5 + 8) )
return0i64;
return v5;
}
用于测试的p.txt的内容为sdjfpisjpdfajspfas\[pfpasjf计算后的结果为Yatspzm25UgfTLY0KDmz8Gi6SZVhA1tIk4HTqwpOBcs=
获取mac地址信息并转换为hex字符串
char \\*\\*sub\\_7FF643B1C6C0()
{
char \\*\\*v0; // rbx
\\_\\_int64 NetworkInterfaces; // rsi
int v2; // edi
int v3; // ebp
\\_\\_int64 \\*v4; // r14
\\_\\_int64 v5; // r15
\\_\\_int64 v6; // rcx
\\_\\_int64 v7; // rax
int v8; // edx
\\_\\_int64 v9; // rax
\\_\\_int64 v11; // \[rsp+28h\] \[rbp-40h\] BYREF
\\_\\_int64 v12; // \[rsp+30h\] \[rbp-38h\]
​
v11 = 0...