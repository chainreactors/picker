---
title: 【从微信收藏图片看微信存储详细记录】
url: https://mp.weixin.qq.com/s?__biz=MzAwNDcwMDgzMA==&mid=2651048035&idx=2&sn=99b7ca7374cd088313d2e11649f66258&chksm=80d08792b7a70e846dd5335f9a5646cc1f4d898014020ac9c01367b1bdba08f778ef5e5261b2&scene=58&subscene=0#rd
source: 电子物证
date: 2024-11-10
fetch_date: 2025-10-06T19:15:29.155880
---

# 【从微信收藏图片看微信存储详细记录】

![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/dDhDhftpRFtoojE71W5kZYhBkiafqGMKGeqFVvwlEl2iaSpiaDpgTbRVQIByYiaO1Aukiay6sFKuJlm0L0z9uWfSQKA/0?wx_fmt=jpeg)

# 【从微信收藏图片看微信存储详细记录】

电子物证

以下文章来源于DFIR蘇小沐
，作者蘇小沐

![](http://wx.qlogo.cn/mmhead/Q3auHgzwzM5Av6VrjsyXhexmyiae1FZu2sNibNbNiciaSvtSOg6dZ7icAkA/0)

**DFIR蘇小沐**
.

致力于电子数据取证（数字取证）与事件应急响应实战技术经验分享，计算机取证、手机取证、网络取证与犯罪调查、数据恢复、模糊图像增强、司法鉴定等技术研究【蘇小沐】

来源：[DFIR蘇小沐](https://mp.weixin.qq.com/s?__biz=MzI2MTUwNjI4Mw==&mid=2247488200&idx=1&sn=aebe23956e9326a0fe292abe46b224d6&scene=21#wechat_redirect)

**1**

**实验环境**

|  |
| --- |
| 电脑版微信，[v3.9.9.43] |
| JPG图片 |
| Windows 11 专业工作站版，[23H2（22631.3374）] |

1

**（一）**

**微信"收藏"图片的存储路径**

微信的全部收藏分类有"最近使用、链接、图片与视频、笔记、文件、语音、位置"等几大类（注意，有些类别没有收藏可能不会显示该类图标）

![](https://mmbiz.qpic.cn/mmbiz_png/g0qdRkVkqNxtRBia9M30DkMPeldz8cCpQkbF4qSBibgo4xYChXw9HNxm4CVrgbuef27fxVRw5iaibdticR2vgCxQ28g/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

2

**（二）**

**微信收藏的三大文件夹**

**看着这三大文件夹陷入了沉思，先猜测一下他们代表的意思，Data应该是存放数据之意；Temp是临时文件；Thumb是缩略图。先以这个思路分析下。**

![](https://mmbiz.qpic.cn/mmbiz_png/g0qdRkVkqNxtRBia9M30DkMPeldz8cCpQF9bdZqxoMAawTFicUTHbVyj9GELb8myIo8Dl17BLlkBic53m44CwyZHg/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

经过观察Data和Thumb文件下有许多子目录文件及他们两个文件下的文件都没有文件后缀，暂时直接看不出属于什么文件。（当然，有朋友可能会说，没有后缀看文件头不就行了？！对的，这方法可行，但先不说文件种类众多，他要是随便加个密我们验证也很难，我们还是先找找有没有其他突破口，越简便越好！）

**1**

**突破口：Temp文件夹，微信收藏图片直接存储在本地的文件路径**

为什么是突破口，因为Temp文件夹的层级关系最少，并且res文件夹存储的视频图像不加密，可以直接显示！！！

不同版本的文件夹"e5f90ce8"可能名称不同，一般"FileStorage\Fav\Temp"下只有一个文件夹，以本地记录的为准！然后进入到res文件夹即可查看到微信收藏缓存在本地的视频图像文件。

未点开收藏图片大图的情况，只会先缓存该图片的缩略图（缩略图很小，一般就几十KB）；点开大图的情况就会将收藏的图片缓存到该文件夹下面。

![](https://mmbiz.qpic.cn/mmbiz_png/g0qdRkVkqNxtRBia9M30DkMPeldz8cCpQmE5kjogRJPCmfpibibrfTCR6VDp4RnNW9bSkWcicLV4GeESAIAnNLfmpw/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

图片基本属性，一大一小。其中缩略图命名和大图的区别是名称多了一个"\_th"尾巴。（猜测th是英文单词thumbnail：缩略图）

![](https://mmbiz.qpic.cn/mmbiz_png/g0qdRkVkqNxtRBia9M30DkMPeldz8cCpQ5ImrCxcXmeA2064uiaUTicyhibFTaKzQ2Y6kYvnOlKJkAPib6qZXFxRcpg/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

根据微信的尿性，你以为到这就结束了吗？NoNoNo，我们试着继续挖挖看。

**2**

**名称索引挖掘**

试下这个名称，看看有没有什么突破点，搜索"9d4a2070a50ed3df8b7dbefdaea48cb0"，一共找到四个同名文件，其中两个的路径分别在"\Fav\Data\9d"、"\Fav\Thumb\9d"下面。

![](https://mmbiz.qpic.cn/mmbiz_png/g0qdRkVkqNxtRBia9M30DkMPeldz8cCpQotT2WhCIv61aPcvOnpnBpBFBpJg0ic0wr8oCV6IS07xiaxeM5EJOdltg/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

发现大小分别对应该两个文件的大小，假设一下这两个就是文件夹的加密文件，而微信聊天图片一般是Dat加密，我们来测试下，看看是否能解密。

![](https://mmbiz.qpic.cn/mmbiz_png/g0qdRkVkqNxtRBia9M30DkMPeldz8cCpQzTgx7c3nSY2hQ5XESiak45w5zAicd7GHya7q4xibz6Yn6UgtFG3T0Wv5w/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

找到收藏中图片大图的缓存文件位置，发现无文件后缀显示。

【路径：\WeChat Files\【微信ID】\FileStorage\Fav\Data\9d】

![](https://mmbiz.qpic.cn/mmbiz_png/g0qdRkVkqNxtRBia9M30DkMPeldz8cCpQ4RYJzJDnMblxeGb8cCQn8ohh4Oz3jbF4nRLPEVOqeZEgjvzncaFUlA/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

收藏的图片另存本地和Temp下的JPG大图片对比，哈希值相同。

![](https://mmbiz.qpic.cn/mmbiz_png/g0qdRkVkqNxtRBia9M30DkMPeldz8cCpQbWZX2ubWbCyDeK53J9vgZevODooUbvNaq4qtobTyuA0MGGFlcBEWlA/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**3**

**解密无后缀大文件**

发现疑似没有没有后缀，搜索

发现虽然收藏存储到本地的图片并没有文件后缀，但其文件哈希和"微信电脑端接收到的原图"生成的Dat文件哈希一致！！！

![](https://mmbiz.qpic.cn/mmbiz_png/g0qdRkVkqNxtRBia9M30DkMPeldz8cCpQjUoz2tN3pJscH8zhF7Jn64ibYYDQ1IquxHMEmHMT2Zj10f6ibATXwjOQ/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

结果另存为JPG图片，并和"微信电脑端接收到的原图"校验，结果一致

![](https://mmbiz.qpic.cn/mmbiz_png/g0qdRkVkqNxtRBia9M30DkMPeldz8cCpQoCP6XOJNoguBy8FUcVvV1umsDPC4RtHIVvPWARpWuB7SKr3RceshFQ/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**4**

**三大存储路径**

同理按Dat格式解密小文件成图片，解密结果对比和缩略图的哈希相同。

【路径：\WeChat Files\【微信ID】\FileStorage\Fav\Thumb\9d】

![](https://mmbiz.qpic.cn/mmbiz_png/g0qdRkVkqNxtRBia9M30DkMPeldz8cCpQeRbuDIqsgu4IIee7Kt6H2ZUjdINSX6Wo5pmbuLPUiclkmoyiaJKGd17Q/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

3

**（三）**

**微信收藏图片思维导图小结**

**微信收藏的图片另存的大小和缓存的图片大小一致，但和转发出去的图片又不一样。**

**文件大小：另存图片=大图缓存>转发图片>小图缓存。**

![](https://mmbiz.qpic.cn/mmbiz_png/g0qdRkVkqNyQmaeBgO8KSOxVTCQ23x0JFB3ibjZtWAbHhToFACJia5YtaW75calddhibMcAyNQlXJibRFsyZhUTicJQ/640?wx_fmt=other&from=appmsg&random=0.30326402096935623&random=0.707309789824986&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

![](https://mmbiz.qpic.cn/mmbiz_png/DRPKCGMAPjKpEd17cIAtSYeR2WeS9b2iam1NKxicAIgXmiaUTUIxib1sZ0sia2Tic788qW6kIuV4H7ofbh16ic9xZmevQ/640?wx_fmt=other&random=0.996556471146399&random=0.9860794955135128&random=0.8347373269248999&random=0.9105563971063932&random=0.6139662865626312&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

总结

![](https://mmbiz.qpic.cn/mmbiz_png/DRPKCGMAPjKpEd17cIAtSYeR2WeS9b2iagsia9cqFp8NNK0ibeplhzgHhMw1FOkb6mCSGbpTPYyBP3xq1WGkpIlRQ/640?wx_fmt=other&random=0.3448522475991753&random=0.03930942131225201&random=0.13319400789048785&random=0.14508789852815873&random=0.16550076118609613&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**微信收藏的图片会稍微特殊一点：**

**预览小图会缓存两个文件在本地，第一个是可以直接查看的图片格式（小图）；第二个是无后缀的文件格式，按照Dat解密后会和第一个图片哈希值相同。**

![](https://mmbiz.qpic.cn/sz_mmbiz_gif/dDhDhftpRFtoojE71W5kZYhBkiafqGMKGyiaibfpBWtYa7ghhC6Ztp90ZAfUcKibElqthnbNqz63iaicdLc8h1vFT0ibQ/640?wx_fmt=gif&from=appmsg)

预览时标签不可点

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/dDhDhftpRFuouuxbQ44msKkdjic0C8WOQrHEN6rex1hiblHTTIpApR8safvHvB9zXorQTMStvvyN2zO8xjOJd5vg/0?wx_fmt=png)

电子物证

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/dDhDhftpRFuouuxbQ44msKkdjic0C8WOQrHEN6rex1hiblHTTIpApR8safvHvB9zXorQTMStvvyN2zO8xjOJd5vg/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过