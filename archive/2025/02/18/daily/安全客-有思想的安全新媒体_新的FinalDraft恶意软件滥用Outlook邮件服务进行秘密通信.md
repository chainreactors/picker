---
title: 新的FinalDraft恶意软件滥用Outlook邮件服务进行秘密通信
url: https://www.anquanke.com/post/id/304382
source: 安全客-有思想的安全新媒体
date: 2025-02-18
fetch_date: 2025-10-06T20:36:08.472271
---

# 新的FinalDraft恶意软件滥用Outlook邮件服务进行秘密通信

йҰ–йЎө

йҳ…иҜ»

* [е®үе…Ёиө„и®Ҝ](https://www.anquanke.com/news)
* [е®үе…ЁзҹҘиҜҶ](https://www.anquanke.com/knowledge)
* [е®үе…Ёе·Ҙе…·](https://www.anquanke.com/tool)

жҙ»еҠЁ

зӨҫеҢә

еӯҰйҷў

е®үе…ЁеҜјиҲӘ

еҶ…е®№зІҫйҖү

* [дё“ж Ҹ](/column/index.html)
* [зІҫйҖүдё“йўҳ](https://www.anquanke.com/subject-list)
* [е®үе…ЁKERеӯЈеҲҠ](https://www.anquanke.com/discovery)
* [360зҪ‘з»ңе®үе…Ёе‘ЁжҠҘ](https://www.anquanke.com/week-list)

# ж–°зҡ„FinalDraftжҒ¶ж„ҸиҪҜд»¶ж»Ҙз”ЁOutlookйӮ®д»¶жңҚеҠЎиҝӣиЎҢз§ҳеҜҶйҖҡдҝЎ

йҳ…иҜ»йҮҸ**53574**

еҸ‘еёғж—¶й—ҙ : 2025-02-17 10:59:42

**x**

##### иҜ‘ж–ҮеЈ°жҳҺ

жң¬ж–ҮжҳҜзҝ»иҜ‘ж–Үз« пјҢж–Үз« еҺҹдҪңиҖ… Bill ToulasпјҢж–Үз« жқҘжәҗпјҡbleepingcomputer

еҺҹж–Үең°еқҖпјҡ<https://www.bleepingcomputer.com/news/security/new-finaldraft-malware-abuses-outlook-mail-service-for-stealthy-comms/>

иҜ‘ж–Үд»…дҫӣеҸӮиҖғпјҢе…·дҪ“еҶ…е®№иЎЁиҫҫд»ҘеҸҠеҗ«д№үеҺҹж–ҮдёәеҮҶгҖӮ

![New FinalDraft malware abuses Outlook mail service for stealthy comms]()

дёҖз§ҚеҗҚдёә вҖңжңҖз»ҲиҚүзЁҝпјҲFinalDraftпјүвҖқ зҡ„ж–°еһӢжҒ¶ж„ҸиҪҜд»¶пјҢеңЁеҜ№еҚ—зҫҺжҙІжҹҗеӣҪдёҖдёӘж”ҝеәңйғЁй—Ёзҡ„ж”»еҮ»дёӯпјҢеҲ©з”Ё Outlook з”өеӯҗйӮ®д»¶иҚүзЁҝиҝӣиЎҢе‘Ҫд»ӨдёҺжҺ§еҲ¶йҖҡдҝЎгҖӮ

иҝҷдәӣж”»еҮ»жҳҜз”ұ Elastic е®үе…Ёе®һйӘҢе®ӨеҸ‘зҺ°зҡ„пјҢж”»еҮ»иҖ…дҪҝз”ЁдәҶдёҖеҘ—е®Ңж•ҙзҡ„е·Ҙе…·йӣҶпјҢе…¶дёӯеҢ…жӢ¬дёҖдёӘеҗҚдёә вҖңи·Ҝеҫ„еҠ иҪҪеҷЁпјҲPathLoaderпјүвҖқ зҡ„иҮӘе®ҡд№үжҒ¶ж„ҸиҪҜд»¶еҠ иҪҪеҷЁгҖҒвҖңжңҖз»ҲиҚүзЁҝвҖқ еҗҺй—ЁзЁӢеәҸпјҢд»ҘеҸҠеӨҡдёӘж”»еҮ»еҗҺеҲ©з”Ёе·Ҙе…·гҖӮ

еңЁиҝҷз§Қжғ…еҶөдёӢпјҢеҜ№ Outlook зҡ„ж»Ҙз”Ёж—ЁеңЁе®һзҺ°йҡҗи”ҪйҖҡдҝЎпјҢдҪҝж”»еҮ»иҖ…иғҪеӨҹеңЁе°ҪеҸҜиғҪе°‘з•ҷдёӢз—•иҝ№зҡ„еҗҢж—¶пјҢиҝӣиЎҢж•°жҚ®зӘғеҸ–гҖҒд»ЈзҗҶгҖҒиҝӣзЁӢжіЁе…Ҙе’ҢжЁӘеҗ‘з§»еҠЁгҖӮ

**ж”»еҮ»й“ҫ**

ж”»еҮ»е§ӢдәҺеЁҒиғҒиЎҢдёәиҖ…дҪҝз”Ё вҖңи·Ҝеҫ„еҠ иҪҪеҷЁвҖқ е…Ҙдҫөзӣ®ж Үзі»з»ҹпјҢвҖңи·Ҝеҫ„еҠ иҪҪеҷЁвҖқ жҳҜдёҖдёӘе°ҸеһӢеҸҜжү§иЎҢж–Үд»¶пјҢе®ғдјҡжү§иЎҢд»Һж”»еҮ»иҖ…еҹәзЎҖи®ҫж–ҪиҺ·еҸ–зҡ„еӨ–еЈід»Јз ҒпјҢе…¶дёӯеҢ…жӢ¬ вҖңжңҖз»ҲиҚүзЁҝвҖқ жҒ¶ж„ҸиҪҜд»¶гҖӮ

вҖңи·Ҝеҫ„еҠ иҪҪеҷЁвҖқ йҖҡиҝҮжү§иЎҢ API е“ҲеёҢеӨ„зҗҶе’ҢдҪҝз”Ёеӯ—з¬ҰдёІеҠ еҜҶжқҘйҳІиҢғйқҷжҖҒеҲҶжһҗгҖӮ

вҖңжңҖз»ҲиҚүзЁҝвҖқ иў«з”ЁдәҺж•°жҚ®зӘғеҸ–е’ҢиҝӣзЁӢжіЁе…ҘгҖӮеңЁеҠ иҪҪй…ҚзҪ®е№¶з”ҹжҲҗдјҡиҜқ ID еҗҺпјҢиҜҘжҒ¶ж„ҸиҪҜд»¶йҖҡиҝҮеҫ®иҪҜеӣҫеҪў APIпјҲMicrosoft Graph APIпјүе»әз«ӢйҖҡдҝЎпјҢж–№ејҸжҳҜйҖҡиҝҮ Outlook з”өеӯҗйӮ®д»¶иҚүзЁҝеҸ‘йҖҒе’ҢжҺҘж”¶е‘Ҫд»ӨгҖӮ

вҖңжңҖз»ҲиҚүзЁҝвҖқ дҪҝз”ЁеөҢе…ҘеңЁе…¶й…ҚзҪ®дёӯзҡ„еҲ·ж–°д»ӨзүҢд»Һеҫ®иҪҜиҺ·еҸ–дёҖдёӘ OAuth д»ӨзүҢпјҢе№¶е°Ҷе…¶еӯҳеӮЁеңЁ Windows жіЁеҶҢиЎЁдёӯпјҢд»ҘдҫҝжҢҒз»ӯи®ҝй—®гҖӮ

![Token stored in Registry]()

еӯҳеӮЁеңЁ Windows жіЁеҶҢиЎЁдёӯзҡ„д»ӨзүҢ
жқҘжәҗпјҡElastic е®үе…Ёе…¬еҸё

йҖҡиҝҮдҪҝз”Ё Outlook иҚүзЁҝиҖҢдёҚжҳҜеҸ‘йҖҒз”өеӯҗйӮ®д»¶пјҢе®ғиғҪеӨҹйҒҝе…Қиў«жЈҖжөӢеҲ°пјҢе№¶ж··е…ҘжӯЈеёёзҡ„еҫ®иҪҜ 365 жөҒйҮҸдёӯгҖӮ

ж”»еҮ»иҖ…зҡ„е‘Ҫд»Өйҡҗи—ҸеңЁиҚүзЁҝпјҲr\_< дјҡиҜқ ID>пјүдёӯпјҢиҖҢе“Қеә”еҲҷеӯҳеӮЁеңЁж–°зҡ„иҚүзЁҝпјҲp\_< дјҡиҜқ ID>пјүдёӯгҖӮжү§иЎҢе‘Ҫд»ӨеҗҺпјҢиҚүзЁҝе‘Ҫд»Өдјҡиў«еҲ йҷӨпјҢиҝҷдҪҝеҫ—еҸ–иҜҒеҲҶжһҗжӣҙеҠ еӣ°йҡҫпјҢд№ҹжӣҙдёҚе®№жҳ“иў«жЈҖжөӢеҲ°гҖӮ

вҖңжңҖз»ҲиҚүзЁҝвҖқ жҖ»е…ұж”ҜжҢҒ 37 жқЎе‘Ҫд»ӨпјҢе…¶дёӯжңҖйҮҚиҰҒзҡ„еҢ…жӢ¬пјҡ

1.ж•°жҚ®зӘғеҸ–пјҲж–Үд»¶гҖҒеҮӯиҜҒгҖҒзі»з»ҹдҝЎжҒҜпјү

2.иҝӣзЁӢжіЁе…ҘпјҲеңЁеҰӮexe зӯүеҗҲжі•иҝӣзЁӢдёӯиҝҗиЎҢжңүж•ҲиҪҪиҚ·пјү

3.е“ҲеёҢдј йҖ’ж”»еҮ»пјҲзӘғеҸ–иә«д»ҪйӘҢиҜҒеҮӯиҜҒд»ҘиҝӣиЎҢжЁӘеҗ‘з§»еҠЁпјү

4.зҪ‘з»ңд»ЈзҗҶпјҲеҲӣе»әйҡҗи”ҪзҪ‘з»ңйҡ§йҒ“пјү

5.ж–Үд»¶ж“ҚдҪңпјҲеӨҚеҲ¶гҖҒеҲ йҷӨжҲ–иҰҶзӣ–ж–Үд»¶пјү

6.PowerShell жү§иЎҢпјҲж— йңҖеҗҜеҠЁ powershell.exeпјү

Elastic е®үе…Ёе®һйӘҢе®ӨиҝҳеҸ‘зҺ°дәҶ вҖңжңҖз»ҲиҚүзЁҝвҖқ зҡ„ Linux зүҲжң¬пјҢиҜҘзүҲжң¬д»ҚеҸҜйҖҡиҝҮ REST API е’Ңеҫ®иҪҜеӣҫеҪў API дҪҝз”Ё OutlookпјҢеҗҢж—¶д№ҹж”ҜжҢҒйҖҡиҝҮ HTTP/HTTPSгҖҒеҸҚеҗ‘ UDP дёҺ ICMPгҖҒз»‘е®ҡ / еҸҚеҗ‘ TCP д»ҘеҸҠеҹәдәҺ DNS зҡ„е‘Ҫд»ӨдёҺжҺ§еҲ¶пјҲC2пјүйҖҡдҝЎгҖӮ

![FinalDraft operational overview]()

вҖңжңҖз»ҲиҚүзЁҝвҖқпјҲFinalDraftпјүиҝҗиЎҢжҰӮиҝ°
жқҘжәҗпјҡElastic е®үе…Ёе…¬еҸё

з ”з©¶дәәе‘ҳеңЁеҸҰдёҖд»ҪжҠҘе‘Ҡдёӯд»Ӣз»ҚдәҶиҝҷеңәиў«з§°дёә REF7707 зҡ„ж”»еҮ»жҙ»еҠЁпјҢжҠҘе‘ҠдёӯжҸҸиҝ°дәҶдёҖдәӣдёҺжүҖдҪҝз”Ёзҡ„й«ҳзә§е…ҘдҫөжүӢж®өзӣёжӮ–зҡ„ж“ҚдҪңе®үе…ЁеӨұиҜҜпјҢжӯЈжҳҜиҝҷдәӣеӨұиҜҜеҜјиҮҙж”»еҮ»иҖ…жҡҙйңІдәҶиЎҢиёӘгҖӮ

REF7707 жҳҜдёҖеңәй’ҲеҜ№еҚ—зҫҺжҙІжҹҗеӣҪеӨ–дәӨйғЁзҡ„зҪ‘з»ңй—ҙи°Қжҙ»еҠЁпјҢдҪҶеҜ№е…¶еҹәзЎҖи®ҫж–Ҫзҡ„еҲҶжһҗжҳҫзӨәпјҢиҜҘжҙ»еҠЁдёҺдёңеҚ—дәҡзҡ„еҸ—е®іиҖ…еӯҳеңЁе…іиҒ”пјҢиҝҷиЎЁжҳҺиҝҷеҸҜиғҪжҳҜдёҖеңәиҢғеӣҙжӣҙе№ҝзҡ„иЎҢеҠЁгҖӮ

и°ғжҹҘиҝҳеҸ‘зҺ°дәҶеңЁж”»еҮ»дёӯдҪҝз”Ёзҡ„еҸҰдёҖз§ҚжӯӨеүҚжңӘиў«и®°еҪ•зҡ„жҒ¶ж„ҸиҪҜд»¶еҠ иҪҪеҷЁпјҢеҗҚдёә вҖңGuidLoaderвҖқпјҢе®ғиғҪеӨҹеңЁеҶ…еӯҳдёӯи§ЈеҜҶе№¶жү§иЎҢжңүж•ҲиҪҪиҚ·гҖӮ

![REF7077 malware timeline]()

REF7077 жҒ¶ж„ҸиҪҜд»¶дәӢд»¶ж—¶й—ҙзәҝ
жқҘжәҗпјҡElastic е®үе…Ёе…¬еҸё

иҝӣдёҖжӯҘзҡ„еҲҶжһҗиЎЁжҳҺпјҢж”»еҮ»иҖ…йҖҡиҝҮе…ҘдҫөдёңеҚ—дәҡзҡ„з”өдҝЎе’Ңдә’иҒ”зҪ‘еҹәзЎҖи®ҫж–ҪжҸҗдҫӣе•Ҷзҡ„з«ҜзӮ№пјҢеҸҚеӨҚзһ„еҮҶй«ҳд»·еҖјжңәжһ„гҖӮ

жӯӨеӨ–пјҢдёңеҚ—дәҡдёҖжүҖеӨ§еӯҰзҡ„йқўеҗ‘е…¬дј—зҡ„еӯҳеӮЁзі»з»ҹиў«з”ЁдәҺжүҳз®ЎжҒ¶ж„ҸиҪҜд»¶жңүж•ҲиҪҪиҚ·пјҢиҝҷиЎЁжҳҺиҜҘзі»з»ҹжӯӨеүҚеҸҜиғҪе·Іиў«ж”»з ҙпјҢжҲ–иҖ…ж”»еҮ»иҖ…еңЁдҫӣеә”й“ҫдёӯе»әз«ӢдәҶз«Ӣи¶ізӮ№гҖӮ

Elastic зҡ„жҠҘе‘Ҡ [1, 2] еә•йғЁжҸҗдҫӣдәҶз”ЁдәҺеё®еҠ©йҳІеҫЎиҖ…жЈҖжөӢ вҖңGuidLoaderвҖқвҖңи·Ҝеҫ„еҠ иҪҪеҷЁвҖқ е’Ң вҖңжңҖз»ҲиҚүзЁҝвҖқ зҡ„ YARA и§„еҲҷгҖӮ

В

жң¬ж–Үзҝ»иҜ‘иҮӘbleepingcomputer [еҺҹж–Үй“ҫжҺҘ](https://www.bleepingcomputer.com/news/security/new-finaldraft-malware-abuses-outlook-mail-service-for-stealthy-comms/)гҖӮеҰӮиӢҘиҪ¬иҪҪиҜ·жіЁжҳҺеҮәеӨ„гҖӮ

е•ҶеҠЎеҗҲдҪңпјҢж–Үз« еҸ‘еёғиҜ·иҒ”зі» anquanke@360.cn

жң¬ж–Үз”ұ**е®үе…Ёе®ў**еҺҹеҲӣеҸ‘еёғ

иҪ¬иҪҪпјҢиҜ·еҸӮиҖғ[иҪ¬иҪҪеЈ°жҳҺ](https://www.anquanke.com/note/repost)пјҢжіЁжҳҺеҮәеӨ„пјҡ [https://www.anquanke.com/post/id/304382](/post/id/304382)

е®үе…ЁKER - жңүжҖқжғізҡ„е®үе…Ёж–°еӘ’дҪ“

жң¬ж–ҮиҪ¬иҪҪиҮӘ: [bleepingcomputer](https://www.bleepingcomputer.com/news/security/new-finaldraft-malware-abuses-outlook-mail-service-for-stealthy-comms/)

еҰӮиӢҘиҪ¬иҪҪ,иҜ·жіЁжҳҺеҮәеӨ„пјҡ <https://www.bleepingcomputer.com/news/security/new-finaldraft-malware-abuses-outlook-mail-service-for-stealthy-comms/>

е®үе…ЁKER - жңүжҖқжғізҡ„е®үе…Ёж–°еӘ’дҪ“

еҲҶдә«еҲ°пјҡ![еҫ®дҝЎ](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

* [зҪ‘з»ңж”»еҮ»](/tag/%D0%B7%D2%AA%E2%80%98%D0%B7%C2%BB%D2%A3%D0%B6%E2%80%9D%C2%BB%D0%B5%D2%AE%C2%BB)

**+1**0иөһ

ж”¶и—Ҹ

![](https://p5.ssl.qhimg.com/t010857340ce46bb672.jpg)е®үе…Ёе®ў

еҲҶдә«еҲ°пјҡ![еҫ®дҝЎ](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

## еҸ‘иЎЁиҜ„и®ә

жӮЁиҝҳжңӘзҷ»еҪ•пјҢиҜ·е…Ҳзҷ»еҪ•гҖӮ

[зҷ»еҪ•](/login/index.html)

![](https://p5.ssl.qhimg.com/t014757b72460d855bf.png)

[![](https://p5.ssl.qhimg.com/t010857340ce46bb672.jpg)](/member.html?memberId=170061)

[е®үе…Ёе®ў](/member.html?memberId=170061)

иҝҷдёӘдәәеӨӘжҮ’дәҶпјҢзӯҫеҗҚйғҪжҮ’еҫ—еҶҷдёҖдёӘ

* ж–Үз«
* **2096**

* зІүдёқ
* **6**

### TAзҡ„ж–Үз«

* ##### [иӢұеӣҪйҖҡиҝҮж•°жҚ®и®ҝй—®е’ҢдҪҝз”Ёзӣ‘з®Ўжі•жЎҲ](/post/id/308719)

  2025-06-20 17:11:10
* ##### [CISAиӯҰе‘ҠпјҡдёҘйҮҚзјәйҷ·пјҲCVE-2025-5310пјүжҡҙйңІеҠ жІ№з«ҷи®ҫеӨҮ](/post/id/308715)

  2025-06-20 17:09:03
* ##### [еӨ§еӨҡж•°е…¬еҸёй«ҳдј°дәҶAIжІ»зҗҶпјҢеӣ дёәйҡҗз§ҒйЈҺйҷ©жҝҖеўһ](/post/id/308708)

  2025-06-20 17:05:02
* ##### [з ”з©¶дәәе‘ҳеҸ‘зҺ°дәҶжңүеҸІд»ҘжқҘжңҖеӨ§зҡ„ж•°жҚ®жі„йңІдәӢд»¶пјҢжҡҙйңІдәҶ160дәҝдёӘзҷ»еҪ•еҮӯиҜҒ](/post/id/308704)

  2025-06-20 17:02:15
* ##### [CVE-2025-6018е’ҢCVE-2025-6019жјҸжҙһеҲ©з”Ёпјҡй“ҫжҺҘжң¬ең°зү№жқғеҚҮзә§зјәйҷ·и®©ж”»еҮ»иҖ…иҺ·еҫ—еӨ§еӨҡж•°LinuxеҸ‘иЎҢзүҲзҡ„ж №и®ҝй—®жқғйҷҗ](/post/id/308701)

  2025-06-20 16:59:36

### зӣёе…іж–Үз«

* ##### [Morteеғөе°ёзҪ‘з»ңиў«жҠ«йңІпјҡжӯЈеҲ©з”Ёи·Ҝз”ұеҷЁдёҺдјҒдёҡеә”з”ЁжјҸжҙһпјҢиҝ…йҖҹжү©еј е…¶вҖңеҠ иҪҪеҷЁеҚіжңҚеҠЎвҖқжҙ»еҠЁ](/post/id/312444)

  2025-09-29 18:04:01
* ##### [AkiraеӢ’зҙўиҪҜд»¶еҲ©з”ЁSonicWall VPNиҙҰжҲ·еҸ‘иө·жҖҘйҖҹе…Ҙдҫө](/post/id/312438)

  2025-09-29 18:03:28
* ##### [DarkCloudдҝЎжҒҜзӘғеҸ–еҷЁзҺ°ж–°еҸҳз§ҚпјҡйҮҮз”ЁVB6ж··ж·ҶжҠҖжңҜе№¶ж–°еўһеҠ еҜҶиҙ§еёҒй’ұеҢ…зӘғеҸ–еҠҹиғҪпјҢеЁҒиғҒжҳҫи‘—еҚҮзә§](/post/id/312435)

  2025-09-29 18:02:53
* ##### [TamperedChefжҒ¶ж„ҸиҪҜд»¶е…ҙиө·пјҡж¬әиҜҲеә”з”ЁеҲ©з”Ёз»ҸиҝҮзӯҫеҗҚзҡ„дәҢиҝӣеҲ¶ж–Үд»¶дёҺжҗңзҙўеј•ж“ҺжҠ•жҜ’еҠ«жҢҒжөҸи§ҲеҷЁ](/post/id/312432)

  2025-09-29 18:02:25
* ##### [й»‘е®ўе°ҶSVGж–Үд»¶жӯҰеҷЁеҢ–пјҢз”ЁдәҺйҡҗз§ҳжҠ•йҖ’жҒ¶ж„ҸиҙҹиҪҪ](/post/id/312351)

  2025-09-24 16:44:10
* ##### [ShadowV2еғөе°ёзҪ‘з»ңеҲ©з”Ёй…ҚзҪ®й”ҷиҜҜзҡ„AWS Dockerе®№еҷЁжһ„е»әDDoSж”»еҮ»з§ҹз”ЁжңҚеҠЎ](/post/id/312381)

  2025-09-24 16:40:43
* ##### [npmиҪҜд»¶еҢ…вҖңfezboxвҖқдёӯиў«еҸ‘зҺ°ж–°еһӢжҒ¶ж„ҸиҪҜд»¶пјҢеҸҜеҲ©з”...