---
title: CVE-2023-39143: PaperCut Path Traversal/File Upload RCE Vulnerability
url: https://buaq.net/go-173700.html
source: unSafe.sh - 不安全
date: 2023-08-05
fetch_date: 2025-10-04T12:00:13.336495
---

# CVE-2023-39143: PaperCut Path Traversal/File Upload RCE Vulnerability

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/f6588be305e526abc91de80689d6ec4b.jpg)

CVE-2023-39143: PaperCut Path Traversal/File Upload RCE Vulnerability

SummaryCVE-2023-39143 is a critical vulnerability we disclo
*2023-8-4 21:10:14
Author: [www.horizon3.ai(查看原文)](/jump-173700.htm)
阅读量:93
收藏*

---

![]( "CVE-2023-39143: PaperCut Path Traversal/File Upload RCE Vulnerability")

## Summary

[CVE-2023-39143](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39143) is a critical vulnerability we disclosed to PaperCut that affects the widely used PaperCut NG/MF print management software. It affects PaperCut NG/MF running on Windows, prior to version 22.1.3. If you are a user of PaperCut on Windows, and have it exposed to the Internet, we recommend you check out the [July 2023 PaperCut security bulletin](https://www.papercut.com/kb/Main/securitybulletinjuly2023/) and immediately patch to the latest version if you haven’t already.

## Impact

CVE-2023-39143 enables unauthenticated attackers to potentially read, delete, and upload arbitrary files to the PaperCut MF/NG application server, resulting in remote code execution in certain configurations.

In particular, the vulnerability affects PaperCut servers running on Windows. File upload leading to remote code execution is possible when the external device integration setting is enabled. This setting is on by default with certain installations of PaperCut, such as the PaperCut NG Commercial version or PaperCut MF.

Based on sample data we have collected at Horizon3 from real-world environments, we estimate that the vast majority of PaperCut installations are running on Windows with the external device integration setting turned on.

## Exploitability

PaperCut has been on the radar of threat actors. Threat actors launched campaigns earlier this year targeting PaperCut servers vulnerable to [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350), a previously disclosed unauthenticated remote code execution vulnerability.

Compared to CVE-2023-27350, CVE-2023-39143 also does not require attackers to have any prior privileges to exploit, and no user interaction is required.

In contrast to CVE-2023-27350, CVE-2023-39143 is more complex to exploit, involving multiple issues that must be chained together to compromise a server. It is not a “one-shot” RCE vulnerability.

## Detection

The following command checks if a PaperCut server is not patched and running on Windows.

```
curl -w "%{http_code}" -k --path-as-is "https://<IP>:<port>/custom-report-example/..\..\..\deployment\sharp\icons\home-app.png"
```

A 200 response indicates the server has not been patched and is running on Windows. A 404 response indicates the server has been patched or not running on Windows.

![](data:image/svg+xml...)

We are not releasing further details at this time to provide users adequate time to upgrade.

## Remediation

We recommend upgrading to the latest PaperCut NG/MF version, 22.1.3 as of this writing.

If upgrading is not possible, it is possible to mitigate this vulnerability by configuring an allowlist of device IP addresses that are permitted to communicate with the PaperCut server. Refer to the “IP Address Allow-listing” section of the [PaperCut security best practices guide](https://www.papercut.com/kb/Main/SecureYourPaperCutServer/).

## Timeline

* May 30, 2023: Horizon3 sends initial disclosure to the PaperCut team
* May 31, 2023: PaperCut acknowledges receipt of disclosure
* June 5, 2023: Horizon3 updates disclosure to include impact of remote code execution
* June 8, 2023: PaperCut confirms it is able to validate findings in disclosure
* June/July 2023: Horizon3/PaperCut work together to test interim builds and coordinate disclosure
* July 24, 2023: Horizon3 reserves CVE-2023-39143 with MITRE
* July 25, 2023: PaperCut releases patch version 22.1.3
* Aug. 4, 2023: This advisory

We’d like to extend our thanks to the PaperCut team for their prompt response and close collaboration to address this vulnerability.

## References

文章来源: https://www.horizon3.ai/cve-2023-39143-papercut-path-traversal-file-upload-rce-vulnerability/
 如有侵权请联系:admin#unsafe.sh

© [unSafe.sh - 不安全](https://unsafe.sh) Powered By [PaperCache](https://github.com/code-scan/PaperCache)

* admin#unsafe.sh
* [安全马克](https://aq.mk)
* [星际黑客](https://xj.hk)
* [T00ls](https://t00ls.net)