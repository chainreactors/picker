---
title: Detecting Packet Sniffing Malware on Linux
url: https://sandflysecurity.com/blog/detecting-packet-sniffing-malware-on-linux
source: Sandfly Security Blog RSS Feed
date: 2025-06-17
fetch_date: 2025-10-06T22:54:06.076084
---

# Detecting Packet Sniffing Malware on Linux

[Sandfly 5.5.4 - Chinese/Korean Rootkit Decloaking. Learn more](/blog/sandfly-5-5-4-north-korean-rootkit-decloaking)

[Partners](/about-us/partner)[Support](/support)[Contact Us](/contact-us)

PlatformWhy SandflyResourcesAbout[Blog](/blog)[Get Sandfly](/get-sandfly)

Sandfly Blog

# Detecting Packet Sniffing Malware on Linux

16 June 2025

Malware

Packet sniffing on Linux can be used for a variety of legitimate reasons, but sometimes it's used by malware for traffic monitoring to steal information and activate covert backdoors. In this article we're going to show you how to search the */proc/net/packet* file on your Linux systems to find suspicious processes that may be grabbing traffic.

### Using the /proc/net Directory to Find Network Activity

On Linux the */proc/net* directory contains many files that describe various network protocols in use and what is using them. For instance you can see all open TCP or UDP sockets by looking at */proc/net/tcp* or */proc/net/udp*. Or, you can view lower level activity using raw sockets to grab network traffic with */proc/net/packet*.

For this article we'll look at the */proc/net/packet* file. This file shows you all raw or packet network sockets sniffing traffic. This can allow you to find legitimate, but also illegitimate, processes that are grabbing network packets. More importantly, it also allows you to find processes that may be hiding this activity from detection.

Below we see a sample of the */proc/net/packet* file.

![](data:image/svg+xml;base64...)![](data:image/jpeg;base64...)![/proc/net/packet showing sniffer activity on Linux.](https://www.datocms-assets.com/56687/1750102704-proc-net-packet-raw.png?auto=format&dpr=2&q=60&w=920 "/proc/net/packet showing sniffer activity on Linux.")

While */proc/net/packet* is handy to check for rogue sniffers, the file only shows you open [inodes](https://en.wikipedia.org/wiki/Inode) and who owns them. It doesn't list the processes doing the deed which means we need to figure that out in a separate step. For example, the sample above actually shows two malicious sniffing processes. Below we've identified one with red arrows.

![](data:image/svg+xml;base64...)![](data:image/jpeg;base64...)![/proc/net/packet with malicious sniffers on Linux.](https://www.datocms-assets.com/56687/1750102772-proc-net-packet-annotated.png?auto=format&dpr=2&q=60&w=920 "/proc/net/packet with malicious sniffers on Linux.")

### Connecting an Open Inode to Active Process

While the sample above shows us open inodes, this isn't useful by itself. We actually need to find out what processes have those inodes open. This reveals what processes are grabbing network traffic. This is tedious to do by hand, so we made a script ([available below and here](https://github.com/sandflysecurity/sandfly-forensic-scripts/tree/main/list-packet-sniffers)) to do it for you. The output when run shows all processes sniffing traffic. Below we see our two malicious processes after running our script.

![](data:image/svg+xml;base64...)![](data:image/jpeg;base64...)![Finding malicious sniffers on Linux.](https://www.datocms-assets.com/56687/1750102852-list-packet-sniffers-output-annotated.png?auto=format&dpr=2&q=60&w=920 "Finding malicious sniffers on Linux.")

Note that there are legitimate reasons to grab traffic such as monitoring for DHCP, routing protocols, etc. You will need to learn what is normal for your Linux hosts and what is not.

Above we see two *systemd* processes with open raw sockets grabbing network traffic (often network discovery protocols). However, we have two suspicious processes. One being "*kthread*" and the other "*dbus-daemon*" are both outliers. They are not normally seen grabbing network traffic and need investigation.

### Using lsof to Find a Packet Sniffer

If you are investigating a Linux host and see a suspicious process, you can use *lsof -p <PID>* (Process ID)to list a process to see if it has an open packet socket. This is handy if *lsof* is installed already, but there are some caveats. First of all it may not be installed. We don't recommend installing any new tools on systems you are investigating either as it may damage evidence. Second of all, some malware has been known to hide from tools like *lsof* so there is a chance it may not show anything.

However in this case, we run *lsof -p 1101* to list everything PID 1101 has open. Below we see the open raw socket, plus multiple other files. Note the deleted binary in */dev/shm* which is a major red flag for malware. This particular malware is a backdoor that waits for magic packets to activate by watching all network traffic. Once magic packets are received, a backdoor can then be accessed by the attacker.

![](data:image/svg+xml;base64...)![](data:image/jpeg;base64...)![lsof -p <PID> to list a suspicious process.](https://www.datocms-assets.com/56687/1750102886-lsof-sniffer-annotated.png?auto=format&dpr=2&q=60&w=920 "lsof -p <PID> to list a suspicious process.")

There are different types of packet sockets that can be used. Some will grab only certain protocol traffic such as DHCP, but others will grab all IP traffic (proto 0x0800 in the */proc/net/packet* file) and are much more suspicious due to the breadth of what they are waiting for.

### Find Hiding Malware by Looking Directly

As discussed, malware has been known to alter the output of system tools like *netstat*, *ss*, and *lsof* to hide. Sometimes looking at */proc/net/packet* may reveal a discrepancy to find something hiding. If you see a process with an open packet socket in this file, but it's not being shown in normal utilities, you may have malware that is hiding.

The script we used to list the open packet sockets and compare against the list of processes is available in our Github repository below. We'll be putting more scripts for Linux forensics and incident response here. Keep it bookmarked as we'll have more scripts for Linux incident response and forensics added in the future:

[Sandfly Security Linux Forensics Scripts](https://github.com/sandflysecurity/sandfly-forensic-scripts)

### Find Packet Sniffing Malware at Scale Instantly

While doing this manually is great for direct incident response, our agentless Linux security platform can do it in seconds at scale. You can get a free trial and know immediately if any suspicious processes are sniffing traffic today. Sandfly deploys instantly without any endpoint agents with complete safety and compatibility across virtually all Linux systems and architectures. Get a [free license](https://sandflysecurity.com/get-sandfly) and try it today.

---

Post Tags:

[Malware](/blog/tag/malware)[Linux Security](/blog/tag/linux-security)[Linux Forensics](/blog/tag/linux-forensics)[Rootkits](/blog/tag/rootkits)

Share this post:

[← Return to Blog](/blog)

---

#### Contact Us

---

+64 3 3792313[4 Ash Street Christchurch, New Zealand 8011](https://goo.gl/maps/9cFto1o6GNa9RK6S9)

#### Connect With Us

---

#### Product Navigation

---

* [Threat Detection](/platform/threat-detection)
* [SSH Key Monitoring](/platform/ssh-key-monitoring)
* [Password Auditing](/platform/password-auditing)
* [Drift Detection](/platform/drift-detection)
* [Incident Response](/platform/incident-response)
* [Requirements & Installation](/resources/requirements-installation)

#### General Navigation

---

* [Our Company](/about-us/our-company)
* [Partners](/about-us/partner)
* [Under Attack?](/under-attack)
* [Contact Us](/contact-us)
* [Let’s Connect](/request-a-meeting)
* [Manage My Subscription](https://billing.sandflysecurity.com/p/login/28o7tJe2vbLNfEA9AA)

#### Sign-up For Updates

---

First Name

First Name

Last Name

Last Name

Email

Email

Subscribe

© 2025 Sandfly Security, Ltd. [End User License Agreement](/end-user-license-agreement) & [Privacy Policy](/privacy-policy). This site is protected by reCAPTCHA and the Google Privacy Policy and Terms of Service apply. Linux® is the registered trademark of Linus Torvalds in the U....