---
title: å¶ç„¶ï¼Ÿè¿˜æ˜¯å¿…ç„¶ï¼Ÿ â€” è°æ˜¯ç½ªé­ç¥¸é¦–
url: https://h4ck.org.cn/2025/08/21237
source: obaby@mars
date: 2025-08-10
fetch_date: 2025-10-07T00:17:34.851602
---

# å¶ç„¶ï¼Ÿè¿˜æ˜¯å¿…ç„¶ï¼Ÿ â€” è°æ˜¯ç½ªé­ç¥¸é¦–

[![obaby@mars](/wp-content/uploads/2023/08/logo-pink-small.png)](https://h4ck.org.cn)

Artificial Intelligence / Reverse Engineering / Internet of Things / Full Stack Developer

* [â€»è¯´è¯´/Talkâ€»](https://h4ck.org.cn/talk)
* [â€»ç•™è¨€/Msgâ€»](https://h4ck.org.cn/guestbook)
* [â€»å½’æ¡£/Fileâ€»](https://h4ck.org.cn/myarchive)
* [â€»èµ„æº/Resâ€»](https://h4ck.org.cn/res-page)
* [â€»æˆ‘æ˜¯è°/Meâ€»](https://h4ck.org.cn/whoami)
* [â€»é›†ç¾ä»¬/Bestiesâ€»](https://h4ck.org.cn/besties)

 [Menu](#mobilemenu)

* [â€»è¯´è¯´/Talkâ€»](https://h4ck.org.cn/talk)
* [â€»ç•™è¨€/Msgâ€»](https://h4ck.org.cn/guestbook)
* [â€»å½’æ¡£/Fileâ€»](https://h4ck.org.cn/myarchive)
* [â€»èµ„æº/Resâ€»](https://h4ck.org.cn/res-page)
* [â€»æˆ‘æ˜¯è°/Meâ€»](https://h4ck.org.cn/whoami)
* [â€»é›†ç¾ä»¬/Bestiesâ€»](https://h4ck.org.cn/besties)

[åå°å¼€å‘ã€BackEndã€](https://h4ck.org.cn/cats/cxsj/backend)

# å¶ç„¶ï¼Ÿè¿˜æ˜¯å¿…ç„¶ï¼Ÿ â€” è°æ˜¯ç½ªé­ç¥¸é¦–

2025å¹´8æœˆ9æ—¥
[47 æ¡è¯„è®º](https://h4ck.org.cn/2025/08/21237#comments)

[![](https://h4ck.org.cn/wp-content/uploads/2025/08/330A1674-tuya-scaled.jpg)](https://h4ck.org.cn/wp-content/uploads/2025/08/330A1674-tuya.jpg)

å®å­æ”¾å‡ï¼Œè½¬çœ¼å‡æœŸå·²ç»è¿‡äº†ä¸€åŠï¼Œæƒ³ç€æ‰¾ä¸ªå‘¨æœ«å¸¦å®å­å›è€å®¶ä½å‡ å¤©ï¼Œå¤§å§å®¶çš„å­©å­å‘¨æ—¥è¦åŠå‡å­¦å®´ï¼Œæ—¢ç„¶éƒ½å›æ¥äº†ï¼Œä¸å»ä¹Ÿä¸åˆé€‚ï¼Œåˆšå¥½å°±å¯ä»¥å‘¨å…­å›è€å®¶ï¼Œå‘¨æ—¥å»æ·„åšã€‚

å¯¹è±¡è¯´ï¼Œå‘¨æ—¥é’å²›ä¼šä¸‹å¤§æš´é›¨ï¼Œè¿˜æ˜¯ä¸‹ç­ä¹‹åç›´æ¥å›å§ï¼Œä¸ç„¶ç¬¬äºŒå¤©å¾ˆå¯èƒ½èµ°ä¸äº†ã€‚

å°±è¿™æ ·ï¼Œé©¬ä¸åœè¹„ï¼Œä¸‹ç­ä¹°ç‚¹ä¸œè¥¿å°±ç›´æ¥æ¥ä¸Šå­©å­å¾€å›èµ°ã€‚å¤©æ°”é¢„æŠ¥é›¶ç‚¹çš„é›¨ï¼Œåœ¨ä¹ç‚¹å¤šåˆ°æ½åŠçš„æ—¶å€™å°±å¼€å§‹é€æ¸å¤§äº†ã€‚

å¯¹è±¡å¼€è½¦çš„æ—¶å€™ï¼Œè‡ªå·±æ‰“å¼€æ‰‹æœºæƒ³å›å¤ä¸‹è¯„è®ºï¼Œä½†æ˜¯å´å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯é¡µé¢éå¸¸å¡ã€‚åˆšå¼€å§‹è¿˜ä»¥ä¸ºæ˜¯ç½‘ç»œé—®é¢˜ï¼Œä½†æ˜¯åˆ‡åˆ°çŸ­è§†é¢‘å´å¼‚å¸¸æµç•…ã€‚

ç¬é—´æœ‰ç§ä¸ç¥¥çš„é¢„æ„Ÿï¼Œé‚£å°±æ˜¯æœåŠ¡å™¨çš„ cpu è‚¯å®šåˆè·‘æ»¡äº†ã€‚

ä¹‹å‰çœ‹åˆ°å¨è¨€å¨è¯­å‘çš„[ã€Šæš‚æ—¶åœç”¨è…¾è®¯EdgeOneäº†ã€‹](https://www.weisay.com/blog/temporarily-disabled-edgeone.html) ï¼Œæ„Ÿè§‰è‡ªå·±çš„ç³»ç»Ÿè²Œä¼¼æ²¡ä»€ä¹ˆå¤ªå¤§çš„é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå®é™…ä¸Šæ˜¯åœ¨è¿™ä¹‹å‰ï¼Œåˆ‡æ¢åˆ° eo ä¹‹åï¼Œä¹Ÿå‡ºç°è¿‡ä¸€æ¬¡ cpu è·‘æ»¡çš„æƒ…å†µï¼Œå½“æ—¶é‡å¯ php ä¹‹åä¸€åˆ‡æ­£å¸¸äº†ï¼Œä»¥ä¸ºæ˜¯å¶å‘äº‹ä»¶ã€‚æ‰€ä»¥ä¹Ÿæ²¡å†å…³æ³¨ï¼Œä½†æ˜¯è¿™æ¬¡å°è¯•è¿œç¨‹é‡å¯æœåŠ¡ä¹‹åï¼Œåªæ˜¯ç¬é—´ç¼“è§£ã€‚å‡ åˆ†é’Ÿä¹‹åå°±åˆå¡æ­»äº†ï¼Œ**æ‰€ä»¥æ˜¨å¤©èƒ½å‘è¯„è®ºçš„å®å­çœŸçš„éƒ½æ˜¯çœŸçˆ±ï¼Œä¹ˆä¹ˆå“’(à¹‘â€¢Ìâ‚ƒâ€¢Ì€à¹‘)ï¼Œå› ä¸ºæˆ‘è‡ªå·±éƒ½æ‰“ä¸å¼€æˆ‘çš„åå°ã€‚**ğŸ˜‚

è¿™ç§æ„Ÿè§‰è¿˜æœ‰ä¸€ä¸ªå‰å…†ï¼Œé‚£å°±æ˜¯åå°èµ„æºåº“çªç„¶å¤šäº†ä¸ªæ–‡ä»¶ã€‚

[![](https://h4ck.org.cn/wp-content/uploads/2025/08/53FC004E74654E68CDC38C58829D0DF9.png)](https://h4ck.org.cn/wp-content/uploads/2025/08/53FC004E74654E68CDC38C58829D0DF9.png)

ä¸è¿‡è¿™ä¸ªæ–‡ä»¶çœ‹èµ·æ¥æ˜¯æŸä¸ªæ’ä»¶çš„å‹ç¼©åŒ…ï¼Œä½†æ˜¯æè¿°æ˜¯å¦å¤–ä¸€ä¸ªåŸŸåï¼ŒçŒœæµ‹æ˜¯å¦å¤–ä¸€ä¸ªåŸŸåä¼ ä¸Šæ¥çš„ã€‚ä½†æ˜¯ã€‚æœäº†ä¸‹è¿™ä¸ªç”¨æˆ·ä¸å­˜åœ¨ï¼Œæ‰€ä»¥æœ€åç›´æ¥æŠŠæ’ä»¶å’Œæ–‡ä»¶ä¸€èµ·åˆ é™¤äº†ã€‚

ä½†æ˜¯è¿™ä¸ª cpu è·‘æ»¡çš„æ„Ÿè§‰è¿˜æ˜¯æ„Ÿè§‰æ˜¯ ccï¼Œä¸ç„¶ä¸è‡³äº php èƒ½ç›´æ¥å æ»¡äº†å…¨éƒ¨èµ„æºã€‚

åˆ°å®¶ä¹‹åï¼Œçœ‹äº†ä¸‹ eo çš„åå°æ²¡ä»€ä¹ˆèƒ½é…ç½®åœ°æ–¹ã€‚ä½†æ˜¯ï¼Œé€šè¿‡æœåŠ¡å™¨çš„è®¿é—®è®°å½•å´å‘ç°ï¼Œæœ‰å‡ ä¸ªåœ°å€åœ¨é¢‘ç¹è¯·æ±‚ç™»å½•é¡µé¢ï¼š

[![](https://h4ck.org.cn/wp-content/uploads/2025/08/Jietu20250808-214858-1-scaled.jpg)](https://h4ck.org.cn/wp-content/uploads/2025/08/Jietu20250808-214858-1.jpg) [![](https://h4ck.org.cn/wp-content/uploads/2025/08/Jietu20250808-223424-scaled.jpg)](https://h4ck.org.cn/wp-content/uploads/2025/08/Jietu20250808-223424.jpg)

å½“ç„¶ï¼Œæ›´è¯¡å¼‚çš„æ˜¯è¿™é‡Œé¢å¥½å‡ ä¸ª ip ç«Ÿç„¶éƒ½æ˜¯è…¾è®¯çš„æµ·å¤–èŠ‚ç‚¹ã€‚è¿™å°±æœ‰ç‚¹å¥‡æ€ªäº†ã€‚

[![](https://h4ck.org.cn/wp-content/uploads/2025/08/Jietu20250809-112749.jpg)](https://h4ck.org.cn/wp-content/uploads/2025/08/Jietu20250809-112749.jpg) [![](https://h4ck.org.cn/wp-content/uploads/2025/08/Jietu20250809-112803.jpg)](https://h4ck.org.cn/wp-content/uploads/2025/08/Jietu20250809-112803.jpg)

å°¤å…¶æ˜¯ 163 è¿™ä¸ªï¼ŒæŒ‰ç…§å¸¸ç†æ¥è¯´ï¼Œå¦‚æœæ˜¯ cdn èŠ‚ç‚¹å›æºï¼Œåº”è¯¥ä¸ä¼šæ‘ç€è¿™ä¸€ä¸ªåœ°å€å›æºï¼Œå¹¶ä¸”è¿™ä¸ªè¯·æ±‚é¢‘ç‡å¤§æ¦‚ç‡ä¼šè¢« cdn æ‹¦æˆªï¼Œç„¶è€Œï¼Œç°åœ¨çš„ç°è±¡æ˜¯ä¸å•æ²¡è¢«æ‹¦æˆªï¼Œè¿˜é«˜é¢‘è®¿é—®ï¼Œä¸€ä¸ªåœ°å€åœ¨ä¸€ç§’å†…å‘èµ·äº†å‡ åä¸ªè¯·æ±‚ã€‚è¿™å°¼ç›å°±ç¦»è°±äº†ï¼ŒæŸ¥äº†ä¸€ä¸‹åŠ é€ŸåŸŸåçš„èŠ‚ç‚¹ï¼Œå‘ç°è¿™äº›éƒ½ä¸åœ¨ eo çš„èŠ‚ç‚¹åˆ—è¡¨å†…ã€‚

[![](https://h4ck.org.cn/wp-content/uploads/2025/08/Jietu20250809-113027.jpg)](https://h4ck.org.cn/wp-content/uploads/2025/08/Jietu20250809-113027.jpg)

é‚£ä¹ˆï¼Œæ­¤æ—¶ä¼šåˆç†çš„çŒœçš„å°±æ˜¯ eo çš„æœºæˆ¿å†…æˆ–è€…æ˜¯åœ¨æŸäº›åœ°æ–¹çš„èŠ‚ç‚¹å›æºä¼šæ³„éœ²åŸå§‹æœåŠ¡å™¨åœ°å€ï¼Œè¿™æ ·è¿™ä¸€ç³»åˆ—çš„è¯·æ±‚å°±è¯´çš„é€šäº†ã€‚è¿™äº›è¯·æ±‚æœ¬èº«å¹¶æ²¡æœ‰ç»“æœ cdnï¼Œæ‰€ä»¥ç›´æ¥æ˜¯ä»æœºæˆ¿å‘èµ·çš„è¯·æ±‚ã€‚

åœ¨å›æºåœ°å€æ³„éœ²ä¹‹åï¼Œæœ‰äººé€šè¿‡ bot æ§åˆ¶äº†å¤§é‡æœºæˆ¿å†…çš„æœºå™¨ï¼Œå°è¯•å¯¹ wp çš„ç™»å½•åœ°å€è¿›è¡Œæš´åŠ›ç ´è§£ï¼Œè€Œè¿™å‘Šè¯‰ cc ä¹Ÿå¯¼è‡´äº†å®¶é‡Œçš„ mac mini çš„æœåŠ¡å™¨èµ„æºç¬é—´è¢«è€—å°½äº†ã€‚

æ‰€ä»¥è¿™ä¸ªé—®é¢˜ä¸æ˜¯ eo æœ¬èº«å¯¼è‡´çš„ï¼Œä½†æ˜¯ç¡®å®æ˜¯å¥—äº† eo çš„å›½å¤–èŠ‚ç‚¹ä¹‹åï¼Œæœ‰ eo çš„æŸäº›è¯·æ±‚æ³„éœ²å›æºåœ°å€å¯¼è‡´å‡ºç°äº†ç›´æ¥é’ˆå¯¹æœåŠ¡å™¨çš„ cc æ”»å‡»ã€‚è¿™ä¸ªæ”»å‡»ç›®æ ‡å¾ˆæ˜ç¡®ï¼Œå°±æ˜¯ç ´è§£ç™»å½•å¯†ç ã€‚æœ¬æ¥æƒ³ç›´æ¥å°é”é‚£å‡ ä¸ª ipï¼Œä½†æ˜¯å°é”ä¹‹åå‘ç°è¿˜æ˜¯ä¸æ–­çš„æœ‰æ–°çš„å¼€å§‹å°è¯•ï¼Œäºæ˜¯ï¼Œæœ€æ–°ç‰ˆæœ¬çš„å·¥å…·å°±å‡ºç°äº†ï¼Œç›´æ¥å†™ä¸ªè„šæœ¬ï¼Œé€šè¿‡æ£€æµ‹ nginx è®¿é—®æ—¥å¿—ï¼Œå®ç°å¯¹ ip åŠ¨æ€é£æ§ã€‚

ä»£ç å¦‚ä¸‹ï¼š

```
#!/bin/bash

# å®æ—¶ç›‘æ§æ—¥å¿—æ–‡ä»¶å¹¶è‡ªåŠ¨å°é”æ¶æ„IP
# ä½¿ç”¨æ–¹æ³•: sudo ./realtime_block.sh

LOG_FILE="/home/wwwlogs/h4ck.org.cn.log"
BLOCKED_IPS_FILE="/tmp/blocked_ips.txt"
MAX_REQUESTS_PER_MINUTE=10
BLOCK_DURATION=3600  # å°é”æ—¶é—´ï¼ˆç§’ï¼‰
DEBUG_MODE=false  # è®¾ç½®ä¸ºtrueå¯ç”¨è°ƒè¯•æ¨¡å¼
QUIET_MODE=false  # è®¾ç½®ä¸ºtrueå¯ç”¨é™é»˜æ¨¡å¼ï¼ˆåªæ˜¾ç¤ºæ–°å¢å°é”ï¼‰
ATTACK_HISTORY_FILE="/tmp/attack_history.txt"  # æ”»å‡»å†å²è®°å½•æ–‡ä»¶

# æ£€æŸ¥æ˜¯å¦ä»¥rootæƒé™è¿è¡Œ
if [ "$EUID" -ne 0 ]; then
    echo "è¯·ä½¿ç”¨sudoè¿è¡Œæ­¤è„šæœ¬"
    exit 1
fi

# æ£€æŸ¥inotify-toolsæ˜¯å¦å®‰è£…
if ! command -v inotifywait &> /dev/null; then
    echo "è¯·å…ˆå®‰è£…inotify-tools:"
    echo "Ubuntu/Debian: sudo apt-get install inotify-tools"
    echo "CentOS/RHEL: sudo yum install inotify-tools"
    exit 1
fi

# æ£€æŸ¥æ—¥å¿—æ–‡ä»¶æ˜¯å¦å­˜åœ¨
if [ ! -f "$LOG_FILE" ]; then
    echo "é”™è¯¯: æ—¥å¿—æ–‡ä»¶ $LOG_FILE ä¸å­˜åœ¨"
    exit 1
fi

# åˆ›å»ºiptablesé“¾ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
iptables -N BLOCK_MALICIOUS_IPS 2>/dev/null

# ç¡®ä¿BLOCK_MALICIOUS_IPSé“¾åœ¨INPUTé“¾çš„æœ€å‰é¢
iptables -C INPUT -j BLOCK_MALICIOUS_IPS 2>/dev/null || iptables -I INPUT 1 -j BLOCK_MALICIOUS_IPS

# åˆå§‹åŒ–æ–‡ä»¶
touch "$BLOCKED_IPS_FILE"
touch "$ATTACK_HISTORY_FILE"

# å‡½æ•°ï¼šæ£€æŸ¥å¹¶ä¿®å¤iptablesé…ç½®
check_iptables_config() {
    echo "æ£€æŸ¥iptablesé…ç½®..."

    # æ£€æŸ¥BLOCK_MALICIOUS_IPSé“¾æ˜¯å¦å­˜åœ¨
    if ! iptables -L BLOCK_MALICIOUS_IPS >/dev/null 2>&1; then
        echo "åˆ›å»ºBLOCK_MALICIOUS_IPSé“¾..."
        iptables -N BLOCK_MALICIOUS_IPS
    fi

    # æ£€æŸ¥INPUTé“¾ä¸­æ˜¯å¦åŒ…å«BLOCK_MALICIOUS_IPS
    if ! iptables -C INPUT -j BLOCK_MALICIOUS_IPS 2>/dev/null; then
        echo "å°†BLOCK_MALICIOUS_IPSé“¾æ’å…¥åˆ°INPUTé“¾çš„æœ€å‰é¢..."
        iptables -I INPUT 1 -j BLOCK_MALICIOUS_IPS
    fi

    # æ˜¾ç¤ºå½“å‰é…ç½®
    echo "å½“å‰iptablesé…ç½®:"
    iptables -L INPUT -n --line-numbers | head -10
    echo "BLOCK_MALICIOUS_IPSé“¾è§„åˆ™:"
    iptables -L BLOCK_MALICIOUS_IPS -n
}

# å‡½æ•°ï¼šé‡æ–°åŠ è½½å·²å°é”çš„IPåˆ°iptables
reload_blocked_ips() {
    echo "é‡æ–°åŠ è½½å·²å°é”çš„IPåˆ°iptables..."

    if [ -f "$BLOCKED_IPS_FILE" ]; then
        local count=0
        while read -r ip; do
            if [ -n "$ip" ]; then
                # æ£€æŸ¥iptablesä¸­æ˜¯å¦å·²æœ‰æ­¤è§„åˆ™
                if ! iptables -C BLOCK_MALICIOUS_IPS -s "$ip" -j DROP 2>/dev/null; then
                    iptables -A BLOCK_MALICIOUS_IPS -s "$ip" -j DROP
                    count=$((count + 1))
                fi
            fi
        done < "$BLOCKED_IPS_FILE"
        echo "é‡æ–°åŠ è½½äº† $count ä¸ªIPåˆ°iptables"
    fi
}

# æ£€æŸ¥å¹¶ä¿®å¤iptablesé…ç½®
check_iptables_config

# é‡æ–°åŠ è½½å·²å°é”çš„IP
reload_blocked_ips

echo "å¼€å§‹å®æ—¶ç›‘æ§æ—¥å¿—æ–‡ä»¶: $LOG_FILE"
echo "æœ€å¤§è¯·æ±‚é¢‘ç‡: $MAX_REQUESTS_PER_MINUTE æ¬¡/åˆ†é’Ÿ"
echo "å°é”æ—¶é—´: $BLOCK_DURATION ç§’"

# å‡½æ•°ï¼šå°é”IP
block_ip() {
    local ip=$1
    local reason=$2

    # æ£€æŸ¥IPæ˜¯å¦å·²ç»è¢«å°é”
    if ! grep -q "^$ip$" "$BLOCKED_IPS_FILE"; then
        echo "$(date '+%Y-%m-%d %H:%M:%S') - å°é”IP: $ip (åŸå› : $reason)"

        # æ·»åŠ åˆ°iptablesï¼ˆç¡®ä¿è§„åˆ™æ­£ç¡®æ·»åŠ ï¼‰
        iptables -A BLOCK_MALICIOUS_IPS -s "$ip" -j DROP

        # éªŒè¯è§„åˆ™æ˜¯å¦æ·»åŠ æˆåŠŸ
        if iptables -C BLOCK_MALICIOUS_IPS -s "$ip" -j DROP 2>/dev/null; then
            echo "$(date '+%Y-%m-%d %H:%M:%S') - æˆåŠŸæ·»åŠ iptablesè§„åˆ™: $ip"
        else
            echo "$(date '+%Y-%m-%d %H:%M:%S') - è­¦å‘Š: iptablesè§„åˆ™æ·»åŠ å¤±è´¥: $ip"
        fi

        # è®°å½•åˆ°æ–‡ä»¶
        echo "$ip" >> "$BLOCKED_IPS_FILE"

        # è®°å½•æ—¥å¿—
        echo "$(date '+%Y-%m-%d %H:%M:%S') - å°é”IP: $ip (åŸå› : $reason)" >> /var/log/realtime_block.log
    else
        echo "$(date '+%Y-%m-%d %H:%M:%S') - IP $ip å·²ç»è¢«å°é”"
    fi
}

# å‡½æ•°ï¼šè®°å½•æ”»å‡»å†å²
record_attack() {
    local ip=$1
    local attack_type=$2
    local timestamp=$(date +%s)
    echo "$ip|$attack_type|$timestamp" >> "$ATTACK_HISTORY_FILE"
}

# å‡½æ•°ï¼šæ£€æŸ¥æ”»å‡»å†å²
check_attack_history() {
    local ip=$1
    local attack_type=$2
    local current_time=$(date +%s)
    local time_window=300  # 5åˆ†é’Ÿæ—¶é—´çª—å£

    # æ¸…ç†è¿‡æœŸçš„æ”»å‡»è®°å½•
    local temp_file="/tmp/temp_attack_history.txt"
    while IFS='|' read -r record_ip record_type record_time; do
        if [ $((current_time - record_time)) -lt $time_window ]; then
            echo "$record_ip|$record_type|$record_time" >> "$temp_file"
        fi
    done < "$ATTACK_HISTORY_FILE"

    mv "$temp_file" "$ATTACK_HISTORY_FILE" 2>/dev/null

    # ç»Ÿè®¡è¯¥IPåœ¨æ—¶é—´çª—å£å†…çš„æ”»å‡»æ¬¡æ•°
    local attack_count=$(grep "^$ip|" "$ATTACK_HISTORY_FILE" | wc -l)
    echo "$attack_count"
}

# å‡½æ•°ï¼šåˆ†ææ–°æ—¥å¿—æ¡ç›®
analyze_new_logs() {
    local new_lines="$1"

    if [ -n "$new_lines" ]; then
        if [ "$DEBUG_MODE" = true ]; then
            echo "DEBUG: åˆ†ææ–°æ—¥å¿—è¡Œæ•°: $(echo "$new_lines" | wc -l)"
        fi

        # ç»Ÿè®¡IPè¯·æ±‚é¢‘ç‡
        local ip_counts=$(echo "$new_lines" | awk '{print $1}' | sort | uniq -c | sort -nr)

        if [ "$DEBUG_MODE" = true ] && [ -n "$ip_counts" ]; then
            echo "DEBUG: IPç»Ÿè®¡ç»“æœ:"
            echo "$ip_counts"
        fi

        # æ£€æŸ¥æ¯ä¸ªIPçš„è¯·æ±‚é¢‘ç‡
        while read -r count ip; do
            if [ -n "$ip" ] && [ "$count" -gt "$MAX_REQUESTS_PER_MINUTE" ]; then
                record_attack "$ip" "high_frequency"
                local total_attacks=$(che...