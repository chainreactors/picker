---
title: 腾讯和清华的最新研究：利用“长度侧信道”绕过5G/4G/WiFi网络的加密
url: https://xlab.tencent.com/cn/2025/08/01/len-oracle/
source: 腾讯玄武实验室
date: 2025-08-02
fetch_date: 2025-10-07T00:50:20.460756
---

# 腾讯和清华的最新研究：利用“长度侧信道”绕过5G/4G/WiFi网络的加密

[![猫聟戮猫庐炉莽聨聞忙颅娄氓庐聻茅陋聦氓庐陇](/cn/assest/XuanwuLogo.png)](/cn/.)

* [茅娄聳茅隆碌](/cn/)
  [氓庐聣氓聟篓氓聟卢氓聭聤](/cn/category/advisories/)
  [忙聤芦茅聹虏氓聨聼氓聢聶](/cn/policy/)
  [氓聟鲁盲潞聨](/cn/about/)
  [English](/en/)

# 猫聟戮猫庐炉氓聮聦忙赂聟氓聧聨莽職聞忙聹聙忙聳掳莽聽聰莽漏露茂录職氓聢漏莽聰篓芒聙聹茅聲驴氓潞娄盲戮搂盲驴隆茅聛聯芒聙聺莽禄聲猫驴聡5G/4G/WiFi莽陆聭莽禄聹莽職聞氓聤聽氓炉聠

2025-08-01

**Author: Guancheng Li of Tencent Security Xuanwu Lab**

氓聹篓氓陆聯盲禄聤忙聲掳氓颅聴氓聦聳忙聴露盲禄拢茂录聦5G茫聙聛4G氓聮聦Wi-Fi莽颅聣忙聴聽莽潞驴茅聙職盲驴隆忙聤聙忙聹炉氓路虏忙聢聬盲赂潞忙聢聭盲禄卢忙聴楼氓赂赂莽聰聼忙麓禄莽職聞茅聡聧猫娄聛氓聼潞莽隆聙猫庐戮忙聳陆茫聙聜猫驴聶盲潞聸莽陆聭莽禄聹忙聶庐茅聛聧茅聡聡莽聰篓氓聟聢猫驴聸莽職聞氓聤聽氓炉聠氓聧聫猫庐庐茂录聦莽聬聠猫庐潞盲赂聤猫聝陆氓陇聼忙聹聣忙聲聢盲驴聺忙聤陇莽聰篓忙聢路茅聙職盲驴隆氓庐聣氓聟篓茫聙聜莽聞露猫聙聦茂录聦猫驴聭忙聹聼莽聰卤忙聢聭盲禄卢猫聟戮猫庐炉莽聨聞忙颅娄氓庐聻茅陋聦氓庐陇盲赂聨忙赂聟氓聧聨氓陇搂氓颅娄茅聶聢氓禄潞氓聠聸猫聙聛氓赂聢氓聸垄茅聵聼氓聹篓EuroS&P 2025盲赂聤氓聫聭猫隆篓莽職聞莽聽聰莽漏露忙聢聬忙聻聹LenOracle忙聫颅莽陇潞盲潞聠盲赂聙盲赂陋忙聳掳莽職聞氓庐聣氓聟篓茅職聬忙聜拢茂录職忙聰禄氓聡禄猫聙聟氓聫炉猫聝陆氓掳聠莽漏潞氓聫拢忙聲掳忙聧庐氓赂搂茂录聢radio frame茂录聣茅聲驴氓潞娄盲驴隆忙聛炉盲陆聹盲赂潞盲戮搂盲驴隆茅聛聯茂录聦氓聹篓盲赂聧莽聽麓猫搂拢忙聴聽莽潞驴氓聤聽氓炉聠莽職聞忙聝聟氓聠碌盲赂聥氓聤芦忙聦聛氓聤聽氓炉聠莽陆聭莽禄聹盲赂颅莽職聞TCP/UDP猫驴聻忙聨楼茫聙聜忙聢聭盲禄卢氓聹篓莽聹聼氓庐聻莽職聞氓聲聠莽聰篓LTE莽陆聭莽禄聹氓聮聦Wi-Fi莽聨炉氓垄聝盲赂颅猫驴聸猫隆聦盲潞聠忙碌聥猫炉聲茂录聦忙聢聬氓聤聼氓聹篓TCP氓聹潞忙聶炉盲赂聥氓聢漏莽聰篓猫炉楼忙聰禄氓聡禄氓聬聭氓聫聴氓庐鲁猫庐戮氓陇聡忙鲁篓氓聟楼盲潞聠盲赂聙忙聺隆盲录陋茅聙聽莽職聞莽聼颅忙露聢忙聛炉茂录聦氓鹿露氓聹篓UDP氓聹潞忙聶炉盲赂聥忙卤隆忙聼聯盲潞聠氓聫聴氓庐鲁猫庐戮氓陇聡莽職聞DNS莽录聯氓颅聵茂录聦氓卤聲莽陇潞盲潞聠猫炉楼忙聰禄氓聡禄氓炉鹿氓聟鲁茅聰庐莽陆聭莽禄聹忙聹聧氓聤隆莽職聞忙陆聹氓聹篓莽聽麓氓聺聫氓聤聸茫聙聜

猫驴聶忙聵炉忙聙聨盲鹿聢盲赂聙氓聸聻盲潞聥氓聭垄茂录聼忙聴聽莽潞驴莽陆聭莽禄聹莽職聞氓聤聽氓炉聠氓聧聫猫庐庐猫聶陆莽聞露氓聫炉盲禄楼茅聵禄忙颅垄忙聰禄氓聡禄猫聙聟氓聹篓莽聣漏莽聬聠氓卤聜莽陋聝氓聬卢茅聙職盲驴隆氓聠聟氓庐鹿忙聢聳莽炉隆忙聰鹿茫聙聛忙鲁篓氓聟楼忙露聢忙聛炉茂录聦盲陆聠氓聹篓盲录聽猫戮聯氓卤聜茂录聦氓娄聜忙聻聹忙聰禄氓聡禄猫聙聟忙聨聦忙聫隆盲潞聠氓聸聸氓聟聝莽禄聞盲驴隆忙聛炉茂录聢氓庐垄忙聢路莽芦炉IP茫聙聛氓庐垄忙聢路莽芦炉莽芦炉氓聫拢茫聙聛忙聹聧氓聤隆氓聶篓IP茫聙聛忙聹聧氓聤隆氓聶篓莽芦炉氓聫拢茂录聣盲禄楼氓聫聤氓潞聫氓聢聴氓聫路茂录聢SEQ茂录聣氓聮聦莽隆庐猫庐陇氓聫路茂录聢ACK茂录聣茂录聦盲禄聧氓聫炉盲禄楼茅聙職猫驴聡氓聫聭茅聙聛盲录陋茅聙聽氓聸聸氓聟聝莽禄聞莽職聞忙聲掳忙聧庐氓聦聟茂录聦氓掳聠盲禄禄忙聞聫忙聲掳忙聧庐忙鲁篓氓聟楼氓聢掳莽聸赂氓潞聰莽職聞莽陆聭莽禄聹猫驴聻忙聨楼盲赂颅茫聙聜猫驴聶盲潞聸盲录陋茅聙聽莽職聞忙聲掳忙聧庐氓聦聟盲录職莽禄聫猫驴聡盲潞聮猫聛聰莽陆聭猫路炉莽聰卤茂录聦忙聹聙莽禄聢猫垄芦猫掳聝氓聢露盲赂潞莽漏潞氓聫拢忙聲掳忙聧庐氓赂搂氓鹿露盲录聽茅聙聮氓聢掳氓聫聴氓庐鲁猫聙聟猫庐戮氓陇聡茂录聦盲禄聨猫聙聦茅聴麓忙聨楼氓庐聻莽聨掳氓炉鹿忙聴聽莽潞驴盲驴隆茅聛聯莽職聞忙露聢忙聛炉忙鲁篓氓聟楼茫聙聜氓聹篓氓庐聻茅聶聟忙聝聟氓聠碌盲赂聥茂录聦忙聰禄氓聡禄猫聙聟茅聙職氓赂赂茅職戮盲禄楼猫聨路氓聫聳氓聸聸氓聟聝莽禄聞氓聮聦氓潞聫氓聢聴氓聫路莽颅聣氓聟鲁茅聰庐盲驴隆忙聛炉茫聙聜猫聙聦忙聢聭盲禄卢莽職聞莽聽聰莽漏露氓聫聭莽聨掳茂录聦氓娄聜忙聻聹氓掳聠莽漏潞氓聫拢忙聲掳忙聧庐氓赂搂莽職聞茅聲驴氓潞娄盲驴隆忙聛炉盲赂聨莽陆聭莽禄聹氓聹掳氓聺聙猫陆卢忙聧垄茂录聢NAT茂录聣莽職聞氓路楼盲陆聹忙聹潞氓聢露盲禄楼氓聫聤TCP氓聧聫猫庐庐莽職聞氓聸潞忙聹聣莽聣鹿忙聙搂莽禄聯氓聬聢茂录聦忙聵炉氓聫炉盲禄楼茅聙聬忙颅楼忙聨篓忙聳颅氓聡潞莽聸庐忙聽聡猫驴聻忙聨楼莽職聞氓聸聸氓聟聝莽禄聞茂录聢忙潞聬IP茫聙聛忙潞聬莽芦炉氓聫拢茫聙聛莽聸庐莽職聞IP茫聙聛莽聸庐莽職聞莽芦炉氓聫拢茂录聣盲禄楼氓聫聤氓聟鲁茅聰庐莽職聞氓聧聫猫庐庐莽聤露忙聙聛盲驴隆忙聛炉茂录聢氓娄聜氓潞聫氓聢聴氓聫路氓聮聦莽隆庐猫庐陇氓聫路茂录聣茂录聦盲禄聨猫聙聦氓庐聻莽聨掳氓炉鹿莽陆聭莽禄聹盲赂颅TCP/UDP茅聙職盲驴隆莽職聞氓聤芦忙聦聛茫聙聜

# 0x01 茅聲驴氓潞娄盲戮搂盲驴隆茅聛聯忙聵炉盲禄聙盲鹿聢茂录聼

盲戮搂盲驴隆茅聛聯忙聰禄氓聡禄氓鹿露盲赂聧忙聵炉莽聸麓忙聨楼莽聽麓猫搂拢氓聤聽氓炉聠莽庐聴忙鲁聲茂录聦猫聙聦忙聵炉茅聙職猫驴聡氓聢聠忙聻聬莽陆聭莽禄聹茅聙職盲驴隆猫驴聡莽篓聥盲赂颅盲潞搂莽聰聼莽職聞盲赂聙盲潞聸芒聙聹氓聣炉盲潞搂氓聯聛芒聙聺芒聙聰芒聙聰忙炉聰氓娄聜忙聲掳忙聧庐氓聦聟莽職聞茅聲驴氓潞娄茫聙聛盲录聽猫戮聯氓禄露猫驴聼莽颅聣芒聙聰芒聙聰忙聺楼茅聴麓忙聨楼忙聨篓忙碌聥氓聡潞氓聨聼忙聹卢盲赂聧氓潞聰忙鲁聞茅聹虏莽職聞盲驴隆忙聛炉茫聙聜

猫聙聦忙聢聭盲禄卢忙聫聬氓聡潞莽職聞忙聴聽莽潞驴莽陆聭莽禄聹盲赂颅莽職聞茅聲驴氓潞娄盲戮搂盲驴隆茅聛聯茂录聦氓聟露忙聽鹿忙聹卢氓聨聼氓聸聽氓聹篓盲潞聨氓陇搂氓陇職忙聲掳忙聴聽莽潞驴氓聧聫猫庐庐茅聡聡莽聰篓莽職聞氓聤聽氓炉聠莽庐聴忙鲁聲氓卤聻盲潞聨忙碌聛氓炉聠莽聽聛茂录聢stream cipher茂录聣茫聙聜忙碌聛氓炉聠莽聽聛莽職聞盲赂聙盲赂陋茅聡聧猫娄聛莽聣鹿忙聙搂忙聵炉茂录職氓聤聽氓炉聠氓聣聧氓聬聨莽職聞忙聵聨忙聳聡氓聮聦氓炉聠忙聳聡茅聲驴氓潞娄氓庐聦氓聟篓盲赂聙猫聡麓茫聙聜氓聹篓氓庐聻茅聶聟茅聙職盲驴隆盲赂颅茂录聦莽禄聫猫驴聡氓聤聽氓炉聠莽職聞忙聲掳忙聧庐氓聦聟盲录職猫垄芦氓掳聛猫拢聟忙聢聬莽漏潞氓聫拢忙聲掳忙聧庐氓赂搂茂录聢radio frame茂录聣氓聹篓忙聴聽莽潞驴盲驴隆茅聛聯盲赂颅盲录聽猫戮聯茫聙聜氓掳陆莽庐隆忙聲掳忙聧庐氓聠聟氓庐鹿猫垄芦氓聤聽氓炉聠茂录聦盲陆聠忙聴聽莽潞驴莽聸聭氓聬卢猫聙聟盲戮聺莽聞露氓聫炉盲禄楼忙聧聲猫聨路猫驴聶盲潞聸氓赂搂茂录聦氓鹿露茅聙職猫驴聡氓聢聠忙聻聬忙炉聫盲赂陋氓赂搂莽職聞茅聲驴氓潞娄茂录聦盲禄聨猫聙聦茅聴麓忙聨楼猫聨路氓聫聳氓聨聼氓搂聥忙聵聨忙聳聡忙聲掳忙聧庐氓聦聟莽職聞茅聲驴氓潞娄盲驴隆忙聛炉茫聙聜

![](/cn/uploads/2025/len_oracle/stream-cipher-encryption.png)

# 0x02 茅聲驴氓潞娄盲戮搂盲驴隆茅聛聯盲赂潞盲禄聙盲鹿聢猫聝陆氓聹篓猫路炉氓戮聞氓陇聳氓聤芦忙聦聛TCP氓聮聦UDP猫驴聻忙聨楼

氓聹篓莽陆聭莽禄聹茅聙職盲驴隆盲赂颅茂录聦忙聴聽猫庐潞忙聵炉TCP猫驴聵忙聵炉UDP茂录聦盲赂聙盲赂陋猫驴聻忙聨楼茅聝陆莽聰卤氓聸聸氓聟聝莽禄聞氓聰炉盲赂聙忙聽聡猫炉聠茂录職氓庐垄忙聢路莽芦炉IP茫聙聛氓庐垄忙聢路莽芦炉莽芦炉氓聫拢茫聙聛忙聹聧氓聤隆氓聶篓IP茫聙聛忙聹聧氓聤隆氓聶篓莽芦炉氓聫拢茫聙聜莽聬聠猫庐潞盲赂聤茂录聦忙聰禄氓聡禄猫聙聟猫娄聛氓庐聻莽聨掳猫路炉氓戮聞氓陇聳氓聤芦忙聦聛茂录聦莽隆庐氓庐聻茅聹聙猫娄聛忙聨聦忙聫隆猫驴聶氓聸聸茅隆鹿氓聫聜忙聲掳茫聙聜盲赂聧猫驴聡氓聹篓氓庐聻茅聶聟忙聰禄氓聡禄氓聹潞忙聶炉盲赂聥茂录聦忙聹聧氓聤隆氓聶篓莽職聞IP氓聮聦莽芦炉氓聫拢氓戮聙氓戮聙忙聵炉氓路虏莽聼楼忙聢聳猫聙聟氓聹篓盲赂聙盲赂陋茅聺聻氓赂赂忙聹聣茅聶聬莽職聞茅聸聠氓聬聢氓聠聟莽職聞茂录聦猫驴聶忙聹聣盲赂陇忙聳鹿茅聺垄氓聨聼氓聸聽茂录職盲赂聙忙聳鹿茅聺垄茂录聦忙聰禄氓聡禄猫聙聟氓聹篓氓聫聭猫碌路忙聰禄氓聡禄氓聣聧茅聙職氓赂赂盲录職忙聵聨莽隆庐茅聙聣忙聥漏盲赂聙盲赂陋莽聸庐忙聽聡忙聹聧氓聤隆氓聶篓茂录聸氓聫娄盲赂聙忙聳鹿茅聺垄茂录聦猫庐赂氓陇職忙聹聧氓聤隆茂录聢氓娄聜DNS茫聙聛Web忙聹聧氓聤隆氓聶篓茂录聣氓聹篓盲赂聙盲赂陋氓聹掳氓聦潞忙聢聳氓潞聰莽聰篓盲赂颅茅聝陆盲录職盲陆驴莽聰篓氓聸潞氓庐職莽職聞忙聹聧氓聤隆氓聶篓IP氓聮聦莽芦炉氓聫拢茂录聦盲戮聥氓娄聜DNS氓赂赂莽聰篓氓聹掳氓聺聙8.8.8.8:53茫聙聜氓聸聽忙颅陇茂录聦氓庐聻茅聶聟忙聰禄氓聡禄盲赂颅茂录聦忙聰禄氓聡禄猫聙聟莽職聞茅聡聧莽聜鹿盲赂禄猫娄聛忙聵炉氓聹篓氓娄聜盲陆聲猫聨路氓聫聳氓聫聴氓庐鲁猫聙聟莽職聞氓陇聳茅聝篓IP氓聹掳氓聺聙氓聮聦氓聟露盲赂聨忙聹聧氓聤隆氓聶篓茅聙職盲驴隆忙聴露盲陆驴莽聰篓莽職聞氓陇聳茅聝篓忙潞聬莽芦炉氓聫拢氓聫路茫聙聜

氓炉鹿盲潞聨UDP氓聧聫猫庐庐茂录聦氓娄聜忙聻聹忙聰禄氓聡禄猫聙聟猫聝陆氓陇聼猫聨路莽聼楼氓聫聴氓庐鲁猫聙聟莽職聞氓陇聳茅聝篓IP氓聮聦忙潞聬莽芦炉氓聫拢茂录聦氓鹿露猫聝陆猫驴聸猫隆聦忙潞聬IP忙卢潞茅陋聴茂录聢氓聧鲁盲录陋茅聙聽忙潞聬IP氓聫聭茅聙聛忙聲掳忙聧庐氓聦聟茂录聣茂录聦氓掳卤忙聹聣氓聫炉猫聝陆氓聬聭猫炉楼猫驴聻忙聨楼忙鲁篓氓聟楼忙聲掳忙聧庐茂录聦猫驴聶莽搂聧忙聰禄氓聡禄忙聣聥忙鲁聲氓掳卤忙聵炉芒聙聹猫路炉氓戮聞氓陇聳氓聤芦忙聦聛茂录聢Off-path hijacking茂录聣芒聙聺茫聙聜氓炉鹿盲潞聨TCP氓聧聫猫庐庐茂录聦茅聶陇盲潞聠氓聸聸氓聟聝莽禄聞氓陇聳茂录聦猫驴聵茅聹聙猫娄聛氓聡聠莽隆庐猫聨路氓聫聳氓潞聫氓聢聴氓聫路茂录聢SEQ茂录聣氓聮聦莽隆庐猫庐陇氓聫路茂录聢ACK茂录聣茂录聦氓聬娄氓聢聶盲录陋茅聙聽莽職聞忙聲掳忙聧庐氓聦聟盲录職猫垄芦氓聧聫猫庐庐忙聽聢莽聸麓忙聨楼盲赂垄氓录聝茂录聦氓聸聽猫聙聦氓聤芦忙聦聛茅職戮氓潞娄忙聸麓茅芦聵茫聙聜

![](/cn/uploads/2025/len_oracle/data-exchange.png)

猫聙聦忙聢聭盲禄卢莽職聞莽聽聰莽漏露氓聫聭莽聨掳茂录聦忙聰禄氓聡禄猫聙聟氓聫炉盲禄楼氓聙聼氓聤漏忙聴聽莽潞驴盲驴隆茅聛聯盲赂颅忙職麓茅聹虏莽職聞忙聲掳忙聧庐氓聦聟茅聲驴氓潞娄莽颅聣盲戮搂盲驴隆茅聛聯盲驴隆忙聛炉茂录聦茅聙聬忙颅楼忙聨篓忙碌聥氓聡潞氓聫聴氓庐鲁猫聙聟盲陆驴莽聰篓莽職聞忙潞聬莽芦炉氓聫拢氓聫路茂录聦莽聰職猫聡鲁猫驴聸盲赂聙忙颅楼猫聨路氓聫聳TCP猫驴聻忙聨楼莽職聞SEQ氓聮聦ACK莽颅聣氓聫聜忙聲掳茂录聦盲禄聨猫聙聦盲赂潞氓聤芦忙聦聛忙聰禄氓聡禄氓聢聸茅聙聽忙聺隆盲禄露茫聙聜猫聙聦氓聫聴氓庐鲁猫聙聟莽職聞氓陇聳茅聝篓IP氓聹掳氓聺聙茂录聦氓聢聶氓聫炉盲禄楼茅聙職猫驴聡氓娄聜RCS氓聧聫猫庐庐忙录聫忙麓聻莽颅聣忙聳鹿氓录聫茂录聦氓聹篓忙聴聽莽聰篓忙聢路盲潞陇盲潞聮莽職聞忙聝聟氓聠碌盲赂聥猫垄芦猫聨路氓聫聳茫聙聜

## 猫聨路氓聫聳氓聫聴氓庐鲁猫聙聟莽職聞氓陇聳茅聝篓忙潞聬IP

氓陇搂氓陇職忙聲掳氓庐露氓潞颅氓聮聦盲录聛盲赂職莽陆聭莽禄聹茅聝陆氓陇聞盲潞聨NAT茂录聢莽陆聭莽禄聹氓聹掳氓聺聙猫陆卢忙聧垄茂录聣莽聨炉氓垄聝盲赂聥茂录聦氓聠聟茅聝篓IP盲赂聧氓聫炉猫搂聛茂录聦氓陇聳茅聝篓IP茅聙職氓赂赂忙聵炉氓聫聴氓庐鲁猫聙聟忙聣聙氓聹篓莽職聞NAT IP茫聙聜盲赂聙莽搂聧猫聨路氓聫聳IP莽職聞忙聳鹿氓录聫忙聵炉茂录聦氓聢漏莽聰篓RCS氓聧聫猫庐庐茂录聦氓聬聭氓聫聴氓庐鲁猫聙聟忙聣聥忙聹潞氓聫聭茅聙聛盲赂聙忙聺隆忙聦聡氓聬聭忙聰禄氓聡禄猫聙聟忙聹聧氓聤隆氓聶篓莽職聞茅垄聞猫搂聢氓聸戮莽聣聡茅聯戮忙聨楼莽職聞忙露聢忙聛炉茫聙聜猫驴聶盲赂聙忙露聢忙聛炉盲录職猫搂娄氓聫聭氓聫聴氓庐鲁猫聙聟氓聬聭忙聰禄氓聡禄猫聙聟忙聹聧氓聤隆氓聶篓氓聫聭茅聙聛盲赂聙盲赂陋GET猫炉路忙卤聜茂录聦盲禄聨猫聙聦猫聨路氓聫聳氓聫聴氓庐鲁猫聙聟莽職聞氓聟卢莽陆聭IP茂录聦莽聰篓忙聢路氓聹篓猫驴聶盲赂陋猫驴聡莽篓聥盲赂颅忙聴聽茅聹聙盲禄禄盲陆聲忙聯聧盲陆聹茫聙聜

![](/cn/uploads/2025/len_oracle/xml-request.png)

忙颅陇氓陇聳茂录聦忙聰禄氓聡禄猫聙聟猫驴聵氓聫炉盲禄楼氓聢漏莽聰篓氓聹掳莽聬聠氓庐職盲陆聧盲驴隆忙聛炉氓聮聦氓聼潞莽芦聶盲陆聧莽陆庐茂录聦莽禄聯氓聬聢猫驴聬猫聬楼氓聲聠莽職聞IP氓聢聠茅聟聧猫搂聞氓戮聥茂录聦莽录漏氓掳聫氓聟卢莽陆聭IP莽職聞莽聦聹忙碌聥猫聦聝氓聸麓茫聙聜

## 氓聢漏莽聰篓茅聲驴氓潞娄盲戮搂盲驴隆茅聛聯猫聨路氓聫聳氓聫聴氓庐鲁猫聙聟莽職聞氓陇聳茅聝篓忙潞聬莽芦炉氓聫拢

莽隆庐氓庐職氓聟卢莽陆聭IP氓聬聨茂录聦盲赂聥盲赂聙忙颅楼忙聵炉猫聨路氓聫聳NAT氓聢聠茅聟聧莽禄聶氓聫聴氓庐鲁猫聙聟莽職聞氓陇聳茅聝篓莽芦炉氓聫拢茫聙聜NAT茅聙職氓赂赂盲录職氓聹篓盲赂聙氓庐職猫聦聝氓聸麓氓聠聟氓聢聠茅聟聧莽芦炉氓聫拢茂录聢氓娄聜Linux氓赂赂猫搂聛氓聦潞茅聴麓32768-61000茂录聣茂录聦盲陆聠氓聢掳氓潞聲忙聵炉氓聯陋盲赂聙盲赂陋莽芦炉氓聫拢茂录聦氓陇聳茅聝篓盲赂聳莽聲聦茅聙職氓赂赂盲赂聧氓聫炉猫搂聛茫聙聜忙聰禄氓聡禄猫聙聟氓聫炉盲禄楼忙聻聞茅聙聽盲赂聧氓聬聦莽芦炉氓聫拢盲赂聧氓聬聦茅聲驴氓潞娄莽職聞忙聲掳忙聧庐氓聦聟氓聫聭茅聙聛氓聢掳氓聫聴氓庐鲁猫聙聟忙聣聙氓聹篓莽職聞氓陇聳茅聝篓NAT IP茫聙聜氓聫陋忙聹聣氓聦鹿茅聟聧莽聹聼氓庐聻莽芦炉氓聫拢莽職聞氓聦聟盲录職猫垄芦NAT猫陆卢氓聫聭茂录聦氓鹿露氓聹篓忙聴聽莽潞驴盲驴隆茅聛聯盲赂颅氓聡潞莽聨掳氓聤聽氓炉聠氓赂搂茂录聦盲禄聨猫聙聦猫垄芦忙聰禄氓聡禄猫聙聟忙聧聲猫聨路茫聙聜茅聙職猫驴聡氓聢聠忙聻聬氓聹篓忙聴聽莽潞驴盲驴隆茅聛聯盲赂颅氓聡潞莽聨掳莽職聞氓赂搂莽職聞茅聲驴氓潞娄莽聣鹿氓戮聛茂录聦忙聰禄氓聡禄猫聙聟盲戮驴氓聫炉盲禄楼猫聨路氓聫聳氓聫聴氓庐鲁猫聙聟莽職聞氓陇聳茅聝篓莽芦炉氓聫拢氓聫路茫聙聜

![](/cn/uploads/2025/len_oracle/nat-ip-port.png)

## 氓聢漏莽聰篓茅聲驴氓潞娄盲戮搂盲驴隆茅聛聯猫聨路氓聫聳忙颅拢莽隆庐莽職聞SEQ茂录聦ACK

氓炉鹿盲潞聨UDP氓聧聫猫庐庐茂录聦氓聫陋猫娄聛猫聨路氓戮聴氓陇聳茅聝篓IP氓聮聦莽芦炉氓聫拢茂录聦忙聰禄氓聡禄猫聙聟氓掳卤猫聝陆猫驴聸猫隆聦盲录陋茅聙聽氓聤芦忙聦聛茫聙聜猫聙聦TCP氓聧聫猫庐庐忙聸麓盲赂潞氓陇聧忙聺聜茂录聦茅聶陇盲潞聠氓聸聸氓聟聝莽禄聞茂录聦猫驴聵茅聹聙猫娄聛氓聡聠莽隆庐猫聨路氓聫聳氓潞聫氓聢聴氓聫路茂录聢SEQ茂录聣氓聮聦莽隆庐猫庐陇氓聫路茂录聢ACK茂录聣茂录聦氓聬娄氓聢聶盲录陋茅聙聽莽職聞忙聲掳忙聧庐氓聦聟盲录職猫垄芦莽聸麓忙聨楼盲赂垄氓录聝茫聙聜

忙颅陇忙聴露茂录聦茅聲驴氓潞娄盲戮搂盲驴隆茅聛聯氓聠聧忙卢隆氓聫聭忙聦楼盲陆聹莽聰篓茫聙聜忙聰禄氓聡禄猫聙聟氓聫炉盲禄楼氓聢漏莽聰篓TCP氓聧聫猫庐庐莽職聞Challenge ACK忙聹潞氓聢露茂录聦氓聬聭忙聹聧氓聤隆氓聶篓氓聫聭茅聙聛氓赂娄盲赂聧氓聬聦氓潞聫氓聢聴氓聫路莽職聞盲录陋茅聙聽氓聦聟茫聙聜氓娄聜忙聻聹氓聫聭茅聙聛盲赂聙盲赂陋氓聦聟茂录聦氓潞聫氓聢聴氓聫路/莽隆庐猫庐陇氓聫路氓聢職氓楼陆氓聹篓氓聹篓莽陋聴氓聫拢氓聠聟茂录聢In Window茂录聣茂录聦莽聸庐忙聽聡忙聹潞盲录職氓聸聻盲赂聙盲赂陋Challenge ACK氓聦聟茂录聦氓娄聜忙聻聹氓潞聫氓聢聴氓聫路/莽隆庐猫庐陇氓聫路氓庐聦氓聟篓茅聰聶盲潞聠茂录聦莽聸麓忙聨楼盲赂垄氓录聝氓聦聟茂录聦猫搂聜氓炉聼氓聫聴氓庐鲁猫聙聟忙聴聽莽潞驴盲驴隆茅聛聯盲赂颅忙聵炉氓聬娄氓聡潞莽聨掳氓聸潞氓庐職茅聲驴氓潞娄莽職聞Challenge ACK氓赂搂茫聙聜氓娄聜忙聻聹氓聡潞莽聨掳茂录聦猫炉麓忙聵聨莽聦聹忙碌聥莽職聞SEQ/ACK氓聹篓忙颅拢莽隆庐猫聦聝氓聸麓氓聠聟茫聙聜茅聙職猫驴聡盲赂聧忙聳颅猫掳聝忙聲麓莽聦聹忙碌聥猫聦聝氓聸麓茂录聦茅聡聡莽聰篓盲潞聦氓聢聠忙鲁聲莽颅聣忙聳鹿氓录聫茂录聦忙聹聙莽禄聢氓聫炉盲禄楼莽虏戮氓聡聠猫聨路氓戮聴TCP猫驴聻忙聨楼莽職聞忙聹聣忙聲聢SEQ氓聮聦ACK茂录聦盲禄聨猫聙聦氓庐聦氓聟篓忙聨搂氓聢露猫驴聻忙聨楼茫聙聜

![](/cn/uploads/2025/len_oracle/challenge-ack.png)

# 0x03 莽聹聼氓庐聻盲赂聳莽聲聦莽職聞忙聰禄氓聡禄忙录聰莽陇潞

忙聢聭盲禄卢氓卤聲莽陇潞盲潞聠盲赂聙莽搂聧氓聼潞盲潞聨莽聹聼氓庐聻氓聹潞忙聶炉莽職聞忙聰禄氓聡禄忙聳鹿忙鲁聲茂录職茅聙職猫驴聡氓聤芦忙聦聛 RCS茂录聢氓聫聢莽搂掳 5G 忙露聢忙聛炉茂录聣莽職聞 TCP 茅聲驴猫驴聻忙聨楼茂录聦氓聬聭莽聸庐忙聽聡忙鲁篓氓聟楼盲禄禄忙聞聫盲录陋茅聙聽莽職聞忙露聢忙聛炉茫聙聜RCS 忙聵炉盲赂聙莽搂聧氓聼潞盲潞聨 TCP 莽職聞 SMS 氓聧聫猫庐庐茂录聦茅聙職猫驴聡氓聤芦忙聦聛氓聟露茅聲驴猫驴聻忙聨楼茂录聦忙聰禄氓聡禄猫聙聟氓聫炉盲禄楼氓聬聭氓聫聴氓庐鲁猫聙聟氓聫聭茅聙聛盲禄禄忙聞聫盲录陋茅聙聽莽職聞莽聼颅盲驴隆茫聙聜氓聤芦忙聦聛 TCP 猫驴聻忙聨楼莽職聞猫驴聡莽篓聥氓陇搂莽潞娄茅聹聙猫娄聛 40 莽搂聮茂录聦忙聢聬氓聤聼氓聤芦忙聦聛氓聬聨茂录聦忙聰禄氓聡禄猫聙聟氓聫陋茅聹聙氓聬聭猫驴聻忙聨楼盲赂颅忙鲁篓氓聟楼盲录陋茅聙聽莽職聞莽聼颅盲驴隆莽禄聯忙聻聞茂录聦氓聧鲁氓聫炉盲陆驴氓聫聴氓庐鲁猫聙聟忙聨楼忙聰露氓聢掳盲禄禄忙聞聫盲录陋茅聙聽莽職聞莽聼颅盲驴隆茫聙聜

![](/cn/uploads/2025/len_oracle/real-world.png)

# 0x04 忙聙禄莽禄聯盲赂聨氓庐聣氓聟篓忙聫聬茅聠聮

猫驴聶莽卤禄忙聰禄氓聡禄莽職聞忙聹卢猫麓篓氓聹篓盲潞聨茂录職氓聧鲁盲戮驴忙聴聽莽潞驴忙碌聛茅聡聫氓路虏氓聤聽氓炉聠茂录聦忙聲掳忙聧庐氓聦聟莽職聞茅聲驴氓潞娄氓聮聦氓聫聭茅聙聛忙聴露氓潞聫莽颅聣氓聟聝盲驴隆忙聛炉盲戮聺莽聞露盲录職忙鲁聞茅聹虏氓聟鲁茅聰庐盲驴隆忙聛炉茫聙聜忙聰禄氓聡禄猫聙聟忙聴聽茅聹聙莽聽麓猫搂拢氓聤聽氓炉聠莽庐聴忙鲁聲茂录聦盲禄聟茅聙職猫驴聡氓聢聠忙聻聬氓聤聽氓炉聠氓赂搂莽職聞茅聲驴氓潞娄氓聮聦氓聧聫猫庐庐莽聣鹿忙聙搂茂录聦氓掳卤猫聝陆茅聙聬忙颅楼猫驴聵氓聨聼氓聡潞氓聫聴氓庐鲁猫聙聟莽職聞猫驴聻忙聨楼氓聫聜忙聲掳茂录聦猫驴聸猫聙聦氓庐聻莽聨掳猫驴聹莽篓聥氓聤芦忙聦聛茫聙聜盲鹿聥忙聣聙盲禄楼盲录職氓聡潞莽聨掳茅聲驴氓潞娄盲驴隆忙聛炉忙鲁聞忙录聫茂录聦盲赂禄猫娄聛忙聵炉氓聸聽盲赂潞忙聴聽莽潞驴氓聧聫猫庐庐忙聶庐茅聛聧茅聡聡莽聰篓忙碌聛氓炉聠莽聽聛茂录聦猫驴聶氓炉录猫聡麓氓聤聽氓炉聠氓聣聧氓聬聨莽職聞忙聲掳忙聧庐氓聦聟茅聲驴氓潞娄...