---
title: Advanced HTTP Request Smuggling (HRS) Exploitation Guide
url: https://infosecwriteups.com/advanced-http-request-smuggling-hrs-exploitation-guide-53ceadd5ac19?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2025-08-16
fetch_date: 2025-10-07T00:47:46.606406
---

# Advanced HTTP Request Smuggling (HRS) Exploitation Guide

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F53ceadd5ac19&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fadvanced-http-request-smuggling-hrs-exploitation-guide-53ceadd5ac19&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fadvanced-http-request-smuggling-hrs-exploitation-guide-53ceadd5ac19&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-53ceadd5ac19---------------------------------------)

¬∑

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-53ceadd5ac19---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# üí£ Advanced HTTP Request Smuggling (HRS) Exploitation Guide

[![Shah kaif](https://miro.medium.com/v2/resize:fill:64:64/1*ZCwTvovflA3nGDtIka9AAQ.jpeg)](https://medium.com/%40SKaif009?source=post_page---byline--53ceadd5ac19---------------------------------------)

[Shah kaif](https://medium.com/%40SKaif009?source=post_page---byline--53ceadd5ac19---------------------------------------)

3 min read

¬∑

Jun 12, 2025

--

Listen

Share

By

[Shah kaif](https://medium.com/u/10f677056bcd?source=post_page---user_mention--53ceadd5ac19---------------------------------------)

 | ‚ÄúTwo headers. One request. Your rules.‚Äù | [LinkedIn](https://www.linkedin.com/in/skaif009/)

Press enter or click to view image in full size

![]()

## What is HTTP Request Smuggling?

HTTP Request Smuggling occurs when **front-end (proxy/load balancer)** and **back-end (origin server)** interpret **request boundaries differently** due to ambiguity in HTTP parsing ‚Äî **CL.TE / TE.CL / TE.TE** confusion. This leads to **request desynchronization**, enabling:

* Web cache poisoning
* Credential hijacking
* Cross-user attacks
* Internal port scanning
* WAF bypassing

## Where it Works

![]()

## Where It Shouldn‚Äôt Work

Press enter or click to view image in full size

![]()

Press enter or click to view image in full size

![]()

## Testing Methodology (Pro-Grade)

## 1. Identify Candidate Targets

* Endpoints behind reverse proxies/load balancers
* Web apps with inconsistencies in error handling
* APIs served via proxy/CDN

Use `curl -I` or Burp to analyze headers ‚Äî look for:

* `Via`, `X-Cache`, `X-Forwarded-For`, `Server`, `Age`, `Transfer-Encoding`, etc.

## 2. Understand Stack Behavior

Perform **differential analysis**:

* Send malformed `Transfer-Encoding` header:
* `Transfer-Encoding: chunked Content-Length: 4`
* If server responds differently depending on header order/format, it‚Äôs a lead.

## 3. Exploit Request Boundary Desync

### TE.CL Example (Frontend respects TE, Backend respects CL):

```
POST / HTTP/1.1
Host: vulnerable.com
Transfer-Encoding: chunked
Content-Length: 4

0

GET /admin HTTP/1.1
Host: vulnerable.com
```

If frontend sees chunked and ends after `0\r\n\r\n`, it forwards the next GET request as part of the previous body to backend. Backend sees CL=4 and processes both.

### CL.TE Variant:

```
POST / HTTP/1.1
Host: target.com
Content-Length: 6
Transfer-Encoding: chunked

G
```

* Here, backend honors TE and sees malformed chunked body.
* Used to desync requests, poison next user‚Äôs session.

## Finding it in the Wild

## Clues:

* Random 404s after malformed requests
* Weird double 200 responses
* Hanging behavior on POST
* Cache keys change unexpectedly
* You get your own request echoed later

## Mitigations That Work (Blue Team View)

* **Drop duplicated headers**: Disallow both `Content-Length` and `Transfer-Encoding`.
* **Normalize headers**: Proxy should sanitize and validate before passing.
* **Chunk size inspection**: Strict TE parsing.
* **Enforce single protocol**: Prefer HTTP/2.

## Chaining Smuggling to Real-World Exploits

* **Steal sessions**: Smuggle poisoned cookies in a fake request.
* **Cache poisoning**: Smuggle into shared cache and poison next response.
* **Admin endpoint access**: Prefix `GET /admin` after 0-byte chunk.

## Real World Case Study (All Reported to Vendors)

Press enter or click to view image in full size

![]()

Follow For More Web Pentest, Red Teaming and Bug Hunter Writeups: [Medium](https://medium.com/%40SKaif009) and [LinkedIn](https://www.linkedin.com/in/skaif009/)

[Bug Bounty](https://medium.com/tag/bug-bounty?source=post_page-----53ceadd5ac19---------------------------------------)

[Bug Bounty Tips](https://medium.com/tag/bug-bounty-tips?source=post_page-----53ceadd5ac19---------------------------------------)

[Ethical Hacking](https://medium.com/tag/ethical-hacking?source=post_page-----53ceadd5ac19---------------------------------------)

[Web Security](https://medium.com/tag/web-security?source=post_page-----53ceadd5ac19---------------------------------------)

[Http Request Smuggling](https://medium.com/tag/http-request-smuggling?source=post_page-----53ceadd5ac19---------------------------------------)

--

--

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:96:96/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--53ceadd5ac19---------------------------------------)

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:128:128/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--53ceadd5ac19---------------------------------------)

Follow

[## Published in InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---post_publication_info--53ceadd5ac19---------------------------------------)

[71K followers](/followers?source=post_page---post_publication_info--53ceadd5ac19---------------------------------------)

¬∑[Last published¬†4 hours ago](/actuator-unleashed-a-guide-to-finding-and-exploiting-spring-boot-actuator-endpoints-29252dcd9d79?source=post_page---post_publication_info--53ceadd5ac19---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow

[![Shah kaif](https://miro.medium.com/v2/resize:fill:96:96/1*ZCwTvovflA3nGDtIka9AAQ.jpeg)](https://medium.com/%40SKaif009?source=post_page---post_author_info--53ceadd5ac19---------------------------------------)

[![Shah kaif](https://miro.medium.com/v2/resize:fill:128:128/1*ZCwTvovflA3nGDtIka9AAQ.jpeg)](https://medium.com/%40SKaif009?source=post_page---post_author_info--53ceadd5ac19---------------------------------------)

[## Written by Shah kaif](https://medium.com/%40SK...