---
title: Ivanti Connect Secure栈溢出漏洞（CVE-2025-0282）分析与复现
url: https://www.4hou.com/posts/Zggg
source: 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com
date: 2025-02-14
fetch_date: 2025-10-06T20:33:52.031601
---

# Ivanti Connect Secure栈溢出漏洞（CVE-2025-0282）分析与复现

Ivanti Connect Secure栈溢出漏洞（CVE-2025-0282）分析与复现 - 嘶吼 RoarTalk – 网络安全行业综合服务平台,4hou.com

[![](https://www.4hou.com/sihou/images/new4hou/newlogoss.png)](https://www.4hou.com)

* [首页](https://www.4hou.com)
* [企业中心](https://www.4hou.com/corp/newindex)
* [产业研究院](https://www.4hou.com/real-time)

![](https://www.4hou.com/sihou/images/new4hou/search-icon.png)

[投稿](https://www.4hou.com/contribute)

[登录](https://www.4hou.com/login)
  |
[注册](https://www.4hou.com/register)

* 导读 ▾
* [活动](https://www.4hou.com/newticket)
* [专题](https://www.4hou.com/category/special)
* [图谱](https://www.4hou.com/atlas/index)
* [报告](https://www.4hou.com/new-report-info)
* [嘶票](https://www.4hou.com/tickets)
* [嘶货](https://www.4hou.com/shop)
* [企业查询](https://www.4hou.com/corp/new-search-company)
* [招聘](https://www.4hou.com/recruit)![](https://www.4hou.com/sihou/images/1561626446625934.png)

* [新闻](https://www.4hou.com/category/news)
* [行业](https://www.4hou.com/category/industry)
* [趋势](https://www.4hou.com/category/observation)
* [访谈](https://www.4hou.com/category/people)
* [漏洞](https://www.4hou.com/category/vulnerable)
* [WEB安全](https://www.4hou.com/category/web)
* [业务安全](https://www.4hou.com/category/business)
* [系统安全](https://www.4hou.com/category/system)
* [内网渗透](https://www.4hou.com/category/penetration)
* [勒索软件](https://www.4hou.com/category/typ)
* [安全工具](https://www.4hou.com/category/tools)

# Ivanti Connect Secure栈溢出漏洞（CVE-2025-0282）分析与复现

盛邦安全
[技术](https://www.4hou.com/category/technology)
2025-02-13 14:44:38

![](https://img.4hou.com/article/%E6%B5%8F%E8%A7%88.png)266887

收藏

导语：Ivanti Connect Secure栈溢出漏洞（CVE-2025-0282）分析与复现

**漏洞概述**

Ivanti Connect Secure、Ivanti Policy Secure和Ivanti Neurons for ZTA gateways  是Ivanti 公司提供的远程访问和安全连接解决方案，主要功能包含VPN、访问控制、流量加密等。其IF-T/TLS协议在认证前，存在栈缓冲区溢出漏洞，攻击者可以利用该漏洞实现未授权远程代码执行。该漏洞已被APT组织利用。

**影响范围**

Ivanti Connect Secure 22.7R2 - 22.7R2.4

Ivanti Policy Secure 22.7R1 - 22.7R1.2

Ivanti Neurons for ZTA gateways 22.7R2 - 22.7R2.3

**复现环境**

版本：Ivanti Connect Secure 22.7R2.3

**环境搭建**

Ivanti Connect Secure 22.7R2.3导入虚拟机后开机，按照界面提示设置IP地址，管理员账号和密码等。

![1.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245388877309.png "1739245388877309.png")

配置成功后，进入命令行界面，可以根据编号进行系统管理，但是无法执行底层Shell命令。

![QQ20250211-114335.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245425392246.png "1739245425392246.png")

同时在浏览器中使用HTTPS协议打开配置的IP地址，可以正常显示Web登录界面。

![QQ20250211-114404.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245449239454.png "1739245449239454.png")

查看虚拟机磁盘文件，尝试挂载到其他系统，解包出系统中的文件。但是文件系统被加密，无法通过常规挂载方式获取系统文件。这种情况下，常见方案可以逆向分析系统启动流程，分析解密算法，解密出系统文件。但是时间成本比较高。

笔者则是选择使用另一种方法，将虚拟机暂停后，修改其内存文件中的/home/bin/dsconfig.pl字符串为///////////////bin/sh。/home/bin/dsconfig.pl是控制台界面执行时需要调用的脚本文件，替换后等待控制台界面超时后按“回车”，即可获取底层Shell。

![QQ20250211-114430.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245473129429.png "1739245473129429.png")

获取到底层Shell后，可以执行任意系统命令。然后使用自带的python程序，开启web服务，下载系统文件进行逆向分析。

![QQ20250211-114459.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245502922404.png "1739245502922404.png")

**漏洞分析**

根据公开的POC，漏洞使用HTTPS触发。定位到HTTPS服务的进程为/home/bin/web。

![QQ20250211-114523.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245526141649.png "1739245526141649.png")

逆向分析该web程序后发现，IF-T/TLS协议在认证时，获取客户端属性字段“clientIP”、“clientHostName”、“clientCapabilities”等进行处理。

![QQ20250211-114547.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245559203417.png "1739245559203417.png")

在处理过程中，使用strncpy复制clientCapabilities属性值时，最后一个参数v23是要复制的最大字节数。但是这里错误的使用了从客户端获取的clientCapabilities属性值的长度加1，用户可控制。

![QQ20250211-114616.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245579289740.png "1739245579289740.png")

而目的缓冲区（dest）是一个栈缓冲区，最大长度为256。客户端可传入超过256字节长度的clientCapabilities属性值，从而导致该栈缓冲区溢出。

![QQ20250211-114719.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245641206001.png "1739245641206001.png")

溢出后可覆盖栈中保存的返回地址，待执行到函数返回时，将跳转到覆盖的指定内存地址执行任意代码。

![QQ20250211-114738.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245662114017.png "1739245662114017.png")

**漏洞利用**

根据以上分析，溢出后只需要覆盖栈中保存的返回地址即可执行任意代码。但事实并非这么简单。目前遇到的问题：

1. 程序自身安全措施

2. 虚函数调用

3. 释放对象内存

首先分析下web程序自身的安全保护措施。

![QQ20250211-114758.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245680827755.png "1739245680827755.png")

该程序有NX和PIE保护，溢出后，栈中的数据默认没有执行权限，不能作为shellcode直接执行，可使用ROP技术绕过。

PIE和系统地址随机化安全措施，导致内存地址不再是固定值，无法提前预测，可使用信息泄露或者暴力破解等方法解决。分析后没找到可泄露内存地址的方法，由于该程序是32位程序，理论上最多尝试16的4次方，共65536次，可暴力破解libc.so.6的内存基地址。

![QQ20250211-114816.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245700261121.png "1739245700261121.png")

在执行到覆盖的返回地址前，还执行了许多其他代码，其中一个虚函数调用地址可能被覆盖，导致程序异常退出，无法执行到栈中被覆盖的返回地址。解决方法是在libc.so.6的内存中搜索满足该条件的虚函数调用，保证能正常执行到后续代码。

![QQ20250211-114835.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245718939538.png "1739245718939538.png")

此外，还有一处代码释放DSUtilMemPool对象内存，但是该内存被溢出覆盖了，导致程序异常退出。可将该对象内存地址设置为-1（0xFFFFFFFF），保证能正常执行到后续代码。

![QQ20250211-114854.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245737208066.png "1739245737208066.png")

经过上述分析，最终的栈布局如下图所示：

![QQ20250211-114911.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245755852550.png "1739245755852550.png")

经过布局，溢出后的clientCapabilities属性值数据，最终覆盖栈中返回地址，函数返回时，配合ROP技术，可执行任意代码。

![QQ20250211-114929.png](https://img.4hou.com/uploads/ueditor/php/upload/image/20250211/1739245773944519.png "1739245773944519.png")

**参考链接**

ddpoc链接：

[www.ddpoc.com/DVB-2025-8730.html](http://www.ddpoc.com/DVB-2025-8730.html)

```
https://github.com/BishopFox/CVE-2025-0282-checkhttps://cloud.google.com/blog/topics/threat-intelligence/ivanti-connect-secure-vpn-zero-dayhttps://labs.watchtowr.com/do-secure-by-design-pledges-come-with-stickers-ivanti-connect-secure-rce-cve-2025-0282/https://labs.watchtowr.com/exploitation-walkthrough-and-techniques-ivanti-connect-secure-rce-cve-2025-0282
```

[原文链接](https://mp.weixin.qq.com/s/e6X7GcKq1DaipmfsRqNq2w)

如若转载，请注明原文地址

* 分享至

![取消](https://www.4hou.com/sihou/images/close.jpg)
![嘶吼](https://www.4hou.com/sihou/images/logo.png)

感谢您的支持，我会继续努力的!

![扫码支持]( "扫一扫")

打开微信扫一扫后点击右上角即可分享哟

### 发表评论

评论

![](https://www.4hou.com/captcha/flat?UV7AoK9Z)

#### 你可能感兴趣的

* [![]()

  新型钓鱼即服务平台VoidProxy：瞄准微软365与谷歌账户 可绕过第三方SSO防护](https://www.4hou.com/posts/om1K)
* [![]()

  ArmouryLoader加载器的全面分析——典型加载器家族系列分析五](https://www.4hou.com/posts/xyE9)
* [![]()

  Darka5恶意家族样本分析](https://www.4hou.com/posts/jBmR)
* [![]()

  NimDoor加密盗窃macOS恶意软件被删除后会自动恢复](https://www.4hou.com/posts/qoEG)
* [![]()

  前瞻对抗｜这大概是首次，AI挖出了Linux内核可利用0day](https://www.4hou.com/posts/6MAV)
* [![]()

  攻防速写｜一条微信消息，实现客户端持久化攻击](https://www.4hou.com/posts/5MzK)

![](https://img.4hou.com/portraits/3c8d3af7c49c95c16dd14518142759d6.png)

# [盛邦安全](https://www.4hou.com/member/9ZO4)

让网络空间更有序

#### 最新文章

* [新型钓鱼即服务平台VoidProxy：瞄准微软365与谷歌账户 可绕过第三方SSO防护](https://www.4hou.com/posts/om1K)
  2025-09-17 12:00:00
* [ArmouryLoader加载器的全面分析——典型加载器家族系列分析五](https://www.4hou.com/posts/xyE9)
  2025-07-28 11:41:32
* [Darka5恶意家族样本分析](https://www.4hou.com/posts/jBmR)
  2025-07-24 14:04:33
* [NimDoor加密盗窃macOS恶意软件被删除后会自动恢复](https://www.4hou.com/posts/qoEG)
  2025-07-15 12:00:00

[查看更多](https://www.4hou.com/member/9ZO4)

# 相关热文

* [新型钓鱼即服务平台VoidProxy：瞄准微软365与谷歌账户 可绕过第三方SSO防护](https://www.4hou.com/posts/om1K)

  胡金鱼
* [ArmouryLoader加载器的全面分析——典型加载器家族系列分析五](https://www.4hou.com/posts/xyE9)

  安天
* [Darka5恶意家族样本分析](https://www.4hou.com/posts/jBmR)

  企业资讯
* [NimDoor加密盗窃macOS恶意软件被删除后会自动恢复](https://www.4hou.com/posts/qoEG)

  胡金鱼
* [前瞻对抗｜这大概是首次，AI挖出了Linux内核可利用0day](https://www.4hou.com/posts/6MAV)

  企业资讯
* [攻防速写｜一条微信消息，实现客户端持久化攻击](https://www.4hou.com/posts/5MzK)

  企业资讯

![]()

[公司简介](https://www.4hou.com/about?title=公司简介)
|
[我要投稿](https://www.4hou.com/about?title=我要投稿)
|
[更新日志](https://www.4hou.com/about?title=...