---
title: PipeMagic Trojan Exploits Windows Zero-Day Vulnerability to Deploy Ransomware
url: https://thehackernews.com/2025/04/pipemagic-trojan-exploits-windows-clfs.html
source: The Hacker News
date: 2025-04-10
fetch_date: 2025-10-06T22:09:36.535122
---

# PipeMagic Trojan Exploits Windows Zero-Day Vulnerability to Deploy Ransomware

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [PipeMagic Trojan Exploits Windows Zero-Day Vulnerability to Deploy Ransomware](https://thehackernews.com/2025/04/pipemagic-trojan-exploits-windows-clfs.html)

**Apr 09, 2025**Ravie LakshmananVulnerability / Ransomware

[![Windows CLFS Zero-Day Vulnerability to Deploy Ransomware](data:image/png;base64... "Windows CLFS Zero-Day Vulnerability to Deploy Ransomware")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi-OTpjyBb2Nu4iNnmTPpiOpg0yB8KzLe_tNoOBEP7MZQWpYrenr4CPHujexTAvU3h4fIaMJ2b5CPMO_7SnCFpF6w6bCIopR_4cgP6p5Pt_rcwVzQqMaVPcxWy06tTmm_RKf5nRliV7d4SDOFTgc9g45a_Mi_9eSjswz34Fntah7nvBVuR15APs0EOBWCqe/s790-rw-e365/ransomware-malware.jpg)

Microsoft has revealed that a now-patched security flaw impacting the Windows Common Log File System (CLFS) was exploited as a zero-day in ransomware attacks aimed at a small number of targets.

"The targets include organizations in the information technology (IT) and real estate sectors of the United States, the financial sector in Venezuela, a Spanish software company, and the retail sector in Saudi Arabia," the tech giant [said](https://www.microsoft.com/en-us/security/blog/2025/04/08/exploitation-of-clfs-zero-day-leads-to-ransomware-activity/).

The vulnerability in question is CVE-2025-29824, a privilege escalation bug in CLFS that could be exploited to achieve SYSTEM privileges. It was [fixed by Redmond](https://thehackernews.com/2025/04/microsoft-patches-126-flaws-including.html) as part of its Patch Tuesday update for April 2025.

Microsoft is tracking the activity and the post-compromise exploitation of CVE-2025-29824 under the moniker Storm-2460, with the threat actors also leveraging a malware named PipeMagic to deliver the exploit as well as ransomware payloads.

[![DFIR Retainer Services](data:image/png;base64...)](https://thehackernews.uk/cloud-insight-d)

The exact initial access vector used in the attacks is currently not known. However, the threat actors have been observed using the certutil utility to download malware from a legitimate third-party site that was previously compromised to stage the payloads.

The malware is a malicious [MSBuild file](https://blog.talosintelligence.com/building-bypass-with-msbuild/) that contains an encrypted payload, which is then unpacked to launch PipeMagic, a plugin-based trojan that has been detected in the wild since 2022.

It's worth mentioning here that CVE-2025-29824 is the second Windows zero-day flaw to be delivered via PipeMagic after [CVE-2025-24983](https://thehackernews.com/2025/03/urgent-microsoft-patches-57-security.html), a Windows Win32 Kernel Subsystem privilege escalation bug, which was flagged by ESET and patched by Microsoft last month.

Previously, PipeMagic was also observed in connection with Nokoyawa ransomware attacks that exploited another CLFS zero-day flaw ([CVE-2023-28252](https://thehackernews.com/2023/04/urgent-microsoft-issues-patches-for-97.html)).

"In some of the other attacks that we attribute to the same actor, we also observed that, prior to exploiting the CLFS elevation-of-privilege vulnerability, the victim's machines were infected with a custom modular backdoor named 'PipeMagic' that gets launched via an MSBuild script," Kaspersky [pointed out](https://securelist.com/nokoyawa-ransomware-attacks-with-windows-zero-day/109483/) in April 2023.

It's crucial to note that Windows 11, version 24H2, is not affected by this specific exploitation, as access to certain System Information Classes within [NtQuerySystemInformation](https://learn.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntquerysysteminformation) is restricted to users with [SeDebugPrivilege](https://learn.microsoft.com/en-us/windows/win32/secauthz/privilege-constants), which typically only [admin-like users](https://devblogs.microsoft.com/oldnewthing/20080314-00/?p=23113) can obtain.

"The exploit targets a vulnerability in the CLFS kernel driver," the Microsoft Threat Intelligence team explained. "The exploit then utilizes a memory corruption and the RtlSetAllBits API to overwrite the exploit process's token with the value 0xFFFFFFFF, enabling all privileges for the process, which allows for process injection into SYSTEM processes."

[![CIS Build Kits](data:image/png;base64...)](https://thehackernews.uk/platform-shield-d)

Successful exploitation is followed by the threat actor extracting user credentials by dumping the memory of LSASS and encrypting files on the system with a random extension.

Microsoft said it was unable to obtain a ransomware sample for analysis, but said that the ransom note dropped after encryption included a TOR domain tied to the [RansomEXX](https://www.ransomlook.io/group/ransomexx) [ransomware family](https://thehackernews.com/2022/11/new-ransomexx-ransomware-variant.html).

"Ransomware threat actors value post-compromise elevation of privilege exploits because these could enable them to escalate initial access, including handoffs from commodity malware distributors, into privileged access," Microsoft said. "They then use privileged access for widespread deployment and detonation of ransomware within an environment."

Found this article interesting? Follow us on [Google News](https://news.google.com/publications/CAAqLQgKIidDQklTRndnTWFoTUtFWFJvWldoaFkydGxjbTVsZDNNdVkyOXRLQUFQAQ), [Twitter](https://twitter.com/thehackersnews) and [LinkedIn](https://www.linkedin.com/company/thehackernews/) to read more exclusive content we post.

SHARE
[**](#link_share)
[**](#link_share)
[**](#link_share)
**

[**Tweet](#link_share)

[**Share](#link_share)

[**Share](#link_share)

**Share

**
[**Share on Facebook](#link_share)
[**Share on Twitter](#link_share)
[**Share on Linkedin](#link_share)
[**Share on Reddit](#link_share)
[**Share on Hacker News](#link_share)
[**Share on Email](#link_share)
[**Share on WhatsApp](#link_share)
[![Facebook Messenger](data:image/png;base64...)Share on Facebook Messenger](#link_share)
[**Share on Telegram](#link_share)

SHARE **

[cybersecurity](https://thehacker...