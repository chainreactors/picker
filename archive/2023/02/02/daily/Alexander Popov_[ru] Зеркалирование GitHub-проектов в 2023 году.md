---
title: [ru] Зеркалирование GitHub-проектов в 2023 году
url: https://a13xp0p0v.github.io/2023/02/01/mirroring-github-projects-ru.html
source: Alexander Popov
date: 2023-02-02
fetch_date: 2025-10-04T05:28:37.065624
---

# [ru] Зеркалирование GitHub-проектов в 2023 году

[![](/img/favicons/a13xp0p0v_ava.png) Alexander Popov](/)
[ ]

[About](/about/)[Articles](/articles/)[Conference Talks](/conference_talks/)

# [ru] Зеркалирование GitHub-проектов в 2023 году

Feb 1, 2023

По ряду причин я решил зеркалировать [свои открытые GitHub-проекты](https://github.com/a13xp0p0v) на другие платформы совместной разработки. Сделать это оказалось не так просто. В этой короткой статье описаны трудности, с которыми мне пришлось столкнуться, и итоговое рабочее решение.

![](https://a13xp0p0v.github.io/img/Alice.jpg)

Ранее я пользовался функцией зеркалирования [GitLab](https://about.gitlab.com/), которая называется pull mirroring. Она с определенной периодичностью копировала код, теги и обсуждения в issues и pull requests из моих GitHub-репозиториев в GitLab. Но некоторое время назад я заметил, что мои GitLab-зеркала стали отставать от основных репозиториев. Я вошел в GitLab и увидел вот такой неприятный баннер:

![](https://a13xp0p0v.github.io/img/gitlab_banner.png)

Функция pull mirroring исчезла из некоторых моих репозиториев. Включить ее бесплатно более невозможно:

![](https://a13xp0p0v.github.io/img/gitlab_pull_mirroring.png)

Покупка премиум-поддержки GitLab (Premium Tier) невозможна в России. GitLab запрещает использовать даже ее бесплатную пробную версию. Поэтому я стал искать другие решения для зеркалирования моих GitHub-проектов:

* Развертывание своего отдельного сервера разработки GitLab или [Forgejo](https://forgejo.org/) мне не подходило: я не хотел размещать свои open-source проекты на изолированном сервере. Это значительно ограничило бы взаимодействие с сообществом и стало бы препятствием для контрибьюторов.
* Я проверил китайскую платформу [Gitee](https://gitee.com), и мне не понравилась ее ограниченная поддержка английской локализации.
* Я посмотрел на [Radicle](https://radicle.xyz), пиринговую сеть для разработки программного обеспечения. Но ее «мощные функциональные возможности, основанные на блокчейне», показались мне слишком уж радикальными.
* Затем я посмотрел на [Codeberg](https://codeberg.org/). Эту платформу коллективной разработки поддерживает одноименная некоммерческая организация, продвигающая идеи свободного программного обеспечения (free software). Эти ребята мне нравятся гораздо больше, чем Microsoft, владеющая GitHub. Но в марте 2020 года они отключили функцию зеркалирования на серверах Codeberg из-за [нехватки ресурсов](https://blog.codeberg.org/mirror-repos-easily-created-consuming-resources-forever.html). По их словам, «зеркалированные репозитории легко создаются, но потребляют ресурсы вечно» :(
* Я также проверил [SourceHut](https://sourcehut.org) (спасибо [paulmairo](https://twitter.com/_paulmairo) за ссылку). Эта платформа мне не подошла, потому что:
  1. Она предоставляет только платные услуги.
  2. Процесс разработки на ней выглядит несовместимым с GitHub: на платформе SourceHut для работы с задачами и кодом проектов используется электронная почта.
* Я посмотрел на [Salsa](https://salsa.debian.org) (спасибо [Mic\_92](https://twitter.com/Mic_92) за идею). Это сервер совместной разработки сообщества Debian, который работает на программном обеспечении GitLab. Сначала я зарегистрировал там учетную запись. Несколько дней спустя администратор Salsa активировал ее, и мне удалось скопировать один из моих проектов из GitHub в Salsa. Но оказалось, что функция pull mirroring в Salsa тоже отключена, как и на [gitlab.com](https://about.gitlab.com/) в бесплатном режиме. Я [задал вопрос об этом](https://salsa.debian.org/salsa/support/-/issues/326) в их трекере, но, к сожалению, не получил никакого ответа.
* Затем я создал [зеркала](https://gitflic.ru/user/a13xp0p0v) для своих GitHub-проектов на [GitFlic](https://gitflic.ru). Это небольшая российская платформа коллективной разработки, которая сейчас активно развивается. Их служба поддержки разрешила мне создать публичные репозитории и настроить зеркалирование. Кроме того, они довольно оперативно отвечали на вопросы и давали комментарии по обнаруженным проблемам. К сожалению, в GitFlic нет CI и даже нет возможности копировать информацию из issues и pull requests с GitHub. Очевидно, зеркала на GitFlic не стали для меня окончательным решением.

![](https://a13xp0p0v.github.io/img/gitflic_mirroring.png)
*Схема зеркалирования GitHub -> GitFlic*

Кстати, я бы предложил команде GitFlic назвать раздел Issues для проектов на платформе не «Проблемы», а «Задачи».

Подводя итог, я не нашел ни одной популярной платформы для совместной разработки, которая могла бы предоставить полнофункциональные зеркала для моих проектов на GitHub. Поэтому я решил взглянуть на эту задачу с другой стороны: как я могу вручную создать резервную копию обсуждений в своих GitHub-проектах?

Первая идея состояла в том, чтобы сделать эту информацию частью кода. Вскоре я нашел проект [gh2md](https://github.com/mattduck/gh2md), который это позволяет. Инструмент gh2md выгружает содержимое GitHub issues и pull requests заданного проекта в Markdown-документ.

Под капотом этот инструмент использует интерфейсы GraphQL, предоставляемые GitHub, поэтому для него мне пришлось сгенерировать личный токен доступа GitHub с минимальными привилегиями. Подробности о работе с такими токенами можно найти в [документации GitHub](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token).

![](https://a13xp0p0v.github.io/img/github_access_token.png)
*Токен доступа GitHub*

Теперь мои проекты содержат файл `issues.md` [с резервной копией всех задач и обсуждений](https://github.com/a13xp0p0v/kconfig-hardened-check/blob/master/issues.md). Можно было бы использовать gh2md в CI, чтобы обновлять `issues.md` автоматически. Но пока я воздерживаюсь от предоставления скриптам GitHub Actions полного доступа к репозиторию.

В определенный момент мне пришла мысль о CI-скрипте, который генерировал бы pull request с обновлениями файла `issues.md`. Но вскоре я понял, что это не очень умная идея: такой автоматически созданный запрос приведет к очередному срабатыванию CI-скрипта для обновления `issues.md`, что создаст еще один pull request, и так далее :) Я решил не изобретать самому себе проблемы и добавил ручное обновление `issues.md` в список релизных процедур для своих проектов.

Есть и другой способ: можно выгрузить задачи и обсуждения из GitHub в git-хранилище проекта. Это можно сделать с помощью специального трекера [git-bug](https://github.com/MichaelMure/git-bug) (спасибо [Сергею Бронникову](https://twitter.com/estet) за ссылку):

![](https://a13xp0p0v.github.io/img/git-bug.png)
*Проект git-bug*

В итоге после создания резервной копии информации из GitHub issues и pull requests я решил создать копии своих проектов на Codeberg и затем просто выполнять операцию `git push` одновременно и для GitHub, и для Codeberg. Платформа Codeberg успешно выполнила разовую миграцию моих проектов из GitHub, даже скопировала все обсуждения и задачи. Так что это было бы идеальным решением для меня, если бы в Codeberg было включено зеркалирование… Увы!

Тогда передо мной возник вопрос: что делать с устаревающей информацией в Codeberg issues? В крайнем случае можно было бы вручную удалять и воссоздавать проекты на Codeberg, чтобы поддерживать актуальность, но такое решение мне совсем не нравилось.

![](https://a13xp0p0v.github.io/img/codeberg_mirroring.png)
*Схема зеркалирования GitHub -> Codeberg*

Я стал изучать настройки репозиториев и нашел обходной путь: Codeberg позволяет использовать внешний трекер задач! Я задал ссылку на задачи в GitHub и формат нумерации, отключил запросы на слияние в Codeberg, и теперь зеркала моих проектов просто ссылаются на issues и pull requests в GitHub.

![](https://a13xp0p0v.github.io/img/codeberg_links.png)
*Настройка репозитория Codeberg*

Вот это уже более или менее рабочее решение. Если что-то пойдет не так с GitHub, то я пересоздам репозитории в Codeberg, включу в них внутренний трекер и запросы на слияние, после чего анонсирую для сообщества и дистрибути...