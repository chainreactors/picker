---
title: FOFA模糊搜索的正确姿势
url: https://www.anquanke.com/post/id/287369
source: 安全客-有思想的安全新媒体
date: 2023-03-15
fetch_date: 2025-10-04T09:33:12.611776
---

# FOFA模糊搜索的正确姿势

首页

阅读

* [安全资讯](https://www.anquanke.com/news)
* [安全知识](https://www.anquanke.com/knowledge)
* [安全工具](https://www.anquanke.com/tool)

活动

社区

学院

安全导航

内容精选

* [专栏](/column/index.html)
* [精选专题](https://www.anquanke.com/subject-list)
* [安全KER季刊](https://www.anquanke.com/discovery)
* [360网络安全周报](https://www.anquanke.com/week-list)

# FOFA模糊搜索的正确姿势

阅读量**1259913**

发布时间 : 2023-03-14 14:30:44

**x**

##### 译文声明

本文是翻译文章

译文仅供参考，具体内容表达以及含义原文为准。

![]()

**▌前言**

当初开发模糊搜索功能的初衷是为了解决分词不完整的问题，包括中文字符和英文字符的分词。这些分词问题可能会导致用户在搜索过程中无法搜到结果。例如，在搜索“banner”数据时，一条MySQL的banner数据中包含”ubuntu”关键词，但是由于系统正确的分词是”0ubuntu0″，导致大家搜索不到匹配结果。

令人惊喜的是，在此过程中我们发现，模糊搜索功能其实可以适用于更多特定的搜索场景。本文即将向各位FOFA工程师介绍模糊搜索的多样玩法，希望为大家带来一些便捷和启发。

**▌使用场景演示**

**1. 基础使用方法演示**

这里我们以域名为例，如**host=”test.baidu.com”**的搜索结果，针对其进行模糊匹配搜索。

host=”test.baidu.com”

![]()

我们需要的是，主域名为**baidu.com**但子域名包含test关键词的资产，test关键词后缀可能有其他信息，那么FOFA的搜索语句就是：

host\*=”test\*.baidu.com”

![]()

这时我们继续变更需求，需要主域名为**baidu.com**但子域名中包含test关键词的资产，test关键词前后可能有其他字符，那么FOFA的搜索语句就是：

host\*=”\*test\*.baidu.com”

![]()

再变更一下目标，需要查询主域为**baidu.com**但是子域中是test+1个字符的关键词资产，那么FOFA的搜索语句是：

host\*=”test?.baidu.com”

![]()

多个字符，就是添加多个?需要多少就添加多少，比如我需要子域字符为5个的，甚至可以是：

host\*=”?????.baidu.com”

![]()

也可以多次进行模糊搜索，test和.baidu.com直接模糊匹配，以及后面继续接字符的资产。

host\*=”test\*.baidu.com.\*”

![]()

也可以这样搜，我需要所有包含test关键词的域名，不管他在哪个位置，继续变更搜法：

host\*=”\*test\*”

![]()

当然，这样搜的结果就是范围特别广了，这里只是作为解锁更多搜索方式为大家介绍使用，其实也可以用这样的形式对边缘资产进行搜索。

**2. 聚焦场景演示**

我们通过前文已经了解到，他可以解决分词的问题，也了解到了模糊搜索的使用方法。那我们聚焦一个小场景，为大家展示模糊搜索的使用。

我们以mysql作为例子：mysql有多个版本存在，先在FOFA上进行搜索：

banner=”mysql version”

![]()

可以看到近一年有1000多万的数据，这里是搜索了所有的版本的，现在可以使用模糊搜索对于版本进行一个范围区分。

我们需要5.?.\*的所有版本，就可以这样进行搜索：

banner=”mysql version” && banner\*=”5.?.\*”

![]()

继续缩小范围，我们仅需要版本为5.5.4+类型的数据，那可以这样进行搜索：

banner=”mysql version” && banner\*=”5.5.4\*”

![]()

通过搜索结果展示，我们成功聚焦到了Mysql Version：5.5.4\*的各种版本，可以继续对目标进行聚焦，方法是一样的。

**3. 更多玩法**

SNMP协议有多个版本，我想一次性找全，使用模糊搜索的语法为：

protocol\*=”snmp\*”

![]()

突然忘记云服务商Cloudflare的名字，使用模糊搜索，快速找到自己需要的目标：

cloud\_name\*=”Cloud\*”

![]()

对于已知的搜索结果，模糊搜索端口是四位数的资产。

domain=”fofa.info” && port\*=”????”

![]()

**▌模糊搜索是什么？**

模糊搜索是一种搜索技巧，用于在数据集中查找与查询词或关键字相似的结果。

模糊搜索可以帮助FOFA工程师更好地匹配和搜索关键词，使得搜索结果更加全面、准确。与精确搜索相比，模糊搜索更加灵活，可以处理各种不规则的输入，例如拼写错误、变体、缩写和语言差异等。

在FOFA平台中，使用通配符匹配功能就可以实现模糊搜索的效果。例如，在搜索时，可以在关键词中使用通配符“\*”和“?”来匹配不同的字符和字符串，以进行模糊搜索。相信大家在前面的演示中已经大概明白了模糊搜索的使用方法，这里再对用法进行一个说明：

在FOFA上，模糊搜索是通过在\*=后面添加通配符 \* 或 ? 来实现的，但 \*= 并不是通配符，仅仅是用来表示使用模糊搜索功能的符号。同时，通配符\*和?代表着不同的意思：

\*表示匹配的数量不受限制，可以用来代替 0 个、1 个或多个字符；

? 仅仅可替代 1 个字符。

**▌总结**

FOFA的模糊搜索功能为大家提供了更多的搜索灵活性和准确性，让大家可以通过通配符的使用更加开放性地搜索到目标资产和漏洞。本文简单介绍了FOFA的模糊搜索功能，以及通过通配符进行模糊搜索的基本用法。

FOFA的模糊搜索功能仍然有很多未被探索的搜索方式等待开发。FOFA工程师们可以根据不同的需求和场景，不断尝试创新，开发出更加高效、精准的搜索方式。

个人版及以上的订阅会员或F点单功能消费就可以使用该功能哦，期待大家的脑洞！

本文翻译自 原文链接。如若转载请注明出处。

商务合作，文章发布请联系 anquanke@360.cn

本文由**FofaBot**原创发布

转载，请参考[转载声明](https://www.anquanke.com/note/repost)，注明出处： [https://www.anquanke.com/post/id/287369](/post/id/287369)

安全KER - 有思想的安全新媒体

本文转载自:

如若转载,请注明出处：

安全KER - 有思想的安全新媒体

分享到：![微信](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

* [fofa](/tag/fofa)
* [网络空间测绘](/tag/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E6%B5%8B%E7%BB%98)
* [模糊搜索](/tag/%E6%A8%A1%E7%B3%8A%E6%90%9C%E7%B4%A2)

**+1**29赞

收藏

![](https://p1.ssl.qhimg.com/t01ae08ffd517dd608b.png)FofaBot

分享到：![微信](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

## 发表评论

您还未登录，请先登录。

[登录](/login/index.html)

![](https://p2.ssl.qhimg.com/t014757b72460d855bf.png)

[![](https://p1.ssl.qhimg.com/t01ae08ffd517dd608b.png)](/member.html?memberId=163741)

[FofaBot](/member.html?memberId=163741)

FOFA唯一官方

* 文章
* **4**

* 粉丝
* **1**

### TA的文章

* ##### [隐匿在供应链丛林中的狩猎者：针对中小型供应商的定向突破策略](/post/id/304754)

  2025-03-12 11:24:03
* ##### [大模型竟成为犯罪帮凶？](/post/id/294205)

  2024-03-25 11:31:37
* ##### [FOFA模糊搜索的正确姿势](/post/id/287369)

  2023-03-14 14:30:44
* ##### [FOFA实战攻防对抗中企业安全运营场景下的应用（一）](/post/id/285593)

  2023-01-28 15:30:12

### 相关文章

* ##### [隐匿在供应链丛林中的狩猎者：针对中小型供应商的定向突破策略](/post/id/304754)

  2025-03-12 11:24:03
* ##### [国际权威认可！知道创宇 ZoomEye 荣获 2023 年度赛可达优秀产品奖](/post/id/292701)

  2024-01-17 18:07:59
* ##### [“网络空间测绘”持续升温 华顺信安获逾亿元B轮融资](/post/id/238853)

  2021-04-21 17:48:26
* ##### [Quake新功能更新：一键C段查询与数据去重](/post/id/238611)

  2021-04-19 18:00:38
* ##### [浅析Cobalt Strike Team Server扫描](/post/id/238391)

  2021-04-16 15:30:28
* ##### [360Quake红蓝对抗新功能更新](/post/id/237806)

  2021-04-12 17:27:18
* ##### [活动 | QUAKE年度活动 限时大放送！](/post/id/237527)

  2021-04-08 18:30:07

### 热门推荐

文章目录

![](https://p0.qhimg.com/t11098f6bcd5614af4bf21ef9b5.png)

安全KER

* [关于我们](/about)
* [联系我们](/note/contact)
* [用户协议](/note/protocol)
* [隐私协议](/note/privacy)

商务合作

* [合作内容](/note/business)
* [联系方式](/note/contact)
* [友情链接](/link)

内容需知

* [投稿须知](https://www.anquanke.com/contribute/tips)
* [转载须知](/note/repost)
* 官网QQ群：568681302

合作单位

* [![安全KER](https://p0.ssl.qhimg.com/t01592a959354157bc0.png)](http://www.cert.org.cn/)
* [![安全KER](https://p0.ssl.qhimg.com/t014f76fcea94035e47.png)](http://www.cnnvd.org.cn/)

Copyright © 北京奇虎科技有限公司 三六零数字安全科技集团有限公司 安全KER All Rights Reserved [京ICP备08010314号-66](https://beian.miit.gov.cn/)[![](https://icon.cnzz.com/img/pic.gif)](https://www.cnzz.com/stat/website.php?web_id=1271278035 "站长统计")

微信二维码

**X**![安全KER](https://p0.ssl.qhimg.com/t0151209205b47f2270.jpg)