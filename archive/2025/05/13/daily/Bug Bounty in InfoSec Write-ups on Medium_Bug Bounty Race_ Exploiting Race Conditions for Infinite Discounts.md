---
title: Bug Bounty Race: Exploiting Race Conditions for Infinite Discounts
url: https://infosecwriteups.com/bug-bounty-race-exploiting-race-conditions-for-infinite-discounts-a2cb2f233804?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2025-05-13
fetch_date: 2025-10-06T22:25:42.837805
---

# Bug Bounty Race: Exploiting Race Conditions for Infinite Discounts

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa2cb2f233804&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fbug-bounty-race-exploiting-race-conditions-for-infinite-discounts-a2cb2f233804&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fbug-bounty-race-exploiting-race-conditions-for-infinite-discounts-a2cb2f233804&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-a2cb2f233804---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-a2cb2f233804---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# Bug Bounty Race: Exploiting Race Conditions for Infinite Discounts

## Race Condition Vulnerability hands on experience to apply discount coupons multiple times and bypass intended pricing logic.

[![Aditya Bhatt](https://miro.medium.com/v2/resize:fill:64:64/1*6TFmlC58KtmaRsYHdjy9Qg.jpeg)](https://medium.com/%40adityabhatt3010?source=post_page---byline--a2cb2f233804---------------------------------------)

[Aditya Bhatt](https://medium.com/%40adityabhatt3010?source=post_page---byline--a2cb2f233804---------------------------------------)

6 min read

·

May 11, 2025

--

Listen

Share

## 🔄 What is a Race Condition?

A Race Condition occurs when two or more operations are executed concurrently, and the final outcome depends on the timing or order of execution. If these operations are not synchronized properly, it can lead to unexpected or malicious results.

In simpler terms:

> *It’s like two people racing to withdraw money from a shared ATM account at the same time — both see the same balance and withdraw it, resulting in double-spending.*

Press enter or click to view image in full size

![]()

Bug Bounty Race

## 🧠 Why Do Race Conditions Matter in Security?

In secure applications, especially those dealing with:

* Payment systems
* Authentication/authorization
* Inventory management
* Coupon codes or rewards

Race conditions can be exploited to bypass checks or perform unauthorized actions. These are a class of business logic vulnerabilities — flaws in the way the application was designed to handle actions in sequence.

## 🕵️‍♂️ Race Conditions in Bug Hunting

In bug bounty hunting or pentesting, race conditions are a goldmine because they often:

* Lead to critical financial losses (e.g., double-purchases with coupons)
* Bypass authorization or verification
* Allow escalation of privileges
* Cause data corruption or leakage

## ✅ Common Use Cases in Bug Hunting:

ScenarioExploitMultiple Coupon ApplicationApply same coupon simultaneously to get stacked discountsBypassing Payment GatewaysTrigger payment confirmation and cancel before debitReset Password AbuseSimultaneously change password and verify tokenInventory ExploitationPurchase limited-stock items more than allowedPrivilege EscalationSend simultaneous role change and privilege check requests

## 🔧 How are Race Conditions Exploited?

Exploitation typically requires sending parallel or concurrent requests that manipulate server-side logic before it updates the shared state.

### 🔨Tools and Methods:

* Burp Suite Repeater’s Tab Groups → Sending requests in parallel
* Fuzzing with Intruder or Turbo Intruder
* Custom Python/Go scripts with threading
* Intercepting sensitive state-changing requests (like coupon or checkout) and duplicating them

### 🔍 Signs of a Race Condition:

* A value is updated after a check is made (TOCTOU: Time of Check to Time of Use).
* Operations lack atomicity (not all done in one indivisible step).
* Repeated or concurrent actions produce inconsistent results.

## 📍 Real-World Examples

1. **Tesla Bug Bounty (2020):** Researcher purchased vehicle software upgrades for free by sending multiple purchase requests simultaneously.
2. **Uber Bug Bounty (2016):** Exploited a logic flaw to earn promo credits infinitely.
3. **e-Commerce Sites:** Repeated coupon code application reduced prices to zero due to missing locking.

## 🧪 Connecting to the Lab: Limit Overrun Race Condition (BurpSuite)

### 🎯 Objective:

Buy a Lightweight L33t Leather Jacket for a price lower than intended by abusing race condition in coupon application logic.

### 🔥 Vulnerability:

The app fails to lock coupon usage during the apply coupon process, allowing multiple discounts via simultaneous requests.

### 🧬 Exploitation Flow:

1. Intercepted the `POST /cart/coupon` request applying the discount.
2. Duplicated the request in Burp Suite Repeater tab group (20 times).
3. Sent all requests in parallel, hitting the server simultaneously.
4. Server responded with multiple success messages, applying the discount multiple times.
5. Final cart value = jacket price — (discount × number of successes).
6. Purchased the jacket with less than original cost, lab marked Solved.

### 🧑‍💻👩‍💻 PoC WriteUp — BurpSuite Lab: Limit Overrun Race Conditions (APPRENTICE)

### 🛠️ Steps Performed

1. Accessing the Lab

* Log in using `wiener:peter` credentials and accessed the application.

Press enter or click to view image in full size

![]()

Screenshot 1

2. Viewing the Jacket

* Navigate to the product catalog and identify the target item: Lightweight L33t Leather Jacket.

Press enter or click to view image in full size

![]()

Screenshot 2

3. Adding the Jacket to Cart

* Add the jacket to the cart to prepare for the exploit.

Press enter or click to view image in full size

![]()

Screenshot 3

4. Opening the Cart, Applying the Coupon, and Setting Up Proxy

* Open the cart, apply the coupon code.
* Enabl BurpSuite Proxy using FoxyProxy to begin interception.

Press enter or click to view image in full size

![]()

Screenshot 4

5. Intercepting the Request

* Intercept the POST /cart/coupon request containing the discount code.
* Later it can be Dropped and the page refreshed after Step 10.

Press enter or click to view image in full size

![]()

Screenshot 5

6. Repeater Screenshot

* Send the coupon application request to Repeater for manual testing.

Press enter or click to view image in full size

![]()

Screenshot 6

7. Creating Duplicate Requests

* Duplicate the POST /cart/coupon request 40 times.
* Ctrl + R can be used after selecting the request number or right click the request > Duplicate tab > Enter 40.

Press enter or click to view image in full size

![]()

Screenshot 7

8. Adding All Tabs to a Group

* Add the original and all duplicate requests into a single tab group in Burp Repeater.

![]()

Screenshot 8

9. Group Screenshot

* Capture a screenshot of the tab group showing ...