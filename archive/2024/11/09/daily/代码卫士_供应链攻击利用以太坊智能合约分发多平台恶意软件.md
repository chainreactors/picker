---
title: 供应链攻击利用以太坊智能合约分发多平台恶意软件
url: https://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247521429&idx=2&sn=cf6c06d85ec7ed76747b42e31d2219dd&chksm=ea94a5ffdde32ce9200617623843d025b5038aacc8e3501352b5bad7e9d0f84ec71d0f9ae087&scene=58&subscene=0#rd
source: 代码卫士
date: 2024-11-09
fetch_date: 2025-10-06T19:19:21.264284
---

# 供应链攻击利用以太坊智能合约分发多平台恶意软件

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/oBANLWYScMTlsP2JygJSIicfMfhx5FBVub87e0qCBuEtgOK2RH3LCanFyxLg2njrocykRSdJAcokib1aIlT5G77g/0?wx_fmt=jpeg)

# 供应链攻击利用以太坊智能合约分发多平台恶意软件

DO SON

代码卫士

![](https://mmbiz.qpic.cn/mmbiz_gif/Az5ZsrEic9ot90z9etZLlU7OTaPOdibteeibJMMmbwc29aJlDOmUicibIRoLdcuEQjtHQ2qjVtZBt0M5eVbYoQzlHiaw/640?wx_fmt=gif) 聚焦源代码安全，网罗国内外最新资讯！

**编译：代码卫士**

![](https://mmbiz.qpic.cn/mmbiz_gif/oBANLWYScMTlsP2JygJSIicfMfhx5FBVuib1JZmLR9lC1JsVnVqOxEh2GDicugag1ibbMrdpqhT0HvFtyQQmrupRUA/640?wx_fmt=gif&from=appmsg)

**Checkmarx 安全研究团队最近发布报告，披露了一起针对NPM生态系统的复杂供应链攻击。其中涉及一款恶意包 jest-fet-mock，它利用以太坊智能合约管理C2基础设施。该恶意软件针对 Windows、Linux 和 macOS 系统，表明了供应链攻击尤其是开发者环境中的一种新的复杂情况。**

该攻击最值得关注的一个方面是使用以太坊智能合约进行C2运营。从传统来讲，恶意软件依赖硬编码服务器或域名进行C2通信，使防御人员更容易拿下该基础设施。然而，通过集成区块链技术，攻击者获得了实际上不可触及的C2设置。

报告中提到，“该攻击最显著的方面是它如何将以太坊区块链用于C2基础设施。当执行时，该恶意软件与智能合约进行交互，检索其C2服务器地址。”

该方法为攻击者提供了一种灵活且有弹性的基础设施。仅通过更新智能合约中的C2地址，攻击者就能将所有受感染系统重定向到新的服务器，而无需修改恶意软件本身，从而实现可持续控制和适应性。

攻击者使用的是typosquatted 程序包 jest-fet-mock。它是对两个热门测试工具 fetch-mock-jest和jest-fetch-mock 的模仿，而后者供 JavaScript 开发人员模拟 HTTP 请求。报告提到，jest-fet-mock 是在更大范围针对NPM生态系统攻击活动中识别的首个程序包。通过伪装成熟悉的工具，攻击者提高了开发人员安装该恶意软件的可能性。

该恶意包利用在安装过程中执行的预安装脚本，判断主机OS并为每个平台下载合适的payload。值得注意的是，攻击者为每个OS都开发出唯一的恶意软件变体，“跨平台恶意软件针对 Windows、Linux 和 macOS 开发环境”。

每个变体都包括与其环境相匹配的能力，如系统侦查、凭据盗取和持久性机制。该跨平台策略强调了攻击者专注于攻陷包括CI/CD管道在内的多种开发环境。

攻击者通过在NPM生态系统中攻击工具的方式，获得对关键开发基础设施的持久访问权限。不仅单个开发者系统处于风险之中，受陷的CI/CD管道也可在组织机构的软件产品和更新中引发一系列感染。

Jest-fet-mock 的发现只是开始。涉及其它程序包的攻击活动还在进行中。报告总结道，“这一案例在提醒开发团队对程序包管理进行严格的安全控制和仔细验证测试工具真实性方面，发挥了重要作用。”

代码卫士试用地址：https://codesafe.qianxin.com

开源卫士试用地址：https://oss.qianxin.com

---

---

**推荐阅读**

[NPM恶意包利用SSH后门攻击开发人员的以太坊钱包](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247521235&idx=2&sn=99c13237279fea36d94e88deab21dab3&chksm=ea94a2b9dde32baf235babb16ceaf3febef0246b6477a8d02d52cae5e02fb7dc580f8f230a9e&scene=21#wechat_redirect)

[以太坊基金会设立最高100万美元的短期漏洞奖励计划](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247513692&idx=1&sn=0f726f793b5bfac0b6d002b8506c64d9&chksm=ea948736dde30e204ff4f91d0084bee437def61910139696409b7b268f10c0ae0f63b07a54da&scene=21#wechat_redirect)

[SushiSwap MISO 遭软件供应链攻击，价值300万美元的以太坊被盗](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247508034&idx=3&sn=105fca4073f2216467fa286866ee0b8e&chksm=ea949128dde3183e3f2854cb011144d77b86966ac05f8203392249de0dd7e92d36c5aefff3b5&scene=21#wechat_redirect)

[被盗还是跑路前奏？韩国密币交易所 Upbit 丢失价值4850万美元的以太坊](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247491684&idx=3&sn=c777cf9847d47b51978e570e0eecdfca&chksm=ea94d10edde3581870b2b0cc3aeb579c601441f6d8a5e283bd55e54b9c79568c5af330d53684&scene=21#wechat_redirect)

**原文链接**

https://securityonline.info/ethereum-smart-contracts-enable-evasive-c2-in-new-supply-chain-attack/

题图：Pixabay License

**本文由奇安信编译，不代表奇安信观点。转载请注明“转自奇安信代码卫士 https://codesafe.qianxin.com”。**

![](https://mmbiz.qpic.cn/mmbiz_jpg/oBANLWYScMSf7nNLWrJL6dkJp7RB8Kl4zxU9ibnQjuvo4VoZ5ic9Q91K3WshWzqEybcroVEOQpgYfx1uYgwJhlFQ/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/oBANLWYScMSN5sfviaCuvYQccJZlrr64sRlvcbdWjDic9mPQ8mBBFDCKP6VibiaNE1kDVuoIOiaIVRoTjSsSftGC8gw/640?wx_fmt=jpeg)

**奇安信代码卫士 (codesafe)**

国内首个专注于软件开发安全的产品线。

![](https://mmbiz.qpic.cn/mmbiz_gif/oBANLWYScMQ5iciaeKS21icDIWSVd0M9zEhicFK0rbCJOrgpc09iaH6nvqvsIdckDfxH2K4tu9CvPJgSf7XhGHJwVyQ/640?wx_fmt=gif) 觉得不错，就点个 “在看” 或 "赞” 吧~

预览时标签不可点

阅读原文

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/oBANLWYScMQnXWuOU95T0gnUjHe8IhdLQuqwxvDpLf7GwP25ntfz6W8dhDhUS3BstsPLPL9YBRXE1QhF9eIjiaw/0?wx_fmt=png)

代码卫士

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/oBANLWYScMQnXWuOU95T0gnUjHe8IhdLQuqwxvDpLf7GwP25ntfz6W8dhDhUS3BstsPLPL9YBRXE1QhF9eIjiaw/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过