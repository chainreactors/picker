---
title: 看我如何黑进丰田的全球供应商管理网络
url: https://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247515504&idx=1&sn=f72cbb0a67b55599f65eddfc898fc162&chksm=ea948c1adde3050cdb0700f12217ae78d49e4c26f2ffad2b80d77b6a025fd0304889c47a6f8d&scene=58&subscene=0#rd
source: 代码卫士
date: 2023-02-09
fetch_date: 2025-10-04T06:07:48.254574
---

# 看我如何黑进丰田的全球供应商管理网络

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/oBANLWYScMSes79e9mQdCBStR8BqfbxESa1TedpbNUsEWzmIYto6l5TfWCp1Rf1T8Q0AYzpCpcWXicJ39p38ltQ/0?wx_fmt=jpeg)

# 看我如何黑进丰田的全球供应商管理网络

Adam Bannister

代码卫士

![](https://mmbiz.qpic.cn/mmbiz_gif/Az5ZsrEic9ot90z9etZLlU7OTaPOdibteeibJMMmbwc29aJlDOmUicibIRoLdcuEQjtHQ2qjVtZBt0M5eVbYoQzlHiaw/640?wx_fmt=gif) 聚焦源代码安全，网罗国内外最新资讯！

![](https://mmbiz.qpic.cn/mmbiz_png/oBANLWYScMRSylJK2k7H6mNqiaS2G6WRaeeK34cLHE6pe9VeOIHYiboAnKB0TMoayZCxFpHMLljzTnz9DnNuFiaqQ/640?wx_fmt=png)

专栏·供应链安全

数字化时代，软件无处不在。软件如同社会中的“虚拟人”，已经成为支撑社会正常运转的最基本元素之一，软件的安全性问题也正在成为当今社会的根本性、基础性问题。

随着软件产业的快速发展，软件供应链也越发复杂多元，复杂的软件供应链会引入一系列的安全问题，导致信息系统的整体安全防护难度越来越大。近年来，针对软件供应链的安全攻击事件一直呈快速增长态势，造成的危害也越来越严重。

为此，我们推出“供应链安全”栏目。本栏目汇聚供应链安全资讯，分析供应链安全风险，提供缓解建议，为供应链安全保驾护航。

*注：以往发布的部分供应链安全相关内容，请见文末“推荐阅读”部分。*

![](https://mmbiz.qpic.cn/mmbiz_png/FIBZec7ucCiaWtRttKahE4rd7icPBW6mLiaWubZBfibktxAlCMH6dwLG1225lH4Xo8nmA5ENG7I4o905Qq23icpkHwg/640?wx_fmt=png)

**安全研究员 Eaton Zveare 表示自己黑进了你的供应商管理网络并获得对敏感数据的访问权限，这些数据与全球约3000家提供商和1.4万名用户之间存在关联。**

Zveare 攻陷了丰田员工和供应商用于协调项目以及包含零件、调查和购买等详情的一款web应用。从该系统上可看到多家著名的合作伙伴和供应商如Michelin、Continental和Stanley Balck & Decker。

Zveare 最终通过登录机制中的一个后门，以管理员身份获得对丰田“全球供应商准备信息管理系统 (GSPIMS)”的访问权限。他指出，恶意攻陷可暴露丰田员工关于供应商和按照风险和其它变量做出的供应商排名的评论。

丰田迅速修复该漏洞，Zveare 指出，该漏洞“是我有史以来发现的最严重的漏洞之一”。

![](https://mmbiz.qpic.cn/mmbiz_png/oBANLWYScMSes79e9mQdCBStR8BqfbxEGtSvRicKyFLmb17tQbKYictzEGANdCTd3o46pJe59f4ULMXslvluhic0A/640?wx_fmt=png)

**0****1**

**返回true**

利用该漏洞始于修复GSPIMS中的JavaScript 代码以及SHI 国际集团代表丰田创建的按单页面应用Angular。

Zveare 在文章中指出，“开发人员通过执行 CanActivate和CanActivateChild 来控制对Angular路径/页面的访问权限。从本质上来说，当用户试图导航到一个路径/页面时，你就会判断他们是否有权进行查看，之后返回true或false。将它们都打补丁为返回true，通常就会完全解锁Angular app。”

他补充道，“要阻止重定向到登录页面，则还需要删除登出代码。通过应用这些补丁，该app加载并可被浏览。”此前曾攻陷Jacuzzi的SmartTub 应用的Zveare接着通过一个createJWT 的HTTP请求利用该后门，通过邮件获得JSON Web Token但并无密码。

该createJWT API用于 “Act As” 特性，可允许高权限用户以任意全局用户身份登录。找到有效邮件仅需稍微搜索丰田人员即可，因为丰田在北美使用了可预测的邮件格式 (firstname.lastname@toyota.com)。

![](https://mmbiz.qpic.cn/mmbiz_png/oBANLWYScMSes79e9mQdCBStR8BqfbxEGtSvRicKyFLmb17tQbKYictzEGANdCTd3o46pJe59f4ULMXslvluhic0A/640?wx_fmt=png)

**0****2**

**全部的全局控制**

Zveare最初以“Mgmt-Purchasing”角色的用户登录，不过通过 user/details API响应中的rolePrivileges 节点，之后找到详述用户管理人员的findByEmail API 重点，最终获得系统管理员身份。

基于该应用中出现的其它标签，Zveare “通过System Admin JWT，最终对整个系统获得全部的全局控制”。因此攻击者本可删除、修改或泄露数据并滥用数据构造鱼叉式钓鱼攻击活动。

Zveare认为，威胁者还可“添加自己的具有提升角色的用户账户，保留访问权限，以防该问题永远不会被发现和修复”。

![](https://mmbiz.qpic.cn/mmbiz_png/oBANLWYScMSes79e9mQdCBStR8BqfbxEGtSvRicKyFLmb17tQbKYictzEGANdCTd3o46pJe59f4ULMXslvluhic0A/640?wx_fmt=png)

**0****3**

**无漏洞赏金**

Zveare 在2022年11月3日将该问题告知丰田公司，后者在同一天予以响应并在11月23日证实称漏洞已修复。

丰田和SHI公司通过让createJWT和findByEmail端点在所有情况下返回 “HTTP status 404-Bad Request”的方式，修复了该漏洞。Zveare提到，“很高兴丰田认可漏洞的严重性并迅速将其修复。丰田是一家庞大的企业，其安全团队似乎能够高效地解决公司各个层面的漏洞。虽然如果颁发漏洞赏金很好，但他们并未提供。我希望未来他们考虑改变这一点。虽然获得认可值得感谢，但赏金才是吸引高级别人才以及让exploit远离黑市的方式。”

丰田公司尚未就此事置评。

---

代码卫士试用地址：https://codesafe.qianxin.com

开源卫士试用地址：https://oss.qianxin.com

![](https://mmbiz.qpic.cn/mmbiz_jpg/oBANLWYScMSZu3o6N7v8IvXlaSpv9pqrC38BdYic1GvE8xzpEraJy9nHYRGk5rCC0dHKEfBr2rC1nJ8gMCDIvIw/640?wx_fmt=jpeg)

**推荐阅读**

[在线阅读版：《2022中国软件供应链安全分析报告》全文](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247513174&idx=1&sn=e474d1ea23ed7cce10e2ae2f872fc003&chksm=ea94853cdde30c2a963cfa00a536764ea55cdee7ba6ef4a7716a28f82a97ca630dc271ee5224&scene=21#wechat_redirect)

[奇安信入选全球《软件成分分析全景图》代表厂商](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247515374&idx=1&sn=8b491039bc40f1e5d4e1b29d8c95f9e7&chksm=ea948d84dde30492f8a6c9953f69dbed1f483b6bc9b4480cab641fbc69459d46bab41cdc4859&scene=21#wechat_redirect)

[在线阅读版：《2021中国软件供应链安全分析报告》全文](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247505380&idx=1&sn=01d2f5af200abc6bb20411ee8f17b6b5&chksm=ea94e48edde36d98f20b66aecf9f359e49226b411872bcea527fcca0a5de018f407415313800&scene=21#wechat_redirect)

[几乎所有企业都与受陷第三方之间存在关联](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247515478&idx=1&sn=759fe4b09a25bbfa2b215044d8c0ebbc&chksm=ea948c3cdde3052aabad27c5aebc6c4f97bc84d8ab2bb490162e86c1848b9c8ac80b8dd56327&scene=21#wechat_redirect)

[热门开源Dompdf PHP 库中存在严重漏洞](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247515460&idx=2&sn=6ff90ed5a1a5cfe857a4aa75a16def08&chksm=ea948c2edde305386563b822262353daa67aecbbe719fdcbf7b97f402220ee247091ea7aeac0&scene=21#wechat_redirect)

[命令注入漏洞可导致思科设备遭接管，引发供应链攻击](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247515439&idx=1&sn=bb8d8abcbaaf7e2be431ab9cd0712617&chksm=ea948c45dde30553179da977f93800b8c57d85c6185257361358931ab913191be82c3079d54c&scene=21#wechat_redirect)

[命令注入漏洞可导致思科设备遭接管，引发供应链攻击](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247515439&idx=1&sn=bb8d8abcbaaf7e2be431ab9cd0712617&chksm=ea948c45dde30553179da977f93800b8c57d85c6185257361358931ab913191be82c3079d54c&scene=21#wechat_redirect)

[PyTorch 披露恶意依赖链攻陷事件](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247515167&idx=1&sn=24c07a386819db63dc889fa9bfe7b382&chksm=ea948d75dde304635dd31a7b3deeb1ff296b25b6ac462e35546afa8779e3ff455b3cd475dff4&scene=21#wechat_redirect)

[速修复！这个严重的 Apache Struts RCE 漏洞补丁不完整](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247511361&idx=1&sn=540cad65022d11423a868f977b4fe663&chksm=ea949c2bdde3153d70ed1c43058c67f7e846f30ea1d2f562389edf804ace5c6bf19621f5bf6e&scene=21#wechat_redirect)

[Apache Cassandra 开源数据库软件修复高危RCE漏洞](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247510538&idx=2&sn=1d92fa67b48167800ad01baa90c58cbd&chksm=ea949b60dde312765657b9d469ce2b1b6befbad085737df863891995b40982a6109939fb82b2&scene=21#wechat_redirect)

[美国国土安全部：Log4j 漏洞的影响将持续十年或更久](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247512944&idx=1&sn=003f4935476be99ce0be8caa3fe086fe&chksm=ea94821adde30b0c5b96de8d9948d479b7a6f59ff1ba75271057b28e17faa26b43c701a5f1fe&scene=21#wechat_redirect)

[Apache Log4j任意代码执行漏洞安全风险通告第三次更新](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247509646&idx=1&sn=34bc8208994380969cd89045067150b7&chksm=ea9497e4dde31ef2991a59f30171df1f69368c1951483d97f3de41d81a5717bb03e234491f5d&scene=21#wechat_redirect)

[PHP包管理器Composer组件 Packagist中存在漏洞，可导致软件供应链攻击](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247514137&idx=1&sn=347691413dc7ecfc2a2dedd365115329&chksm=ea948973dde3006553ae4c52ee22cd9f9c1eb480c80a59e78eaf25d9f9c974ed002d8e053488&scene=21#wechat_redirect)

[LofyGang 组织利用200个恶意NPM包投毒开源软件](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247514172&idx=1&sn=271b12e7a37da40fb7ddc58a30cf4135&chksm=ea948956dde300402d1d9ef54ea22519931efbfc852b82816c893892b876166c39063af581fc&scene=21#wechat_redirect)

[软件和应用安全的六大金科玉律](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247514145&idx=1&sn=639a349a140d429c996a51949fec0a92&chksm=ea94894bdde3005d6eeb0e37e7a3f81c6518bdce555fd5d9fff4418c5b305e17c5fb7916cb58&scene=21#wechat_redirect)

[美国政府发布关于“通过软件安全开发实践增强软件供应链安全”的备忘录（全文）](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247514050&idx=1&sn=14f44208b38382e14a3f4562615bedb5&chksm=ea9486a8dde30fbe2b0ef3231a0a73e44579f710c6bede1cd4eb563d0545476d5ef3607ea39d&scene=21#wechat_redirect)

[OpenSSF发布4份开源软件安全指南，涉及使用、开发、漏洞报告和包管理等环节](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247514034&idx=1&sn=51f02a3110acce0dbd53196876ef1fad&chksm=ea9486d8dde30fce4995e5734ad507e889b4c58c0d3ff8d777f66119f2d5fb3f1c7d0e064726&scene=21#wechat_redirect)

[美国政府发布联邦机构软件安全法规要求，进一步提振IT供应链安全](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247513979&idx=1&sn=66625cf062357864cf86053f868d8bb7&chksm=ea948611dde30f0758522e7694b72c9f1abdcbf9c7de8eece909dcdf444e2ce7cf19d357db91&scene=21#wechat_redirect)

[美国软件供应链安全行动中的科技巨头们](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247513936&idx=1&sn=ffd61a99532c853e13587e17ccb3e9a1&chksm=ea94863adde30f2cbc1141ebad6ae15d7b5ec09ee3c8337db26c9bda2b26c2914cdde4757ffb&scene=21#wechat_redirect)

[Apache开源项目 Xalan-J 整数截断可导致任意代码执行](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247513963&idx=4&sn=8f7f84190a33593bda1e3d6c86470af6&chksm=ea948601dde30f178f02bdcc42ac15f052526722f31417ec3cc51f2b92cde6a84be7894c8fe8&s...