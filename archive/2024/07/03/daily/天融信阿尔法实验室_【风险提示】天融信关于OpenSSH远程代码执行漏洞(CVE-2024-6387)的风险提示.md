---
title: 【风险提示】天融信关于OpenSSH远程代码执行漏洞(CVE-2024-6387)的风险提示
url: https://mp.weixin.qq.com/s?__biz=Mzg3MDAzMDQxNw==&mid=2247496648&idx=1&sn=34cf6111dc8ff2fca5fb1e2c2b2acd74&chksm=ce96bef6f9e137e07c35a98ee741d562d347d1f6014d6017a40a619440194df4d5b0bc662978&scene=58&subscene=0#rd
source: 天融信阿尔法实验室
date: 2024-07-03
fetch_date: 2025-10-06T17:45:46.319896
---

# 【风险提示】天融信关于OpenSSH远程代码执行漏洞(CVE-2024-6387)的风险提示

![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/H6W1QCHf9dFxISBaKcoOLdfvQbBErJicol6hhbuEmXUFtX4j8EiabLwAFkP3HoNl8pEIKJgRribb42YGWUSu74pRg/0?wx_fmt=jpeg)

# 【风险提示】天融信关于OpenSSH远程代码执行漏洞(CVE-2024-6387)的风险提示

天融信应急响应

天融信阿尔法实验室

![](https://mmbiz.qpic.cn/sz_mmbiz_png/H6W1QCHf9dFxISBaKcoOLdfvQbBErJicoLfYHl6AUlXiabtxjH0DUrvEGc8Y3Yau9uI6iaRNDAjd2mdWoouf9Votw/640?wx_fmt=png&from=appmsg)

**0x00 背景介绍**

---

近日，天融信阿尔法实验室监测到国外研究团队Qualys发布了OpenSSH的一个远程代码执行漏洞CVE-2024-6387的细节及漏洞利用代码，该漏洞被命名为“regreSSHion”。建议受影响用户尽快做好自查和防护。

**0x01** ****漏洞描述****

---

OpenSSH的sshd组件存在一个信号处理条件竞争漏洞CVE-2024-6387，未经身份认证的远程攻击者能够利用此漏洞以root权限执行任意代码。该漏洞是CVE-2006-5051的回归，是在OpenSSH 8.5p1版本的一次代码变更中引入的。

该漏洞被证实能够在Linux系统上运行的以Glibc编译的OpenSSH上成功利用，不过利用过程复杂、成功率不高且耗时较长。漏洞发现作者表示，平均需要大于10000次尝试（大约3~4小时）才能赢得竞争条件，平均需要6~8小时才能获得远程root shell。在以非Glibc编译的OpenSSH上利用此漏洞也是可能的，但尚未证实。

目前的漏洞利用代码仅针对在32位Linux系统上运行的OpenSSH，由于在64位Linux系统下的ASLR更强，因此在64位Linux系统上利用该漏洞的难度更大。

**0x02 影响版本**

---

1、OpenSSH < 4.4p1。4.4p1之前的OpenSSH版本容易受到此信号处理程序竞争条件的影响，除非它们针对CVE-2006-5051和CVE-2008-4109进行了修补。

2、8.5p1 <= OpenSSH < 9.8p1。8.5p1及之后的OpenSSH版本由于意外删除了漏洞函数中的一段代码，使CVE-2006-5051漏洞被重新引入。

**0x03 修复建议**

##

---

* **临时缓解**

如果暂时无法更新和重新编译sshd,可通过如下步骤暂时缓解该漏洞：

可以在配置文件/etc/ssh/sshd\_config中将LoginGraceTime设置为0（永不超时）。这可以防止远程代码执行的风险，但仍然会造成sshd拒绝服务。

* **升级修复**

目前官方已有可更新版本，建议受影响用户参考以下链接下载源码并重新编译以升级至最新版本：

https://www.openssh.com/releasenotes.html

https://github.com/openssh/openssh-portable/releases/tag/V\_9\_8\_P1

Linux发行版可根据各个发行版漏洞公告页面的修复信息将OpenSSH升级到Linux发行版官方编译的安全版本。

Debian漏洞公告：

https://security-tracker.debian.org/tracker/CVE-2024-6387

Ubuntu漏洞公告：

https://ubuntu.com/security/CVE-2024-6387

RedHat漏洞公告：

https://access.redhat.com/security/cve/cve-2024-6387

**0x04 参考链接**

##

---

1、OpenSSH漏洞公告

https://www.openssh.com/releasenotes.html#9.8p1

2、漏洞发现者披露文章

https://blog.qualys.com/vulnerabilities-threat-research/2024/07/01/regresshion-remote-unauthenticated-code-execution-vulnerability-in-openssh-server

https://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt

## **0x05 声明**

---

天融信阿尔法实验室拥有对此公告的修改和解释权，如欲转载，必须保证此公告的完整性。由于传播、利用此公告而造成的任何后果，均由使用者本人负责，天融信阿尔法实验室不为此承担任何责任。

天融信阿尔法实验室成立于2011年，一直以来，阿尔法实验室秉承“攻防一体”的理念，汇聚众多专业技术研究人员，从事攻防技术研究，在安全领域前瞻性技术研究方向上不断前行。作为天融信的安全产品和服务支撑团队，阿尔法实验室精湛的专业技术水平、丰富的排异经验，为天融信产品的研发和升级、承担国家重大安全项目和客户服务提供强有力的技术支撑。

![](https://mmbiz.qpic.cn/mmbiz_png/H6W1QCHf9dGfIEDOlNXXDTqOpRkEkicJakNxM37lzr8eRJRibEfxkwBibg9KpVh6nibXHoG4xC6KyGFtTd4TOe6GyA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/H6W1QCHf9dGfIEDOlNXXDTqOpRkEkicJawf8nKyKatopPJiaayibAUCvfTVFKfxVDInq2TiaUib6xhmhpLK4Zqscgyg/640?wx_fmt=jpeg)

天融信

阿尔法实验室

长按二维码关注我们

预览时标签不可点

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/H6W1QCHf9dGDWkSzfzMzTbO3A3TNOlV25ib6QxMqggGr0xEsDy3YnQUDt6zApFEp9LEAiaLctFdghjstu66PUWzA/0?wx_fmt=png)

天融信阿尔法实验室

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/H6W1QCHf9dGDWkSzfzMzTbO3A3TNOlV25ib6QxMqggGr0xEsDy3YnQUDt6zApFEp9LEAiaLctFdghjstu66PUWzA/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过