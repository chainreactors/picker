---
title: Using Application Functionality to Exploit Insecure Deserialization
url: https://infosecwriteups.com/using-application-functionality-to-exploit-insecure-deserialization-b4e7c6abdae1?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2024-10-23
fetch_date: 2025-10-06T18:50:12.471622
---

# Using Application Functionality to Exploit Insecure Deserialization

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb4e7c6abdae1&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fosintteam.blog%2Fusing-application-functionality-to-exploit-insecure-deserialization-b4e7c6abdae1&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fosintteam.blog%2Fusing-application-functionality-to-exploit-insecure-deserialization-b4e7c6abdae1&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## OSINT Team](https://osintteam.blog/?source=post_page---publication_nav-2983bc435765-b4e7c6abdae1---------------------------------------)

·

Follow publication

[![OSINT Team](https://miro.medium.com/v2/resize:fill:76:76/1*6HjOa5Z6TkeJm6SEnqVrRA.png)](https://osintteam.blog/?source=post_page---post_publication_sidebar-2983bc435765-b4e7c6abdae1---------------------------------------)

We teach OSINT from multiple perspectives. Cybersecurity experts, investigators, law enforcement, and intelligence specialists read us to grow skills faster.

Follow publication

# Using Application Functionality to Exploit Insecure Deserialization

[![Ryan G. Cox](https://miro.medium.com/v2/resize:fill:64:64/1*VkvYzjvK_fuZ2Js8dEFC_g.jpeg)](https://medium.com/%40ryangcox?source=post_page---byline--b4e7c6abdae1---------------------------------------)

[Ryan G. Cox](https://medium.com/%40ryangcox?source=post_page---byline--b4e7c6abdae1---------------------------------------)

5 min read

·

Sep 17, 2024

--

Listen

Share

Press enter or click to view image in full size

![]()

[The Cybersec Café](https://www.cyberseccafe.com/)

Welcome back to another Lab Walkthrough at the Cybersec Cafe, where I detail my mindset as I approach a Web Application.

## Objective

Edit the serialized object in the session cookie to delete the */home/carlos/morale.txt* file.

If you enjoy this article and want to be the first to see more like it, consider **subscribing** to my newsletter, the [Cybersec Cafe](https://www.cyberseccafe.com/), for *free*. I post content there first, and here second. Plus, you’ll get it straight to your inbox.

My goal is to deliver you value in various cybersecurity topics each week and to become your ultimate destination for expanding your expertise or for any aspiring cybersecurity professionals to break into the field.

## What is Insecure Deserialization?

Insecure deserialization is a vulnerability that occurs when an application deserializes converts data from a serialized format (JSON, XML, etc.) back to it’s original form without proper validation or integrity checks. It can be exploited by attackers in a way that leads to remote code execution, data tampering, or other malicious actions.

## Methodology

Want to follow along with the lab yourself? You can check it out on PortSwigger’s website [here](https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-using-application-functionality-to-exploit-insecure-deserialization) for free.

## The Recon

The first step of our methodology will be to get an understanding of the application and its functionality.

We can see that this is a standard Blog environment that has the functionality to comment on each post.

Press enter or click to view image in full size

![]()

For this lab, we are given 2 sets of credentials to log in with:

* The Main account
* The Backup account

Let’s start by logging in with our Backup account.

Press enter or click to view image in full size

![]()

We can see there is quite a bit of functionality available to us here.

* Update email
* Upload avatar photo
* Delete the account

In order to fully capture the functionality of this lab environment, we need to submit each of the requests to capture within our Burp Suite instance.

We should complete them in a logical order so that we can capture the other requests before deleting the account, but if you delete the account before doing so, there is the Main account to fall back on.

Taking a look at our SiteMap, we can see it’s lit up like a christmas tree!

Press enter or click to view image in full size

![]()

There’s quite a lot of issues that Burp as auto-identified.

Sicne we captured all of the account actions, we have 2 requests that should initially stick out:

Press enter or click to view image in full size

![]()

* The Delete file since it’s performing a *delete* action
* The File upload since we are dealing with a file.

Let’s send them both over to the repeater for testing.

## Testing

To kick off the manual testing, let’s start with the delete account endpoint and see if we can make sense of the serialized object:

Press enter or click to view image in full size

![]()

If you highlight the seession cookie in Burp, the Inspector will be able to automatically decode it for you.

We can see that this cookie has information about the user, but let’s take a look at the upload avatar endpoint before we draw any conclusions.

Press enter or click to view image in full size

![]()

Again, we can highlight the cookie and see something interesting stands out right away: The *avatar\_link*.

Let’s take a look at these objects side-by-side for reference.

Press enter or click to view image in full size

![]()

It looks like both tokens have exactly the same format.

If we think about the functionality we have available to us and the objects in each function, our attack vector is starting to become quite obvious, right?

## Exploitation

Let’s grab the avatar object in the request and edit the contents to reflect the file we want to take action on:

Press enter or click to view image in full size

![]()

Remember to edit the length right before the object to reflect the new length of the file we are referencing. It should look like this:

`s:11:”avatar_link”;s:23:”/home/carlos/morale.txt”`

With 23 being the length of */home/carlos/morale.txt .*

Now, given that we have an endpoint that has the functionality to delete, if we change *POST /my-account/avatar* to be *POST /my-account/delete* we should be able to delete the file:

Press enter or click to view image in full size

![]()

Lab solved — file deleted!

Press enter or click to view image in full size

![]()

## What We’ve Learned

We can see just how dangerous Insecure Deserialization in an application can be. Failing to sanitize input when passing to a dangerous method can have severe consequences, like in our instance, deleting a file on the filesystem. This shows that deserialization of user input should be avoided in an application unless rendered absolutely essential. Deserizalition can have sever impact because it can be any entry point to an entirely new attack surface and lead to things such as privilege escalation, file access, and even Denial of Service attacks.

—

Remember: The Cybersec Café gets articles first. Subscribe for free [here](https://www.cyberseccafe.com/).

Interested in getting into Cybersecurity? I have a course called the [Security Sip](https://securitysip.cyberseccafe.com/). The curriculum is designed to help you build skills progressively over 12 sections, 85 modules, and 155 exercises. With r...