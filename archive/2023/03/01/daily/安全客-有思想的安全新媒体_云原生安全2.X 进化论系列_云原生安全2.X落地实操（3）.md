---
title: 云原生安全2.X 进化论系列|云原生安全2.X落地实操（3）
url: https://www.anquanke.com/post/id/286819
source: 安全客-有思想的安全新媒体
date: 2023-03-01
fetch_date: 2025-10-04T08:19:09.326330
---

# 云原生安全2.X 进化论系列|云原生安全2.X落地实操（3）

首页

阅读

* [安全资讯](https://www.anquanke.com/news)
* [安全知识](https://www.anquanke.com/knowledge)
* [安全工具](https://www.anquanke.com/tool)

活动

社区

学院

安全导航

内容精选

* [专栏](/column/index.html)
* [精选专题](https://www.anquanke.com/subject-list)
* [安全KER季刊](https://www.anquanke.com/discovery)
* [360网络安全周报](https://www.anquanke.com/week-list)

# 云原生安全2.X 进化论系列|云原生安全2.X落地实操（3）

阅读量**307657**

发布时间 : 2023-02-28 17:30:23

**x**

##### 译文声明

本文是翻译文章

译文仅供参考，具体内容表达以及含义原文为准。

![]()

随着云计算技术的蓬勃发展，传统上云实践中的应用升级缓慢、架构臃肿、无法快速迭代等“痛点”日益明显。能够有效解决这些“痛点”的云原生技术正蓬勃发展，成为赋能业务创新的重要推动力，并已经应用到企业核心业务。然而，云原生技术在创造效益的同时，却也面临着严峻的安全问题。当下常见的**云原生安全产品在发挥效能的同时也引入新问题**。作为数字经济时代下的特殊产物，云原生安全解决方案的未来与演进又该何去何从？

安全狗推出**云原生安全2.X专题**，用翔实的系列文章为读者揭晓云原生安全的演进之路以及未来趋势。

在前一篇文章[（点此查看）](https://mp.weixin.qq.com/s?__biz=MjM5NTc2NDM4MQ==&mid=2650836267&idx=1&sn=1ae53f8e9c3824cf520275e785b91c97&chksm=bd07acd98a7025cfb1c6147c4c69e1d4f6ab8f794d74b994dd72f90bc532a7c2d82d5a4a55bc&token=485575865&lang=zh_CN#rd)中，笔者详细分析了云原生安全1.X和云原生安全2.X的差异性，并且阐述了云原生安全2.X五大特征，即，软件资产管理和安全一体化、编排环境适配一体化、工作负载安全一体化、网络层安全一体化、应用安全一体化的具体含义以及目标。在本篇文章中，笔者将结合安全狗实践过程的经验为读者分享如何落地云原生安全2.X概念。

**01**

**云甲V5.0实现云原生安全2.X总体架构思路**

安全狗云甲V5.0是国内首个实现了云原生安全2.X的五个一体化，以及两个扩展一体化的产品。作为落地云原生安全2.X概念的实际产品，**云甲V5.0总体架构设计思路**如下图所示：

![]()

图1

通过将容器云平台通用安全能力下沉到一个**“N合1”安全基座**上，云甲在避免单品堆叠部署之余，一个Agent同时覆盖主机安全、容器安全、网络微隔离、多租户、安全策略联邦、云原生安全合规、资产精细化采集等云原生全栈安全需求，且安全组件稳定、资源占用少、不影响业务。**云甲**以安全大基座的方式**支撑**了资产管理与安全一体化，环境安全一体化，工作负载安全一体化、网络安全一体化的落地实现。

在**赋能应用安全**方面，云甲依托外联WAF、API安全网关和内联RASP虚拟补丁引擎形成“里应外合”一体化方案，将具有漏洞预防、业务访问授权、数据脱敏、应用合规基线等普遍性、共性需求应用安全能力下沉到PASS层的安全基座，赋能对象包括传统单体应用，也包括微服务应用。这样降低应用自身安全类功能的开发成本，整体提高应用开发效率和安全性，同时解决了老旧应用安全加固免改造的难题。

最后，云甲可同时推送数据和开放威胁阻断类、排查验证类的API接口，与容器云平台、数字化安全运营平台无缝衔接，数据共享和联防联抗，满足了**安全集成协同需求**。

接下来笔者将重点介绍云甲的资产管理和安全一体化、工作负载安全一体化和网络层安全一体化三个方面的**重要创新亮点**。

**02**

**云甲V5.0软件资产管理与安全一体化**

在**资产管理和安全一体化**方面，云甲的技术实现逻辑原理如图所示：

![]()

图2

**第一个亮点：**多来源、多渠道自动化静态资产、动态资产采集和管理一体化，以及基于流量的漏管资产发现机制，确保底数清。

**第二个亮点：**资产画像，基于融合数据的基础上，对镜像、容器、pod、集群对象，从资产属性、漏洞隐患、安全事件等三大维度构建画像模型打标签，并进一步提供资产一键搜等高级分析功能。比如排查Log4j这样的0day资产，用户点击一键搜就能在一个界面查看到具有0day漏洞Log4j多个版本影响到哪些镜像、哪些正在运行的容器、pod，哪些namespace，以及相关的service、ingress。

**· 资产一键搜 ·**

可以快速定位问题资产，评估漏洞影响规模，并生成漏洞风险报告，大幅度降低漏洞平均响应时间。

![]()

图3

**· 资产画像 ·**

融合分散孤立各类静态、动态和关联媒介类数据，从资产基础信息、漏洞风险和安全事件三维度构建画像标签算法，整体状态一目了然。

![]()

图4

![]()

图5

**第三个亮点：**纳管资产一体化安全检测。云甲是**国内首个**支持软件供应链安全图谱，以扩展检测基础设施即代码的产品。这两个功能在**实战场景**中发挥着重要的作用。

如下图所示，云甲构建组件依赖关系链图谱，完整可视化全栈软件供应链，以及间接依赖软件包的漏洞风险。

![]()

图6

云甲采用漏洞情报库帮助用户确定漏洞的优先级，帮助用户修复“真正需求修补”的漏洞，而不盲目关注所有的漏洞。漏洞情报运营原理如下图所示：

![]()

图7

如下图所示，某客户依托漏洞情报库的协助，在漏洞治理方面取得显著的成效。

![]()

图8

云甲V5.0的软件供应链安全图谱结合漏洞情报库可以**高效提升漏洞修复率**，如果没有完整的可见性或整个依赖树的指导，漏洞将无法检测或修复、并进行漏洞利用预防。安全狗云甲一体化软件供应链安全解决方案提供了一直到叶节点的完整依赖扫描，以确保组织能够了解每个潜在的漏洞来源。

云甲V5.0软件资产管理与安全一体化的第3个创新针对的是传统的SBOM 不包括云基础设施资源以及客户对其云基础设施风险不可见等系列问题。云甲实现了将基础架构中的资源即代码(IaC) 进行检查并生成 SBOM 的功能，并进一步提供了开源许可证、漏洞和错误配置等风险信息，以便组织可以了解软件的法律和安全风险。因此，云甲支持用户在早期代码/构建阶段掌控全栈风险，尽早采取预防措施。

**03**

**云甲V5.0工作负载安全一体化**

云甲V5.0工作负载安全一体化的创新提出“N合1”安全Agent大基座的架构设计思路。如下图所示。云甲在每个节点上部署一个轻代理软件，同时覆盖宿主机和容器工作负载的一体化安全防护目标。

![]()

图9

一是在防护部位角度，从“应用侧、容器侧、主机侧”，从内往外层层设防、层层监控；

二是威胁检测、防护和响应技术角度，采用了恶意程序静态、动态检测一体化；基于规则和特征库的威胁检测、与基于AI算法模型的检测技术和基于进程行为模型基线的手段一体化。

云甲可应对**运行时安全**。通过静态检测和动态监控检测容器运行时的已知风险和未知风险。静态检测优势：webshell、弱口令、应急漏洞；动态监控优势：实时逃逸、进程rce、暴力破解。

**场景1：**云甲支持基于“静态扫描”和“动态实时防护”，可及时发现Webshell以及挖矿木马，并对它们进行信任、隔离、下载、删除等操作。

![]()

图10

![]()

图11

**场景2：**针对“植入内存木马攻击”，云甲支持通过“内存马检测”功能进行威胁检测。

**攻击方视角：**运用“WEB应用漏洞”与“可引发容器逃逸的配置缺陷”进行渗透攻击。

![]()

图12

**防守方视角：**“一体化”的运行时威胁攻击

![]()

图13

总体来说，云甲可形成多维度实时威胁检测，对容器逃逸、无文件/无恶意软件攻击快速发现，以及横移攻击的感知和自动化响应阻断。

**04**

**云甲V5.0网络层安全一体化**

云甲V5.0进行了**云原生网络层底层技术创新**，开发了新一代高性能一体化云原生防火墙。对于Kubernetes集群中不支持Kubernetes NetworkPolicy的Pod，云甲也能实施RBAC（基于角色访问控制）和ABAC（基于属性访问控制）相结合的网络流量管控策略。此创新点满足有“高度合规监管，技术安全性、稳定性、网络延迟和资源消耗要求严格”特点的**银行、电力等核心业务系统在云原生化升级过程**中对多模网络场景下网络访问控制的严苛需求，兼容国产信创环境。

第一个创新

解决了在业务峰值期间防火墙自身资源开销高、网络延迟大、网络吞吐下降等影响业务应用的问题。

云甲V5.0是**业界首个**提出“访问控制策略快调度、容器间非法访问数据包少跑动”设计思路，如下图所示：

![]()

图14

1. 首先基于eBPF 技术一体化覆盖主机层和容器层数据包检测
2. 然后从数据包发送侧对数据包进行访问策略检查与控制，相对当前主流云原生防火墙基于传统的防火墙技术在接收侧对数据包进行访问策略检查与控制，云甲V5.0实现了非法访问数据包不出容器且无需封包、或SNAT转换的效果，极大的减少数据包在虚拟网络设备（比如：Veth pair、OVS等）上传输的数量和性能消耗。

云甲V5.0新一代云原生防火墙技术解决了当前云原生防火墙在业务峰值期间自身占用CPU、内存、IO等资源开销高、网络延迟大、网络吞吐下降等影响业务应用的问题；同时也解决了云原生防火墙对国产信创环境和Underlay 网络方案的CNI插件兼容性差、定制改造成本高的问题。

第二个创新

采用零信任模型实现统一安全策略协同。

云原生架构下的访问控制整体需求从底层到高层依次包括：K8S L3-L4层的（网络访问控制策略）、K8S L7层服务网格（服务访问控制策略）、业务应用层的业务访问控制策略、数据层数据访问控制策略，这个四个层面访问控制策略虽然抽象粒度不同，但本质上在技术层面是有相互关联的，如下图所示：

![]()

图15

**云甲V5.0网络层访问控制策略**支持包括用户属性、环境属性和资源属性等丰富的上下文信息，支持用户制定覆盖四个层面的综合性访问策略和自动化联防联抗策略，实现访问控制策略统一协同。

云甲V5.0访问控制策略实现采用了RBAC（基于角色访问控制）和ABAC（基于属性访问控制）结合的零信任访问控制策略实现模型，支持各类策略作者使用高级声明性语言表达、定义、管理具备上下文感知的策略，以适应环境或数据的变化，从而实现高级自动化，可扩展性更强、更方便，支持更加细粒度控制和根据上下文动态执行。解决了云原生东西向流量访问关系复杂、快速变化和访问控制策略需动态频繁调整的场景下，用户无法根据用户属性（比如：访问者进程运行用户、角色或组、特权账号、弱口令账号等）、环境属性（漏洞、安全状态、安全事件等）、资源属性（创建日期、资源所有者、文件名和数据敏感性等）基于零信任模式制定综合性访问策略和自动化联防联抗的难题。

**05**

**小结**

本文主要分享了安全狗云甲V5.0在落地云原生安全2.X五大特征时的经验。在下篇文章笔者将重点分享安全狗云原生安全2.X的未来拓展方向与思路，敬请期待~

本文翻译自 原文链接。如若转载请注明出处。

商务合作，文章发布请联系 anquanke@360.cn

本文由**安全狗safedog**原创发布

转载，请参考[转载声明](https://www.anquanke.com/note/repost)，注明出处： [https://www.anquanke.com/post/id/286819](/post/id/286819)

安全KER - 有思想的安全新媒体

本文转载自:

如若转载,请注明出处：

安全KER - 有思想的安全新媒体

分享到：![微信](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

* [容器安全](/tag/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8)
* [云原生安全](/tag/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%AE%89%E5%85%A8)
* [云原生安全2.X](/tag/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%AE%89%E5%85%A82.X)

**+1**2赞

收藏

![](https://p3.ssl.qhimg.com/t01cf9fec636c785d35.png)安全狗safedog

分享到：![微信](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

## 发表评论

您还未登录，请先登录。

[登录](/login/index.html)

![](https://p5.ssl.qhimg.com/t014757b72460d855bf.png)

[![](https://p3.ssl.qhimg.com/t01cf9fec636c785d35.png)](/member.html?memberId=131816)

[安全狗safedog](/member.html?memberId=131816)

国内领先的云安全服务与解决方案提供商&amp;CWPP领导厂商

* 文章
* **35**

* 粉丝
* **19**

### TA的文章

* ##### [云原生容器安全|容器全生命周期的漏洞防治实践](/post/id/287957)

  2023-03-31 17:00:17
* ##### [云原生安全2.X 进化论系列|云原生安全2.X未来展望（4）](/post/id/287247)

  2023-03-28 15:22:31
* ##### [零信任实战案例|“无边界可信访问”为某央企构建数字化业务系统安全](/post/id/287796)

  2023-03-28 10:07:07
* ##### [来了，业界首款信创云主机安全产品](/post/id/287402)

  2023-03-27 10:02:03
* ##### [云原生安全2.X 进化论系列|云原生安全2.X落地实操（3）](/post/id/286819)

  2023-02-28 17:30:23

### 相关文章

* ##### [Kubernetes RBAC 最佳安全实践](/post/id/300925)

  2024-10-15 21:29:20
* ##### [一个未公开的容器逃逸方式](/post/id/290540)

  2023-09-07 18:22:32
* ##### [BlackHat Asia 2023 武器库| 开源工作负载解决方案Elkeid](/post/id/288765)

  2023-05-23 17:17:41
* ##### [云原生安全2.X 进化论系列|云原生安全2.X未来展望（4）](/post/id/287247)

  2023-03-28 15:22:31
* ##### [云原生安全2.X 进化论系列 | 揭秘云原生安全2.X的五大特征（2）](/post/id/286238)

  2023-02-14 10:30:12
* ##### [云原生安全2.X 进化论系列|云原生安全从1.X到2.X的演变之路（1）](/post/id/286082)

  2023-02-08 16:30:29
* ##### [浅析容器运行时安全加固](/post/id/284713)

  2023-01-03 12:00:53

### 热门推荐

文章目录

![](https://p0.qhimg.com/t11098f6bcd5614af4bf21ef9b5.png)

安全KER

* [关于我们](/about)
* [联系我们](/note/contact)
* [用户协议](/note/protocol)
* [隐私协议](/note/privacy)

商务合作

* [合作内容](/note/business)
* [联系方式](/note/contact)
* [友情链接](/link)

内容需知

* [投稿须知](https://www.anquanke.com/contribute/tips)
* [转载须知](/note/repost)
* 官网QQ群：568681302

合作单位

* [![安全KER](https://p0.ssl.qhimg.com/t01592a959354157bc0.png)](http://www.cert.org.cn/)
* [![安全KER](https://p0.ssl.qhimg.com/t014f76fcea94035e47.png)](http://www.cnnvd.org.cn/)

Copyright © 北京奇虎科技有限公司 三六零数字安全科技集团有限公司 安全KER All Rights Reserved [京ICP备08010314号-66](https://beian.miit.gov.cn/)[![](https://icon.cnzz.com/img/pic.gif)](https://www.cnzz.com/stat/website.php?web_id=1271278035 "站长统计")

微信二维码

**X**![安全KER](https://p0.ssl.qhimg.com/t0151209205b47f2270.jpg)