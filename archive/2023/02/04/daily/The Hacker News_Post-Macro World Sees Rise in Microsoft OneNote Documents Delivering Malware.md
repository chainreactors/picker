---
title: Post-Macro World Sees Rise in Microsoft OneNote Documents Delivering Malware
url: https://thehackernews.com/2023/02/post-macro-world-sees-rise-in-microsoft.html
source: The Hacker News
date: 2023-02-04
fetch_date: 2025-10-04T05:43:37.452915
---

# Post-Macro World Sees Rise in Microsoft OneNote Documents Delivering Malware

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [Post-Macro World Sees Rise in Microsoft OneNote Documents Delivering Malware](https://thehackernews.com/2023/02/post-macro-world-sees-rise-in-microsoft.html)

**Feb 03, 2023**Ravie LakshmananAttack Vector / Endpoint Security

[![Microsoft OneNote Documents Delivering Malware](data:image/png;base64... "Microsoft OneNote Documents Delivering Malware")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqGrLrBGsWfuhn9ah4GySczod5ORTszXKF8c7eIxIi37i2hzwxJCeYQA9ajHE0PPhPu_zRs2KqBGat-4luK7TJT-v6urkX0Wxwuwrd6qfYXRGyym7U64kW8MTpy3mAbr0kVGu-ydLn_l3dkAkTEoytqIq_kLVcsie2krbi7eSR3h6TKvzpR699uaSb/s790-rw-e365/onenote-malware-hacking.png)

In a continuing sign that threat actors are adapting well to a [post-macro world](https://thehackernews.com/2022/07/hackers-opting-new-attack-methods-after.html), it has emerged that the use of Microsoft OneNote documents to deliver malware via phishing attacks is on the rise.

Some of the notable malware families that are being distributed using this method include AsyncRAT, [RedLine Stealer](https://www.rapid7.com/blog/post/2023/01/31/rapid7-observes-use-of-microsoft-onenote-to-spread-redline-infostealer-malware/), Agent Tesla, [DOUBLEBACK](https://www.mandiant.com/resources/blog/unc2529-triple-double-trifecta-phishing-campaign), Quasar RAT, XWorm, [Qakbot](https://blog.cyble.com/2023/02/01/qakbots-evolution-continues-with-new-strategies/), [BATLOADER](https://blog.cyble.com/2023/02/02/new-batloader-disseminates-rats-and-stealers/), and [FormBook](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/trojanized-onenote-document-leads-to-formbook-malware/).

Enterprise security firm Proofpoint said it detected over 50 campaigns leveraging OneNote attachments in the month of January 2023 alone.

In some instances, the email phishing lures contain a OneNote file, which, in turn, embeds an HTA file that invokes a PowerShell script to retrieve a malicious binary from a remote server.

[![DFIR Retainer Services](data:image/png;base64...)](https://thehackernews.uk/cloud-insight-d)

Other scenarios entail the execution of a rogue VBScript that's embedded within the OneNote document and concealed behind an image that appears as a seemingly harmless button. The VBScript, for its part, is designed to drop a PowerShell script to run DOUBLEBACK.

"It is important to note, an attack is only successful if the recipient engages with the attachment, specifically by clicking on the embedded file and ignoring the warning message displayed by OneNote," Proofpoint [said](https://www.proofpoint.com/us/blog/threat-insight/onenote-documents-increasingly-used-to-deliver-malware).

The infection chains are made possible owing to a OneNote feature that allows for the execution of select file types directly from within the note-taking application in what's a case of a "payload smuggling" attack.

"Most file types that can be processed by MSHTA, WSCRIPT, and CSCRIPT can be executed from within OneNote," TrustedSec researcher Scott Nusbaum [said](https://www.trustedsec.com/blog/new-attacks-old-tricks-how-onenote-malware-is-evolving/). "These file types include CHM, HTA, JS, WSF, and VBS."

[![Microsoft OneNote](data:image/png;base64... "Microsoft OneNote")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhgQoZHj49toBu2q0qJyuZdOLU0vlgy3Gm-5FTiW4rMlaw-JvYC9W6a0C6oXXqHnI26VR1XW_NDlXB50VHFF9w1gQMS6yuHhuSVEpwFfJm2j0bW26nMG1DOKmt0Q9zEGC6RDba0iGFFQAGOqtNvlDnet1YqfkjejlUTEVG64H1Jj4YWIgWnaspFsbTN/s790-rw-e365/onenote-malware.png)

As remedial actions, Finnish cybersecurity firm WithSecure is [recommending](https://labs.withsecure.com/publications/detecting-onenote-abuse) users block OneNote mail attachments (.one and .onepkg files) and keep close tabs on the operations of the OneNote.exe process.

The shift to OneNote is seen as a response to Microsoft's decision to [disallow macros](https://thehackernews.com/2022/07/microsoft-resumes-blocking-office-vba.html) by default in Microsoft Office applications downloaded from the internet last year, prompting threat actors to experiment with [uncommon](https://thehackernews.com/2023/01/new-research-delves-into-world-of.html) [file types](https://thehackernews.com/2022/12/hacking-using-svg-files-to-smuggle-qbot.html) such as ISO, VHD, SVG, CHM, RAR, HTML, and LNK.

The aim behind blocking macros is two-fold: To not only reduce the attack surface but also increase the effort required to pull off an attack, even as email continues to be the [top delivery vector](https://threatresearch.ext.hp.com/hp-wolf-security-threat-insights-report-q3-2022/) for malware.

[![CIS Build Kits](data:image/png;base64...)](https://thehackernews.uk/platform-shield-d)

But these are not the only options that have become a popular way to conceal malicious code. Microsoft Excel add-in (XLL) files and Publisher macros have also been put to use as an attack pathway to skirt Microsoft's protections and propagate a remote access trojan called [Ekipa RAT](https://thehackernews.com/2022/12/apt-hackers-turn-to-malicious-excel-add.html) and other backdoors.

The abuse of XLL files hasn't gone unnoticed by the Windows maker, which is [planning](https://www.microsoft.com/en-us/microsoft-365/roadmap?filters=Excel&searchterms=115485) an update to "block XLL add-ins coming from the internet," citing an "increasing number of malware attacks in recent months." The option is expected to be available sometime in March 2023.

When reached for comment, Microsoft told The Hacker News that it had nothing further to share at this time.

"It's clear to see how cybercriminals leverage new attack vectors or less-detected means to compromise user devices," Bitdefender's Adrian Miron [said](https://www.bitdefender.com/blog/hotforsecurity/threat-actors-impersonate-canadian-gas-retailer-to-deliver-malicious-onenote-phishing-campaign-bitdefender-labs-warns/). "These campaigns are likely to proliferate in coming months, with cybercrooks testing out better or improved angles to compromise victims."

Found this article intere...