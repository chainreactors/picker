---
title: AD Certificate Exploitation: ESC1
url: https://www.hackingarticles.in/ad-certificate-exploitation-esc1/
source: Hacking Articles
date: 2025-04-07
fetch_date: 2025-10-06T22:02:44.967596
---

# AD Certificate Exploitation: ESC1

[Skip to content](#content)

Hacking Articles

## Recent Posts

* [AWS: IAM CreateLoginProfile Abuse](https://www.hackingarticles.in/aws-iam-createloginprofile-abuse/)
* [Privacy Protection: Encrypted DNS](https://www.hackingarticles.in/privacy-protection-encrypted-dns/)
* [Privacy Protection: Windows Privacy](https://www.hackingarticles.in/privacy-protection-windows-privacy/)
* [Privacy Protection: Browsers](https://www.hackingarticles.in/privacy-protection-browsers/)
* [Privacy Protection: Password Manager](https://www.hackingarticles.in/privacy-protection-password-manager/)

## Most Used Categories

* [CTF Challenges](https://www.hackingarticles.in/category/ctf-challenges/) (504)
  + [VulnHub](https://www.hackingarticles.in/category/ctf-challenges/vulnhub/) (311)
  + [HackTheBox](https://www.hackingarticles.in/category/ctf-challenges/hackthebox/) (164)
* [Penetration Testing](https://www.hackingarticles.in/category/penetration-testing/) (408)
* [Red Teaming](https://www.hackingarticles.in/category/red-teaming/) (126)
* [Website Hacking](https://www.hackingarticles.in/category/website-hacking/) (64)
* [Cyber Forensics](https://www.hackingarticles.in/category/cyber-forensics-tricks/) (68)
* [Privilege Escalation](https://www.hackingarticles.in/category/privilege-escalation/) (59)
* [Hacking Tools](https://www.hackingarticles.in/category/collection-of-hacking-tools/) (33)
* [Pentest Lab Setup](https://www.hackingarticles.in/category/pentest-lab-setup/) (29)

# [Hacking Articles](https://www.hackingarticles.in/)

Raj Chandel’s Blog

Search for:

Menu

* [Courses We Offer](https://www.hackingarticles.in/courses-we-offer/)
* [CTF Challenges](https://www.hackingarticles.in/ctf-challenges-walkthrough/)
* [Penetration Testing](https://www.hackingarticles.in/penetration-testing/)
* [Web Penetration Testing](https://www.hackingarticles.in/web-penetration-testing/)
* [Red Teaming](https://www.hackingarticles.in/red-teaming/)
* [Donate us](https://www.hackingarticles.in/donate-us/)

* [Home](https://www.hackingarticles.in/)
»* [Active Directory Certificate Attack](https://www.hackingarticles.in/category/active-directory-certificate-attack/)
»* [AD Certificate Exploitation: ESC1](https://www.hackingarticles.in/ad-certificate-exploitation-esc1/)
»

[Active Directory Certificate Attack](https://www.hackingarticles.in/category/active-directory-certificate-attack/)

# AD Certificate Exploitation: ESC1

[April 6, 2025July 23, 2025](https://www.hackingarticles.in/ad-certificate-exploitation-esc1/) by [Raj](https://www.hackingarticles.in/author/raj/)

**AD CS ESC1 Certificate Exploitation** is a critical vulnerability in **Active Directory Certificate Services**. In this article, we will explores how misconfigured certificate templates can lead to privilege escalation. Additonally, we will cover various exploitation techniques.

The **AD CS (Active Directory Certificate Services)** certificate template is a predefined configuration in Microsoft AD CS that defines the type of certificate a user, computer, or service can request. It specifies parameters such as the intended purpose of the certificate, encryption algorithms, validity period, and whether it can be auto-enrolled.

These templates allow administrators to control the issuance and management of certificates within an organization’s Active Directory environment. AD CS uses these templates to standardize certificate issuance, thus making it easier to deploy secure certificates for users, computers, and services.

Some common types of certificate templates include:

1. **User Certificate** – Used for authenticating users.
2. **Computer Certificate** – Used for authenticating computers.
3. **Web Enrollment Certificate** – Used for enrolling via the web.
4. **Code Signing Certificate** – Used to sign software or applications.

### Table of Content

* Active Directory Certificate Services (AD CS) – Certificate Flow
* Understanding Enrollment Right Misconfigurations
* Prerequisites
* Lab Setup

**Enumeration & Exploitation**

* Methods 1: Certipy-ad
* Methods 2: Metasploit
* Methods 3: certipy.exe

**Mitigation Strategies**

### Active Directory Certificate Services (AD CS) – Certificate Flow

**Setup ->** **Request  ->** **Approval ->** **Use ->** **Renewal or Revocation ->** **Validity Check**

**![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi6KxxjgYgYeQedgrsv9EY2wA_xpOlWJbqnJgdLyyXAfgFIT5mwjhtWpzB4SLUKWfVNN2bjlByvEAzBV9H8y5O2QaUuXe_WwVvptMVaufDcHlUeGP6vSKw9d5lQ_5EuN-UwW5e3gDt3SvWzAAzfFjIA7kx6cU65h3EI0NSG3bN0SIeofYw5iGiy8rMIh3St/s16000/0.png)**

1. **Setup**

Initially, the organization sets up a Certificate Authority (CA) – this acts like an official office that issues digital identity cards (certificates) to users and computers.

2. **Request**

A user or device asks the CA:

“*Please give me a certificate*.”

This can happen:

* **Automatically** (via Group Policy for domain-joined systems)
* **Manually** (using tools like MMC, certreq, or web enrollment)

3. **Approval**

Next, the CA checks:

*“Is this a valid and authorized request?”*

If yes, it **signs** the certificate (just like stamping and issuing an ID card) and sends it back to the requester.

4. **Use**

Once issued, the certificate is now used for secure purposes, such as:

* Logging into domain computers
* Enabling HTTPS on web servers
* Email encryption and signing
* VPN and Wi-Fi authentication
* IPsec communication

5. **Renewal or Revocation**

* **Renewal**: Before a certificate expires, the system or user can request a new one.
* **Revocation**: If the certificate is compromised or no longer needed, the CA can revoke (cancel) it.

6. **Validity Check**

Other systems regularly check:

*“Is this certificate still valid and trusted?”*

They look at:

* **Certificate Revocation Lists (CRL)**
* **Online Certificate Status Protocol (OCSP)**

to verify if the certificate is still good or has been revoked.

In this article, we will exploit misconfigured ADCS certificate template to request a certificate for any user, such as **Administrator**, and use it for authentication

### Understanding Enrollment Rights Misconfiguration

To begin with, Enrollment Rights Misconfiguration occurs when an Active Directory Certificate Services (AD CS) template has the following misconfigurations:

* ENROLLEE\_SUPPLIES\_SUBJECT → Allows users to specify their own Subject Alternative Name (SAN).
* Any Purpose (EKU: 1.3.6.1.5.5.7.3.3) → Allows authentication with the certificate.
* No Manager Approval Required → Directly issues certificates.
* Accessible to Low-Privilege Users → Any domain user can request a certificate.

Therefore, if any of these are seen this means, any authenticated user can request a certificate for another user like Administrator and then use that certificate for authentication and privilege escalation.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgHf2h7bHG4qLCkdF9I06T3mRu6aVf-SzDZVnTOvjOUrg_7vWoiQcQBthIDW-GafFTUvg7Zkxt4o7NwXVIRzix6L0Qgt3bfs4S_zurPRYO-U1V9dmVAXtJMCxFBOY4YRngxqtz5-zW5g06VWvBy9bw3w5ALV3iqP4G0CvAxgB1r0pt5Lzg2VpVrYrtdEECF/s16000/1.0.png)

The image given below will help you to understand the type of policy that is used to certificate purpose. For example, here the given certificate is design for clients or user authentication.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgN9PAkeNGebX2P64Ty16cUgGwSXRv2WNzwN52YUA20I9rGcTsLA_pvJ7B6Q44Aym4YKTvwlTze6d4lyUriihfFLSMylFKL48823tLvcZOfYRPpj3_ZN5DL423_Hwf_hkDdlN6rqIb0NKUFy9wk8c6RrFcl0flJxGrs3NUxD4zxhaVuEV-6osbgmS9Vu1Qr/s16000/1.2.png)

### Prerequisites

* Windows Server 2019 as Active Directory that supports PKINIT
* Domain must have Active Directory Certificate Services and Certificate Authority configured.
* Kali Linux
* Tools: Rubeus.exe, certify.exe, Impacket, certipy-ad, Metasploit

### Lab Setup

To simulate the vulnerability in a practical environment, we will create a user named ‘aarti and add her to the **Domain Users** group,...