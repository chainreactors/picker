---
title: Who You Gonna Call&#x3f; AndroxGh0st Busters&#x21; &#x5b;Guest Diary&#x5d;, (Tue, Jul 16th)
url: https://isc.sans.edu/diary/rss/31086
source: SANS Internet Storm Center, InfoCON: green
date: 2024-07-18
fetch_date: 2025-10-06T17:46:45.447102
---

# Who You Gonna Call&#x3f; AndroxGh0st Busters&#x21; &#x5b;Guest Diary&#x5d;, (Tue, Jul 16th)

# [Internet Storm Center](/)

[Sign In](/login.html)
[Sign Up](/register.html)

Handler on Duty: [Johannes Ullrich](/handler_list.html#johannes-ullrich "Johannes Ullrich")

Threat Level: [green](/infocon.html)

* [previous](/diary/31084)
* [next](/diary/31094)

# [Who You Gonna Call? AndroxGh0st Busters! [Guest Diary]](/forums/diary/Who%2BYou%2BGonna%2BCall%2BAndroxGh0st%2BBusters%2BGuest%2BDiary/31086/)

**Published**: 2024-07-16. **Last Updated**: 2024-07-17 00:33:04 UTC
**by** [Guy Bruneau](/handler_list.html#guy-bruneau) (Version: 1)

[0 comment(s)](/diary/Who%2BYou%2BGonna%2BCall%2BAndroxGh0st%2BBusters%2BGuest%2BDiary/31086/#comments)

[This is a Guest Diary by Michael Gallant, an ISC intern as part of the SANS.edu [BACS](https://www.sans.edu/cyber-security-programs/bachelors-degree/) program]

![](https://isc.sans.edu/diaryimages/images/michael_gallant_pic1.png)
                                                                                                  Image generated by DALL-E [[8](https://openai.com/index/dall-e-2/)]

**Introduction**

During my internship at the SANS Internet Storm Center, I was tasked with setting up a honeypot, an internet device intentionally vulnerable, to observe and analyze attack vectors. Among the numerous attacks recorded, one particular observation stood out: the AndroxGh0st malware. This threat targets Laravel web applications and poses major risks to sensitive data. In this post, I aim to share my experience and raise awareness about AndroxGh0st, detailing its exploitation methods and providing strategies to defend against it.

**Understanding AndroxGh0st**

AndroxGh0st is a Python-scripted malware designed to target .env files that contain sensitive information in web applications, specifically those using the Laravel framework. This malware is part of a botnet operation that primarily aims to steal credentials and abuse other functions such as vulnerability scanning, Simple Mail Transfer Protocol (SMTP), application programming interfaces (APIs), and web shell deployment [1][[2](https://www.bleepingcomputer.com/news/security/fbi-androxgh0st-malware-botnet-steals-aws-microsoft-credentials/)].

**What is Laravel?**

Laravel is an open-source PHP web application development framework. It simplifies development with built-in database interaction, authentication, routing, sessions, and caching features. Laravel is popular for designing web applications such as e-commerce platforms, social networking platforms, APIs (Application Programming Interfaces), and Content Management Systems (CMS). Laravel applications often handle critical data, making them attractive targets for attackers. The added complexity of Laravel can lead to security oversights, providing opportunities for exploitation and including exposed default settings or sensitive files, making it easier for attackers to gain access [[3](https://blogs.juniper.net/en-us/security/shielding-networks-against-androxgh0st)].

                                                                                           Key Characteristics [[6](https://thehackernews.com/2024/03/androxgh0st-malware-targets-laravel.html)]
                                             ![](https://isc.sans.edu/diaryimages/images/michael_gallant_pic2.png)

AndroxGh0st exploits multiple known vulnerabilities:

**CVE-2017-9841**: A Remote Code Execution (RCE) vulnerability in PHPUnit.

* AndroxGh0st malware typically uses scripts to scan for and exploit specific vulnerabilities on websites. One common method is to run PHP code on vulnerable websites using the PHPUnit module. If the /vendor folder is accessible from the internet, attackers can send malicious HTTP POST requests to the /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php uniform resource identifier (URI), allowing them to execute code remotely.
* Once inside, attackers use AndroxGh0st to download malicious files to the compromised system. They can also set up fake web pages to maintain backdoor access, enabling them to download more malicious files and access databases.

**CVE-2018-15133**: The Laravel App Key Deserialization RCE.

* AndroxGh0st malware creates a botnet to scan for websites using the Laravel framework. It looks for exposed .env files at the root level of the domain, which often contain credentials and tokens. Attackers target these files to steal sensitive information.
* If an .env file is found, attackers send a GET request to /.env to access its contents. However, they might use a POST request with a specific identifier to the same URI. This method is often used on websites in debug mode, exposing non-production sites to the internet. Successful responses allow attackers to steal usernames, passwords, and credentials for services like email and AWS accounts.
* Also, AndroxGh0st can exploit the Laravel application key. If the key is found, attackers encrypt the PHP code and send it as a value in the XSRF-TOKEN cookie in a GET request. This exploit allows remote code execution on Laravel applications, allowing attackers to upload files and gain further access to the website

**CVE-2021-41773**: A directory traversal and RCE vulnerability in the Apache HTTP server.

* AndroxGh0st attackers scan for vulnerable Apache HTTP Servers (2.4.49 and 2.4.50). They use path traversal attacks to find uniform resource locators (URLs) for files outside the root directory. If these files aren't protected and Common Gateway Interface (CGI) scripts are enabled, attackers can execute code remotely.
* Once attackers obtain credentials through these methods, they can access sensitive data or use the services for further malicious activities. For example, if they compromise AWS credentials, they might create new users and policies or launch new AWS instances to conduct additional scans [[1](https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-016a)][[3](https://blogs.juniper.net/en-us/security/shielding-networks-against-androxgh0st)][[4](https://www.lacework.com/blog/androxghost-the-python-malware-exploiting-your-aws-keys)].

**My interaction with AndroxGh0st**

On March 11, 2024, I observed suspicious activities originating from IP address 78.153.140.179. The attacker made 191 connections to my honeypot, targeting TCP port 80 from various source ports and enacting the same HTTP requests. The user-agent string ‘androxgh0st’ was present in these connections, almost like a calling card left behind by the attacker.

                                                                               Sample of the HTTP connections made to TCP/80:
                     ![](https://isc.sans.edu/diaryimages/images/michael_gallant_pic3.png)

                                                       Sample of sequences with HTTP Requests and different source ports:
                                      ![](https://isc.sans.edu/diaryimages/images/michael_gallant_pic4.png)

![](https://isc.sans.edu/diaryimages/images/michael_gallant_pic5.png)

![](https://isc.sans.edu/diaryimages/images/michael_gallant_pic6.png)

Noting the threat actor’s user-agent string and the “androxgh0st” from all POST requests:

![](https://isc.sans.edu/diaryimages/images/michael_gallant_pic7.png)

![](https://isc.sans.edu/diaryimages/images/michael_gallant_pic8.png)

![](https://isc.sans.edu/diaryimages/images/michael_gallant_pic9.png)

Although my honeypot didn't have an exposed .env file or other specific targets the malware was searching for, the meticulous behavior of AndroxGh0st was evident. Taking an account for the URIs after the successful connections and the incoming POST requests consistently included the "androxgh0st" string, demonstrating the malware's systematic approach to identifying vulnerable Laravel applications.

**Am I Being Haunted by AndroxGh0st?**

When detecting AndroxGh0st on our systems, we need to be aware of the various indicators of compromise. Provided by CISA/FBI, Juniper Labs, and Lacework Labs, here are some signs that this malware...