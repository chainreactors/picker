---
title: Technical Analysis of Ducex: Packer of Triada Android Malware
url: https://any.run/cybersecurity-blog/ducex-packer-analysis/
source: Over Security - Cybersecurity news aggregator
date: 2025-07-09
fetch_date: 2025-10-06T23:54:33.621754
---

# Technical Analysis of Ducex: Packer of Triada Android Malware

[![ANY.RUN's Cybersecurity Blog](/cybersecurity-blog/wp-content/uploads/2020/07/Logo-1.png)](/cybersecurity-blog/)

* [Register for free](https://app.any.run/#register)
* [Guides and Tutorials](/cybersecurity-blog/guides/)
* [Research](/cybersecurity-blog/research/)
* Featured posts
  + [Malware Analysis in ANY.RUN:
    The Ultimate Guide](/cybersecurity-blog/malware-analysis-in-a-sandbox/)
  + [Raccoon Stealer 2.0 Malware analysis](/cybersecurity-blog/raccoon-stealer-v2-malware-analysis/)
  + [How to Get Free Malware Samples and Reports](/cybersecurity-blog/free-malware-samples-reports/)
* Categories
  + [Analyst Training](/cybersecurity-blog/category/training/)
  + [Cybersecurity Lifehacks](/cybersecurity-blog/category/lifehacks/)
  + [Instructions on ANY.RUN](/cybersecurity-blog/category/instructions/)
  + [Interviews](/cybersecurity-blog/category/interviews/)
  + [Malicious History](/cybersecurity-blog/category/history/)
  + [Malware Analysis](/cybersecurity-blog/category/malware-analysis/)
  + [News](/cybersecurity-blog/category/news/)
  + [Service Updates](/cybersecurity-blog/category/service-updates/)
* [Write for us](/cybersecurity-blog/write-for-us/)
* [Go to service](https://app.any.run/)
* [Register for free](https://app.any.run/#register)

* + Search

[![ANY.RUN's Cybersecurity Blog](/cybersecurity-blog/wp-content/uploads/2020/07/Logo-1.png)](/cybersecurity-blog/)

* [Register for free](https://app.any.run/#register)
* [Guides and Tutorials](/cybersecurity-blog/guides/)
* [Research](/cybersecurity-blog/research/)
* Featured posts
  + [Malware Analysis in ANY.RUN:
    The Ultimate Guide](/cybersecurity-blog/malware-analysis-in-a-sandbox/)
  + [Raccoon Stealer 2.0 Malware analysis](/cybersecurity-blog/raccoon-stealer-v2-malware-analysis/)
  + [How to Get Free Malware Samples and Reports](/cybersecurity-blog/free-malware-samples-reports/)
* Categories
  + [Analyst Training](/cybersecurity-blog/category/training/)
  + [Cybersecurity Lifehacks](/cybersecurity-blog/category/lifehacks/)
  + [Instructions on ANY.RUN](/cybersecurity-blog/category/instructions/)
  + [Interviews](/cybersecurity-blog/category/interviews/)
  + [Malicious History](/cybersecurity-blog/category/history/)
  + [Malware Analysis](/cybersecurity-blog/category/malware-analysis/)
  + [News](/cybersecurity-blog/category/news/)
  + [Service Updates](/cybersecurity-blog/category/service-updates/)
* [Write for us](/cybersecurity-blog/write-for-us/)
* [Go to service](https://app.any.run/)
* [Register for free](https://app.any.run/#register)

* + Search

[![ANY.RUN's Cybersecurity Blog](/cybersecurity-blog/wp-content/uploads/2022/10/mini-logo.png)](/cybersecurity-blog/)

* + Search

![Technical Analysis of Ducex: Packer of Triada Android Malware ](/cybersecurity-blog/wp-content/uploads/2025/07/ducex_blog.jpg)

[Malware Analysis](/cybersecurity-blog/category/malware-analysis/)

# Technical Analysis of Ducex: Packer of Triada Android Malware

July 8, 2025

[Add comment](#comments-14618)
35966 views
15 min read

[Home](/cybersecurity-blog/)[Malware Analysis](/cybersecurity-blog/category/malware-analysis/)

Technical Analysis of Ducex: Packer of Triada Android Malware

#### Recent posts

* [![](/cybersecurity-blog/wp-content/uploads/2025/09/Release-notes-1024x497.png)

  #### Release Notes: Palo Alto Networks, Microsoft, IBM Connectors and 2,300+ Suricata Rules

  1763
  0](/cybersecurity-blog/release-notes-september-2025/)
* [![](/cybersecurity-blog/wp-content/uploads/2025/10/FunkLocker_blog-1024x497.jpg)

  #### FunkSec’s FunkLocker: How AI Is Powering the Next Wave of Ransomware

  3179
  0](/cybersecurity-blog/funklocker-malware-analysis/)
* [![](/cybersecurity-blog/wp-content/uploads/2025/09/defender_blog-1024x497.jpg)

  #### ANY.RUN & MS Defender: Enrich Alerts Faster, Stop Attacks Early

  3267
  0](/cybersecurity-blog/ms-defender-connectors/)

[Home](/cybersecurity-blog/)[Malware Analysis](/cybersecurity-blog/category/malware-analysis/)

Technical Analysis of Ducex: Packer of Triada Android Malware

Many have probably heard of the modular malware for mobile devices called Triada. Even nine years after its first mention in 2016, it remains one of the most advanced [Android trojans](https://any.run/cybersecurity-blog/android-malware-analysis/) out there. Recently, our team at [ANY.RUN](http://any.run/?utm_source=anyrunblog&utm_medium=article&utm_campaign=ducex_analysis&utm_term=080725&utm_content=linktolanding) came across an interesting sample of this malicious software. The sample in question was embedded in a fake Telegram app.

Since the capabilities of this threat have been extensively studied and described by other researchers, we focused on the packer used by the malware that we named Ducex.

Here’s a detailed breakdown of our analysis and key findings.

## Key Takeaways

* **Triada’s Android Packer:** Ducex is an advanced Chinese Android packer found in Triada samples, whose primary goal is to complicate analysis and confuse the detection of its payload.

* **Encrypted Functions:** The packer employs serious obfuscation through function encryption  using a modified RC4 algorithm with added shuffling.

* **XORed Strings:** Beyond functions, all strings used by Ducex are also encrypted using a simple sequential [XOR algorithm](https://any.run/cybersecurity-blog/encryption-in-malware/) with a changing 16-byte key.

* **Debugging Challenges**: Ducex creates major roadblocks for debugging. It performs APK signature verification, failing if the app is re-signed. It also employs self-debugging using fork and ptrace to block external tracing.

* **Analysis Tool Detection**: The packer actively detects the presence of popular analysis tools such as Frida, Xposed, and Substrate. If any of these tools are found in memory, the process terminates its execution.

* **Payload Storage & Encryption**: The Triada payload is uniquely stored within Ducex’s own classes.dex file in a large, additional section after the main application code, avoiding detection as separate files.

## Initial Analysis

Our investigation began with the [analysis of a Triada sample](https://app.any.run/tasks/27e699df-b754-4ddd-9bcb-997f5a98150f/?utm_source=anyrunblog&utm_medium=article&utm_campaign=ducex_analysis&utm_term=080725&utm_content=linktoservice) inside ANY.RUN’s Interactive Sandbox.

![](/cybersecurity-blog/wp-content/uploads/2025/07/image24-1024x574.png)

The service quickly identified the malware family, and we were able to confirm this by recognizing the characteristic domains it communicated with.

![](/cybersecurity-blog/wp-content/uploads/2025/07/imaged-1.png)

From there, we moved on to inspect the packer.

Detect malware in a live, interactive environment
 Analyze suspicious files and URLs in ANY.RUN’s Sandbox

[Sign up with business email](https://app.any.run/?utm_source=anyrunblog&utm_medium=article&utm_campaign=ducex_analysis&utm_term=080725&utm_content=linktoregistration#register/)

## Why We Decided to Analyze Ducex

Not malicious itself, Ducex is still quite interesting. Its developers tried their best to complicate analysis as much as possible and confuse detection of the payload it carries using various techniques that will be discussed below.

We have not obtained the source code of this tool, so we relied exclusively on its reverse engineering. For the same reason, we gave it a name ourselves. Studying the classes in the code, we noticed that its authors used the word “Duce” a lot.

![](/cybersecurity-blog/wp-content/uploads/2025/07/image12.png)

The library they utilize is called “libducex”. Based on this, we called the packer “Ducex”.

## Ducex: The Architecture

Before proceeding to detailed analysis of the tool, let’s look at the general operation scheme of Ducex:

![](/cybersecurity-blog/wp-content/uploads/2025/07/image25-1024x847.png)

We have outlined all the stages of the tool’s execution; we will demonstrate and discuss them below in their interplay.

## Analyzing App’s Java ...