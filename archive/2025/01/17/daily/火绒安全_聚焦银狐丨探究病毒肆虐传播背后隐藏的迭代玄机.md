---
title: 聚焦银狐丨探究病毒肆虐传播背后隐藏的迭代玄机
url: https://mp.weixin.qq.com/s?__biz=MzI3NjYzMDM1Mg==&mid=2247521662&idx=1&sn=d892c1ee59c408fd2318701d76ce76eb&chksm=eb704b41dc07c257e791093a007f7281efb53f3f4302acc7f352f5567cc85528f957695de501&scene=58&subscene=0#rd
source: 火绒安全
date: 2025-01-17
fetch_date: 2025-10-06T20:11:34.652084
---

# 聚焦银狐丨探究病毒肆虐传播背后隐藏的迭代玄机

![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96slRenib2KX8OHO8BCQJtRHrJEwZDU2YI5uqBiaibiaSTI3WyhFzP5QibMQQ/0?wx_fmt=jpeg)

# 聚焦银狐丨探究病毒肆虐传播背后隐藏的迭代玄机

原创

火绒安全

火绒安全

# ![](https://mmbiz.qpic.cn/sz_mmbiz_gif/0icdicRft8tz4nrnOI1emtFr0UYnrLKytAvy2gia6ZuIUJs14h2pEIwpiaWPCTTuCQIDibx9dlfXoyrNyVEWb8DVUUA/640?wx_fmt=gif&from=appmsg)

随着数字化进程的加速，网络已经深度融入社会各层面，在极大地促进了信息交流与经济发展的同时，也滋生了大量网络犯罪活动，为网络安全领域带来了严峻挑战。自2021年起，“银狐”团伙在网络世界中悄然崛起。作为活跃在黑色产业链中的犯罪团伙，其制作的“银狐”木马病毒不断演变升级，凭借高度一致的技术手段与攻击策略，对企业和个人造成持续性威胁。**本文将梳理“银狐”木马的迭代过程和传播方式，并进行溯源分析，期望大家能够深入了解此类病毒，提高警惕，防止遭受攻击。**

银狐团伙的黑色产业链广泛渗透至金融、诈骗、政府机构及多个行业领域。从2021年直至2024年12月，“银狐”木马活动显著增多，且始终保持相当高的活跃度。起初，“银狐”组织将目标锁定在企业与机构中的关键岗位人员，如管理层、财务部门、销售团队以及电子商务从业者，通过定向钓鱼攻击获取敏感信息。随着时间的推移，银狐病毒高效的攻击模式与成功的示范效应逐渐引起其他网络犯罪分子的关注，他们开始模仿其攻击手段并进行传播，导致全球范围内类似攻击事件频发。不同于传统钓鱼木马攻击，“银狐”木马采用更为隐蔽的多级白进程劫持技术进行搭载。如今，不仅企业和机构深受其害，普通网民也面临着日益严峻的安全威胁。

火绒终端威胁情报系统的监测数据显示，“银狐”团伙在过去一年多，始终保持高度活跃，每月攻击频率呈现增高趋势，受害设备数量以每月数万台计。尤其是在2023年底，其攻击事件显著增长，这一攻击趋势在2024年仍在延续，且其影响范围也在不断扩大。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96MteKvWzXydJjP36obXwGMTHeRtrZ9MibC0p7d1ukqPA9ibrIypAHdXHA/640?wx_fmt=png&from=appmsg)

银狐事件曲线

通过对近期发现的“银狐”木马进行分析，得知其主要采用Win0s作为后门模块，以实现对用户电脑活动的监控。通过网上泄露的源代码可以看到，这类后门已具备键盘记录、查看屏幕（高速屏幕、娱乐屏幕、后台屏幕）、摄像头查看、文件管理、语音监听、远程终端执行、系统管理、驱动插件、注册表管理、压力测试等功能。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96v4GA8tYibPTNiaTBp8icfAibB3T6fkfN1JOl9CnFZIUdMmFLSJVnvzRehw/640?wx_fmt=png&from=appmsg)

源代码对比图

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96ntBvBt2Z9MWqF0ibfRWpnrCgW48geWvK9bdGZGicUUCLQCzvUKLaiakog/640?wx_fmt=png&from=appmsg)

Win0s 功能图

IP-Guard等行为管理软件本身是用于企业内部管理的工具，具备记录电脑日常操作的功能。而“银狐”组织利用这类软件，能够获取用户电脑的更多权限，从而记录用户电脑的日常操作，包括浏览网站、社交通信消息记录、文件外发跟踪、电子邮件劫持、智能截图、文件操作、打印机日志、剪贴板记录、屏幕录像等。因此，一旦“银狐”组织成功取得用户电脑的控制权，便会通过类似软件对木马进行更深层次的传播。

“银狐”团伙通过控制受害者的电脑屏幕，在社交平台（如微信、钉钉、企业微信）上实施一系列精心设计的操作，包括：

1. **群聊传播木马：**控制电脑屏幕将恶意木马文件转发至群聊，诱导群成员点击下载。一旦木马被运行，更多设备可能被感染，之后，迅速退出群聊以降低被发现的风险。
2. **冒充上级实施诈骗：**控制领导社交账号或管理人员，单独创建新群，假借紧急事务或企业内部需求，诱骗财务人员转账或泄露敏感信息。

这种手法结合了高度针对性的社会工程学攻击，不仅能实现恶意木马的快速传播，还会导致受害者损失惨重。本文后续将会针对此类木马进行详细分析。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96WodwN5NeovicxDt5VtgQJFwbhXUMlhFPoQPqE3bSeID6cAS8aHQLSwg/640?wx_fmt=png&from=appmsg)

IP-Guard 群聊传播

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96P9weuUQuvGcFPhW1HNpjO9JQHRvqp7ohQVaH8K4bT67Q47LKXOph4w/640?wx_fmt=png&from=appmsg)

群聊二次传播

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96qxXuQUYCJTS8WYwAMrFyty3qicRjpgN8Zqe0l17BcHjbAbMVhULofeA/640?wx_fmt=png&from=appmsg)

控制社交平台诈骗

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96uXcApv5YelbX7h9EzChibFibTLvFAa6icvnNlCiaMPC1zogezSf5VoVNhw/640?wx_fmt=png&from=appmsg)

Ping32 功能图

**一**

**木马传播方式**

“银狐”木马在传播过程中展现出高度的社工性和灵活性，以下是其主要传播途径：

**1.定向政企财务钓鱼邮件**

* **邮件伪装：**通过伪装成看似合法的发件人身份（如供应商、合作伙伴或客户）发送含有恶意附件或链接的邮件。这些附件通常以PDF、Word、Excel等常见文档格式出现，并会利用社会工程手段诱使受害者将其打开。
* **宏代码攻击：**如果附件是Office文件，则常常嵌入有恶意宏代码。一旦启用宏功能，这些恶意脚本就会被执行，进而下载和安装木马程序。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96Zp7UIX0FtBATTpjZJ9EWc3Xibe4QDicaXnKNVzJl4rzcVUoX48qymxVQ/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP964xZcibZDfaGxQ3m7MOyc6ZI7J1BHYAqhvmlDL5QaR076jBNGJ7Zow7Q/640?wx_fmt=png&from=appmsg)

钓鱼邮件

**2.伪造应用下载网页并推广**

* **假冒合法应用：**创建高仿的应用下载页面，伪装为热门工具、游戏或办公软件，诱骗受害者下载含有木马的应用程序。
* **搜索引擎广告投放：**通过购买广告位或优化搜索引擎排名，使伪造页面出现在搜索结果前列，从而提高受害者下载恶意程序的概率。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96PQwxgrsDLbaiaZTgcbq1HvJ686FgicPdHrj1oyDiatylOum1rfib7icmaeg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP9676hBANP4iaS4dgaFtkw7UAMUYmibgGXgicrdYwCJicxC2GpyoxWkrfPZfw/640?wx_fmt=png&from=appmsg)

钓鱼网页

**3.网页挂马**

* 水坑攻击：在政企人员频繁访问的网站或论坛中植入恶意代码，受害者一旦访问，浏览器会自动下载并执行木马程序。
* 广告劫持：利用恶意广告注入技术，在正常网页的广告弹窗分发木马。

**4.色情信息诱导**

* 诱导下载：利用伪装成色情视频、图片等资源的链接和附件，引诱受害者下载恶意文件。
* 钓鱼网站：搭建钓鱼网站并将其伪装成色情网站，受害者在访问或尝试下载内容时会被植入木马。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96jHm7s3Jtt7XCMKZFm3vHHxYrxVHN0UvxLYd9tnwuNVgbtQlt2pLgUQ/640?wx_fmt=png&from=appmsg)

色情引诱

**5.游戏资源传播**

* **盗版游戏私服**：通过私服游戏客户端或外挂工具捆绑木马程序，吸引受害者下载。
* **论坛分享：**在游戏论坛或社群中发布伪装成游戏补丁、福利资源的木马程序，诱导受害者下载。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96YRD7fLeicz5ZC1WS0cJWD6L0ViaCHAbN8jiajpEIjRp4DiaJKUib8avx4Pw/640?wx_fmt=png&from=appmsg)

游戏私服

**6.常见web Nday漏洞**

* **已知漏洞攻击：**利用受害者使用的网站中常见的Nday漏洞（如Struts2、Log4j、WebLogic等）直接植入木马，入侵受害者系统。
* **工具化攻击：**借助自动化漏洞扫描工具批量检测受害者系统，并在漏洞存在时植入恶意程序。

**7.社交信息**

* **键盘和鼠标劫持：**通过木马获取受害者设备的控制权限，利用受害者的社交软件（如微信、企业微信、Telegram）向其联系人群发恶意链接或文件，达到木马传播的目的。
* **信任链攻击：**伪装为受害者本人发送的消息，增强恶意链接的可信度，从而扩散木马传播。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96Kib7Ta78jzOVgr7wl3NC33WdH6ibxGwYx2oT8wlmVmPd4CpicSlJp2TYA/640?wx_fmt=png&from=appmsg)

社交平台传播

**8.供应链**

* **软件更新劫持：**通过入侵第三方软件库，篡改其中的更新包或安装包，将木马伪装为合法软件的部分功能，借助供应链传播至受害者系统。
* **外包或合作渠道渗透：**利用受感染的外包服务商或合作伙伴的程序或系统，以共享文件或系统集成为媒介传播木马。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96S1gicKNx0vzuScaDfKd4OlZn7YoXy1xziaNHBxUImz8VRp3WarfG8Lkg/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96eXazr6vuEXv0x67IJvjVmZSnkyHf5XL8oQN6fp1rrzBa56v5OskMBQ/640?wx_fmt=png&from=appmsg)

Github投毒事件

**二**

**木马迭代**

“银狐”木马的**执行流程**可分为以下三个阶段：

* 单文件加载器：释放白加黑文件
* 白加黑实现权限维持
* 执行后门模块

而木马在各个阶段的攻击手法，也随着时间的推移在不断演变。其中，加载器的种类日趋多样，从最初的.exe文件发展到如今的.chm、.bat、.vbs、.msi等格式。同时，在编程语言的运用上也越发多元，涵盖了C、C++、C#、Go等多种语言。这一演变使得“银狐”木马能够更加灵活地突破安全防御，增加了防范和检测的难度。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96WV7LTSrrxMemnG6LcvQFlkiaJYFGc4r5ceMRbUibDuXJVfibFLORTViaRg/640?wx_fmt=png&from=appmsg)

伪装文件名

**如今，其后门模块历经演变，也从原始Gh0st、大灰狼演变为DcRat、Win0s，甚至开始利用国内正规行为管理软件。**

**第一阶段：Gh0st**

Gh0st 阶段的木马通常采用套MFC壳的方式，将恶意代码塞入MFC程序初始化对话框之后。当程序执行到恶意代码所在位置时，会通过简单的异或解密恶意代码，之后直接加载执行恶意代码。在此阶段，木马的后门主要是基于 Gh0st 内核改版的灰鸽子、大灰狼远控等远控工具。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96kkiaicrniciaHrGp1m52POD4fo10REgIPyQ0fmqurNkBCsMV4APY0USyXA/640?wx_fmt=png&from=appmsg)

Gh0st 加载流程

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96zO5aDKyExfAUSUBicxYzECpDtaXfsqAkxSNSJb5YTkTrGBBibOAT3lRw/640?wx_fmt=png&from=appmsg)

Gh0st 服务端

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP966RVT2W68xUIvVcPhlRiaHbVkdawNibicUfDxu8eyXF9jticFOicNBibfQic1w/640?wx_fmt=png&from=appmsg)

大灰狼服务端

**第二阶段：DcRat**

DcRat 是一种使用 C# 语言编写的后门远控工具。其背后的所依托的木马技术也随着 C# 语言的发展不断演变。C# 语言与 .NET Framework 和 Windows 系统深度集成，凭借其丰富的标准库和第三方库，能够更加便捷高效的实现木马功能。随着 .NET Core 的出现，C# 程序的运行平台从 Windows 扩展到了 Linux 和 macOS，大幅提升了其跨平台的适用性。这种演变不仅拓宽了木马的传播范围，还增强了它的灵活性与隐蔽性，为安全防护带来了新的挑战。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96DlWaZK4QZ4ichdmTW5nfSZPIMvap2uwmyukNEOMJ3lqDGmVGnQ3b3hA/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96OTVnJU0woOMN0VFOC5OSQAlAU1wrOqFBAV2AlZjRdgzicOzyW8n7vUQ/640?wx_fmt=png&from=appmsg)

DcRat加载器

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP9631tnEh0YEzUklPyLaMunkn8uMt4By3km42OWuthG5x91KrvCRRMJWw/640?wx_fmt=png&from=appmsg)

DcRat服务端

**第三阶段：Win0s**

自“银狐”木马采用 Win0s 作为后门模块以来，其权限维持技术在不断升级，与安全软件的对抗也进入了白热化阶段。“银狐”通过持续优化恶意代码加载器，结合内存加载 PE、白加黑技术以及多样化的进程注入手段，不断突破安全防线。其中，“银狐”对白加黑技术的利用尤为突出，它通过劫持白名单软件，将自身伪装为可信程序，从而规避杀软的监控和检测。此外，“银狐”还会通过多种系统特性进行提权操作，成功绕过进程链检测机制，并利用BYOVD技术在驱动层展开对抗，由此确保攻击者可以长期保持对目标系统的控制，以实现攻击行为的持续隐蔽与高效执行。

以下是银狐目前使用的技术手法：

**1.RPC （Remote Procedure Call）远程调用**

RPC （Remote Procedure Call）远程调用是一种进程间通信（IPC）协议。该技术能够隐藏网络通信的复杂性，使计算机程序像调用本地程序一样，对远程系统（通常是另一台计算机）上的程序或服务进行调用。RPC 远程调利用 ALPC 进行底层消息传递，能够通过 svchost.exe 启动进程，而借助 RPC 远程调用能够实现进程链的加白。

* RPC 创建system权限进程

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7SUaKiaVExN7Kewb1h8uP96p8ibbnSjicNJBib4KBQmibn9ibMkL6khPU5oJAfscSYx4V3do95yAL...