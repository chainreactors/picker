---
title: Session Cookies, Keychains, SSH Keys and More | 7 Kinds of Data Malware Steals from macOS Users
url: https://buaq.net/go-154769.html
source: unSafe.sh - 不安全
date: 2023-03-23
fetch_date: 2025-10-04T10:21:02.626533
---

# Session Cookies, Keychains, SSH Keys and More | 7 Kinds of Data Malware Steals from macOS Users

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/2edab0a8d25be6eb8d84ded60a3470d1.jpg)

Session Cookies, Keychains, SSH Keys and More | 7 Kinds of Data Malware Steals from macOS Users

The scourge of ransomware attacks that has plagued Windows endpoints over the past half decade or s
*2023-3-22 23:10:17
Author: [www.sentinelone.com(查看原文)](/jump-154769.htm)
阅读量:36
收藏*

---

The scourge of ransomware attacks that has plagued Windows endpoints over the past half decade or so has, thankfully, not been replicated on Mac devices. With a few unsuccessful exceptions, the notion of locking a Mac device and holding its owner to ransom in return for access to the machine and its data has not yet proven an attractive proposition for attackers.

However, the idea of [stealing valuable data and then monetizing it](https://www.sentinelone.com/blog/ransoms-without-ransomware-data-corruption-and-other-new-tactics-in-cyber-extortion/) in nefarious ways is a tactic that is now common across platforms. On macOS, threat actors will quietly exfiltrate session cookies, keychains, SSH keys and more as malicious processes from adware to spyware look to harvest data that can be recycled and sold on various [underground forums](https://www.sentinelone.com/blog/more-evil-markets-how-its-never-been-easier-to-buy-initial-access-to-compromised-networks/) and marketplaces, or used directly in espionage campaigns and [supply chain attacks](https://www.sentinelone.com/labs/cratedepression-rust-supply-chain-attack-infects-cloud-ci-pipelines-with-go-malware/).

In recent posts, we have looked at how threat actors [deliver payloads](https://www.sentinelone.com/blog/7-ways-threat-actors-deliver-macos-malware-in-the-enterprise/) to macOS targets and how they attempt to [evade detection](https://www.sentinelone.com/blog/macos-payloads-7-prevalent-and-emerging-obfuscation-techniques/). In this post, we look at the data assets targeted by macOS malware in some of the most recent in-the -wild incidents in order to help defenders better protect the enterprise and hunt for signs of compromise.

![](https://www.sentinelone.com/wp-content/uploads/2023/03/Session-Cookies-Keychains-SSH-keys-and-More-7-Kinds-of-Data-Malware-Steals-from-macOS-Users-7.jpg)

## 1. Session Cookies

One of the top targets for observed macOS malware are session cookies stored on user’s devices. For convenience and productivity, browsers and many enterprise apps that are designed to work across devices, such as Slack, TeamViewer, Zoom and similar, allow the user to remain logged in until they explicitly log out.

![The Slack App allows infinite sessions until the user explicitly logs out](https://www.sentinelone.com/wp-content/uploads/2023/03/macos_data_theft_1.jpg)

The Slack App allows infinite sessions until the user explicitly logs out

This is achieved by storing a session cookie on the device. In the event that a process or user copies and steals those cookies, they can use them on a different device to log in without authentication.

The theft of session cookies was implicated in the recent [CircleCI breach](https://circleci.com/blog/jan-4-2023-incident-report/#c-consent-modal). According to CirlceCI’s public statement:

*“To date, we have learned that an unauthorized third party leveraged malware deployed to a CircleCI engineer’s laptop in order to steal a valid, 2FA-backed SSO session. This machine was compromised on December 16, 2022. The malware was not detected by our antivirus software. Our investigation indicates that the malware was able to execute session cookie theft, enabling them to impersonate the targeted employee in a remote location and then escalate access to a subset of our production systems.

Because the targeted employee had privileges to generate production access tokens as part of the employee’s regular duties, the unauthorized third party was able to access and exfiltrate data from a subset of databases and stores, including customer environment variables, tokens, and keys”*.

Session cookies can be stored anywhere, but typically they are in locations which can be accessed by the user or a process running as the user. Some locations, such as the User’s Library Cookies folder, may be restricted by [TCC](https://www.sentinelone.com/labs/bypassing-macos-tcc-user-privacy-protections-by-accident-and-design/) unless the parent process has [Full Disk Access](https://www.sentinelone.com/labs/bypassing-macos-tcc-user-privacy-protections-by-accident-and-design/) or uses one of the many known [TCC bypasses](https://www.sentinelone.com/blog/mojaves-security-hardening-user-protections-bypassed/). Real world attacks (e.g., [XCSSET](https://www.sentinelone.com/blog/xcsset-malware-update-macos-threat-actors-prepare-for-life-without-python/)) and [researchers](https://github.com/acheong08/CVE-2022-26726-POC) have [consistently](https://www.blackhat.com/us-21/briefings/schedule/index.html#-ways-to-bypass-your-macos-privacy-mechanisms-23133) shown that TCC, while often a nuisance to users, does not present a significant obstacle to attackers.

Here are some common examples of locations that store session cookies on macOS:

```
~/Library/Cookies/*.binarycookies

Chrome:  ~/Library/Application Support/Google/Chrome/Default/Cookies
Firefox: ~/Library/Application Support/Firefox/Profiles/[Profile Name]/
Slack :  ~/Library/Application Support/Slack/Cookies (file)
	 ~/Library/Application Support/Slack/storage/*
         ~/Library/Containers/com.tinyspeck.slackmacgap/Data/Library/Application Support/Slack/storage
```

An excellent post on abusing Slack and session cookies for offensive security was written by Cody Thomas [here](https://posts.specterops.io/abusing-slack-for-offensive-operations-2343237b9282).

In addition, encrypted and unencrypted databases associated with enterprise software can also be targeted by criminals and crimeware. Weakly encrypted databases may be decryptable with a [little work and knowledge](https://old.reddit.com/r/computerforensics/comments/kch7ot/zoom_artifacts_encrypted_dbs/) of the user’s password, often scraped by malware installers upon initial compromise. Zoom’s encrypted database, for example, is targeted by the [Pureland](https://www.virustotal.com/gui/file/845ef90acc34abfce89e3e630265f23c03581918d30256c9e3c3d65250464933/relations) infostealer.

![Pureland Infostealer searches for Zoom encrypted database, among other items](https://www.sentinelone.com/wp-content/uploads/2023/03/macos_data_theft_8.jpg)

Pureland Infostealer searches for Zoom encrypted database, among other items

```
~/Library/Application Support/zoom.us/data/zoomus.enc.db
```

![Pureland Info Stealer hosted on Dropbox (Source: VirusTotal)](https://www.sentinelone.com/wp-content/uploads/2023/03/macos_data_theft_5.jpg)

Pureland Info Stealer hosted on Dropbox (Source: VirusTotal)

## 2. Login Keychain

Perhaps prized above all data on a user’s Mac is the user’s keychain, an encrypted database used to store passwords, authentication tokens and encryption keys. The keychain uses strong encryption that can’t be broken simply by stealing the database or even accessing the computer. However, the weakness of the keychain is that its secrets can all be unlocked if the attacker knows the user’s login password. If that password is weak, easily guessable, or – as is most common – voluntarily given up to a [malicious process by request](https://www.sentinelone.com/blog/privilege-escalation-macos-malware-the-path-to-root-part-2/), the strength of the keychain’s encryption is entirely irrelevant.

Unsurprisingly, malware authors are known to target exfiltrating the keychain database. Recent exam...