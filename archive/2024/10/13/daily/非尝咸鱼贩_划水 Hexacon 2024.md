---
title: 划水 Hexacon 2024
url: https://mp.weixin.qq.com/s?__biz=Mzk0NDE3MTkzNQ==&mid=2247485446&idx=1&sn=b2a6f667627fa798c61756b794ba21de&chksm=c329f6f6f45e7fe09cbf6ac089f65c8193a72f90750c863a819e779ff7f945f6370c612d4f3c&scene=58&subscene=0#rd
source: 非尝咸鱼贩
date: 2024-10-13
fetch_date: 2025-10-06T18:51:38.007033
---

# 划水 Hexacon 2024

![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/6N4b2yN3FOLodjDSlzErryalcuu02ZZfB5Y7RoreucnQKvBA6CiaWoAE8wfyiaaBrHqxsicwWjZcfS69weIdQS8LQ/0?wx_fmt=jpeg)

# 划水 Hexacon 2024

原创

0xcc

非尝咸鱼贩

又到了会棍博主流水账的时间。

去年[简单介绍了一下法国的安全会议 Hexacon](http://mp.weixin.qq.com/s?__biz=Mzk0NDE3MTkzNQ==&mid=2247485160&idx=1&sn=08ec3be21110b5062039cf4b1786fbac&chksm=c329f818f45e710e082918a7b5b458ef8f25a1109ec1d9edc417c55f492f8bb5e5ed55209175&scene=21#wechat_redirect)，似乎是国内最早宣传这个会议的博主？在现场还意外遇到了本号的读者，有点没回过神……

[![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/6N4b2yN3FOLodjDSlzErryalcuu02ZZfUkNFKicVRUzv56xh6zH8yuDnYncDcfrElgWhgoOBp18Y0FydvicEleFQ/640?wx_fmt=jpeg)](http://mp.weixin.qq.com/s?__biz=Mzk0NDE3MTkzNQ==&mid=2247485160&idx=1&sn=08ec3be21110b5062039cf4b1786fbac&chksm=c329f818f45e710e082918a7b5b458ef8f25a1109ec1d9edc417c55f492f8bb5e5ed55209175&scene=21#wechat_redirect)

场地和去年依旧保持熟悉的配方——蓬尼阿尔宫旧贸易中心。

会议前有一个插曲。一位培训讲师从阿布扎比机场转机，随身行李携带的 Android 设备和用于调试的线缆，在安检直接被扣了。理由是线太多。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/6N4b2yN3FOJTiciaVONp9icuPLJ8pv11TCbPYEeEWZ9pNDqmKqhT2KrgPvrF1BC44v1LCO30UpFQRO1JHXD4C6W2w/640?wx_fmt=png&from=appmsg)

不靠谱的推测，大体是跟中东不久前的事件有关系，机场安检加码了。

除了主场之外，现场还设置了“闪电议题”（Lightning Talk）环节，讲一一段五分钟内的内容。形式大概或多或少有参考 MOSEC 的 BaijiuCon？去年这个环节被安排在茶点附近一个小区域，估计是觉得效果不好，今年换回了和主题演讲一样的讲台。

另一个新颖的环节是“CTF 速通”（Speedrun）。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/6N4b2yN3FOJTiciaVONp9icuPLJ8pv11TCbxFOXQ9eia0w937rj78pLEUiasrRtJxZicttPZvcPgd3iabX7RAttzzRmtQ/640?wx_fmt=png&from=appmsg)

为防止不小心违反当地的隐私相关法律法规，人脸一律处理成法制节目。

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/6N4b2yN3FOJTiciaVONp9icuPLJ8pv11TCbCRgCibMEicjVicgBaS7d1ia7xDVvc8y1TLQMvo7BjDyD7Z12jJjnibO8xAA/640?wx_fmt=jpeg&from=appmsg)

只接受个人现场报名，题目难度不大，但是要求众目睽睽之下直播解题。在这里我想 at 一些大佬……

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/6N4b2yN3FOJTiciaVONp9icuPLJ8pv11TCb6Y6tMWF7HY7w6RXOgBTeUMck2UlMWuQLWb7XZWyWP0JCMFzKicU9QZw/640?wx_fmt=jpeg&from=appmsg)

水泄不通的现场不由得让我联想起上学时班上有人用投影直播打红警的场面。比赛大概从晚饭后持续到将近午夜，冠军抱走了一台游戏机。酸葡萄的我听说这款主机要过时了，道德与法治 6 都带不动。

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/6N4b2yN3FOJTiciaVONp9icuPLJ8pv11TCbtGslMPWHIOdMEC8XLf23wqhvQOPzcVRDmOXAZ3Y16JmKMYpmYYTyYw/640?wx_fmt=jpeg&from=appmsg)

目前议题材料放出来的不多，洗稿一下充字数。

先来填一下[上一篇 0x41con](http://mp.weixin.qq.com/s?__biz=Mzk0NDE3MTkzNQ==&mid=2247485433&idx=1&sn=85181506463300a071af13a53df6f169&chksm=c329f909f45e701f45aba24bd9ef2eb6cdcad2d9b8bf3f608d2cdbaea1ce850033fb16be271d&scene=21#wechat_redirect) 的坑。上一篇推文提到一个关于 frida 在非越狱 iOS 下的官方使用教程会公开会议材料，但直到现在也没发。下个月在巴塞罗那有 radare2 的会议，这个议题会再讲一次，所以应该是等这个讲完之后再放啦。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/6N4b2yN3FOJTiciaVONp9icuPLJ8pv11TCb3TicAQ4zRBRo8wA5frCjOD0P3sFWmMzmPKwNBUOSHYNvIC6Jy6xLElQ/640?wx_fmt=png&from=appmsg)

https://rada.re/con/2024/

倒是 headless IDA Pro 在 9.0 已经有了官方的实现，而且 beta 版都泄漏得满天飞了。题外话，新版 IDA 调整了订阅和定价方案，招致老用户骂声一片。

---

**Pwning Blockchain for Fun and Profit: Exploiting an RCE Vulnerability in the Solana validator**

https://github.com/th3anatomist/Publications/blob/main/2024\_Hexacon\_pwning\_blockchain\_for\_fun\_and\_profit.pdf

（表示看不懂）

---

**Proxying to Kernel : Streaming vulnerabilities from the Windows Kernel**

这一篇演讲来自 Angelboy 大佬，在 devcore 的官网上有繁体中文的博客分享，可以直接移步原文：

https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1/

https://devco.re/blog/2024/10/05/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part2/

博主对 Windows 没有什么研究，然后据说🍊神本人会看这个公众号，就不瞎解读贻（台）笑大方了。

有趣（唯一能看明白）的一点内容是 Windows 漏洞利用上的一个新思路。

作者发现 ntoskrnl.exe 用全局变量用来表示特定权限对应的标志位的下标索引，例如 SeDebugPrivilege 对应的全局变量值是 0x14，在 OpenProcess 检查是否具有对应权限时就会比对第 0x14 个 bit。而这个索引值只会随系统初始化一次（应该是个 static 变量？），保存在可写的内存。

议题的漏洞实现的原语是（有条件的）任意内存地址自增。只要把这个变量自增魔改成 0x17，对应 SeChangeNotifyPrivilege，就相当于把调试特权送给了大部分具有这个普通特权的进程——不单 exploit，大家好才是真的好。

---

**Exploiting File Writes in Hardened Environments - From HTTP Request to ROP Chain in Node.js**

这篇也有作者的博客释出。

https://www.sonarsource.com/blog/why-code-security-matters-even-in-hardened-environments/

议题针对一个有趣的场景，在 node.js 应用的上传应用中找到了任意路径写入的 bug（可控的 fs.writeFile），但环境的文件系统除了上传目录之外全部只读，如何获得代码执行权限？

nodejs 基于 libuv 实现事件循环，内部基于管道实现通信。通过文件写入的 bug，结合 Linux 下 procfs 的特性可以构造路径写入这个管道。libuv 会将其中的二进制数据读出，直接当作 uv\_\_signal\_msg\_t 结构体处理。

```
typedef struct {  uv_signal_t* handle;  int signum;} uv__signal_msg_t;
struct uv_signal_s {  UV_HANDLE_FIELDS  uv_signal_cb signal_cb;  int signum;  // [...]
```

uv\_signal\_cb 是一个函数回调指针，那么读者到这就应该明白发生了什么事了。只要构造好结构，就能通过写入管道来控制程序执行流。作者发现这个版本的 nodejs 为了性能没有开启随机化，省去了信息泄露的步骤，一步到位进入 ROP 环节。

此前 h1 上有另一个研究员将这个思路报告给 nodejs，可以绕过 nodejs 的进程内“沙盒”特性（https://nodejs.org/api/permissions.html）。不过官方认为这不算安全边界。

https://hackerone.com/reports/2260337

议题的剩余部分还解决了如何构造符合 UTF8 编码要求的 ROP 链等问题。

这个场景通过脚本运行时的底层机制把一个受限制的 Web 安全漏洞利用了起来，相当有意思。

然后不知怎的一写 js 的内容就会联想起一位先哲的话，本公众号唯一珍藏表情包

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/6N4b2yN3FOIKXPfswFsPuticck1Pd79TJSPw7e7uibibxTzLmS0UiaVBMrNx9a3ibM2VPH4gyubudibFgibTrUZRUkYkw/640?wx_fmt=jpeg)

---

最后是彩蛋。

今年日冕物质喷射现象非常活跃，五月一场极光大爆发让人印象深刻，正好发生在 OffensiveCon 第一天晚上。在 Hexacon 前几天又开始有可能的极光预报，让我一度怀疑是不是混进了神仙，怎么一开会就闹极光。

其实今年中纬度地区观测到极光已经好几次了。

会议结束几天后，今年排名第二的大爆发虽然迟到，但没有缺席。昨晚屁颠屁颠跑去郊区追到了。

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/6N4b2yN3FOJTiciaVONp9icuPLJ8pv11TCbpre2rQOPgX0pLp61osub6ZGZ8MyDibk1C9fN4NF6hmZ3NVia3AR85jAw/640?wx_fmt=jpeg)

甚至半夜失眠起来看窗外，夸张到可以直接家盖着被子肉眼看。

预览时标签不可点

个人观点，仅供参考

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/sz_mmbiz_png/6N4b2yN3FOJePjhDUn7xMMlhZWpLjDwu3WUia32nGS0LiaB64WpyniauGgN9ibRaG1okaRpxswTPwaEgqTlic3aRJrQ/0?wx_fmt=png)

非尝咸鱼贩

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/sz_mmbiz_png/6N4b2yN3FOJePjhDUn7xMMlhZWpLjDwu3WUia32nGS0LiaB64WpyniauGgN9ibRaG1okaRpxswTPwaEgqTlic3aRJrQ/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过