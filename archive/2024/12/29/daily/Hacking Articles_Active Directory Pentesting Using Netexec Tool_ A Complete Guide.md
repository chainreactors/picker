---
title: Active Directory Pentesting Using Netexec Tool: A Complete Guide
url: https://www.hackingarticles.in/active-directory-pentesting-using-netexec-tool-a-complete-guide/
source: Hacking Articles
date: 2024-12-29
fetch_date: 2025-10-06T19:33:24.451955
---

# Active Directory Pentesting Using Netexec Tool: A Complete Guide

[Skip to content](#content)

Hacking Articles

## Recent Posts

* [AWS: IAM CreateLoginProfile Abuse](https://www.hackingarticles.in/aws-iam-createloginprofile-abuse/)
* [Privacy Protection: Encrypted DNS](https://www.hackingarticles.in/privacy-protection-encrypted-dns/)
* [Privacy Protection: Windows Privacy](https://www.hackingarticles.in/privacy-protection-windows-privacy/)
* [Privacy Protection: Browsers](https://www.hackingarticles.in/privacy-protection-browsers/)
* [Privacy Protection: Password Manager](https://www.hackingarticles.in/privacy-protection-password-manager/)

## Most Used Categories

* [CTF Challenges](https://www.hackingarticles.in/category/ctf-challenges/) (504)
  + [VulnHub](https://www.hackingarticles.in/category/ctf-challenges/vulnhub/) (311)
  + [HackTheBox](https://www.hackingarticles.in/category/ctf-challenges/hackthebox/) (164)
* [Penetration Testing](https://www.hackingarticles.in/category/penetration-testing/) (408)
* [Red Teaming](https://www.hackingarticles.in/category/red-teaming/) (126)
* [Website Hacking](https://www.hackingarticles.in/category/website-hacking/) (64)
* [Cyber Forensics](https://www.hackingarticles.in/category/cyber-forensics-tricks/) (68)
* [Privilege Escalation](https://www.hackingarticles.in/category/privilege-escalation/) (59)
* [Hacking Tools](https://www.hackingarticles.in/category/collection-of-hacking-tools/) (33)
* [Pentest Lab Setup](https://www.hackingarticles.in/category/pentest-lab-setup/) (29)

# [Hacking Articles](https://www.hackingarticles.in/)

Raj Chandel’s Blog

Search for:

Menu

* [Courses We Offer](https://www.hackingarticles.in/courses-we-offer/)
* [CTF Challenges](https://www.hackingarticles.in/ctf-challenges-walkthrough/)
* [Penetration Testing](https://www.hackingarticles.in/penetration-testing/)
* [Web Penetration Testing](https://www.hackingarticles.in/web-penetration-testing/)
* [Red Teaming](https://www.hackingarticles.in/red-teaming/)
* [Donate us](https://www.hackingarticles.in/donate-us/)

* [Home](https://www.hackingarticles.in/)
»* [Red Teaming](https://www.hackingarticles.in/category/red-teaming/)
»* [Active Directory Pentesting Using Netexec Tool](https://www.hackingarticles.in/active-directory-pentesting-using-netexec-tool-a-complete-guide/)
»

[Red Teaming](https://www.hackingarticles.in/category/red-teaming/)

# Active Directory Pentesting Using Netexec Tool

[December 28, 2024June 24, 2025](https://www.hackingarticles.in/active-directory-pentesting-using-netexec-tool-a-complete-guide/) by [Raj](https://www.hackingarticles.in/author/raj/)

Active Directory (AD) penetration testing is an essential part of the security assessment of enterprise networks. Moreover, the Netexec tool offers a wide range of capabilities for AD enumeration, credential validation, Kerberos attacks, and privilege escalation. This guide provides a detailed overview of the Netexec tool’s purpose, usage, and how to map its commands to the MITRE ATT&CK framework for Active Directory pentesting.

This article focuses on **Active Directory Pentesting Using Netexec**, a powerful toolset for **enumeration**, **credential testing**, and **exploitation** in **AD environments**.

### Table of Contents

* **Introduction to Active Directory Pentesting**
* **Overview of the Netexec Tool**
* **Test if an Account Exists without Kerberos**
* **Testing Credentials**
* **Enumerating Users**
* **LDAP Queries for Specific Users**
* **ASREPRoasting**
* **Find Domain SID**
* **Admin Count Enumeration**
* **Kerberoasting**
* **BloodHound Ingestor**
* **User Description Enumeration**
* **WhoAmI Command**
* **Enumerating Group Membership**
* **Group Members Enumeration**
* **Machine Account Quota**
* **Get User Descriptions**
* **LAPS Enumeration**
* **Extracting Subnet Information**
* **DACL Reading**
* **Get User Passwords**
* **Get Unix User Password**
* **Password Settings Objects (PSO)**
* **Trusts Enumeration**
* **Identifying Pre-Created Computer Accounts**
* **Active Directory Certificate Services (ADCS)**
* **Conclusion**

**Note\***: The command was fetched from the ChatGPT unfortunately it missed some key which was not expected, please feel free to connect us if you do have any suggestions.

### Introduction to Active Directory Pentesting

**Active Directory (AD)** serves as the backbone for **authentication** and **authorization** in many organizations. Therefore, **penetration testing AD** is crucial for identifying **vulnerabilities** that could be exploited by attackers. **Netexec** is a **versatile tool** used for **AD enumeration** and **exploitation**. This tool assists **pentesters** in retrieving **valuable information**, testing **credentials**, and identifying **weaknesses** within an **AD environment**.

### Overview of the Netexec Tool

In this post, we will use **Netexec** for **Active Directory pentesting**, **enumeration**, and **exploitation** via **LDAP**. Specifically, it allows **pentesters** to test the existence of **accounts**, authenticate using **hashes**, enumerate **users** and **groups**, and even exploit certain **vulnerabilities** in **AD services**. The tool operates via simple **command-line syntax** and provides a variety of options to **customize the attack** or **enumeration process**.

The basic syntax for **Netexec** is:

nxc ldap <target> -u <username> -p <password> <options>

Where:

* <target>: The IP address or hostname of the LDAP server.
* <username>: The username for authentication.
* <password>: The password (or NTLM hash) for authentication.
* <options>: Specific attack or enumeration options to be performed.

### Test if an Account Exists without Kerberos

**Purpose**: This command is used to check whether an account exists within Active Directory without Kerberos protocol. When using the option -k or–use-kcache, you need to specify the same hostname (FQDN) as the one from the kerberos ticket

```
nxc ldap 192.168.1.48 -u "user.txt" -p '' -k
```

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgNNNwiICcOsj4aDlCXW9UA9lHsLKnsuIDyQSWVxK3ROflZw1luCD7lNHFbJtvAr3j2_ViYUWMHkEWF3wMckPaJcITORBsRPa29lJzmsxOSXIr4MvthV6AMYefiFN9u3gI1bbXUf9tu1nwPtuuNKWJ4ubLctviaMAyIDiO-F9QwmXVnkiXymF98pO1s7t1A/s16000/0.png)

**Explanation**:

* -u “user.txt”: List of usernames to check.
* -p ”: No password is supplied (since it’s only testing account existence).

**MITRE ATT&CK Mapping**:

**T1071** – Application Layer Protocol: LDAP (This is a reconnaissance activity using LDAP).

### Testing Credentials

**Purpose**: This command tests a user’s credentials to validate whether they are correct, either with a plaintext password or an NTLM hash.

**Using username and password**:

```
nxc ldap 192.168.1.48 -u raj -p Password@1
```

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiyPTNloJ7_4WnoXsT_j2iT8nUIfdx3yiF_NWJwwsmKnmI3E9qmbOg6ZeRUgnAXHG_LuvZ6uNZ8LsEvnkAHbS5fxeSJZRzfub5Kpj8nz72jHxNj0yrQwTgK0sWfre8xDFTDNyU6Svkn6_QGHctQEy_SoSd0Kl0u6nhwsjcdsQCbug00cnmGiDDdbSyCQkKh/s16000/1.png)

**Using NTLM hash**:

```
nxc ldap 192.168.1.48 -u raj -H 64FBAE31CC352FC26AF97CBDEF151E03
```

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRPu8pyvDOdWHt3WW0JHfVjK6tD4BMRS7Y5O5WBintPNsR-PsLyQQymPSba8i7cpqcRnhox-I5fDQ6eo4W0-YqdtgRGgaGHpYs2HpBIkjBGL-G1eVuq5TPzqzgRo_w-BAI6mDfBv8kwif3WDcGiaCiwbmeQJxjoIoSGLNpB1muvjlnExe2hheRChn8wQBj/s16000/2.png)

**Explanation**:

* -u raj -p Password@1: Tests the raj user with the given password.
* -H <hash>: Uses an NTLM hash instead of a plaintext password.

**MITRE ATT&CK Mapping**:

**T1110** – Brute Force (Credential testing using hashes).

### Enumerating Users

**Purpose**: To retrieve all user accounts in the Active Directory domain. This is a key reconnaissance step to identify potential targets for further attacks.

**All users**:

```
nxc ldap 192.168.1.48 -u raj -p Password@1 –users
```

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhPTRqRWx06WIvW0xSxjU5htUp1Mabc-uaFomiERUwra57t1x_EVSwgP95mdNBboJxePr...