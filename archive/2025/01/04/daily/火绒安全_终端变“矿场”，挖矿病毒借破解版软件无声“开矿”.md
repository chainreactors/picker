---
title: 终端变“矿场”，挖矿病毒借破解版软件无声“开矿”
url: https://mp.weixin.qq.com/s?__biz=MzI3NjYzMDM1Mg==&mid=2247521420&idx=1&sn=42c9999b8f605d1c8708c4291f1c8eb9&chksm=eb704ab3dc07c3a58e1be9fb38da299b5182df850dd7c20a7567c3e843db9cd78dfb364d37be&scene=58&subscene=0#rd
source: 火绒安全
date: 2025-01-04
fetch_date: 2025-10-06T20:11:36.435694
---

# 终端变“矿场”，挖矿病毒借破解版软件无声“开矿”

![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9j4a7y1FRKLic6KLFZgpxVolg5nSiabmNHAD9NMNrxmwc8vzwGJQvOUuA/0?wx_fmt=jpeg)

# 终端变“矿场”，挖矿病毒借破解版软件无声“开矿”

原创

火绒安全

火绒安全

# ![](https://mmbiz.qpic.cn/sz_mmbiz_gif/0icdicRft8tz4nrnOI1emtFr0UYnrLKytAvy2gia6ZuIUJs14h2pEIwpiaWPCTTuCQIDibx9dlfXoyrNyVEWb8DVUUA/640?wx_fmt=gif&from=appmsg)

随着互联网的发展，各类软件的功能日益强大，市面上出现了越来越多的付费软件或提供高级功能的订阅服务。为了进行教育与学习、或是节省成本以获取软件的高级功能，寻求并使用未经官方授权的破解软件或许已经成为一种常见现象。虽然破解版软件可以暂时满足使用的需求，但同时也可能会带来病毒感染等风险，轻则影响计算机性能、重则威胁自身信息安全和财产安全。

近期，火绒威胁情报中心监测到 XMRig 挖矿病毒正在通过破解软件进行传播，该破解软件下载链接由 CSDN 用户在其发布的文章中提供。破解软件中的脚本可以进行创建计划任务、检查 CPU 数量与修改挖矿线程数等操作，最终执行 XMRig 挖矿病毒进行挖矿。**目前，火绒安全产品可对上述病毒进行拦截查杀。同时，我们希望广大用户能够提高警惕，不要轻易下载和运行来源不明的文件，不要轻信部分软件分享内容中提供的关闭杀毒软件等建议，并通过官方正规渠道下载使用正版软件，以防企业或个人信息泄露以及避免财产损失。**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9X6swnQEJu2CDVvyoVN4j87ibQYSGA4bj8icBwEicgXpO1ldhiaIDCSTbZQ/640?wx_fmt=png&from=appmsg)

查杀图

该样本执行流程图如下所示：

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9T7jwdzcicdnHMnjEm3fdaAN8peZmibSpLG3G7Fg82V3dMNBHBMgKt9jA/640?wx_fmt=png&from=appmsg)

流程图

火绒工程师对样本的分析过程中，发现 CSDN 用户在其发布的文章中不仅提供了该破解软件的下载链接，还添加了“部分杀软会因该版本软件未购买签名证书而阻止运行，可通过将软件目录加入排除项或者信任区来解决。”的“友情提醒”，诱导用户将此破解版软件添加信任。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9HWibFAqxByB3GCYu6iaq6qccTqcCAkbRncujUxNYl7d4MGqef8vgttpQ/640?wx_fmt=png&from=appmsg)

破解软件下载文章

此外，该用户还发布了其他类似的破解软件分享文章，其中的软件都含有挖矿病毒。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9aAytZpKS2aaAniaQAr2tQgLusx6gxMr67Z1ianXl6tvCDSQzQZEic3wLg/640?wx_fmt=png&from=appmsg)

其他文章

调查后发现，发布分享此类含有挖矿病毒的破解版软件文章的用户并非个例。截至目前，已发现以下用户均发布了相关内容：

* https://blog.csdn.net/SM2268XT2?type=blog # 名称为已注销
* https://blog.csdn.net/Seika3092?type=blog
* https://blog.csdn.net/baobao\_\_36?type=blog
* https://blog.csdn.net/smartyguy80?type=blog
* https://blog.csdn.net/2404\_87139007?type=blog
* https://blog.csdn.net/2404\_87213641?type=blog
* https://blog.csdn.net/YS9085N?type=blog
* https://blog.csdn.net/2403\_87087630?type=blog
* https://blog.csdn.net/RTS5766DL?type=blog
* https://blog.csdn.net/2404\_87210054?type=blog
* https://blog.csdn.net/2400\_87157272?type=blog
* https://blog.csdn.net/SM2263XT?type=blog
* https://blog.csdn.net/yhnmj678?type=blog
* https://blog.csdn.net/2201\_75554009?type=blog
* https://blog.csdn.net/2401\_85381299?type=blog
* https://blog.csdn.net/2304\_76306332?type=blog
* https://blog.csdn.net/randkmr?type=blog

其中，最新发布的文章日期是 2024 年 12 月 27 日。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9KdCKJ8iaMQmBjnAWjUzyeE0MZWeFrve3r6JTWSFZXJS7NMBHcWCYw6w/640?wx_fmt=png&from=appmsg)

最新发布文章日期

最终经过实际下载查看后，发现破解软件中携带的挖矿病毒均指向同一矿池 104.168.101.23。

**一**

**样本分析**

start\_everEdit.bat 文件头添加了 FF FE，使得文件按照 UTF-16 LE 格式打开，从而导致文件内容显示为乱码。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9FIh1FgUlOibNcEnQDp5MCicPvBTeoKk2Ks20yfRHEySwkeEiaLhaH1MoQ/640?wx_fmt=png&from=appmsg)

脚本文件头

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9WR29fpsdPicRulqIiays4LfJJSOqFOvVdTJFSlfTekoyB6FzicvZMrZDA/640?wx_fmt=png&from=appmsg)

bat 文件乱码

**脚本功能：**

1. 使用管理员模式重新打开该脚本。
2. 通过修改注册表键值以实现禁用用户账户控制（UAC）的目的。其具体操作是将 ConsentPromptBehaviorAdmin、EnableLUA 和 PromptOnSecureDesktop 设置为 0。
3. 使用 attrib +s +h 命令将 EverEdit.exe 的文件属性设置为系统和隐藏属性。
4. 执行 add.ps1 脚本，执行的命令为 Add-MpPreference -ExclusionPath ($pwd).Path。其功能是将当前目录添加到 Windows Defender 的白名单中。
5. 通过遍历目录并统计文件数量的方式验证文件完整性：若文件总数为 5，则正常执行 EverEdit.exe；若文件数量异常，则提示用户检查杀毒软件隔离区并恢复文件，或关闭杀毒软件后重新解压运行程序。
6. 利用 wmic 获取 CPU 核心数，并将 CrashReporting.bat 中挖矿程序的线程数修改为 CPU 核心数 / 2，以降低其 CPU 占用率。
7. 创建计划任务，在用户登录时延迟 5 分钟运行批处理文件 CrashReporting.bat 。
8. 执行 CrashReporting.bat 文件。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9qZZafVDZ6ft3rLxwib3LyrGRqwtKoH5ibFHibEE0kfryoYqibYzxWd1U1A/640?wx_fmt=png&from=appmsg)

start\_everEdit.bat

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9Sdp24t37BQDR7kuiaXAjO9feq6icRWUQ6eW8DGh6qpia6sYgGRpkg0a2g/640?wx_fmt=png&from=appmsg)

使用户添加信任区或关闭杀软

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9FnJoMiaBSCQCicpgAqwf8tBSL8V4MWwg4I2KgcPibbLP0iaMYiadn1drLNw/640?wx_fmt=png&from=appmsg)

计划任务

该脚本在执行 CrashReporting.bat 文件的过程中，会运行 XMRig 挖矿程序 EverEdit\_license.exe 。该挖矿程序指向的矿池 IP 为 104.168.101.23， -B 表示后台执行， -t 表示线程数。其中，线程数 -t 会按照 CPU 核心数的情况作出相应修改，如果 CPU 核心数为 2，线程数就会被设置为 1。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic97P4Ln2XVUsnmicibhKRDVpsuv9H7e2iby99ibWlF8RQu78xnOW0HkSC5YQ/640?wx_fmt=png&from=appmsg)

CrashReporting.bat

在实际运行该病毒后发现无法连接到矿池。通过进行多地 ping 测试，发现黑龙江和北京地区连接矿池时出现超时现象。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9KGohGxELtZyrNcCQsSxIjBoibWU1ic3DYV3uEQGCniaTvE8OYsbGStQtA/640?wx_fmt=png&from=appmsg)

ping 图

更换地区后则可以正常运行，且此时 CPU 占用率会提高。

下图为去掉 -B 参数后显示的内容。从其中 new job 一行的日志中可以看到，病毒运行所采用的算法是 algo rx/0 ，该算法在 xmrig 文档中记录为门罗币，由此可以推断该私人矿池正在挖取门罗币。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9EibaqFzibiazfE7DMQlVXNV7TrMicQxJ5hg9wLSliaqnOvKAYmt2TibnLsicA/640?wx_fmt=png&from=appmsg)

挖矿病毒运行图

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic97nYKa0uW2vpwZyBInL2p0ibkywVkHLvjLfxkfrkHGsHBAWFoWiapcvdw/640?wx_fmt=png&from=appmsg)

门罗币判断

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic99IkyI2RewcV0QPbic6644aIq8A8gp2KuDBbyTfSaCpN8nmvkbu6Yfzg/640?wx_fmt=png&from=appmsg)

CPU 占用率提高

其中， CPU 占用率提高的原因在于病毒在挖矿过程中需要不断调整随机值，计算区块头的哈希值，直至找到一个小于当前网络目标值的哈希值。这一行为会导致计算量增大，从而使得 CPU 占用率升高。

挖矿病毒可以通过多种途径侵入用户电脑。检测是否感染挖矿病毒的常见方法是查看 CPU 的占用率，如果 CPU 占用率一直处于比较高的状态时，则需要怀疑是否中了病毒。

**二**

**附录**

**HASH：**

![](https://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz7k1gLFxmvXhrUbqLicnXUic9nP1UWxliaQgYgroC3HQbWM59Sdib7S9sYWiasIu9LWGKDhnr7gFWJlw9Q/640?wx_fmt=png&from=appmsg)

**讲点大白话**

有的小伙伴表示想来点更有趣的总结，看这篇文章，那么你可以参考如下说明。

有的小伙伴表示没有学过计算机知识，看不太懂这篇文章，你也可以参考这段大白话。

在数字宇宙深处，蛰伏着一些神秘矿工（挖矿病毒）。这些矿工十分狡猾，他们会偷偷潜伏在CSDN星球上部分居民分享的资源（破解版软件）中，暗暗等待猎物上钩。而资源的分享者往往会热心嘱咐说：“你可以信任并放心使用这些资源哦~”然而，一旦有受害者采掘并开始使用这些诱人的资源，这些矿工就会迅速入侵到计算机系统中。他们像邪恶的殖民者，把系统变成自己的矿场，还会利用计算机的能量，无情地挖掘并盗取其中的珍贵资源。等到受害者突然发现，或许自己计算机的能量与财富都已经被消耗殆尽了。

目前，火绒安全产品能够拦截查杀此类病毒。在这里也再次提醒广大用户，认准官方渠道，非官方渠道软件安全性无法保证，各平台下载需谨慎！同时，也希望大家能够擦亮双眼，不要轻信未经官方授权的破解版软件分享内容中所谓关闭杀软或加入信任区的“友情提示”~

预览时标签不可点

个人观点，仅供参考

修改于

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz5V9C96RXn1xV11tycAnWHXCicgKqfOS3JOw7jrIJckWH6Hg0bnXibjicPZs1ET2KwtvsRs41ZhCxh2A/0?wx_fmt=png)

火绒安全

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/sz_mmbiz_png/0icdicRft8tz5V9C96RXn1xV11tycAnWHXCicgKqfOS3JOw7jrIJckWH6Hg0bnXibjicPZs1ET2KwtvsRs41ZhCxh2A/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过