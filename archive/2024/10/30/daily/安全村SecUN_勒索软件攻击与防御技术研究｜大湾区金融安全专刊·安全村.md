---
title: 勒索软件攻击与防御技术研究｜大湾区金融安全专刊·安全村
url: https://mp.weixin.qq.com/s?__biz=MzkyODM5NzQwNQ==&mid=2247495981&idx=1&sn=1040ee7522c190d15b2a3a7470baea89&chksm=c21bd01ff56c5909ad0b4e88034916ee6c4a0143630367157302c856b9bfa2f56b9cf8457b22&scene=58&subscene=0#rd
source: 安全村SecUN
date: 2024-10-30
fetch_date: 2025-10-06T18:55:25.920093
---

# 勒索软件攻击与防御技术研究｜大湾区金融安全专刊·安全村

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/kvCk9Nm6FzQqKibetbah7VgGicyXXzcLbdfjhXocxAia0Rib8YDh09J8U3ibI2pC6IYEDaPPkOe3lduODfhoBiaB2RcQ/0?wx_fmt=jpeg)

# 勒索软件攻击与防御技术研究｜大湾区金融安全专刊·安全村

原创

陈小兵等

安全村SecUN

![](https://mmbiz.qpic.cn/mmbiz_png/kvCk9Nm6FzTQIVRupkBz6icX1VsHSXEobYH9Jm89tib2uBaToVnKGUAflWqfuZHuX0AbVic4bUMfM2oicy34D2Ibhw/640?wx_fmt=png&from=appmsg)

![](https://mmbiz.qpic.cn/mmbiz_png/kvCk9Nm6FzR3pCia87mnhcVuHoC7OfG528GK23BaA6r7rM2FeXPl1FNfZjmrWCMibCaibJ7RMCctIcvfiaa9o5ibW1Q/640?wx_fmt=png&from=appmsg)

**摘要：**勒索软件攻击危害巨大，轻者数据丢失，重者需要支付数万甚至上千万的高额赎金。本文系统研究勒索软件攻击类型与特征、工作原理、加解密机制等内容。总结当前防御的有效手段，如备份、更新、端点防护、隔离、教育与应急响应等；并展望未来趋势，关注安全保险、加密货币追踪、AI行为分析在风险转移、打击支付、实时防御等方面的应用潜力。总之，论文全方位剖析勒索病毒，揭示其复杂危害与攻击策略，提出综合防御体系与未来发展方向，为有效应对这一网络安全威胁提供理论指导与实践参考。

**关键词：**勒索软件；加密与解密；安全防御

**1.引言**

#

勒索软件（Ransomware），也有称为勒索病毒，是指一种恶意软件，其目的是通过加密受害者的文件或封锁其系统访问权限，然后向受害者勒索赎金以解密文件或恢复系统功能。由于勒索软件一般采用强加密手段加密用户数据（部分勒索软件存在漏洞或者密钥泄漏可以直接解密），几乎是不可逆转的，由此给用户和企业带来了极大的隐私和安全威胁，新的勒索病毒除了勒索金钱外，有的还泄露及出售数据，带来更大的安全隐患。

勒索病毒的发展可追溯到上世纪80年代末和90年代初的计算机病毒时代。然而，随着数字货币的兴起，特别是比特币等匿名性较高的加密货币，勒索病毒攻击在近年来变得更加普遍和有利可图。攻击者通常使用钓鱼邮件、恶意网站、可利用的安全漏洞和网络渗透等手段传播勒索病毒。

一旦系统被感染，勒索病毒会立即开始加密文件，并在屏幕上显示勒索信息，通常要求受害者支付特定金额的比特币或其他加密货币以解密文件。付款后，攻击者可能提供解密密钥或工具，但并不保证一定能够成功解密文件。同时，即使受害者支付了赎金，攻击者也可能继续盗取、滥用或销售受害者的敏感数据。

勒索病毒攻击是一个极其重要的问题，因为它对个人用户和组织都造成了严重的影响。个人用户可能失去他们的个人文件、照片和其他重要数据，而企业和组织可能面临生产中断、数据泄露、财务损失和声誉受损等问题。此外，勒索病毒攻击不仅对受害者本身造成损失，还会对整个网络生态和信息安全产生负面影响，破坏信任、导致数据泄露和个人隐私泄露，甚至可能引发更严重的安全事件。

勒索软件穷尽目前可以利用的漏洞进行攻击，攻击成功后开展勒索，要么支付赎金解锁系统，要么就接受损失，重做系统。2017年的WannaCry对我国很多个人和企事业单位造成巨大的损失，后续勒索软件对我国的攻击越来越频繁，鉴于此场景，笔者对勒索软件开展研究，了解其加密的方法和攻击的途径等，研究防御勒索攻击的技术和解决方案。

**2.勒索病毒攻击的类型和工作原理**

#

##

## **2.1分类与特征**

勒索病毒主要分为以下四大类型：

**1.文件加密类勒索病毒**

此类病毒会在进入用户系统以后，搜索系统中的文件，包括文档、图片、视频等，然后勒索受害者支付赎金以获取解密密钥。加密通常使用强加密算法，如RSA或AES。以此索要赎金，破解存在很大的难度，例如 WannaCry、CryptoLocker、Locky等。

**2.数据窃取类勒索病毒**

此类与文件加密类病毒类似，通常采用混合加密算法对用户数据进行加密，但攻击者会甄别和窃取用户重要数据，通过公开这些重要数据胁迫用户支付勒索赎金，如Conti勒索病毒已经攻击并感染政府、重点企业等300多家，窃取并公开大量数据。此方式即为双重勒索。

**3.系统加密类勒索病毒**

此类病毒通过各类加密算法对系统磁盘主引导记录、卷引导记录等进行加密，阻止用户进行磁盘访问，影响用户设备的正常启动和使用。

**4.屏幕类勒索病毒**

这类勒索病毒不会加密文件，而是锁定受害者的计算机屏幕，使其无法操作计算机。通常会显示虚假的警告信息，声称受害者涉嫌违法活动，并要求支付赎金以解锁屏幕，例如FBI Virus、Urausy、Police Central e-crime Unit Virus等。

**5.移动设备勒索病毒**

这类勒索病毒针对移动设备（如智能手机和平板电脑）进行攻击，通常通过安装恶意应用程序或访问感染的网站传播。一旦感染，它们会锁定设备或加密文件，并要求支付赎金。例如Android.Lockscreen、Koler、Double Locker等。

##

## **2.2工作原理**

勒索病毒感染系统并加密文件的过程可以分为以下几个步骤：

**1.传播途径**

勒索病毒使用各种传播途径，包括恶意电子邮件附件、捆绑在可疑软件中、通过漏洞利用攻击、恶意广告等。用户在点击恶意链接、下载可疑附件或访问感染的网站时，可能会启动勒索病毒的传播。

**2.渗透入侵**

一旦用户与恶意源互动，勒索病毒开始渗透目标系统。它可能利用操作系统或应用程序的安全漏洞，或者通过社会工程技术引诱用户执行恶意代码。

**3.权限提升**

勒索病毒通常需要获得系统管理员或高权限用户的权限才能在系统上运行和执行恶意操作。为了获取这些权限，它可能会利用已知的漏洞、弱密码或通过欺骗用户来获取管理员凭据。

**4.潜伏感染**

一旦勒索病毒成功渗透到目标系统中，它会尽可能地隐藏自己，以免被安全软件或用户察觉。它通常会修改系统设置、关闭防护软件、阻止安全更新等，以确保其持续存在。

**5.加密文件**

勒索病毒开始对系统中的文件进行加密操作。它使用强加密算法（如RSA或AES）将文件转换为不可读的格式，只有具有正确解密密钥的人才能还原文件。这样，用户将无法打开、编辑或使用被加密的文件。

**6.勒索信息**

加密完成后，勒索病毒会在受害者的屏幕上显示勒索信息，通常要求受害者支付赎金以获取解密密钥。该信息通常包括详细的支付说明、定时器或威胁删除文件等方式来增加压力。

需要注意的是，不同类型的勒索病毒在感染和加密文件的过程中可能会有所不同，但总体上它们都追求加密受害者的文件以达到勒索的目的。

##

## **2.3勒索病毒攻击方式**

**1.弱口令攻击**

弱口令攻击是指攻击者利用易于猜测、常见、已泄露或过于简单的密码，尝试登录系统、服务或账户，以获取未经授权的访问权限。这种攻击方式主要针对那些使用不安全口令的用户或设备，是网络攻击中一种常见且基础的手段。目前都有成熟工具对操作系统、数据库软件、框架等暴力破解，成功获取访问权限后，有的可以直接获取系统权限，有的需要通过权限提升来获取更高权限，然后种植感染勒索软件。

**2.利用各种漏洞攻击**

攻击者会组合利用各种已经存在的漏洞进行攻击，尤其是最新出现的一些远程代码执行漏洞。在针对服务器的勒索攻击中，漏洞利用已经成为最流行的一类勒索投放手段，一些大规模勒索事件，往往也是存在同一类漏洞的服务器被同时攻击造成。2023年11月8日，中国工商银行旗下的美国工商银行遭遇了勒索软件CitrixBleed漏洞（CVE-2023-4966）网络攻击。

**3.横向渗透**

横向渗透是指在网络安全攻击中，攻击者利用已经取得的访问权限，尝试在网络内部横向移动，并尝试获取更多的敏感信息或控制更多的系统。横向渗透通常发生在攻击者成功入侵了网络中的一个节点后，试图通过不断侵入其他系统或设备，扩大攻击范围和控制权。

**4.挂马与钓鱼攻击**

攻击者通过钓鱼邮件、社交媒体、恶意广告等渠道，发送含有恶意附件或链接的消息，诱使用户打开或点击。这些附件（如伪装成文档、PDF、压缩文件等）或链接在被用户交互后，会执行恶意代码，悄无声息地感染用户系统。挂马则是将恶意代码（通常为木马）植入正常运行的网页中，当用户访问时自动执行。挂马攻击常与其它手段结合，如与钓鱼邮件配合，诱导用户安装病毒文件。挂马手法包括对正常网站植入恶意代码或搭建专门的恶意网站引诱用户访问，两者常相互交织进行攻击。

**5.供应链攻击**

供应链攻击在最近几年的安全事件中频频发生，其隐蔽性较高、发现难度大、影响范围广、时间跨度长，经常被APT组织用来作为攻击手段。供应链攻击是一种高级威胁，攻击者会针对供应链中的软件、硬件或服务进行攻击，以此来感染最终目标或绕过传统的安全防护措施。这种攻击方式通常利用供应链的信任关系，通过篡改、替换或植入恶意代码到供应链产品中，从而影响到最终用户或组织。2024年3月在GitHub上发现有人通过发布CVE-2021-21980的POC进行投毒攻击【1，2】，本地编译后执行POC本地计算机会感染LockBit勒索病毒。

**6.破解软件与激活工具**

激活工具、破解软件、工具软件等，由于不是正版软件无法保证软件是否捆绑有木马病毒及勒索软件，出于免费，很多用户下载到本地后直接运行，导致被勒索攻击。这已经成为国内个人用户感染勒索软件的主要渠道之一。例如Magniber勒索软件通过伪装Windows10、Windows11升级包对普通用户发起勒索攻击。还有在GitHub代码种直接嵌入勒索软件，运行程序即可感染病毒。

**7.勒索软件即服务（RaaS）**

一些黑客团伙提供了类似服务的模式，允许技术能力有限的罪犯购买现成的勒索软件工具包进行分发，扩大了攻击面。勒索软件即服务（Ransomware as a Service，RaaS）是一种模式，其中黑客或犯罪团伙提供一个完整的勒索软件解决方案，让其他人（通常是不具备技术知识的人）可以租用或购买并使用来进行勒索攻击。

**8.水坑攻击（Watering Hole）**

黑客瞄准特定网站或论坛，将这些网站感染后，访问这些网站的用户在不知情的情况下加载了带有勒索软件的脚本或程序。

**9.USB驱动器传播**

USB驱动器传播是一种常见的恶意软件传播方式，攻击者利用USB闪存驱动器来传播病毒、木马或其他恶意软件。故意将U盘丢在显眼处，捡到U盘的人出于好奇，插入U盘即可感染病毒。另外也有基于U盘轮渡的病毒，通过U盘来进行病毒的传播及感染。

#

**3.勒索病毒加密与解密**

#

##

## **3.1勒索软件加密特点**

对仍在流行且具有一定代表性的勒索软件家族进行分析。统计了各家族的加密算法及相关信息。

![](https://mmbiz.qpic.cn/mmbiz_png/kvCk9Nm6FzR3pCia87mnhcVuHoC7OfG52WqOJYAg2KP34rbREMtaWo8WbkbbUbPjCF8JmdUfDPTYKYdRDAescnQ/640?wx_fmt=png&from=appmsg)

经汇总整理后发现，虽然各个勒索软件家族都有各自的发展方向——有些甚至互相排挤，但在一些基础技术方案上，各个家族都有“趋同”的特点：

（1）加密方案均使用对称加密算法与非对称加密算法相互结合的多级加密方案。

（2）初始密钥均采用内置非对称加密公钥的方法，来兼顾加密强度和解密的灵活性。

（3）均开始使用分片加密、头部数据加密等方法，以此来提升加密速度。

以上这些共性可以看出，勒索软件在长期对抗中，越来越趋向专业化与标准化，可预见在接下来通过技术方案破解勒索软件的难度将越来越大。

##

## **3.2勒索软件加密方式**

勒索软件的加密方式通常包括对称加密、非对称加密和混合加密，这些方式在勒索软件中都有可能被采用。加密趋势方面，随着技术的不断发展和攻击者的不断创新，勒索软件的加密方式也在不断演变和变化。加密趋势方面，随着加密技术的不断发展和加密算法的更新换代，勒索软件的加密方式也在不断演进。攻击者可能会尝试使用更高级的加密算法或者将多种加密方式组合使用，以增加加密的复杂度和安全性，使得受害者更难以解密文件而被迫支付赎金。

### **3.2.1基础加密**

基础加密是指以一种极其简单的运算方式来修改原始文件的数据，而没有特定数学算法参与，比较典型的方式比如异或运算、加法运算、减法运算或者结合起来使用，最初的勒索软件由于技术水平不成熟，加密算法技术未普及等诸多原因会使用这种运算符操作数据的方式修改文件的数据，解密这样的文件只需要进行运算符暴力枚举，文件数据碰撞或者逆向勒索软件运算时使用的密钥就能直接对数据内容进行还原。

### **3.2.2对称加密**

勒索软件随技术发展强化加密手段，初期依赖对称加密算法（AES、DES、3DES、RC4、Salsa20、TEA等），其特点为使用单一密钥完成加密与解密，虽加密快速，但密钥易泄漏且可能通过文件分析或逆向工程找回。部分攻击者选择将对称密钥远程发送至服务器并删除本地记录，此举虽提高解密难度，但也令服务器成为攻击目标，增加风险。

1.勒索软件中对称加密的应用

（1）勒索软件侵入受害者系统后，会生成一个随机的对称密钥（AES密钥为例）。

（2）使用该密钥通过AES加密算法对受害者的敏感文件进行加密，使得未经解密无法访问文件内容。

（3）加密完成后，通常会将密钥信息通过非对称加密的方式（如RSA）加密，并上传至攻击者服务器或者保存在本地加密文件中。

（4）然后向受害者展示勒索通知，要求支付赎金以换取解密密钥。

（5）受害者支付赎金后，攻击者提供私钥用于解密之前用RSA加密过的AES密钥。

（6）受害者使用解密后的AES密钥对文件进行解密恢复。

整个过程中，对称加密算法用于快速大量地加密用户文件，而非对称加密则用于保证对称密钥的安全传输。

###

### **3.2.3非对称加密**

非对称加密算法（公钥加密）不同于对称加密，需一对密钥：公钥公开用于加密，私钥保密仅作解密。攻击者利用公钥嵌入勒索软件加密文件，私钥紧握手中，导致无私钥即难以解密。尽管非对称加密较慢，勒索软件结合两者优势：快速使用对称算法加密文件，再用非对称算法加密对称密钥，实现安全与效率兼顾。RSA与ECC是非对称加密在勒索软件中的主流选择。勒索软件经常采用非对称加密技术来加密受害者的数据，以确保除非支付赎金得到解密密钥，否则数据无法解密。其中，RSA是最著名的非对称加密算法之一，被多种勒索软件所采用，例如CryptoLocker、WannaCry、NotPetya、REvil（Sodinokibi）和LockBit等。

非对称加密在勒索软件中的实现过程和原理大致如下：

（1）感染阶段

勒索软件首先入侵受害者的计算机系统。

（2）密钥生成

勒索软件会在受害者的设备上生成一个随机的对称密钥（如AES密钥），这个密钥用于快速高效地加密受害者的文件。

（3）文件加密

使用上述对称密钥通过AES等对称加密算法加密受害者的重要文件，确保数据无法直接读取。

（4）非对称加密保护对称密钥

为了避免对称密钥在本地被找到和使用，勒索软件接着会使用非对称加密算法（如RSA）加密这个对称密钥。攻击者拥有非对称加密算法的一对密钥，其中公钥会被嵌入到勒索软件中，私钥则保留在攻击者手中。勒索软件使用公钥加密对称密钥后，将其存储在受害者的计算机上或是通过网络发送给攻击者。

（5）支付赎金与解密

受害者收到勒索通知，被告知要支付赎金以获取私钥。支付赎金后，攻击者提供私钥，受害者用这个私钥解密之前用RSA加密过的对称密钥。最后，受害者使用解密出来的对称密钥对被加密的文件进行解密。

这样，即便受害者获得了加密后的文件和加密对称密钥，但在没有攻击者的私钥的情况下，仍然无法解密原始文件。同时，由于非对称加密的特性，攻击者可以在不泄露私钥的情况下向多个受害者传播他们的公钥，实施大规模的勒索攻击。

###

### **3.2.4混合加密类**

混合加密通常是指结合了对称加密和非对称加密两种加密技术的方案，以便利用各自的优势：对称加密算法速度快，适合大量数据加密；而非对称加密算法提供了安全的密钥交换机制。

1.采用混合加密的勒索软件

在勒索软件领域，许多恶意软件也采用了混合加密策略来加密受害者的文件，例如CryptoLocker、WannaCry、NotPetya、REvil（Sodinokibi）、LockBit、Cerber、GandCrab、DarkSide等。

2.勒索软件实现混合加密过程

（1）勒索软件会在受害者的计算机上生成一个随机的对称密钥（如AES密钥）。

（2）使用这个对称密钥对受害者的所有敏感文件进行快速加密。

（3）勒索软件生成一个非对称密钥对（比如RSA密钥对）或者从其服务器获取公钥。

（4）使用公钥加密刚才生成的对称密钥，并将加密后的对称密钥保存在本地或上传至攻击者的服务器。

（5）向受害者显示勒索通知，声称只有通过攻击者提供的私钥才能解密那个对称密钥，进而解密所有被加密的文件。

通过这种方式，勒索软件既保证了数据加密的速度，又利用了非对称加密的强安全性，使得攻击者可以在保持私钥保密的前提下，迫使受害者付费获取解密密钥。

##

## **3.3勒索软件解密方式**

目前勒索病毒领域甚至兴起了一种RaaS模式（勒索即软件服务），与此同时也出现了多家安全企业专门研究并提供勒索软件解密服务。

### **3.3.1免费解密**

（1）解密工具

安全研究人员或组织可能会发布特定勒索软件变种的解密工具。这些工具可能会帮助您解密受感染的文件而无需支付赎金。

（2）解密密钥泄露：有时，攻击者可能会被抓获，或者他们的服务器可能被关闭，导致解密密钥的泄露。在这种情况下，安全研究人员可能会利用泄露的密钥来创建解密工具，帮助受害者解密文件。

（3）后门或漏洞：有时，勒索软件本身可能存在后门或漏洞，可以用来解密文件。安全专家可能会利用这些漏洞来帮助受害者解密文件。

国内一些杀毒软件或者安全公司都提供了勒索软件检索、勒索软件解密等在线服务，主要有：

* 腾讯：https://habo.qq.com/tool/index
* nomoreransom勒索软件解密工具集：https://www.nomoreransom.org/zh/index.html
* 瑞星解密工具：http://it.rising.com.cn/fanglesuo/index.html
* 卡巴斯基免...