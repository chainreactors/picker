---
title: Behind the Attack: Paradies Clipper Malware
url: https://buaq.net/go-148192.html
source: unSafe.sh - 不安全
date: 2023-02-07
fetch_date: 2025-10-04T05:50:03.737474
---

# Behind the Attack: Paradies Clipper Malware

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/faae7e77a9457450d524da01274c7970.jpg)

Behind the Attack: Paradies Clipper Malware

In this blog we cover a new underground Clipper malware that allows attacks t
*2023-2-6 19:23:43
Author: [perception-point.io(查看原文)](/jump-148192.htm)
阅读量:30
收藏*

---

In this blog we cover a new underground Clipper malware that allows attacks to replace a victim’s crypto wallet with their own.

![](https://perception-point.io/wp-content/uploads/post-img-lines-top.svg)

![](https://perception-point.io/wp-content/uploads/post-img-lines-bottom.svg)

Clipper malware is a type of malware that specifically targets cryptocurrency wallets. It replaces wallet addresses with the attacker’s own address, effectively diverting funds to the attacker. The danger of Clipper malware lies in its ability to intercept and manipulate sensitive information, such as wallet addresses, through various hooking techniques.

In this blog we review Paradies Clipper malware, which is uncommon in the wild due to its developer’s low popularity, but still interesting from a cyber research perspective.

## Threat Intel

Let’s start from the beginning, at the source of the malware: a sales thread in the [nulled.to](https://www.nulled.to/topic/1405777-paradiescc-1-crypto-clipper-on-nulled-unique-fud-control-panel-native-c-bulletproof-server/) forum. There, anyone can access the Clipper panel [site](http://paradies.cc/auth), register, and buy a subscription.

![](https://lh4.googleusercontent.com/5fXgfN6RZHDs-srROepRqtlRolElIj37AOpWx1eVPlGmzalBPjD-QE07Az6dFfYEQOdNgdLZiJbpADwhCHa1b6sB-W8LmuQjx4dzZqvVfT_ppQyYUgyCzJIngVVo-TrRdJPj1Ij6hIXnRdgF8PG-HMo)

Figure 1: The Clipper panel site

## Static Info

To determine the basics about this malware, we opened a sample in [DiE](https://github.com/horsicq/Detect-It-Easy), a malware analysis tool. From there, we could see that the sample was written in C/C++ and that it is a PE32 file.

![](https://lh4.googleusercontent.com/VRG4z2s14ROnngzEsMQxjCgJa32yjnWQOTuvqspX4Xp4oPWFGdbgjcS9va7CUmGJWkfhbl5ew_CLAbaWNxEnv4fXRUyqxxhaNUV1BtgUBiLZizmKTCTU7Je7CyRSp-otDGwSrNiS7FQnSYRYi-nY6HA)

Figure 2: Malware written in C/C++ as a PE32 file

Looking at the strings of the sample, we noticed that the developer hasn’t invested time in obfuscating the strings. This enabled us to find what could be the C2 (and the compilation path on the developer’s computer):

![](https://lh6.googleusercontent.com/Zq7Sb8lmndR1lX7a1kyqHBQUCJp5Rjw6f1HoCU6hpg8OCsoVkNPkk7mop8SuEw661I7rSQVmgF_2WDdsGy77uwUv_8boVSFjMDmhuAAfv6Vg9rnFdyPQbHx0Cgr9ti6y3BrD-vnOycFqWboALewCa3o)

Figure 3: Possible C2 and compilation path

We could also understand a lot by looking at the imports, no dynamic API resolution necessary:

![](https://lh4.googleusercontent.com/wKC3yp2n6nKjsr2ZUVPzi1IsEkvjZBHSp37S5nT5S0Pc2p1XvtCoizH_ZV61PTCK4PbBRMgkRwqv12H8G2xVhGtSmRDoa1O2gZzi4wd2CHOAUdit8mDbEjoqx_hHJKBxKL2Mpxh3kZNdn1ue9Srz6fA)

Figure 4: The imports

## Analysis

Opening up the malware binary in IDA, a disassembler tool, we found a long main function. The function first checks for a mutex handle with the value: **7CmLQX**. If it exists, the program will understand that it is already executed and will terminate itself.

![](https://lh6.googleusercontent.com/j9k7AvVeS87yLBkrtV_-y3C7G5wJtOGTK5ueKNq5Ih7uEg46pnl17TlUkCy2RbhNvssOLqMTlmqGTrMlzHFWat-L0ErK87zCZm_P4EclurngzQ4tHMPkcpyqgGgw8KO76peKw4PdLCyCrA47QaSYP0s)

Figure 5: Mutex handle function

## Persistence

The program then retrieves the path to the user’s **AppDataLocal** folder and combines it with the **persistence executable name**: **Update.exe**.

From there, the program compares the persistence path to the current path of the executable (it retrieves the path using **GetModuleFileNameA**). If the executable is not running from the persistence path (**C:\Users\user\AppData\Local\Update.exe**), it will skip the main functionality code and create persistence:

![](https://lh3.googleusercontent.com/ASuDqLRG-asaNnc9qkXaxXyGz7X7GPEXacldw_6H84LcVMK4v_zwndFC1gyF5S0LKHrRTLjEjMrf5PajIvmDAcnjqHu1OyQe6I07gBGbQKyopI3XYzOVmlAOCB4OBkW6O_LfVQjvGGWkUdvA3XEFQMI)Figure 6: Creating persistence

Figure 6: Creating persistence

The program creates a registry key with the name **Update** under the path **HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run** with the value pointing to the persistence path.

![](https://lh5.googleusercontent.com/LsOo8shNjA5oPwDgZ2kxp6cZanOevJshqd4PurxjHgRibA0PAzNHIibe3hAqbKFXGr9U5drsjtntBG1FIv3dZ9yyZjNsqqNNBQu2g-5PpK-3gtBGa96ve2mutjjO1WSt-feUcYnthmcB9YKPuIoCcXk)

![](https://lh6.googleusercontent.com/l3rm50gEg8fGeG_OW8ChCsxWoPMo4cIEEtEXrMMebPibvtsehlv2vPEecD3_jk076iBzxmCq7rbb81gCf7kmp0jsrfvHLAsfB7rmsnUzj2Ih6LzPEyEfRyJUdL1TOgmoVWH7HDw5KnkvopFV0wiBzuc)Figures 7 & 8: Creating a registry path

Figures 7 & 8: Creating a registry path

Next, the binary concatenates a CMD command and executes it. The command copies the executable to the desired persistence path, deletes the executable, and executes it again from the persistent path.

![](https://lh6.googleusercontent.com/JuB04DkceJOv0FPHdamF99whaGgCbDv0sE3FL1oK571tcKQenmOnBVrU8ZISmqSADxq2dvUbtlOWA3Pegsfb_MnMsav2uCuwG9k_WwfdmnMwLT_pDpXO1uXqQy-lepSSvBfNtkWfTEhi_zLs2LlcCJc)

Figure 9: Linking and executing the executable

The final concatenated command is as follows:

```

					start cmd /Q /C " ping localhost -n 1 && copy
"C:\Users\igal\Desktop\Paradies2.bin"
"C:\Users\igal\AppData\Local\Update.exe" && attrib +r +h +a
"C:\Users\igal\AppData\Local\Update.exe" && icacls
"C:\Users\igal\AppData\Local\Update.exe" /deny "everyone":(WD,AD,WEA,WA) && del
"C:\Users\igal\Desktop\Paradies2.bin" && cmd /C "start
"C:\Users\igal\AppData\Local\Update.exe" && exit" && && exit "

```

This command uses the **attrib** command with several flags:

* **+r**  – sets the file as read-only.
* **+h** – sets the file as hidden.
* **+a** – flags the file as available for archiving when using the BACKUP or XCOPY commands.

The command uses the **icacls** command with several flags:

* **/deny “everyone”** – denies specified user access rights.
* **WD** – write data/add file.
* **AD** – append data/add subdirectory.
* **WEA** – write extended attributes.
* **WA** – write attributes.

![](https://lh4.googleusercontent.com/tJ5IyUjsF-tcf5GkS249Li5H1_YvEF9VrIssD5GhrJEKSPi1lh-c-3BJpCIJqcGJ8yjwfCTvaY5pOusvy2sPDvHVVA9MtdEt-kn1trGJEu0cLewJm3rWHaQfFnUxDOaZCBLvylvSsVD1jczsDXK-2gg)

![](https://lh5.googleusercontent.com/LNFyDDaRsY3c159YxQORIUzgTEzpL2GJq5sQt6EYakvbBA7532pA9AT6nJsyM_zx_B9dRVEtTBALNVzx_Gu0yPSHq619xPOdwh9q-GrulLoYiVxVuk8UcLRvLytHsMi2BKrDZUT-xJAp3H0_6sZ07Vc)

Figures 10 & 11: Command features

Once the persistence is made and the binary restarts we can dive into the Clipper functionality.

## Main Functionality

The program starts off by creating the Mutex that the program initially tried to retrieve. The program then sleeps for a minute.

![](https://lh3.googleusercontent.com/qPNMhzvO9_k_r_MEpi-3d6Tff1k6j-UplKD96deNexH929CUFbTM104puTH44ZuewnkiJ9-Xm3oi8rO5IK0F6LGeOjJenJ-w098KFXQjTTMWa5Ag-hiPTesyLjpq-7zdBcfRQyljm9pxZQykCdJYi_I)

Figure 12: The program creates the Mutex and then sleeps

Before the Clipper begins the clipping function it creates the first connection to the Paradies server.

The first **POST** request that the Clipper makes contains the following fields:

* **username** – the computer username (by using the **GetUserNameA**).
* **ip** – the computer IP.
* **country** – the country associated with the computer IP.
* **city** – the city associated with the computer IP.
* **date** – the initial infection date (followed up with the format **DD-MM-YYYY**).
* **time** – the i...