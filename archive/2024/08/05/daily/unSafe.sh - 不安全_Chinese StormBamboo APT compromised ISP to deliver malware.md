---
title: Chinese StormBamboo APT compromised ISP to deliver malware
url: https://buaq.net/go-254199.html
source: unSafe.sh - 不安全
date: 2024-08-05
fetch_date: 2025-10-06T17:59:51.716614
---

# Chinese StormBamboo APT compromised ISP to deliver malware

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/ce8a27ff21acf381b70041ffcde6ef59.jpg)

Chinese StormBamboo APT compromised ISP to deliver malware

Chinese StormBamboo APT compromised ISP to deliver malwareA China-linked APT, tracked as Storm
*2024-8-4 23:55:27
Author: [securityaffairs.com(查看原文)](/jump-254199.htm)
阅读量:49
收藏*

---

## Chinese StormBamboo APT compromised ISP to deliver malware

![]()

## A China-linked APT, tracked as StormBamboo, compromised an internet service provider (ISP) to poison software update mechanisms with malware.

Volexity researchers reported that a China-linked APT group, tracked as StormBamboo (aka [Evasive Panda](https://securityaffairs.com/166102/apt/daggerfly-macma-macos-backdoor.html), [Daggerfly](https://securityaffairs.com/166102/apt/daggerfly-macma-macos-backdoor.html), and StormCloud), successfully compromised an undisclosed internet service provider (ISP) in order to poison DNS responses for target organizations.

The threat actors targeted insecure software update mechanisms to install malware on macOS and Windows victim machines.

In mid-2023, Volexity discovered multiple malware infections affecting macOS and Windows systems within victim organizations. The company linked the attacks to StormBamboo APT group. Upon investigating the incidents, the researchers determined that a DNS poisoning attack at the ISP level caused the infection. The attackers altered DNS responses for domains related to software updates to deploy multiple malware families, including [MACMA](https://securityaffairs.com/166102/apt/daggerfly-macma-macos-backdoor.html) and [POCOSTICK](https://securityaffairs.com/166102/apt/daggerfly-macma-macos-backdoor.html) (MGBot). The attacker’s methods resemble those of DriftingBamboo, suggesting a possible connection between the two threat actors.

Daggerfly has been active for at least a decade, the group is known for the use of the custom MgBot malware framework. In 2023, Symantec identified a Daggerfly intrusion at an African telecom operator, using new MgBot plugins. This highlights the group’s ongoing evolution in cyber espionage tactics.

The Macma macOS backdoor was [first detailed by Google in 2021](https://blog.google/threat-analysis-group/analyzing-watering-hole-campaign-using-macos-exploits/) and has been used since at least 2019. At the time of discovery, threat actors employed the malware in watering hole attacks involving compromised websites in Hong Kong. The watering hole attacks used exploits for iOS and macOS devices. Attackers exploited the privilege escalation vulnerability [CVE-2021-30869](https://securityaffairs.com/124513/malware/macos-zero-day-watering-hole-hong-kong.html) to install Macma on macOS devices.

Macma is a modular backdoor that supports multiple functionalities, including device fingerprinting, executing commands, screen capture, keylogging, audio capture, uploading and downloading files.

Although Macma was widely used in cyber operations carried out by nation-state actors, it was not linked to a particular group.

*“During one incident investigated by Volexity, it was discovered that StormBamboo poisoned DNS requests to deploy malware via an HTTP automatic update mechanism and poison responses for legitimate hostnames that were used as second-stage, command-and-control (C2) servers.” reads the [report](https://www.volexity.com/blog/2024/08/02/stormbamboo-compromises-isp-to-abuse-insecure-software-update-mechanisms/) published by Volexity. “The DNS records were poisoned to resolve to an attacker-controlled server in Hong Kong at IP address `103.96.130[.]107`. Initially, Volexity suspected the initial victim organization’s firewall may have been compromised. However, further investigation revealed the DNS poisoning was not performed within the target infrastructure, but further upstream at the ISP level.”*

Volexity promptly alerted the ISP, which then investigated key traffic-routing devices on their network. After rebooting and taking parts of the network offline, the DNS poisoning stopped. The researchers were not able to identify a specific compromised device, however updating or deactivating various infrastructure components effectively ended the malicious activity.

*“The logic behind the abuse of automatic updates is the same for all the applications: the legitimate application performs an HTTP request to retrieve a text-based file (the format varies) containing the latest application version and a link to the installer.” continues the report. “Since the attacker has control of the DNS responses for any given DNS name, they abuse this design, redirecting the HTTP request to a C2 server they control hosting a forged text file and a malicious installer. The AiTM workflow is shown below.”*

[![StormBamboo](https://i0.wp.com/securityaffairs.com/wp-content/uploads/2024/08/image-2.png?resize=1024%2C543&ssl=1)](https://i0.wp.com/securityaffairs.com/wp-content/uploads/2024/08/image-2.png?ssl=1)

StormBamboo targeted various software vendors with insecure update mechanisms, using complex methods to deploy malware. For example, they targeted 5KPlayer’s update process for the “youtube-dl” dependency to deliver a backdoored installer from their C2 servers. Once compromised systems, the attackers installed a malicious Google Chrome extension called ReloadText to steal browser cookies and email data.

*“The incident described in this blog post confirms the supposition made by ESET concerning the infection vector for the POCOSTICK malware. The attacker can intercept DNS requests and poison them with malicious IP addresses, and then use this technique to abuse automatic update mechanisms that use HTTP rather than HTTPS.” concludes the report. “This method is similar to the attack vector Volexity previously observed being used by DriftingBamboo following the [0-day exploitation of Sophos Firewalls](https://www.volexity.com/blog/2022/06/15/driftingcloud-zero-day-sophos-firewall-exploitation-and-an-insidious-breach/).”*

Follow me on Twitter: [**@securityaffairs**](https://twitter.com/securityaffairs) and [**Facebook**](https://www.facebook.com/sec.affairs) and [Mastodon](https://infosec.exchange/%40securityaffairs)

[**Pierluigi Paganini**](http://www.linkedin.com/pub/pierluigi-paganini/b/742/559)

**(**[**SecurityAffairs**](http://securityaffairs.co/wordpress/)**–** **hacking, malware)**

---

文章来源: https://securityaffairs.com/166552/apt/stormbamboo-compromised-isp-malware.html
 如有侵权请联系:admin#unsafe.sh

© [unSafe.sh - 不安全](https://unsafe.sh) Powered By [PaperCache](https://github.com/code-scan/PaperCache)

* admin#unsafe.sh
* [安全马克](https://aq.mk)
* [星际黑客](https://xj.hk)
* [T00ls](https://t00ls.net)