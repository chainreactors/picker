---
title: Hackers Exploited Krpano Framework Flaw to Inject Spam Ads on 350+ Websites
url: https://thehackernews.com/2025/02/hackers-exploited-krpano-framework-flaw.html
source: The Hacker News
date: 2025-02-27
fetch_date: 2025-10-06T21:55:28.821319
---

# Hackers Exploited Krpano Framework Flaw to Inject Spam Ads on 350+ Websites

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [Hackers Exploited Krpano Framework Flaw to Inject Spam Ads on 350+ Websites](https://thehackernews.com/2025/02/hackers-exploited-krpano-framework-flaw.html)

**Feb 26, 2025**Ravie LakshmananWebsite Security / Vulnerability

[![](data:image/png;base64...)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjrli4on3bnY-JlZOnd00-z4le2y6JZ1fRGH4kA8PoCbSbLKGHQAbUxrQ1bAZ23_VzSSn8qgc0L-SU1I36IW8IQNnCA84kTWMFoW_tPpeCZV-q2cXaC7b6_BR5oK7WoD-pDbqm4RzdFGvK25gWBjxyZN4ZEQZzLnNJINsF4z164FHwq8BHmUN55zIsDhZmE/s790-rw-e365/xss.png)

A cross-site scripting (XSS) vulnerability in a virtual tour framework has been weaponized by malicious actors to inject malicious scripts across hundreds of websites with the goal of manipulating search results and fueling a spam ads campaign at scale.

Security researcher Oleg Zaytsev, in a report shared with The Hacker News, said the campaign – dubbed **360XSS** – affected over 350 websites, including government portals, U.S. state government sites, American universities, major hotel chains, news outlets, car dealerships, and several Fortune 500 companies.

"This wasn't just a spam operation," the researcher [said](https://olegzay.com/360xss/). "It was an industrial-scale abuse of trusted domains."

All these websites have one thing in common: A popular framework called [Krpano](https://krpano.com/home/) that's used to embed 360° images and videos to facilitate interactive virtual tours and VR experiences.

Zaytsev said he stumbled upon the campaign after coming across a pornography-related ad listed on Google Search but with a domain associated with Yale University ("virtualtour.quantuminstitute.yale[.]edu").

[![DFIR Retainer Services](data:image/png;base64...)](https://thehackernews.uk/cloud-insight-d)

A notable aspect of these URLs is an XML parameter that's designed to redirect the site visitor to a second URL that belongs to another legitimate website, which is then used to execute a Base64-encoded payload via an XML document. The decoded payload, for its part, fetches the target URL (i.e., the ad) from yet another legitimate site.

The XML parameter passed in the original URL served in the search results is part of a broader configuration setting named "[passQueryParameters](https://krpano.com/docu/embedpano/#passQueryParameters)" that's [used](https://krpano.com/docu/embedpano/#embeddingparameters) when [embedding a Krpano panorama viewer](https://krpano.com/docu/embedpano/#embedpano) into an HTML page. It's specifically designed to pass HTTP parameters from the URL to the viewer.

The security issue here is that if the option is enabled, it opens the door to a scenario where an attacker could use a specially crafted URL to execute a malicious script in a victim's web browser when the vulnerable site is visited.

Indeed, a [reflected XSS flaw](https://thehackernews.com/2023/05/new-vulnerability-in-popular-wordpress.html) arising as a result of this behavior was disclosed in Krpano in late 2020 ([CVE-2020-24901](https://nvd.nist.gov/vuln/detail/CVE-2020-24901), CVSS score: 6.1), indicating that the [potential for abuse](https://packetstorm.news/files/id/159477) has been publicly known for over four years.

While an update introduced in version 1.20.10 restricted "passQueryParameters" to an allowlist in an attempt to prevent such XSS attacks from taking place, Zaytsev found that explicitly adding the XML parameter to the allowlist reintroduced the XSS risk.

[![](data:image/png;base64...)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTh3TvVmldQXa0Z0Vu-YZidxaicmydZadyJt26BrJZc4KHU2Vp9z32ONJaRSjfOIIYVvePefaretvN1WyFiv1pyc5hnP1dib7R9bGQ_c-8sjJKg_scPKSahbUwa64KbLxPxOk62Ioxr5bvL_bmZTgj7E5wN3rY9-RzR9I6tDo_PtYDCm8k7sZsQADDB5e0/s790-rw-e365/reflected.png)

"Since version 1.20.10, Krpano's default installation was not vulnerable," the researcher told The Hacker News via email. "However, configuring passQueryParameter in combination with the XML parameter allowed external XML configuration via the URL, leading to an XSS risk."

"The exploited versions I've come across were primarily older ones, predating version 1.20.10."

The campaign, per Zaytsev, has leveraged this weakness to hijack over 350 sites to serve sketchy ads related to pornography, diet supplements, online casinos, and fake news sites. What's more, some of these pages have been weaponized to boost YouTube video views.

The campaign is noteworthy, not least because it abuses the trust and credibility of legitimate domains to show up prominently in search results, a technique called [search engine optimization (SEO) poisoning](https://www.crowdstrike.com/en-us/cybersecurity-101/social-engineering/seo-poisoning/), which, in turn, is accomplished by abusing the XSS flaw.

"A reflected XSS is a fun vulnerability but on its own requires user interaction, and one of the biggest challenges is to make people click your reflected XSS link," Zaytsev said. "So using search engines as a distribution platform for your XSS is a very creative and cool way to do it."

[![CIS Build Kits](data:image/png;base64...)](https://thehackernews.uk/platform-shield-d)

Following responsible disclosure, the latest release of Krpano eliminates support for external configuration via the XML parameter, thereby mitigating the risk of XSS attacks even when the setting is used.

"Improved embedpano() passQueryParameters security: data-urls and external URLs are generally not allowed as parameter values anymore and URLs for the XML parameter are limited to be within the current folder structure," according to the [release notes](https://krpano.com/docu/releasenotes/?version=122#top) for version 1.22.4 released this week.

It's currently not known who is behind the massive operation, although the abuse of an XSS flaw to serve just redirects, as opposed to carrying out more nefarious attacks like credential or cookie theft, raises the possibility of an ad firm with questionable practices that's serving these ads as a monetization strategy.

Users of Krpano are advi...