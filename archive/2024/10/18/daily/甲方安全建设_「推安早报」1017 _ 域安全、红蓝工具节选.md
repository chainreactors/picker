---
title: 「推安早报」1017 | 域安全、红蓝工具节选
url: https://mp.weixin.qq.com/s?__biz=MzU0MDcyMTMxOQ==&mid=2247487735&idx=1&sn=afde6aaf1957c1e157a357d42480bf9e&chksm=fb35b93fcc42302970a3fd5309958409af011315932a2542adc9e1d488021b3cc40e89756d55&scene=58&subscene=0#rd
source: 甲方安全建设
date: 2024-10-18
fetch_date: 2025-10-06T18:56:07.545792
---

# 「推安早报」1017 | 域安全、红蓝工具节选

![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/icqm3vRUymZmq9olbYbLBTq8AYY0qtCp6A3xACHb6Ot8ccOzofLLbv87Q2F4egDBfOPJZPQmQ0WxEDtqYEsU1icQ/0?wx_fmt=jpeg)

# 「推安早报」1017 | 域安全、红蓝工具节选

red4blue

甲方安全建设

# 2024-10-17 「红蓝热点」每天快人一步

> 1. 推送`「新、热、赞」`，帮部分人`阅读提效`
> 2. 学有`精读浅读深读`，艺有`会熟精绝化`，觉知此事`重躬行`。推送只在`浅读预览`
> 3. 机读为主，人工辅助，每日数万网站，10w推特速读
> 4. 推送可能`大众或小众`，不代表本人偏好或认可
> 5. 因渲染和外链原因，公众号`甲方安全建设`发送`日报`或日期,如`20241017`获取`图文评论版pdf`

### 目录

> 0x01 【2024-1012】微软指南帮助缓解Kerberoasting攻击
> 0x02 【2024-1012】KeyCloak中的SAML签名验证漏洞分析
> 0x03 【2024-1012】利用.NET框架枚举和攻击活动目录环境
> 0x04 【2024-1014】针对MikroTik路由器的渗透测试研究
> 0x05 【2024-1014】Zendesk在多家财富500强公司中故意留下后门漏洞
> 0x06 【2024-1014】远程桌面协议（RDP）简易解释
> 0x07 【2024-1014】深入解析ViewState安全问题
> 0x08 【2024-1014】利用韩文字母填充字符执行隐形JavaScript
> 0x09 【2024-1015】简单脚本从reg.py/lookupsid复制并受itm4n的注册表会话枚举启发
> 0x0a 【2024-1016】DLL劫持：恶意代码代理的新视角
> 0x0b 【2024-1016】早期级联注入技术：从Windows进程创建到隐蔽注入
> 0x0c 【2024-1016】克隆克隆器：构建自定义RFID克隆设备
> 0x0d 【2024-1016】Ghost：利用Fiber线程绕过EDR检测的Shellcode加载器
> 0x0e 【2024-1017】绕过noexec限制执行任意二进制文件
> 0x0f 【2024-1017】通过API0cradle添加证书和GPO转储脚本
> 0x10 【2024-1017】微信MMTLS加密协议安全性分析

### 0x01 微软指南帮助缓解Kerberoasting攻击

> 微软提供了针对Kerberoasting攻击的防御指南，强调了使用gMSA或dMSA、设置强密码以及审计SPN的重要性。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmq9olbYbLBTq8AYY0qtCp6DR1xHHNjsKB5xic7xtGx4sZx2eHJaIklJicibiaoCW61l3uX1JqtbyKvYw/640?from=appmsg)

### 热评

* Kerberoasting攻击：原理、检测与防御
* Windows Server 2025：Active Directory 安全增强，不容忽视

### 关键信息点

* Kerberoasting是一种低技术、高影响力的攻击，可以利用开源工具来查询目标账户、获取服务票证并通过暴力破解离线获取账户密码。
* 服务账户的安全性对于防止Kerberoasting至关重要。应优先使用gMSA或dMSA，它们提供了更强的密码安全性和自动管理功能。
* 密码策略对于防御Kerberoasting同样关键。应禁用弱加密算法，如RC4，并确保所有服务账户使用AES加密。
* 监测和审计是检测Kerberoasting攻击的关键步骤。应检查异常的Kerberos加密类型请求和重复的服务票证请求。

🏷️: Kerberoasting, Active Directory, 密码破解, GPU加速, 网络安全

### 0x02 KeyCloak中的SAML签名验证漏洞分析

> Keycloak 存在一个 SAML 签名验证方法的漏洞，该漏洞允许攻击者通过创建精心设计的响应来绕过验证，可能导致权限提升或模拟攻击。

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/icqm3vRUymZmq9olbYbLBTq8AYY0qtCp6g46sNianvSAeXDzgic19bLSmTkEtygycefWxUNseAu9TF3wOucLZ65vw/640?from=appmsg)

### 热评

* KeyCloak 漏洞 CVE-2024-8698 分析
* KeyCloak 漏洞 CVE-2024-8698 分析

### 关键信息点

* Keycloak 的 SAML 签名验证漏洞可能导致严重的安全风险，包括权限提升和模拟攻击。
* 漏洞的根本原因在于 `XMLSignatureUtil` 类中的 `validate` 方法错误地实现了签名验证逻辑。
* 攻击者可以通过精心设计的 XML 签名和断言操作来绕过验证。
* 为了防御这种攻击，开发者应该确保使用最新版本的 Keycloak，并且在配置 SAML 时启用所有必要的安全验证。

🏷️: KeyCloak, SAML, 签名验证, 漏洞, XMLSignatureUtil

### 0x03 利用.NET框架枚举和攻击活动目录环境

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmq9olbYbLBTq8AYY0qtCp66f0c3FhBc7FY5WwcxWbCHAWzrED2VlYR7RhlyL7aWpV28r7tjhCcNw/640?from=appmsg)

### 热评

* 利用Offensive .NET枚举和利用Active Directory环境
* .NET 攻击技巧：枚举和利用 Active Directory 环境

### 关键信息点

* .NET Framework是进行Windows和Active Directory环境操作的理想选择，因为它不需要额外的依赖安装，能够原生运行，并且提供了丰富的类库和命名空间来简化开发。
* LDAP是Active Directory中最基础的协议之一，使用.NET进行LDAP枚举能够有效地收集用户、组和其他对象的信息。
* 枚举Domain Controllers和Trusts是理解和横向移动在Active Directory环境中的关键步骤，利用.NET可以轻松实现这一点。
* RBCD攻击是一种高风险的权限提升方法，通过修改目标对象的特定属性，攻击者可以实现对资源的委托。

🏷️: .NET, 活动目录, 攻击, 枚举, 网络安全

### 0x04 针对MikroTik路由器的渗透测试研究

> 本文主要介绍了针对MikroTik路由器的渗透测试方法和技术，包括API服务的暴力破解、设备发现、SNMP协议的滥用、UPnP扫描、缺失的安全特性、Winbox凭证的提取、PMKID攻击、配置分析工具Sara的使用、内网渗透技术Pivoting以及RouterOS的后期利用策略。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmq9olbYbLBTq8AYY0qtCp6F928d1p8VicYnx2psnHHslESXpdSc4HRRADvxxdQMSoGaPzAchWReLA/640?from=appmsg)

<<<左右滑动见更多 >>>

### 热评

* 渗透测试 MikroTik 路由器
* MikroTik 路由器渗透测试

### 关键信息点

* MikroTik路由器的安全性至关重要：由于MikroTik路由器在全球范围内的广泛使用，它们的安全性对网络稳定性和保护至关重要。
* API服务的不当配置是安全风险：MikroTik设备的API服务如果未经配置或保护不当，可能会成为攻击者获取控制权限的入口点。
* 网络发现和SNMP协议的滥用：攻击者可以利用网络发现协议和SNMP协议来收集关键的网络设备信息，这些信息可能会被用于进一步的攻击。
* 缺乏安全特性增加了攻击面：缺少DAI、Storm Control和VACL等网络安全特性会增加网络面临的安全风险。

🏷️: 渗透测试, MikroTik, 路由器, 网络安全, 攻击

### 0x05 Zendesk在多家财富500强公司中故意留下后门漏洞

> 15岁的黑客小伙佩尔在业余时间发现了一个漏洞，该漏洞允许攻击者通过Zendesk的电子邮件合作功能入侵包括超过一半的全球500强公司在内的企业的支持票据系统，并可能通过OAuth登录特性进一步入侵Slack工作空间。尽管Zendesk最初将这个问题标记为“不在作用域内”并拒绝修复，但最终在受影响公司的压力下修复了漏洞。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmq9olbYbLBTq8AYY0qtCp62RJalAICvlgBm7CYE4e8ZrrpTiaQhqWSKkeQRMVP9La0Wd58TI1OLiag/640?from=appmsg)
![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmq9olbYbLBTq8AYY0qtCp6icPJyMkk9t61vv6uXpDuL86WbkF6SVOPO2troQUv0775VwaDSfq1urw/640?from=appmsg)

<<<左右滑动见更多 >>>

### 热评

* Zendesk 漏洞赏金：数百家公司后门敞开，最高奖励 5 万美元
* Zendesk 漏洞赏金争议：漏洞被认定为“信息性”却未支付赏金

### 关键信息点

* Zendesk的安全漏洞可能会对使用其服务的公司造成严重影响，尤其是当这些公司包括全球500强企业时。
* 即使是值得信赖的第三方服务提供商，也可能存在安全漏洞，这要求企业对这些服务进行适当的安全审计和监控。
* 黑客攻击和漏洞利用可能会通过电子邮件系统的弱点进行，因此对于电子邮件的安全性和身份验证的严格性至关重要。
* 企业在处理安全漏洞报告时的反应可能会受到公众和其他公司的压力，这可能会促使他们采取行动解决问题。

🏷️: Zendesk, 漏洞, 财富500强, 后门, 网络安全

### 0x06 远程桌面协议（RDP）简易解释

> 远程桌面协议（RDP）是一种流行的用于远程访问Windows计算机的协议，其复杂性和扩展性可能导致新的关键漏洞的发现，对安全行业的专业人士来说具有重要意义。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmq9olbYbLBTq8AYY0qtCp64z26iccVOTL1Jc1sGp809DJ2bGyqD0RnAhceibDS1k88cwnCiaYNpE3pQ/640?from=appmsg)

### 热评

* 远程桌面协议 (RDP) 简单解释

### 关键信息点

* RDP协议的复杂性和广泛的应用使其成为安全领域的关注重点。由于其多样的扩展和潜在的新漏洞，安全专业人士需要对其进行深入学习和研究。
* RDP的安全性至关重要。近年来发现的关键漏洞，如BlueKeep和DejaBlue，表明了RDP协议安全性的脆弱性。这些漏洞可能被用来进行远程代码执行，因此需要采取措施，如使用增强型安全性和NLA，来提高RDP服务器的安全性。
* RDP协议的设计和实现允许高效的数据传输和良好的用户体验。通过使用多通道通信和数据压缩技术，RDP能够在网络上有效地传输图形和输入数据。
* 为了保护RDP服务器免受攻击，应该采取一些最佳实践。这包括防止RDP服务器直接暴露在互联网上，以及启用网络层认证，以限制只有已认证的用户才能访问RDP服务。

🏷️: RDP, 远程访问, 网络安全

### 0x07 [深入解析ViewState安全问题](https://mp.weixin.qq.com/s?__biz=MzkzNTUwNTg2Ng==&mid=2247484605&idx=1&sn=e40ab30b6317c78b7889c13faf780151&scene=21#wechat_redirect)

> 本文主要探讨了ASP.NET中ViewState机制的安全问题，包括不同配置、版本下的安全问题，以及如何从黑盒和白盒视角发现和利用这些问题，并最终提供了对ViewState处理流程的分析。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmq9olbYbLBTq8AYY0qtCp63kQxSic53xpSs8JNVa34VB9gN0KTmYpz9HVib9SDS485d3pzhX6qVOiag/640?from=appmsg)

<<<左右滑动见更多 >>>

### 热评

### 关键信息点

* ViewState是ASP.NET中用于保持页面状态的关键机制，但在不当配置下可能会带来安全风险。
* 在不同的配置和版本环境下，ViewState的安全性会有显著差异，需要特别注意的是Mac验证和加密的配置。
* 攻击者可以通过多种手段来利用ViewState的安全漏洞，包括生成恶意payload、绕过加密和Mac验证等。
* 在实战中，攻击者可以采用黑盒测试和白盒审计两种方法来发现和利用ViewState的问题。

🏷️: ViewState, ASP.NET, 安全问题, 渗透测试

### 0x08 利用韩文字母填充字符执行隐形JavaScript

> 该网页介绍了利用韩文字符填充漏洞来执行看不见的JavaScript代码的方法，并且这一方法受到了Martin Kleppe的INVISIBLE.js的启发。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmq9olbYbLBTq8AYY0qtCp60KZhNrea2Qthm80qHWAiaIysgwSyc2YAuYBjTTtgGsMibM4qsBmX8ogw/640?from=appmsg)

### 热评

### 关键信息点

* 利用韩文字符填充漏洞执行JavaScript代码是一种巧妙的方法，可以在用户看不到代码的情况下执行。
* 这种方法受到了Martin Kleppe的INVISIBLE.js的启发，INVISIBLE.js是一个专门用于隐藏JavaScript代码执行的框架。
* 通过本文提供的示例代码，可以看到代码执行的过程，以及这种技术的实际应用。
* 这种技术可能会有潜在的安全风险和滥用情况，因为它允许在用户不知情的情况下执行脚本。

🏷️: JavaScript, 隐形代码, 韩文字母, 代码执行

### 0x09 简单脚本从reg.py/lookupsid复制并受itm4n的注册表会话枚举启发

> 该网页提供了一个简单的Python脚本，用于通过注册表检查Windows系统上的登录用户，该脚本灵感来源于itm4n的会话枚举方法。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmq9olbYbLBTq8AYY0qtCp6SGNibmqxsWdzNtbneIFfjwT7o2ibazfj8sTYib1XoLfpIInkYKuslm9SQ/640?from=appmsg)

### 热评

* 低权限用户利用注册表进行C#/BOF替代方案

### 关键信息点

* 远程检测Windows登录用户：该脚本的主要目的是远程检测Windows系统上当前登录的用户，这对于安全审计和管理员的日常工作非常有用。
* 基于注册表的枚举方法：脚本利用Windows注册表中的HKEY\_USERS键来枚举用户的SID，这是一种高效的检测已登录用户的方法。
* 集成Kerberos认证：脚本支持Kerberos认证，这使得在支持Kerberos的环境中进行更安全的认证成为可能。
* 灵活的命令行参数：用户可以通过命令行参数来指定目标主机的IP地址、端口、认证方式等，提供了很高的灵活性。

🏷️: 脚本, 注册表, 会话枚举, Python

### 0x0a DLL劫持：恶意代码代理的新视角

> 本网页主要介绍了DLL劫持的新技术和实战应用，以及持续渗透测试（CPT）在这一领域的重要性。

### 热评

* DLL劫持：一种新的Shellcode代理方式

### 关键信息点

* DLL劫持依然是一种有效的攻击手段，尽管微软采取了一些措施来减轻这些攻击，但攻击者仍然可以通过新的技术来实现代理shellcode。
* 持续渗透测试（CPT）对于发现新的攻击路径和漏洞至关重要，它允许红队团队进行深入的研究和开发，以适应坚固的环境。
* 简单而有效的方法，如使用process monitor来监控系统事件，可以帮助发现DLL加载的漏洞。
* DLL代理攻击是一种新的技术，它允许攻击者在不中断服务的情况下加载恶意代码。

🏷️: DLL劫持, 恶意代码, 网络安全, 红队工具

### 0x0b 早期级联注入技术：从Windows进程创建到隐蔽注入

> 本文介绍了一种新型的进程注入技术——早期级联注入（Early Cascade Injection），分析了Windows进程创建的用户模式部分，并探讨了多个端点检测和响应系统（EDRs）如何在进程创建过程中初始化它们的检测能力。

### 热评

* 新型隐蔽进程注入技术：Early Cascade Injection
* 早期的级联注入：从 Windows 进程创建到隐蔽注入

### 关键信息点

* 早期级联注入是一种新型的进程注入技术，它通过操纵用户模式进程创建过程中的回调指针，避免了传统的跨进程APC排队，从而实现了对EDR的逃避。
* 传统的Early Bird APC注入技术可能对现代EDR系统不再有效，因为EDR系统已经开始更早地加载其检测措施。
* EDR-Preloading技术展示了如何通过修改回调指针来在进程创建时执行代码，但它的执行受到加载器锁的限制。
* 早期级联注入利用了`ShimGlobalOptions`回调指针，该指针不受加载器锁的限制，允许在进程初始化早期阶段执行代码。

🏷️: EDR, 进程注入, Windows, 安全检测, 技术

### 0x0c 克隆克隆器：构建自定义RFID克隆设备

> 作者在尝试构建一个长距离RFID克隆器，经过一系列的测试和调试，最终通过使用一个更强大的电源解决方案，成功增加了克隆器的读取距离。

![](https://mmbiz.qpic...