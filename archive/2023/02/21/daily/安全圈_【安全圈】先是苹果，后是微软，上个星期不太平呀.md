---
title: 【安全圈】先是苹果，后是微软，上个星期不太平呀
url: https://mp.weixin.qq.com/s?__biz=MzIzMzE4NDU1OQ==&mid=2652030835&idx=3&sn=f967f36c43353d65e6f847024ff776d9&chksm=f36feb33c418622505f4eadcf403bbfe42a50edfbe19e62f35d736c329605d597899de5e66fd&scene=58&subscene=0#rd
source: 安全圈
date: 2023-02-21
fetch_date: 2025-10-04T07:38:49.417660
---

# 【安全圈】先是苹果，后是微软，上个星期不太平呀

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/aBHpjnrGylhd7J2voEejx9jCkzzVc6dKRRxez6Cvuhylibs5HqSK39LkUKBicViaV5rib1ibRcGJ8L6gPyJz4qE32SQ/0?wx_fmt=jpeg)

# 【安全圈】先是苹果，后是微软，上个星期不太平呀

安全圈

![](https://mmbiz.qpic.cn/mmbiz_jpg/aBHpjnrGylgSxa9I02IBd3bgLEhwfJCeRibw3LEjMujeAhD2CvyiaVCZJVHGHODbkPx3pViaX0sAibZsDun6sicUzdQ/640?wx_fmt=jpeg)

**关键词**

服务器攻击

roadcom Software 旗下的赛门铁克发现了一种新的恶意软件，它滥用 Microsoft 的 Internet 信息服务 (IIS) 的一项功能，在目标系统上部署后门。

该恶意软件被称为 Frebniis，目前未知的威胁行为者使用它来攻击台湾的目标。

Frebniis 使用的技术涉及将恶意代码注入与 IIS 功能相关的 DLL 文件 (iisfreb.dll) 的内存中，该 IIS 功能用于对失败的网页请求进行故障排除和分析。这允许恶意软件偷偷监视所有 HTTP 请求并识别攻击者发送的特殊格式的 HTTP 请求，从而允许远程代码执行。为了使用这种技术，攻击者需要通过其他方式获得对运行 IIS 服务器的 Windows 系统的访问权限。在这种特殊情况下，尚不清楚这种访问是如何实现的。

IIS 是在 Windows 系统上运行的通用 Web 服务器，用于提供请求的 HTML 页面或文件。IIS Web 服务器接受来自远程客户端计算机的请求并返回适当的响应。IIS 具有称为失败请求事件缓冲 (FREB) 的功能，可收集有关请求的数据和详细信息，例如原始 IP 地址和端口、带有 cookie 的 HTTP 标头等。

称为失败请求跟踪的功能可用于对 IIS 失败请求进行故障排除。失败请求跟踪缓冲请求的跟踪事件，如果请求满足用户设置的“失败”定义，则将它们刷新到磁盘。例如，失败的请求跟踪可用于了解请求返回特定 HTTP 状态代码（401 或 404 等）的原因，或者请求处理时间过长或未响应的原因。

Frebniis 确保启用失败请求跟踪，然后访问 w3wp.exe (IIS) 进程内存，获取加载失败请求事件缓冲代码 (iisfreb.dll) 的地址。通过这个代码起始地址，Frebniis 从那里搜索一个函数指针表来劫持代码执行。

Frebniis 的作者已经确定，每当从 Web 客户端向 IIS 发出任何 HTTP 请求时，iiscore.dll 都会调用 iisfreb.dll 中的特定函数指针。此函数通常检查 HTTP 请求的内容是否符合失败请求跟踪规则。

Frebniis 恶意注入代码解析所有收到的 /logon.aspx 或 /default.aspx HTTP POST 请求以及设置为“7ux4398!”的参数密码。如果密码匹配，Frebniis 会解密并执行注入代码的一部分，这是包含主要后门功能的 .NET 可执行代码。在此过程中没有可执行文件保存到磁盘，使后门完全隐蔽。

.NET 代码提供代理功能和远程代码执行，由提供的第二个 HTTP 参数控制，该参数是 Base64 编码的字符串。

为启用代理，编码字符串先进行 Base64 解码，然后解密 (xor 0x08)，第一个字符表示代理命令，后跟预期参数。代理用于发送和接收来自其他计算机系统的 Base64 编码数据。这允许攻击者通过受感染的 IIS 服务器与通常可能被 Internet 阻止的内部资源进行通信。

![](https://mmbiz.qpic.cn/mmbiz_png/aBHpjnrGylhd7J2voEejx9jCkzzVc6dKv7Emxia9jm7ibQwiaPgicACBve1jh40FvqAIdJq8W7WxYNibt0icsLfLCj6g/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/aBHpjnrGylhd7J2voEejx9jCkzzVc6dKqcia3SXx8QBwtBE13J9Vhf8ylOd4yQc2Thy3BkO3ia6qialWkGC027fxg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/aBHpjnrGylhd7J2voEejx9jCkzzVc6dKjoyGQcYdkqQtGEVrN27y2ZZCicBSl7YXJ7eicNMJegOPKKM0fhfj0gUQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/aBHpjnrGylhd7J2voEejx9jCkzzVc6dKicOK2nlSicznqzibBWDBXGHA77DmHBYwc2a5qrDjgsHRGw7LqAEticFtrw/640?wx_fmt=png)

.NET 后门代码还支持远程执行。如果在没有密码参数的情况下收到对 logon.aspx 或 default.aspx 的 HTTP 调用，但使用 Base64 字符串，则假定 Base64 字符串是将直接在内存中执行的 C# 代码。Base64 字符串被解码然后解密 (xor 0x08)，预计是一个 XML 文档，其中包含要在 'data' 属性下的 '/doc' 节点中执行的 C# 代码（例如 <doc data=C# code>） . 提取并执行 C# 代码。这使得 Frebniis 可以在系统上秘密执行任意代码。

通过劫持和修改 IIS Web 服务器代码，Frebniis 能够拦截 HTTP 请求处理的常规流程并寻找特殊格式的 HTTP 请求。这些请求允许远程代码执行和以隐秘方式代理到内部系统。系统上不会运行任何文件或可疑进程，这使得 Frebniis 成为一种相对独特且罕见的 HTTP 后门类型。

***END***

阅读推荐

![](https://mmbiz.qpic.cn/mmbiz_png/aBHpjnrGylg06gGwYpjT81JZt5HaBh3dxCvpU6umzbLnIImOQLhVaKOWrMUMibsnqz5GvdCqodrER6pnt3zJHfg/640?wx_fmt=png)[【安全圈】弄“料子”薅羊毛终获刑 个人信息要保护好](http://mp.weixin.qq.com/s?__biz=MzIzMzE4NDU1OQ==&mid=2652030766&idx=1&sn=1d10cf7d73ee963ff5380c0ad0ce5244&chksm=f36feb6ec4186278efddd98817b08bddd4755b0deb9a59319f81f9cd588c02bedd3e51705e99&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/mmbiz_jpg/aBHpjnrGylg06gGwYpjT81JZt5HaBh3dDZykcaxYmzeSkqpY9GicGeURCDhYb5p8aH0icv6TXDniaWsS7UEAGrIicw/640?wx_fmt=jpeg)[【安全圈】因数据泄露和网络中断 韩国运营商LG Uplus首席执行官公开道歉](http://mp.weixin.qq.com/s?__biz=MzIzMzE4NDU1OQ==&mid=2652030766&idx=2&sn=4b39e19d49861b8278ace9c424ad2b56&chksm=f36feb6ec4186278642e8b9820777094f65bb229bf1d677c65d65c8fbf5529fb03785bcc0f16&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/mmbiz/aBHpjnrGylg06gGwYpjT81JZt5HaBh3dgxPrkux6oFNrWg3JCfjE416nqAapzGLGNfKrJedycNlyykpR9v8ESA/640?wx_fmt=other)[【安全圈】德媒：德国机场网络遭遇大规模黑客攻击](http://mp.weixin.qq.com/s?__biz=MzIzMzE4NDU1OQ==&mid=2652030766&idx=3&sn=9e9de863cd6fed0dfba29fd644f26ea6&chksm=f36feb6ec41862787148cf8a3a362f1c96eadfe9541ced2f2e3bc28924e27a63a0b68a278b8a&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/mmbiz_jpg/aBHpjnrGylhd7J2voEejx9jCkzzVc6dK5NWVfPPzIcVzibQZTVa2kwZAnDWibS5SLU6bHUoUibC8UlgpBnXTZapVg/640?wx_fmt=jpeg)[【安全圈】服务器被黑客攻击，威马汽车全力抢修终于恢复！](http://mp.weixin.qq.com/s?__biz=MzIzMzE4NDU1OQ==&mid=2652030766&idx=4&sn=f5c794e1565477536cad1ff5b96db0c2&chksm=f36feb6ec4186278085d73f1e039e158fc8c36037c38e0385cf2f1a26fcd6b69389bb4f25971&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/mmbiz_gif/aBHpjnrGylgeVsVlL5y1RPJfUdozNyCEft6M27yliapIdNjlcdMaZ4UR4XxnQprGlCg8NH2Hz5Oib5aPIOiaqUicDQ/640?wx_fmt=gif)

![](https://mmbiz.qpic.cn/mmbiz_png/aBHpjnrGylgeVsVlL5y1RPJfUdozNyCEDQIyPYpjfp0XDaaKjeaU6YdFae1iagIvFmFb4djeiahnUy2jBnxkMbaw/640?wx_fmt=png)

**安全圈**

![](https://mmbiz.qpic.cn/mmbiz_gif/aBHpjnrGylgeVsVlL5y1RPJfUdozNyCEft6M27yliapIdNjlcdMaZ4UR4XxnQprGlCg8NH2Hz5Oib5aPIOiaqUicDQ/640?wx_fmt=gif)

←扫码关注我们

**网罗圈内热点 专注网络安全**

**实时资讯一手掌握！**

![](https://mmbiz.qpic.cn/mmbiz_gif/aBHpjnrGylgeVsVlL5y1RPJfUdozNyCE3vpzhuku5s1qibibQjHnY68iciaIGB4zYw1Zbl05GQ3H4hadeLdBpQ9wEA/640?wx_fmt=gif)

**好看你就分享 有用就点个赞**

**支持「****安全圈」就点个三连吧！**

![](https://mmbiz.qpic.cn/mmbiz_gif/aBHpjnrGylgeVsVlL5y1RPJfUdozNyCE3vpzhuku5s1qibibQjHnY68iciaIGB4zYw1Zbl05GQ3H4hadeLdBpQ9wEA/640?wx_fmt=gif)

预览时标签不可点

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/aBHpjnrGylhgCQcCZBwQrSQRLABhjrXviafAj0avc5c69t69K1YymAruIaZWzXPqbGPourlnuu8pfibV0ebgqV9g/0?wx_fmt=png)

安全圈

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/aBHpjnrGylhgCQcCZBwQrSQRLABhjrXviafAj0avc5c69t69K1YymAruIaZWzXPqbGPourlnuu8pfibV0ebgqV9g/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过