---
title: Exploiting Client-Side Path Traversal to Perform Cross-Site Request Forgery - Introducing CSPT2CSRF
url: https://blog.doyensec.com/2024/07/02/cspt2csrf.html
source: Over Security - Cybersecurity news aggregator
date: 2024-07-03
fetch_date: 2025-10-06T17:44:29.024897
---

# Exploiting Client-Side Path Traversal to Perform Cross-Site Request Forgery - Introducing CSPT2CSRF

[

](https://doyensec.com/img/home-video.mp4)

[![](/public/images/doyensec-logo.svg)](/index.html)

[![](/public/images/logo.svg)](/index.html)

#### ABOUT US

We are [**security engineers**](https://doyensec.com) who break bits and tell stories.

Visit us
[doyensec.com](https://doyensec.com)

Follow us
[@doyensec](https://twitter.com/doyensec)

Engage us
info@doyensec.com

#### Blog Archive

* 2025
* 2024
* 2023
* 2022
* 2021
* 2020
* 2019
* 2018
* 2017

© 2025 [Doyensec LLC](https://doyensec.com) [![](/public/images/rss.png)](/atom.xml "RSS")

# Exploiting Client-Side Path Traversal to Perform Cross-Site Request Forgery - Introducing CSPT2CSRF

02 Jul 2024 - Posted by Maxence Schmitt

![Doyensec CSPT2CSRF](../../../public/images/cspt2csrf_doyensec.png)

To provide users with a safer browsing experience, the IETF proposal named âIncrementally Better Cookiesâ set in motion a few important changes to address Cross-Site Request Forgery (CSRF) and other client-side issues. Soon after, Chrome and other major browsers implemented the recommended changes and introduced the SameSite attribute. SameSite helps mitigate CSRF, but does that mean CSRF is dead?

While auditing major web applications, we realized that Client Side Path-Traversal (CSPT) can be actually leveraged to resuscitate CSRF for the joy of all pentesters.

This blog post is a brief introduction to my research. The detailed findings, methodologies, and in-depth analysis are available in the [whitepaper](https://www.doyensec.com/resources/Doyensec_CSPT2CSRF_Whitepaper.pdf).

This research introduces the basics of Client-Side Path Traversal, presenting sources and sinks for Cross-Site Request Forgery. To demonstrate the impact and novelty of our discovery, we showcased vulnerabilities in major web messaging applications, including Mattermost and Rocket.Chat, among others.

Finally, we are releasing a [Burp extensionto help discover Client-Side Path-Traversal sources and sinks.](https://github.com/doyensec/CSPTBurpExtension)

Thanks to the Mattermost and Rocket.Chat teams for their collaboration and authorization to share this.

# Client-Side Path Traversal (CSPT)

Every security researcher should know what a path traversal is. This vulnerability gives an attacker the ability to use a payload like `../../../../` to read data outside the intended directory. Unlike server-side path traversal attacks, which read files from the server, client-side path traversal attacks focus on exploiting this weakness in order to make requests to unintended API endpoints.

![Doyensec CSPT2CSRF](../../../public/images/cspt2csrf-simple.png)

While this class of vulnerabilities is very popular on the server side, only a few occurrences of Client-Side Path Traversal have been widely publicized. The first reference we found was a [bug](https://www.facebook.com/notes/996734990846339/) reported by Philippe Harewood in the Facebook bug bounty program. Since then, we have only found a few references about Client-Side Path Traversal:

* a [tweet](https://x.com/samwcyo/status/1437030056627523590) from Sam Curry back in 2021
* [1-click CSRF](https://gitlab.com/gitlab-org/gitlab/-/issues/365427) in GitLab by Johan Carlsson
* [CSS Injection](https://mr-medi.github.io/research/2022/11/04/practical-client-side-path-traversal-attacks.html) by Medi, nominated in the [Portswigger Top 10 Web hacking techniques of 2022](https://portswigger.net/research/top-10-web-hacking-techniques-of-2022)
* a [CSRF](https://erasec.be/blog/client-side-path-manipulation/) by Antoine Roly from Erasec
* Some other references were found about Client-Side CSRF from OWASP and in [this](https://www.usenix.org/system/files/sec21-khodayari.pdf) research paper by Soheil Khodayari and Giancarlo Pellegrino.

Client Side Path-Traversal has been overlooked for years. While considered by many as a low-impact vulnerability, it can be actually used to force an end user to execute unwanted actions on a web application.

# Client-Side Path Traversal to Perform Cross-Site Request Forgery (CSPT2CSRF)

This research evolved from exploiting multiple Client-Side Path Traversal vulnerabilities during our web security engagements. However, we realized there was a lack of documentation and knowledge to understand the limits and potential impacts of using Client-Side Path Traversal to perform CSRF (CSPT2CSRF).

## Source

While working on this research, we figured out that one common bias exists. Researchers may think that user input has to be in the front end. However, like with XSS, any user input can lead to CSPT (think DOM, Reflected, Stored):

* URL fragment
* URL Query
* Path parameters
* Data injected in the database

When evaluating a source, you should also consider if any action is needed to trigger the vulnerability or if itâs triggered when the page is loaded. Indeed, this complexity will impact the final severity of the vulnerability.

## Sink

The CSPT will reroute a legitimate API request. Therefore, the attacker may not have control over the HTTP method, headers and body request.

All these restrictions are tied to a source. Indeed, the same front end may have different sources that perform different actions (e.g., GET/POST/PATCH/PUT/DELETE).

Each CSPT2CSRF needs to be described (source and sink) to identify the complexity and severity of the vulnerability.

As an attacker, we want to find all impactful sinks that share the same restrictions. This can be done with:

* API documentation
* Source code review
* Semgrep rules
* Burp Suite Bambda filter

![CSPT2CSRF bambda](../../../public/images/cspt2csrf-bambda.png)

## CSPT2CSRF with a GET Sink

Some scenarios of exploiting CSPT with a GET sink exist:

* Using an open redirect to leak sensitive data associated with the source
* Using an open redirect to load malicious data in order to trigger an XSS

However, open redirects are now hunted by many security researchers, and finding an XSS in a front end using a modern framework may be hard.

That said, during our research, even when stage-changing actions werenât implemented directly with a GET sink, we were frequently able to exploit them via CSPT2CSRFs, without having the two previous prerequisites.

In fact it is often possible to chain a CSPT2CSRF having a GET sink with another state-changing CSPT2CSRF.

![CSPT2CSRF get sink](../../../public/images/cspt2csrf-getsink2.png)

1st primitive: GET CSPT2CSRF:

* Source: `id` param in the query
* Sink: GET request on the API

2nd primitive: POST CSPT2CSRF:

* Source: `id` from the JSON data
* Sink: POST request on the API

To chain these primitives, a GET sink gadget must be found, and the attacker must control the `id` of the returned JSON. Sometimes, it may be directly authorized by the back end, but the most common gadget we found was to abuse file upload/download features. Indeed, many applications exposed file upload features in the API. An attacker can upload JSON with a manipulated `id` and target this content to trigger the CSPT2CSRF with a state-changing action.

In the [whitepaper](https://www.doyensec.com/resources/Doyensec_CSPT2CSRF_Whitepaper.pdf), we explain this scenario with an example in Mattermost.

# Sharing with the Community

This research was presented last week by Maxence Schmitt ([@maxenceschmitt](https://x.com/maxenceschmitt)) at OWASP Global Appsec Lisbon 2024. The slides can be found [here](https://www.doyensec.com/resources/Doyensec_CSPT2CSRF_OWASP_Appsec_Lisbon.pdf).

This blog post is just a glimpse of our extensive research. For a comprehensive understanding and detailed technical insights, please refer to the [whitepaper](https://www.doyensec.com/resources/Doyensec_CSPT2CSRF_Whitepaper.pdf).

Along with this whitepaper, we are releasing a [BURP extension](https://github.com/doyensec/CSPTBurpExtension) to find Client-Side Path Traversals.

![CSPTBurpExtension](../../../public/images/cspt2csrf-burp.png)

# In Conclusion

We feel CSPT2CSRF is overlooked by many security researcher...