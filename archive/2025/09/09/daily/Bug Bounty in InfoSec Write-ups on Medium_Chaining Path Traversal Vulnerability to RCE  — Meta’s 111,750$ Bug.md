---
title: Chaining Path Traversal Vulnerability to RCE  — Meta’s 111,750$ Bug
url: https://infosecwriteups.com/chaining-path-traversal-vulnerability-to-rce-metas-111-750-bug-a98a473c6a05?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2025-09-09
fetch_date: 2025-10-02T19:50:05.079187
---

# Chaining Path Traversal Vulnerability to RCE  — Meta’s 111,750$ Bug

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa98a473c6a05&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fchaining-path-traversal-vulnerability-to-rce-metas-111-750-bug-a98a473c6a05&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fchaining-path-traversal-vulnerability-to-rce-metas-111-750-bug-a98a473c6a05&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-a98a473c6a05---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-a98a473c6a05---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# Chaining Path Traversal Vulnerability to RCE — Meta’s 111,750$ Bug

[![Abhishek meena](https://miro.medium.com/v2/resize:fill:64:64/1*g4tYjgpvB52xwZPNMcvefg.png)](https://medium.com/%40Aacle?source=post_page---byline--a98a473c6a05---------------------------------------)

[Abhishek meena](https://medium.com/%40Aacle?source=post_page---byline--a98a473c6a05---------------------------------------)

5 min read

·

Sep 4, 2025

--

Listen

Share

In the high-stakes world of bug bounty hunting, a single vulnerability can be the key to unlocking a significant reward. But what happens when a seemingly simple bug is chained with another, turning a file placement issue into full-blown Remote Code Execution (RCE)? This is the story of a critical vulnerability discovered in Facebook Messenger for Windows during the Meta BountyCon hacking event in June 2024, a finding that ultimately led to a first-place finish and a massive $111,750 payout.

This write-up breaks down the entire attack chain, from an initial path traversal flaw to a clever DLL hijacking technique, demonstrating how creative thinking and persistence can elevate a simple bug into a critical security threat.

Press enter or click to view image in full size

![]()

From Path Traversal to RCE: A $111,750 Facebook Messenger Exploit

## The Initial Foothold: Path Traversal in Encrypted Chats

The investigation began by probing the end-to-end encrypted (E2EE) chat feature in Messenger. In an E2EE environment, the client application is responsible for validating all incoming data, as the server has no visibility into the encrypted content. This client-side trust model often presents a rich attack surface.

The theory was simple: if the Messenger for Windows client mishandled file attachments sent over an encrypted channel, it could lead to a vulnerability. By sending an attachment with a specially crafted filename containing path traversal sequences (`%2e%2e%5c`, the URL-encoded version of `..\`), a flaw was quickly identified.

The Messenger client naively accepted the filename, placing the attachment at a location dictated by the traversal sequences. For instance, a file named `..\test.bat` would be saved outside of its intended directory. The full path looked something like this:

```
C:\Users\vulna\AppData\Local\Messenger\TamStorage\media_bank\AdvancedCrypto\100027775233281\persistent\da7a85eb-aac7-46da-9cba-7a2f38f88e08\2024\06\03\20240603T091559605.att.04484a15-4cbf-4a1d-9e65-a48c59dcc7a2\..\test.bat
```

This confirmed a classic **path traversal vulnerability**. An attacker could send a message to a victim and write an arbitrary file to a location on their Windows machine. However, this was far from a game-over scenario.

Press enter or click to view image in full size

![]()

breaking out of a sandboxed directory (/media\_bank/) and moving into a higher-level directory /home

## The Obstacle: Windows Path Length Limitation

The initial excitement was quickly tempered by a significant constraint: the Windows MAX\_PATH limitation. The maximum length for a file path in Windows is typically 260 characters. The base directory where Messenger stored the attachment was already incredibly long:

```
C:\Users\vulna\AppData\Local\Messenger\TamStorage\media_bank\AdvancedCrypto\100027775233281\persistent\da7a85eb-aac7-46da-9cba-7a2f38f88e08\2024\06\03\20240603T091559605.att.04484a15-4cbf-4a1d-9e65-a48c59dcc7a2\
```

This path alone consumed **212 characters**, leaving only 48 characters for the traversal sequence and the final payload filename. Each `..\` sequence uses 3 characters, so traversing up the directory tree was costly. Traversing 11 levels up (`..\..\..\..\..\..\..\..\..\..\..`) consumed 33 characters, landing the file in `C:\Users\vulna\AppData\Local\`.

This left a meager **15 characters** for the destination folder and filename. Furthermore, the vulnerability did not allow for overwriting existing files. The challenge was now to find a way to achieve code execution with a 15-character filename in a directory filled with files from other applications.

## The Pivot: Achieving RCE via DLL Hijacking

The solution lay in a well-known Windows attack technique: **DLL Hijacking**. Many applications, when they start, attempt to load Dynamic-Link Libraries (DLLs) that they need to function. They often search for these DLLs in a predefined order, which typically includes the directory the application is running from. If an attacker can place a malicious DLL with the correct name in a location that is searched before the legitimate DLL, the application will load the malicious code.

Research revealed that other popular applications installed on the victim machine, such as Viber and Slack, were vulnerable to this attack. Specifically, the Viber client, when launched, would attempt to load the `qwave.dll` library from its own application directory: `C:\Users\vulna\AppData\Local\Viber`. Crucially, this DLL was not present in that directory by default.

This was the golden ticket. The payload path would be:

```
..\Viber\qwave.dll
```

This path is exactly **19 characters** long. After careful recalculation of the traversal sequence, the final filename was crafted:

```
%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5cViber%5cqwave.dll
```

When the victim received this file via an encrypted Messenger chat, the client would save the malicious `qwave.dll` into `C:\Users\vulna\AppData\Local\Viber\`. The next time the victim launched Viber, the application would load and execute the attacker's code, achieving remote code execution without any further user interaction.

Press enter or click to view image in full size

![]()

A flowchart showing the DLL hijacking process

## Attack Demonstration and Timeline

The full attack was demonstrated in the following video, showing how sending a file via Messenger leads to code execution on the victi...