---
title: MSMAP  - Memory WebShell Generator
url: https://buaq.net/go-137372.html
source: unSafe.sh - 不安全
date: 2022-11-27
fetch_date: 2025-10-03T23:52:16.783592
---

# MSMAP  - Memory WebShell Generator

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/30d1fafc45b725116d8bf4a22e4f015b.jpg)

MSMAP - Memory WebShell Generator

Msmap is a Memory WebShell Generator. Compatible with various Containers, Components, Encoder
*2022-11-26 19:30:0
Author: [www.kitploit.com(查看原文)](/jump-137372.htm)
阅读量:87
收藏*

---

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFIbnlPX21rBdoXqphfcf48-C_N1KVXbSvxWTg2bA_v3MhV7CMzINh_B8DIwZcs7edLURdT6TjdmHITcaDn8oNhChfJOGzklu3o5oBJ7ksnUkN9kQeuOgB3pQ56GZtYBKb9mtua0OcH_AzHUKoEbMJd3EZ7YtoxFIgWN_xMpuxuC-4QgaC4onFJNkWrw/w640-h258/msmap_1_a.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFIbnlPX21rBdoXqphfcf48-C_N1KVXbSvxWTg2bA_v3MhV7CMzINh_B8DIwZcs7edLURdT6TjdmHITcaDn8oNhChfJOGzklu3o5oBJ7ksnUkN9kQeuOgB3pQ56GZtYBKb9mtua0OcH_AzHUKoEbMJd3EZ7YtoxFIgWN_xMpuxuC-4QgaC4onFJNkWrw/s1409/msmap_1_a.png)

Msmap is a Memory WebShell Generator. Compatible with various Containers, Components, Encoder, *WebShell / Proxy / Killer* and [Management](https://www.kitploit.com/search/label/Management "Management") Clients. [简体中文](https://github.com/hosch3n/msmap/blob/main/README_CN.md "简体中文")

[The idea behind I](https://hosch3n.github.io/2022/08/08/Msmap%E5%86%85%E5%AD%98%E9%A9%AC%E7%94%9F%E6%88%90%E6%A1%86%E6%9E%B6%EF%BC%88%E4%B8%80%EF%BC%89/ "The idea behind I"), [The idea behind II](https://hosch3n.github.io/2022/08/09/Msmap%E5%86%85%E5%AD%98%E9%A9%AC%E7%94%9F%E6%88%90%E6%A1%86%E6%9E%B6%EF%BC%88%E4%BA%8C%EF%BC%89/ "The idea behind II")

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj9tBa_XK4mBWZ4K8b30JrczdLl4-2uj7IOTDKYgbzmy5qedslTw8PxKB5O3w9sWEoheYdaQ9eWL70Y_jHomF4-PDuoQdEkqnfgdQ68J8OCgYXn-dBAestDMtuX0ARNOSsyMyHZ6qRSPYJhDbTmJtu5o9ldXqqZ479lfN2hOlG7F6jedZXbq7sXPU1Vyg/w640-h258/msmap_1_a.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj9tBa_XK4mBWZ4K8b30JrczdLl4-2uj7IOTDKYgbzmy5qedslTw8PxKB5O3w9sWEoheYdaQ9eWL70Y_jHomF4-PDuoQdEkqnfgdQ68J8OCgYXn-dBAestDMtuX0ARNOSsyMyHZ6qRSPYJhDbTmJtu5o9ldXqqZ479lfN2hOlG7F6jedZXbq7sXPU1Vyg/s1409/msmap_1_a.png)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh-urR5rkhG3sL4hA2X34xPWB-UIkpeMH2YThayaH19tH0tVnLpseyjyUMzg6--M8KO5SDswDSqM0GipL74acdqg6-RAGco478I0LU97hibboSfsYf4Mh584Zz8lGYlJK9u7iu4ktLzHExtWYTjYMD05jAb7Lb9mSs6AGXxBwGqM2Y3MXXvR3mv7pVHIw/w640-h258/msmap_2_b.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh-urR5rkhG3sL4hA2X34xPWB-UIkpeMH2YThayaH19tH0tVnLpseyjyUMzg6--M8KO5SDswDSqM0GipL74acdqg6-RAGco478I0LU97hibboSfsYf4Mh584Zz8lGYlJK9u7iu4ktLzHExtWYTjYMD05jAb7Lb9mSs6AGXxBwGqM2Y3MXXvR3mv7pVHIw/s1409/msmap_2_b.png)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjsMez_f6RjJ6u0m0nuELb_V_4c8XRhEoyIXjdsIbbRJorUZ3leK1ZRjW96BpVA3_p22GkWqg-giyrTF62kJ8O_OmcfWy166TiwrKuzK45LkOnxHg7iHMvAxEiCt8mHDS9LYBGqWCTgIUx8vxEfaDDxXN1LNjB9iNaDccGw675Y1qN5MEErBo6ZTV3FOA/w640-h258/msmap_3_c.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjsMez_f6RjJ6u0m0nuELb_V_4c8XRhEoyIXjdsIbbRJorUZ3leK1ZRjW96BpVA3_p22GkWqg-giyrTF62kJ8O_OmcfWy166TiwrKuzK45LkOnxHg7iHMvAxEiCt8mHDS9LYBGqWCTgIUx8vxEfaDDxXN1LNjB9iNaDccGw675Y1qN5MEErBo6ZTV3FOA/s1409/msmap_3_c.png)

### Function

* Dynamic Menu
* [Automatic](https://www.kitploit.com/search/label/Automatic "Automatic") Compilation
* Generate Script
* Lite Mode
* Graphical Interface

### Container

* Java
  + Tomcat7
  + Tomcat8
  + Tomcat9
  + Tomcat10
  + Resin3
  + Resin4
  + WebSphere
  + GlassFish
  + WebLogic
  + JBoss
  + Spring
  + Netty
  + JVM\*
* .NET
  + IIS
* PHP
* Python

\*: Default support for `Linux Tomcat 8/9`, more versions can be adapted according to the advanced guide.

### WebShell / Proxy / Killer

* WebShell

  + CMD / SH
  + AntSword
  + JSPJS
  + Behinder
  + Godzilla
* No need for modularity

~~Proxy: Neo-reGeorg, wsproxy~~

~~Killer: java-memshell-scanner, ASP.NET-Memshell-Scanner~~

### Decoder / [Decryptor](https://www.kitploit.com/search/label/Decryptor "Decryptor") / Hasher

* Decoder
  + Base64
  + Hex
* Decryptor
  + XOR
  + RC4
  + AES128
  + AES256
  + RSA
* Hasher
  + MD5
  + SHA128
  + SHA256

## Usage

> [Warning] MUST set a unique password, Options are case sensitive.

### Advanced

Edit `config/environment.py`

```
# Auto Compile
```

Edit `gist/java/container/tomcat/servlet.py`

```
// Servlet Path Pattern
private static String pattern = "*.xml";
```

If an [encryption](https://www.kitploit.com/search/label/Encryption "encryption") encoder is used in WsFilter, the password needs to be the same as the path (eg `/passwd`)

`gist/java/container/jdk/javax.py` with `lib/servlet-api.jar` can be replaced depending on the target container.

`pip3 install pyperclip` to support automatic copying to clipboard.

## Example

**CMD / SH**

**Command** with **Base64** Encoder | Inject Tomcat Valve

`python generator.py Java Tomcat Valve Base64 CMD passwd`

**AntSword**

Type **JSP** with **default** Encoder | Inject Tomcat Valve

`python generator.py Java Tomcat Valve RAW AntSword passwd`

Type **JSP** with **[aes\_128\_ecb\_pkcs7\_padding\_md5](https://github.com/hosch3n/msmap/blob/main/extend/AntSword/encoder/aes_128_ecb_pkcs7_padding_md5.js "aes_128_ecb_pkcs7_padding_md5")** Encoder | Inject Tomcat Listener

`python generator.py Java Tomcat Listener AES128 AntSword passwd`

Type **JSP** with **[rc\_4\_sha256](https://github.com/hosch3n/msmap/blob/main/extend/AntSword/encoder/rc_4_sha256.js "rc_4_sha256")** Encoder | Inject Tomcat Servlet

`python generator.py Java Tomcat Servlet RC4 AntSword passwd`

Type **JSP** with **[xor\_md5](https://github.com/hosch3n/msmap/blob/main/extend/AntSword/encoder/xor_md5.js "xor_md5")** Encoder | AgentFiless Inject HttpServlet

`python generator.py Java JDK JavaX XOR AntSword passwd`

Type **JSPJS** with **[aes\_128\_ecb\_pkcs7\_padding\_md5](https://github.com/hosch3n/msmap/blob/main/extend/AntSword/encoder/aes_128_ecb_pkcs7_padding_md5.js "aes_128_ecb_pkcs7_padding_md5")** Encoder | Inject Tomcat WsFilter

`python generator.py Java Tomcat WsFilter AES128 JSPJS passwd`

**Behinder**

Type **default\_aes** | Inject Tomcat Valve

`python generator.py Java Tomcat Valve AES128 Behinder rebeyond`

Type **default\_xor\_base64** | Inject Spring Interceptor

`python generator.py Java Spring Interceptor XOR Behinder rebeyond`

**Godzilla**

Type **JAVA\_AES\_BASE64** | Inject Tomcat Valve

`python generator.py Java Tomcat Valve AES128 Godzilla superidol`

Type **JAVA\_AES\_BASE64** | AgentFiless Inject HttpServlet

`python generator.py Java JDK JavaX AES128 Godzilla superidol`

> [Known issue](https://github.com/BeichenDream/Godzilla/issues/76 "Known issue")

## Reference

[GodzillaMemoryShellProject](https://github.com/BeichenDream/GodzillaMemoryShellProject "GodzillaMemoryShellProject")

[AntSword-JSP-Template](https://github.com/AntSwordProject/AntSword-JSP-Template "AntSword-JSP-Template")

[As-Exploits memshell\_manage](https://github.com/yzddmr6/As-Exploits/tree/master/core/memshell_manage "As-Exploits memshell_manage")

[Behinder](https://github.com/rebeyond/Behinder "Behinder") | [wsMemShell](https://github.com/veo/wsMemShell "wsMemShell") | [ysomap](https://github.com/wh1t3p1g/ysomap "ysomap")

文章来源: http://www.kitploit.com/2022/11/msmap-memory-webshell-generator.html
 如有侵权请联系:admin#unsafe.sh

© [unSafe.sh - 不安全](https://unsafe.sh) Powered By [PaperCache](https://github.com/code-scan/PaperCache)

* admin#unsafe.sh
* [安全马克](https://aq.mk)
* [星际黑客](https://xj.hk)
* [T00ls](https://t00ls.net)