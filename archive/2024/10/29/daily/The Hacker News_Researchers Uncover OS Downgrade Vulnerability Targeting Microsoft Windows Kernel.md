---
title: Researchers Uncover OS Downgrade Vulnerability Targeting Microsoft Windows Kernel
url: https://thehackernews.com/2024/10/researchers-uncover-os-downgrade.html
source: The Hacker News
date: 2024-10-29
fetch_date: 2025-10-06T18:56:21.279153
---

# Researchers Uncover OS Downgrade Vulnerability Targeting Microsoft Windows Kernel

#1 Trusted Cybersecurity News Platform

Followed by 5.20+ million[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.facebook.com/thehackernews)

[![The Hacker News Logo](data:image/png;base64...)](/)

**

**

[** Subscribe – Get Latest News](#email-outer)

* [** Home](/)
* [** Newsletter](#email-outer)
* [** Webinars](/p/upcoming-hacker-news-webinars.html)

* [Home](/)
* [Data Breaches](/search/label/data%20breach)
* [Cyber Attacks](/search/label/Cyber%20Attack)
* [Vulnerabilities](/search/label/Vulnerability)
* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Expert Insights](https://thehackernews.com/expert-insights/)
* [Contact](/p/submit-news.html)

**

**

**

Resources

* [Webinars](/p/upcoming-hacker-news-webinars.html)
* [Free eBooks](https://thehackernews.tradepub.com)

About Site

* [About THN](/p/about-us.html)
* [Jobs](/p/careers-technical-writer-designer-and.html)
* [Advertise with us](/p/advertising-with-hacker-news.html)

Contact/Tip Us

[**

Reach out to get featured—contact us to send your exclusive story idea, research, hacks, or ask us a question or leave a comment/feedback!](/p/submit-news.html)

Follow Us On Social Media

[**](https://www.facebook.com/thehackernews)
[**](https://twitter.com/thehackersnews)
[**](https://www.linkedin.com/company/thehackernews/)
[**](https://www.youtube.com/c/thehackernews?sub_confirmation=1)
[**](https://www.instagram.com/thehackernews/)

[** RSS Feeds](https://feeds.feedburner.com/TheHackersNews)
[** Email Alerts](#email-outer)

[![Salesforce Security Handbook](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWa8tsMNqlevi1HGF1ALQRGIq7hROPFAbHd3R1RTEOe73T8_Q2xW_-91t2jSGjU5peiPb8QYblGp4igNW-u2Qmlxbp2BKzTVMSvyXDZJmC-BYpiiJHrcnG5drmSP97iZ9PVIf1DeEr7U-7vWpe4HXwfMjt8FGNgq5mOycOJluYr9wF7YOKrQY9MfArwgjt/s728-e100/ai-agent-security-d.png)](https://thehackernews.uk/ai-agent-security-d)

# [Researchers Uncover OS Downgrade Vulnerability Targeting Microsoft Windows Kernel](https://thehackernews.com/2024/10/researchers-uncover-os-downgrade.html)

**Oct 28, 2024**Ravie LakshmananVulnerability / Windows Security

[![OS Downgrade Vulnerability](data:image/png;base64... "OS Downgrade Vulnerability")](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhSA6OqMJerGPFWg6AeADsejeV2RkcYdPxSOEvzZI1qEHefZudBwIaenT28meo_dCs67iT5-9fERxJl7rw33PP4wxXrdHHEXegt4M2hY37oX5G8S3olvYPwaq-ZZcY49A61WceYN0QITpxI8fuJezTqN3i0mJtIr3ddGa4EuXk2U55OTa4dv9aZiUsNoDJj/s790-rw-e365/windows.png)

A new attack technique could be used to bypass Microsoft's Driver Signature Enforcement (DSE) on fully patched Windows systems, leading to operating system (OS) downgrade attacks.

"This bypass allows loading unsigned kernel drivers, enabling attackers to deploy custom rootkits that can neutralize security controls, hide processes and network activity, maintain stealth, and much more," SafeBreach researcher Alon Leviev [said](https://www.safebreach.com/blog/update-on-windows-downdate-downgrade-attacks/) in a report shared with The Hacker News.

The latest findings build on an [earlier analysis](https://thehackernews.com/2024/08/windows-downgrade-attack-risks-exposing.html) that uncovered two privilege escalation flaws in the Windows update process ([CVE-2024-21302](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-21302) and [CVE-2024-38202](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38202)) that could be weaponized to rollback an up-to-date Windows software to an older version containing unpatched security vulnerabilities.

The exploit materialized in the form of a tool dubbed Windows Downdate, which, per Leviev, could be used to hijack the Windows Update process to craft fully undetectable, persistent, and irreversible downgrades on critical OS components.

[![DFIR Retainer Services](data:image/png;base64...)](https://thehackernews.uk/cloud-insight-d)

This can have severe ramifications, as it offers attackers a better alternative to Bring Your Own Vulnerable Driver ([BYOVD](https://techcommunity.microsoft.com/t5/microsoft-security-experts-blog/strategies-to-monitor-and-prevent-vulnerable-driver-attacks/ba-p/4103985)) [attacks](https://research.checkpoint.com/2024/breaking-boundaries-investigating-vulnerable-drivers-and-mitigating-risks/), permitting them to downgrade first-party modules, including the OS kernel itself.

Microsoft subsequently addressed CVE-2024-21302 and CVE-2024-38202 on August 13 and October 8, 2024, respectively, as part of Patch Tuesday updates.

The latest approach devised by Leviev leverages the Windows Downdate tool to downgrade the "ItsNotASecurityBoundary" DSE bypass patch on a fully updated Windows 11 system.

ItsNotASecurityBoundary was [first documented](https://www.elastic.co/security-labs/false-file-immutability) by Elastic Security Labs researcher Gabriel Landau in July 2024 alongside PPLFault, describing them as a new bug class codenamed False File Immutability. Microsoft remediated it earlier this May.

In a nutshell, it exploits a race condition to replace a verified [security catalog file](https://learn.microsoft.com/en-us/windows-hardware/drivers/install/catalog-files) with a malicious version containing authenticode signature for an unsigned kernel driver, following which the attacker prompts the kernel to load the driver.

Microsoft's code integrity mechanism, which authenticates a file using the kernel mode library [ci.dll](https://www.cybereason.com/blog/code-integrity-in-the-kernel-a-look-into-cidll), then parses the rogue security catalog to validate the signature of the driver and load it, effectively granting the attacker the ability to execute arbitrary code in the kernel.

The DSE bypass is achieved by making use of the downgrade tool to replace the "ci.dll" library with an older version (10.0.22621.1376) to undo the patch put in place by Microsoft.

That having said, there is a security barrier that can prevent such a bypass from being successful. If Virtualization-Based Security ([VBS](https://thehackernews.com/2024/05/windows-11-to-deprecate-ntlm-add-ai.html)) is running on the targeted host, the catalog scanning is carried out by the Secure Kernel Code Integrity DLL (skci.dll), as opposed to ci.dll.

However, It's worth noting that the default configuration is VBS without a Unified Extensible Firmware Interface (UEFI) lock. As a result, an attacker could turn it off by tampering with the EnableVirtualizationBasedSecurity and RequirePlatformSecurityFeatures registry keys.

Even in cases where UEFI lock is enabled, the attacker could disable VBS by replacing one of the core files with an invalid counterpart. Ultimately, the exploitation steps an attacker needs to follow are below -

* Turning off VBS in the Windows Registry, or invalidating SecureKernel.exe
* Downgrading ci.dll to the unpatched version
* Restarting the machine
* Exploiting ItsNotASecurityBoundary DSE bypass to achieve kernel-level code execution

The only instance where it fails is when VBS is turned on with a UEFI lock and a "Mandatory" flag, the last of which causes boot failure when VBS files are corrupted. The Mandatory mode is enabled manually by means of a registry change.

[![CIS Build Kits](data:image/png;base64...)](https://thehackernews.uk/platform-shield-d)

"The Mandatory setting prevents the OS loader from continuing to boot in case the Hypervisor, Secure Kernel, or one of their dependent modules fails to load," Microsoft [notes](https://learn.microsoft.com/en-us/windows/security/hardware-security/enable-virtualization-based-protection-of-code-integrity) in its documentation. "Special care should be used before enabling this mode, since, in case of any failure of the virtualization modules, the system will refuse to boot."

Thus, in order to fully mitigate the attack, it's essential that VBS is enabled with UEFI lock and the Mandatory flag set. In any other mode, it makes it possible f...