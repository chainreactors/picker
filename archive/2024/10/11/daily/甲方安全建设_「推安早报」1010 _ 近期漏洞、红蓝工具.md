---
title: 「推安早报」1010 | 近期漏洞、红蓝工具
url: https://mp.weixin.qq.com/s?__biz=MzU0MDcyMTMxOQ==&mid=2247487728&idx=1&sn=c5bab130b8939748b305e97018968ca2&chksm=fb35b938cc42302eb6ee9d5c39cd5bd24a55f006fc9e15428ee399e70b9f8427971dc69c421b&scene=58&subscene=0#rd
source: 甲方安全建设
date: 2024-10-11
fetch_date: 2025-10-06T18:53:48.798933
---

# 「推安早报」1010 | 近期漏洞、红蓝工具

![cover_image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKuKQJoSicGo0jUPBjEOzC9MBSot9qQgKmticVzgFPqprXYbUWZkibMwib7ng/0?wx_fmt=jpeg)

# 「推安早报」1010 | 近期漏洞、红蓝工具

red4blue

甲方安全建设

# 2024-10-10 「红蓝热点」每天快人一步

> 1. 推送`「新、热、赞」`，帮部分人`阅读提效`
> 2. 学有`精读浅读深读`，艺有`会熟精绝化`，觉知此事`重躬行`。推送只在`浅读预览`
> 3. 机读为主，人工辅助，每日数万网站，10w推特速读
> 4. 推送可能`大众或小众`，不代表本人偏好或认可
> 5. 因渲染和外链原因，公众号`甲方安全建设`发送`日报`或日期,如`20241010`获取`图文评论版pdf`

### 目录

> 0x01 【2024-0927】CUPS打印系统漏洞报告泄露
> 0x02 【2024-0927】CUPS漏洞快速概念验证
> 0x03 【2024-0927】恶意软件虚拟化在EDR时代的逃避策略
> 0x04 【2024-0927】利用ProxyNotShell后的Exchange PowerShell：无参数构造函数
> 0x05 【2024-0927】中国防火墙引发的漏洞问题
> 0x06 【2024-0928】通过RPC调用Google Chrome提升服务解密App绑定密钥
> 0x07 【2024-0928】Supermicro 系统漏洞 CVE-2024-36435 的 PoC 工具
> 0x08 【2024-0929】Office URI方案中的NTLMv2哈希捕获漏洞
> 0x09 【2024-0929】检测和缓解Active Directory的妥协
> 0x0a 【2024-0929】CVE-2024-6769：利用激活缓存漏洞从中等权限提升至高权限
> 0x0b 【2024-0929】Zimbra邮件平台远程命令执行漏洞（CVE-2024-45519）
> 0x0c 【2024-1009】Ruby-SAML库中的GitLab认证绕过漏洞分析
> 0x0d 【2024-1009】通过iTunes利用的Windows本地权限提升漏洞
> 0x0e 【2024-1009】Zimbra Postjournal漏洞利用指南
> 0x0f 【2024-1009】PrintNightmare漏洞仍未解决
> 0x10 【2024-1009】C#程序查找Windows Defender文件夹排除项
> 0x11 【2024-1009】TeamViewer漏洞利用：非特权用户加载任意内核驱动
> 0x12 【2024-1009】识别常见EDR进程和服务的工具Invoke-EDRChecker
> 0x13 【2024-1009】基于Socks5代理的Windows管理员级植入工具包
> 0x14 【2024-1009】CVE-2024-38816 路径遍历漏洞概念验证
> 0x15 【2024-1010】Pwnlook：一款控制Outlook应用的攻击后利用工具
> 0x16 【2024-1010】利用Visual Studio转储文件的CVE-2024-30052漏洞

### 0x01 CUPS打印系统漏洞报告泄露

> CUPS系统的多个组件存在漏洞，可能导致远程代码执行。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKuv0nEPXBnwGQqIaibvoNfNaW2EVyI5a9nS34iboqfGZJDBkTMiblJOzicCg/640?from=appmsg)

### 热评

### 关键信息点

* CUPS打印系统的漏洞可能导致严重的安全风险，包括远程代码执行。
* 漏洞利用的方式包括通过UDP端口631接收任何来源的自定义数据包，以及通过mDNS广播。
* 受影响的系统包括多种GNU/Linux发行版、Google ChromeOS和大多数BSD系统。
* 漏洞的根本原因在于CUPS打印机发现机制（cups-browsed）和其他CUPS系统组件没有对外部输入进行足够的消毒和验证。

🏷️: CUPS, 漏洞, 泄露, OpenPrinting, GitHub

### 0x02 CUPS漏洞快速概念验证

> Cupshax 网页提供了一个针对最近 CUPS 漏洞的快速概念验证（PoC），该漏洞允许远程代码执行。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKuxQmnwG9MywWDKmPAoictaqY8xibicgMsnmoWib5f1Gic4a8DAibGuoTAZKLQ/640?from=appmsg)

### 热评

* CUPS 漏洞允许 Linux 远程代码执行

### 关键信息点

* Cupshax 是针对 CUPS 漏洞的一个快速开发的 PoC 工具。
* 该工具的开发受到了公开的 OpenPrinting CUPS 仓库中的一个提交的启发，但由于 embargo 提前结束，工具代码相对仓促。
* Cupshax 依赖于 dns-sd 打印机发现，需要目标设备与攻击者在同一网络中。
* 利用工具使用了 zeroconf 和 ippserver，可以通过 pip 安装。

🏷️: CUPS, 漏洞, 技术细节, PoC, dns-sd

### 0x03 恶意软件虚拟化在EDR时代的逃避策略

> 網頁主要介述了在端點检测和响应(EDR)技術日益先进的情况下，紅隊如何通過恶意软件虚拟化技術來实现对EDR系统的逃避。

### 热评

* EDR时代下的红队攻击：利用恶意软件虚拟化逃避端点检测
* EDR 时代下的红队攻击：利用恶意软件虚拟化绕过终端检测

### 关键信息点

* 随着EDR系统的不断提升，攻击者需要不断改进他们的方法来逃避检测。
* 传统的杀毒Signature检测已不再有效，打包器和多态引擎出现了，但它们也面临着被检测的问题。
* 恶意软件的虚拟化能够有效地隐藏攻击者的真实intent和code flow，通过这种方式来逃避EDR的检测。
* 使用自定义虚拟机和Bytecode可以实现恶意软件的高度定制和逃避检测的能力。

🏷️: 恶意软件, EDR, 虚拟化, 逃避策略, 网络安全

### 0x04 利用ProxyNotShell后的Exchange PowerShell：无参数构造函数

> 本文详细介绍了 PowerShell Remoting 中的 `ConvertViaNoArgumentConstructor` 转换机制，并展示了如何利用这一机制发现三个新的 Exchange 漏洞，分别是 XXE 文件读取、NTLM 中继以及对 CVE-2023-36035 的部分绕过。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKuGVibXv2yPrfYQHYhNsRgMBGwtbZsibqISme7ebyu4NVX35LC968ibZRIQ/640?from=appmsg)
![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKuvJRUQeHDVMlnSglXjvLBwBAQz370zcLWic1jhFrMo8FmfJPOuEHGqPw/640?from=appmsg)
![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKuGmcYJZ7YFWtpsGeg1RHxjaFAvbmJLRkqWTN9lKZcXVkmhE4JJKNtiaA/640?from=appmsg)

<<<左右滑动见更多 >>>

### 热评

### 关键信息点

* `ConvertViaNoArgumentConstructor` 的强大能力：这一转换机制允许攻击者通过允许的类型的成员进行反序列化，即使这些成员的类型不在允许列表上。这显著扩大了攻击面。
* 成员反序列化的风险：即使成员没有公共 setter，或者有 setter 但不是公共的，反序列化过程仍然会发生。
* 微软对 NTLM 中继的态度：微软认真对待 Exchange 中的 NTLM 中继漏洞，因为它可能导致权限提升。
* 安全加固的挑战：即使在对 PowerShell Remoting 进行加固后，仍然存在利用允许的类型成员进行攻击的漏洞。

🏷️: Exchange, PowerShell, 漏洞利用, 网络安全, ProxyNotShell

### 0x05 中国防火墙引发的漏洞问题

> Assetnote 发现并研究了一种由中国防火长城引起的 DNS 污染问题，该问题可能影响数百万个域名，并可能导致子域名接管和其他安全风险。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKurBbYamImQ2nsL70BQ3Fu9BqHSGVNxLhCLic4VKRfibMPIqUMyLcFM4QQ/640?from=appmsg)
![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKu4bkmxbKlcoiaYVILL49jE5H9m7HgSZRzDiafYoFjficjiaQkK3ukcq0HIQ/640?from=appmsg)

<<<左右滑动见更多 >>>

### 热评

* 中国域名DNS污染影响3000万+域名，PrettyRecon可查询受影响域名
* DNS 污染影响数千万域名：研究揭示中国域名服务器风险

### 关键信息点

* DNS 污染问题：中国防火长城通过篡改 DNS 查询结果，导致域名解析到随机或特定的 IP 地址，这种行为可能是出于审查目的。
* 影响范围广泛：受影响的域名不仅限于 .cn 顶级域名，任何通过中国基础设施路由的域名都可能受到影响。
* 关键词触发：DNS 污染行为似乎基于子域名中的关键词触发，这些关键词与中国审查的内容相关联。
* 安全风险：这种 DNS 污染可能导致子域名接管、XSS 攻击以及其他安全问题。

🏷️: 防火墙, 漏洞, DNS, 攻击, 中国

### 0x06 通过RPC调用Google Chrome提升服务解密App绑定密钥

> 该网页提供了一个Proof-of-Concept (PoC) 示例，用于通过对 Google Chrome Elevation Service 的远程过程调用 (RPC) 来解密应用程序绑定的加密密钥。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKu8kN5x81qUyPJYscpO4xV0PxgbzELAr1t6Od5TN9maicP47uKKY6Qicvg/640?from=appmsg)

### 热评

* 绕过App-Bound Chromium 加密：最小 PoC 示例
* Chromium 应用绑定加密被绕过，PoC 可解密 Local State 密钥

### 关键信息点

* Google Chrome Elevation Service 可以通过 RPC 调用来解密应用程序绑定的加密密钥。
* 通过提供的 C++ 代码，可以实现对存储在文件中的加密密钥进行解密的操作。
* 这个 PoC 展示了如何与 Elevation Service 进行交互，包括如何调用其提供的接口来执行解密操作。
* 代码中使用了 COM 技术和 Windows 特有的安全机制，如 `CoInitializeEx`、`CoCreateInstance` 和 `CoSetProxyBlanket`。

🏷️: Google Chrome, 加密, RPC调用, 安全漏洞, PoC

### 0x07 Supermicro 系统漏洞 CVE-2024-36435 的 PoC 工具

> 网页提供了一个名为 CVE-2024-36435.py 的 PoC（Proof of Concept）工具，用于展示 Supermicro 设备中的一个安全漏洞。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKuYruoBoEquz8qGc1dplbBaw72USjDqia8jvjc8P5Dr9Snf5MPb0ru6tA/640?from=appmsg)

### 热评

* 公开的 PoC 利用漏洞执行任意命令

### 关键信息点

* GitHub 仓库中的 CVE-2024-36435.py 文件是一个用于展示 Supermicro 设备漏洞的 PoC 工具。
* 该工具与 Supermicro 硬件的 CVE-2024-36435 漏洞相关。
* 网页显示了最新的提交记录，包括代码更新的细节和统计信息。
* 用户尝试执行某个操作时遇到了限制，这可能是由于权限不足、操作限制或其他技术问题。

🏷️: CVE-2024-36435, Supermicro, PoC, 漏洞, 网络安全

### 0x08 Office URI方案中的NTLMv2哈希捕获漏洞

> 网页主要介绍了 CVE-2024-38200 漏洞，该漏洞利用 Office URI 方案和 NTLM 认证机制，通过 HTTP 302 重定向到 UNC 路径，捕获 NTLMv2 哈希值，进而可能导致 NTLM Relaying 攻击，甚至可能在默认配置下通过两次点击就能获取域控制器权限。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKuFvqsQ2pdJTQSWToTdXqxibCUqA9BqEXibibKezABR43dsfdz8IaJicju0w/640?from=appmsg)

<<<左右滑动见更多 >>>

### 热评

* 微软Office NTLMv2 漏洞 CVE-2024-38200 披露与 PoC
* 微软Office NTLMv2 漏洞 CVE-2024-38200 披露与 PoC

### 关键信息点

* Office URI 方案可以被利用来捕获 NTLMv2 哈希值，这可能导致对域控制器的 NTLM Relaying 攻击。
* 利用 HTTP 302 重定向到 UNC 路径的方法，可以在用户无意中的情况下捕获哈希值。
* GPO 设置和 DNS 记录欺骗可以迫使 Office 应用程序进行自动认证，这使得哈希捕获更加容易。
* 浏览器的信任区域设置对 NTLM 认证行为有重要影响，攻击者可以利用这一点来实现自动认证。

🏷️: CVE, Office, URI, NTLMv2, 哈希

### 0x09 检测和缓解Active Directory的妥协

> 本网页主要介绍了如何检测和减轻针对微软Active Directory（AD）的攻击手段，包括Kerberoasting、AS-REP Roasting、密码喷雾、机器账户配额滥用、无约束委派、AD证书服务（AD CS）滥用、DCSync、ntds.dit转储、金票据、银票据以及金SAML等技术，并提供了相应的缓解策略和检测方法。

### 热评

* Active Directory安全指南：防御和检测攻击

### 关键信息点

* Active Directory是攻击者的主要目标：由于其在企业IT网络中的核心作用，Active Directory经常成为攻击者的目标。
* 安全配置和监控是关键：通过合理配置AD组件、使用强密码、限制权限和监控异常活动，可以显著降低攻击风险。
* 多因素认证（MFA）的重要性：MFA可以有效阻止许多攻击技术，如密码喷雾和无约束委派。
* 定期更改KRBTGT密码：为了防止Golden Ticket攻击，应定期更改KRBTGT账户的密码。

🏷️: Active Directory, 网络安全, 妥协检测, 缓解措施

### 0x0a CVE-2024-6769：利用激活缓存漏洞从中等权限提升至高权限

> 该网页详细介绍了利用DLL劫持和激活上下文缓存中毒攻击两个链式漏洞，从中等完整性级别提升到高完整性级别，进而实现本地提权攻击的技术细节和步骤。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKuNZ9DORx5mibiaTQnpJ5rDbiavq08bPEiczh8vI5A5LAS9JmlqODiaNia7aVA/640?from=appmsg)
![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKu3tfbxrVAUmR7atIfZ6vuM0oEcCTsXYTt7jfUjmibFia9zOVVZKMcxvYg/640?from=appmsg)
![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZmyq5bxfrpKjOKMIfnBkjKuNsHW31Et1NczyGjPdur06OSwbN695mo50IHkat6ibqXyiccqCOuKcuiaw/640?from=appmsg)

<<<左右滑动见更多 >>>

### 热评

### 关键信息点

* DLL劫持和激活上下文缓存中毒是提升权限的有效手段：通过这两个漏洞，攻击者可以从中等完整性级别提升到高完整性级别，并获得与管理员相同的权限。
* 激活上下文缓存中毒利用了CSRSS服务器的机制：攻击者可以通过构造恶意的激活上下文消息，使CSRSS服务器接受并使用恶意的XML清单，从而控制DLL的加载路径。
* ALPC攻击矢量是中毒激活缓存的关键：ALPC提供了一种跨进程通信的机制，攻击者可以利用它直接与CSRSS服务器通信，实现缓存中毒。
* 攻击者需要绕过安全检查以成功执行提权：文章中提到了微软在2022年10月的更新中增加的RID检查，攻击者需要找到方法绕过这些检查以确保提权攻击的成功。

🏷️: CVE-2024-6769, 激活缓存, DLL劫持, 权限提升, Ekoparty 2023

### 0x0b Zimbr...