---
title: Malware on the Google Play store leads to harmful phishing sites
url: https://buaq.net/go-133782.html
source: unSafe.sh - 不安全
date: 2022-11-02
fetch_date: 2025-10-03T21:30:21.817002
---

# Malware on the Google Play store leads to harmful phishing sites

* [unSafe.sh - 不安全](https://unsafe.sh)
* [我的收藏](/user/collects)
* [今日热榜](/?hot=true)
* [公众号文章](/?gzh=true)
* [导航](/nav/index)
* [Github CVE](/cve)
* [Github Tools](/tools)
* [编码/解码](/encode)
* [文件传输](/share/index)
* [Twitter Bot](https://twitter.com/buaqbot)
* [Telegram Bot](https://t.me/aqinfo)
* [Search](/search/search)

[Rss](/rss.xml)

[ ]
黑夜模式

![](https://8aqnet.cdn.bcebos.com/b2ec20180bb09d5f61e6a438dd76ce61.jpg)

Malware on the Google Play store leads to harmful phishing sites

A family of malicious apps from developer Mobile apps Group are listed
*2022-11-1 22:0:0
Author: [www.malwarebytes.com(查看原文)](/jump-133782.htm)
阅读量:25
收藏*

---

A family of malicious apps from developer [Mobile apps Group](https://play.google.com/store/apps/dev?id=5631376253411320738) are listed on Google Play and infected with Android/Trojan.HiddenAds.BTGTHB. In total, four apps are listed, and together they have amassed at least one million downloads.

Older versions of these apps have been detected in the past as different variants of Android/Trojan.HiddenAds. Yet, the developer is still on Google Play dispensing its latest HiddenAds malware.

This follows on the heels of [adware that was found on Google Play just a couple months ago from a rogue PDF reader](https://www.malwarebytes.com/blog/news/2022/08/adware-found-on-google-play-pdf-reader-servicing-up-full-screen-ads).

![Play1](https://www.malwarebytes.com/blog/news/2022/11/easset_upload_file30524_242884_e.png)

## Delayed ungratification

Our analysis of this malware starts with us finding an app named Bluetooth Auto Connect (full app information at the bottom of this article). When users first install this malicious app, it takes a couple of days before it begins to display malicious behavior.  Delaying malicious behavior is a common tactic to evade detection by malware developers.  It turns out that this app uses delays quite a bit, as you’ll discover in our analysis.

After the initial delay, the malicious app opens phishing sites in Chrome. The content of the phishing sites varies—some are harmless sites used simply to produce pay-per-click, and others are more dangerous phishing sites that attempt to trick unsuspecting users.  For example, one site includes adult content that leads to phishing pages that tell the user they've been infected, or need to perform an update.

The Chrome tabs are opened in the background even while the mobile device is locked.  When the user unlocks their device, Chrome opens with the latest site.  A new tab opens with a new site frequently, and as a result, unlocking your phone after several hours means closing multiple tabs.  The users browser history will also be a long list of nasty phishing sites.

![phish_site2](https://www.malwarebytes.com/blog/news/2022/11/easset_upload_file1212_242884_e.png)![phish_site3](https://www.malwarebytes.com/blog/news/2022/11/easset_upload_file73685_242884_e.png)![phish_site4](https://www.malwarebytes.com/blog/news/2022/11/easset_upload_file43610_242884_e.png)![phish_site5](https://www.malwarebytes.com/blog/news/2022/11/easset_upload_file6295_242884_e.png)

## Deeper analysis using LogCat

As per my last [blog post](https://www.malwarebytes.com/blog/news/2022/08/adware-found-on-google-play-pdf-reader-servicing-up-full-screen-ads), I once again used an Android OS test phone and plugged it into my laptop running *LogCat* via good old *Android Device Monitor.*To clarify, *LogCat* is usedto observe all logs created by installed apps and the Android OS, including the logs of this malware.  The first log entry from this malware came several hours after the initial installation.

```
10-20 05:11:07.504: D/sdfsdf(11987): {"adDelay":7200000,"flurryId":"YQBTHDXPVMFT3D7Z7Q92","chromeLink":"https://<phishing_URL>.com/?ts=1666264263370&id=344","showOuterAd":true,"firstAdDelay":259200000,"versionWithNoAd":"no"}
```

The first important datapoint of the log entry is what *LogCat* calls the *Tag*.  This usually is a descriptor of the log text like *ActivityManager.*In this case, they use an obfuscated tag of *sdfsdf* — another sign of willful deception.Diving into the *Text* segment of the log, where the important data is stored, there are couple of key datapoints: ***adDelay****, **chromeLink**,* and ***firstAdDelay**.*

First, the ***chromeLink*** is the URL of the phishing site to open in Chrome. Next, let’s look at the ***firstAdDelay*** datapoint with thevalue of*259200000.*This value is the length of delay to displaying the first ad in milliseconds—seventy-two hours. Add the several hours to this delay before the log entry is created, and you have roughly four days from the time the malicious app is installed to when it displays the first ad in Chrome.

Keep in mind that the delay length of each malware app varies.  Additionally, after the first ad is displayed, it then has an ***adDelay*** of *7200000*, or two hours.  It's unclear if that means to wait an additional two hours after the first ad delay, or display another ad two hours after the first ad.  Regardless, it is another example of using delays to obfuscate detection.  These type of log entries are recorded every fifteen minutes, constantly setting new time released ads.

After the delay time ends, the ad is then triggered to display.  At this instant, it creates additional log entries using *tag* *ActivityManager*.

```
10-24 08:26:30.476: I/ActivityManager(765): START u0 {act=android.intent.action.VIEW dat=https:// <phishing_URL>.com/... flg=0x14002000 pkg=com.android.chrome cmp=com.android.chrome/org.chromium.chrome.browser.ChromeTabbedActivity (has extras)} from uid 10062
```

```
10-24 08:26:31.026: W/ActivityManager(765): Activity pause timeout for ActivityRecord{736d893 u0 com.android.chrome/org.chromium.chrome.browser.ChromeTabbedActivity t11780}
```

These log entries are representative of when Chrome opens a new tab with a phishing site using activity *ChromeTabbedActivity.*After that point, unlocking the mobile device will reveal the ad.

## Tracing it back to code

Now that we have *LogCat* entries, the next step in our analysis is to trace back to where in the code this malicious behavior is happening.  To do that, we first need to look in the app’s *Manifest* file.

The *Manifest* file is basically a guide for the Android OS to use to run activities, services, and receivers of an app.  Each activity, service, and receiver contains code to be ran. Every Android app has a *Manifest* file.

Many times, the activities, services, and receivers used by a particular malware is unique.  However, at first glance at this malware it is hard to tell which activities, services, or receivers are running the malicious code.  This is where the *LogCat* entries can assist.  These logs are the *smoking gun* of exactly what activities, services, or receivers are triggering malicious behavior. Ironically, their attempt to obfuscate detection using a *LogCat* *tag* of *sdfsdf* made tracking the culprit easy. A quick search of *sdfsdf* in the code reveals it traces back to service name *com.github.libpackage.service.PushService*, and activity name *com.github.libpackage.view.NotificationActivity.*The use of the popular GitHub in the naming convention is yet another blatant attempt to obfuscate detection.  From there, we were able to further verify using the additional datapoints from the *LogCat* *text.*

## History of HiddenAds

Continuing to focus on Bluetooth Auto Connect, this app has had a long history of being infected with different variants of HiddenAds.  Note that other apps from *Mobile apps Group* have a similar history.

* Date of release 2020-12-??: Bluetooth Auto Connect v1.4 infected wtih Android/Trojan.HiddenAds.llib
* Date of release 2021-01-05: Bluetooth Auto Connect v1.8 infected wtih Android/Trojan.HiddenAds.llib
* Date of release 2021-01-11: Bluetooth Auto Connect v1.9 infected wtih Android/Trojan.HiddenAds.llib
* Date of release 2021-01-19: Bluetooth Auto Connect v2.2 infected w...