---
title: MSSQL for Pentester: NetExec
url: https://www.hackingarticles.in/mssql-for-pentester-netexec/
source: Hacking Articles
date: 2024-08-25
fetch_date: 2025-10-06T17:59:19.316548
---

# MSSQL for Pentester: NetExec

[Skip to content](#content)

Hacking Articles

## Recent Posts

* [AWS: IAM CreateLoginProfile Abuse](https://www.hackingarticles.in/aws-iam-createloginprofile-abuse/)
* [Privacy Protection: Encrypted DNS](https://www.hackingarticles.in/privacy-protection-encrypted-dns/)
* [Privacy Protection: Windows Privacy](https://www.hackingarticles.in/privacy-protection-windows-privacy/)
* [Privacy Protection: Browsers](https://www.hackingarticles.in/privacy-protection-browsers/)
* [Privacy Protection: Password Manager](https://www.hackingarticles.in/privacy-protection-password-manager/)

## Most Used Categories

* [CTF Challenges](https://www.hackingarticles.in/category/ctf-challenges/) (504)
  + [VulnHub](https://www.hackingarticles.in/category/ctf-challenges/vulnhub/) (311)
  + [HackTheBox](https://www.hackingarticles.in/category/ctf-challenges/hackthebox/) (164)
* [Penetration Testing](https://www.hackingarticles.in/category/penetration-testing/) (408)
* [Red Teaming](https://www.hackingarticles.in/category/red-teaming/) (126)
* [Website Hacking](https://www.hackingarticles.in/category/website-hacking/) (64)
* [Cyber Forensics](https://www.hackingarticles.in/category/cyber-forensics-tricks/) (68)
* [Privilege Escalation](https://www.hackingarticles.in/category/privilege-escalation/) (59)
* [Hacking Tools](https://www.hackingarticles.in/category/collection-of-hacking-tools/) (33)
* [Pentest Lab Setup](https://www.hackingarticles.in/category/pentest-lab-setup/) (29)

# [Hacking Articles](https://www.hackingarticles.in/)

Raj Chandel’s Blog

Search for:

Menu

* [Courses We Offer](https://www.hackingarticles.in/courses-we-offer/)
* [CTF Challenges](https://www.hackingarticles.in/ctf-challenges-walkthrough/)
* [Penetration Testing](https://www.hackingarticles.in/penetration-testing/)
* [Web Penetration Testing](https://www.hackingarticles.in/web-penetration-testing/)
* [Red Teaming](https://www.hackingarticles.in/red-teaming/)
* [Donate us](https://www.hackingarticles.in/donate-us/)

* [Home](https://www.hackingarticles.in/)
»* [MS-SQL Penetration Testing](https://www.hackingarticles.in/category/ms-sql-penetration-testing/)
»* [MSSQL for Pentester: NetExec](https://www.hackingarticles.in/mssql-for-pentester-netexec/)
»

[MS-SQL Penetration Testing](https://www.hackingarticles.in/category/ms-sql-penetration-testing/)

# MSSQL for Pentester: NetExec

[August 24, 2024June 19, 2025](https://www.hackingarticles.in/mssql-for-pentester-netexec/) by [Raj](https://www.hackingarticles.in/author/raj/)

**MSSQL NetExec Pentesting** is an essential technique for **red teamers** and **penetration testers** who want to automate attacks against **Microsoft SQL Servers**. Moreover, **NetExec (nxc)** offers a powerful **network exploitation tool** that replaces **CrackMapExec (CME)**, a tool previously favored by security professionals. Initially, **mpgn** actively maintained **CrackMapExec**, but **NetExec** later emerged as a more popular choice. In this article, we will cover the most relevant scenarios where this tool helps automate tasks like **password spraying**, **command execution**, **file upload**, and much more. Specifically, we will perform test cases on an **MSSQL server** using the **nxc tool**.

### Table of Contents

* **Lab Setup**
* **Password spray**
* **Password spray using Hashes**
* **Check Authentication**
* **DB Command execution using nxc**
* **Command execution using nxc**
* **Command execution with Hashes**
* **File upload and download**
* **Privilege escalation**
* **Enumeration on a different port number**
* **Conclusion**

### Lab Setup

Target Machine: Windows 10 (192.168.31.126)

Attacker Machine: Kali Linux (192.168.31.141)

For demonstration purposes, here we will be using the MSSQL service to show all the test cases. We have already setup the MSSQL server on the target machine and created few users for the running instance.

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh3wEu8LvNPe67Mrl56UhEAjIrl8n8gYsIpLe2d0gIYzYH2-S6cWYuntilSSpS0153iB2U9J2UsP44XPRHFB00SN1TySdY4pb7XZNLyt95M5skGai4w2hhoMVdV4moGI0GVLPy7eo5MItZnRSlc1xSF-3yNoNOZyq0kmWmTH1QTzeg3fFoGeZ8wgf4rp1pX/s16000/1.png)

### Password spray

To begin, we will create a dictionary of usernames as users.txt and passwords as pass.txt to check for valid credentials. Once prepared, we can run a **password spray attack** to identify the correct **username-password** pair. We will perform this spray on the **MSSQL server**. The following command achieves this:

```
nxc mssql 192.168.31.126 -u users.txt -p pass.txt --continue-on-success
```

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjygUDtnxa-VHtss3eb18cD4VVjXpHCu58Ip-qAeeaiqj2t2EDdq5W18fe0b2_v4RtLZN1Z-qxO57GL6lU3MpLDEUgU1-A_Wc4KSctiEdek213mU0GFYoZx1BbnFVvKQX2ROibyhwllSlz-oXXDnZUN_-s-oAsF08Z4U6WdKjAXhS8oGPsOIZTP8-O2Q8VT/s16000/50.png)

To perform the password spray using the local authentication, we can use the **–local-auth** flag as it specifies that the authentication attempts should be made against the local accounts on the MSSQL server.

```
nxc mssql 192.168.31.126 -u users.txt -p pass.txt --continue-on-success --local-auth
```

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgq6IcqaEJW0rZwJzvOIKOK3zQ2E9O_92zkHHKVxBJDLEfbTHDnMzAEerPIsw5rBDmlICd0zogfCdfd4yx56BD812-s-CGfTvlpbc4DtHXc75X9AjfgdB-fIbOv69BgpnTGtJaL5BJLpN6Xn9jnQyXXbt_Uraix8lbB_h30bGB2C1L24HpliQUKf847Ha2J/s16000/51.png)

### Password spray using Hashes

We can also perform the same if we have obtained a hash, but we are not sure that the hash belongs to which user. Here we will be passing a list of users and giving the obtained hash value in the -H flag.

```
nxc mssql 192.168.31.126 -u users.txt -H 64FBAE31CC352FC26AF97CBDEF151E03 --continue-on-success
```

![MSSQL NetExec Pentesting](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhqaehCKCMJKrRvT_7XZiNsP6oxCrUq5hFbhh0WtrI6lx2pb7mIw6C53uXZ0qc3iEn_E1r9mkOmSTE4DklxzaSDse4zkw0qllsVdn3XSnlT4WDXPGSStQluvhk9zihVkG-qDpTqcz3KFyIYrlx6Xg-GPpoCTuBCxMJMLwuu3cqR8GCB-tcd574vrtHyekPC/s16000/52.png)

If we want to perform password spray in such a way that each username should be used ony with its corresponding password from the list, then we can use the **–no-bruteforce** flag. If the username-password pair matches, it will proceed, otherwise it will skip to the next pair without trying other possible combinations.

```
nxc mssql 192.168.31.126 -u users.txt -p pass.txt --continue-on-success --no-bruteforce
```

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgFW9hG-kNouV0LJZEfD0jR1it7836EYsACS1aumwcfzP-EbzH8MFdhHDYFe25UG5SZGEVubQp8IJk_07BF-8itBk5fGssTxaZTdrQsSt60Fu1lyxNJxfDmCmOVUxEs9jmIGtOLbUtNoeJMLAgXJdGzffBQQp3oiNxBL_F4qUM6wsuXVAYYvu0bS9wQJFJF/s16000/4.png)

### Check Authentication

We can use two methods to authenticate to MSSQL i.e., **windows** or **local**, the default authentication is windows. To use local authentication, add the following flag **–local-auth** in the command. Here we are trying to perform the local authentication as **sa** user.

```
nxc mssql 192.168.31.126 -u sa -p 'Password@123' --local-auth
```

![MSSQL NetExec Pentesting](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0lkR0XP3LIcUEouqZ1u0uC7Ww-oPBEp2e96Hu6XSuktWWZHHvHnXA81-JTJqUzLDniINHpl1ji3EAJUU9ejnf_KPK1vvrSygzTG-lr22-3KJuTNIe6DhobCdU-44UuR8NeSoKFtsFuREV86ZVprgDwx3PdonMHyxYMgm0_kZKchluAEooTmI-FXgdfdQK/s16000/6.png)

As mentioned previously, we can also test for the window’s authentication. Since the default mode is set to windows authentication, hence we don’t need to give any authentication flag to perform windows authentication.

```
nxc mssql 192.168.31.126 -u administrator -p 'Ignite@987'
```

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrrm6TQppmpysvge1C3Ym9Db5Y1QzrgOj7glOkaXawWtu-vqc4RDJubDeappTkrdd-qTi9-JWHYyPUmBJX_vnx-5YPy2FWkgi1hRLobnM6kLFdxaizbCRHcuHRwU-n1-9XD8MX5CIY4Ff0fvVo53kVAsTQ1ZpaagwHkRWDauvkgWVY97y2tDL0q6jFoUc_/s16000/7.png)

### DB Command e...