---
title: Rhysida ransomware Malware Analysis - Part 1: Dynamic analysis
url: https://www.secjuice.com/rhysida-ransomware-malware-analysis-part-1-dynamic-analysis/
source: Over Security - Cybersecurity news aggregator
date: 2024-03-12
fetch_date: 2025-10-04T12:13:03.303389
---

# Rhysida ransomware Malware Analysis - Part 1: Dynamic analysis

[![Secjuice](https://www.secjuice.com/content/images/2018/12/Logo-1.png)](https://www.secjuice.com)

* [Donate](https://opencollective.com/secjuice)
* [About Us](https://secjuice.com/about-us/)
* [Technical](https://secjuice.com/tag/technical/)
* [OSINT](https://secjuice.com/tag/OSINT/)
* [Unusual Journeys](https://secjuice.com/tag/unusual-journeys-into-infosec/)
* [HoF](https://secjuice.com/secjuice-hall-of-fame/)
* [Write With Us](https://secjuice.com/join-secjuice-writing-team/)
* [Hire A Writer](https://secjuice.com/hire-infosec-cybersecurity-writer/)
* [Rankings](https://secjuice.com/secjuice-writers-ranking/)

[Sign in](#/portal/signin)
[Subscribe](#/portal/signup)

# Rhysida ransomware Malware Analysis - Part 1: Dynamic analysis

* [![Andy74](/content/images/size/w100/2020/01/avatar.png)](/author/andy74/)

#### [Andy74](/author/andy74/)

Mar 11, 2024
â€¢ 37 min read

![Rhysida ransomware Malware Analysis - Part 1: Dynamic analysis](/content/images/size/w2000/2024/03/IMG_7729.webp)

This AI-generated image was created on Midjourney and curated by Tom Caliendo.

> This article is very different from one of my classic **HTB walkthroughs**. Driven by one of my greatest passions and by the recent articles of another **Secjuice** author, [fairycn](https://www.secjuice.com/author/fairycn/), whom I thank for his detailed series of articles on **malware analysis** and [secprentice](https://www.secjuice.com/author/secprentice/) that gave the idea about the malware's name, I moved towards writing a tutorial on a specific case; the reversal of one of the **malware** which has affected a large number of victims since mid-2023: **Rhysida ransomware**. I want to underline that I will not go through all the points of a complete **malware analysis**, but rather I will focus and concentrate my efforts on the **dynamic analysis**.

# Introduction

The article aims to serve not only as a tutorial but also as an analysis of the effects of the well-known ransomware named **Rhysida**. Its main objective is to examine the process of recovering files lost during an attack, providing an alternative that avoids succumbing to the threats of the attacker. To date, approximately a year after the initial appearance of the malware, a tool has finally emerged in recent months, enabling the automatic recovery of lost documents. This tutorial guides through the secure analysis of a virus, highlighting some reverse engineering techniques used during the dynamic analysis of the malware, and ultimately explaining how it was possible to identify the vulnerability that allowed researchers to develop a tool for restoring files damaged by the virus.

# **Sandbox preparation**

First of all, you need to obtain a copy of the **ransomware**. There are several online sources and portals where you can download versions of files infected with any type of **malware** (*viruses, spyware, keyloggers, ransomware, etc.*). There are also many builders that allow you to create your own customized version of viruses (including ransomware), easily found on the internet through simple searches. For this tutorial, a classic version was retrieved, downloaded from one of the many **Git repositories** where entire "malware collections" can be found.

One of the most crucial steps in approaching malware analysis is to "get safe" In this case, "making yourself safe" means preparing a **sandbox** in your laboratory. By **sandbox**, we mean a "controlled environment" in which the malware can be executed, allowing it to act freely to understand its behavior. Documents of zero relevance will be placed inside the sandbox to offer the malware some files to infect. Another characteristic of the sandbox is to be ***isolated from the rest of the ecosystem*** forming the network of the entire laboratory. Essentially, it must be possible to ***disable the sandbox network***, making it impossible for the malware to identify and/or connect to other devices. Tools can be installed within the sandbox for *identifying* the binary, *disassembling* it, and *debugging* it. In short, from the description, a sandbox is nothing more than a *virtual machine* disconnected from any type of network.

After installing the **OS** (I chose a light version of **windows 11**) and **IDA Freeware**, you will have to proceed to load the malware and some documents (images, PDFs, text files, etc.). It will be important to ***disconnect the network*** once this setup phase is finished, ***eliminate any folders shared with the HOST, and any other type of connection that can connect the VM with the laboratory network*** (*USB, Bluetooth, etc.*). Before starting, it is possible to take a **snapshot** of the VM so that you can restore its state if you want to proceed from the starting point again. At this point, you are practically ready to start the ransomware and observe the harmful effects it brings.

# Dynamic malware analysis

Although this is a dynamic analysis, understanding a minimum of the behavior of the malware is necessary, after a few launches, which in any case have not done too much damage (Windows 11 seems to be immune at least in the folders where the authorization rights are well set), the infection of the files is successful (lowering exactly those rights on the signs).

![](https://www.secjuice.com/content/images/2024/03/img_01.png)![](https://www.secjuice.com/content/images/2024/03/img_02.png)

Once the effect of the malware has been ascertained, the VM is restarted to begin a debug session with **IDA**.

> For those who are not very familiar with IDA and are not particularly familiar with reading the assembler code, I suggest also installing Ghidra, a decompilation tool that can help with reading the code and which will be used in the second part of this article.

A first reflection on malware is that it must be started in the background, otherwise, despite the speed of propagation of the virus, a relatively prepared user could stop it in time before it does too much damage. However, this is not impossible if you consider the possibility of starting scripts by downloading files via phishing emails.

The first lines of code are relatively simple:

1. recover the OS time (**call time**)
2. generate a random number using the seed of the time just recovered (**call srand**)
3. get the current path of the running process (**call getcwd**)
4. retrieve system information (**call \_\_imp\_GetSystemInfo**) to access the number of available processors (**sysinfo.dwNumberOfProcessors**)

```
[...]
.text:000000000041979B 55                      push    rbp
.text:000000000041979C 57                      push    rdi
.text:000000000041979D 56                      push    rsi
.text:000000000041979E 53                      push    rbx
.text:000000000041979F 48 81 EC 78 02 00 00    sub     rsp, 278h
.text:00000000004197A6 48 8D AC 24 80 00 00 00 lea     rbp, [rsp+80h]
.text:00000000004197AE 89 8D 20 02 00 00       mov     [rbp+210h+argc], ecx
.text:00000000004197B4 48 89 95 28 02 00 00    mov     [rbp+210h+argv], rdx
.text:00000000004197BB E8 C0 E5 02 00          call    __main
.text:00000000004197C0 B9 00 00 00 00          mov     ecx, 0          ; Time
.text:00000000004197C5 E8 5E 1A 03 00          call    time
.text:00000000004197CA 89 C1                   mov     ecx, eax        ; Seed
.text:00000000004197CC E8 AF 1A 03 00          call    srand
.text:00000000004197D1 48 8D 85 90 00 00 00    lea     rax, [rbp+210h+cwd]
.text:00000000004197D8 BA 04 01 00 00          mov     edx, 104h       ; SizeInBytes
.text:00000000004197DD 48 89 C1                mov     rcx, rax        ; DstBuf
.text:00000000004197E0 E8 23 1A 03 00          call    getcwd
.text:00000000004197E5 48 8D 45 60             lea     rax, [rbp+210h+sysinfo]
.text:00000000004197E9 48 89 C1                mov     rcx, rax        ; lpSystemInfo
.text:00000000004197EC 48 8B 05 79 BD 05 00    mov     rax, cs:__imp_GetSystemInfo
.text:00000000004197F3 FF D0                   call   ...