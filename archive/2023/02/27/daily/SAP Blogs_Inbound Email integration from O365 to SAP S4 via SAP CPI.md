---
title: Inbound Email integration from O365 to SAP S4 via SAP CPI
url: https://blogs.sap.com/2023/02/26/inbound-email-integration-from-o365-to-sap-s4-via-sap-cpi/
source: SAP Blogs
date: 2023-02-27
fetch_date: 2025-10-04T08:10:44.730203
---

# Inbound Email integration from O365 to SAP S4 via SAP CPI

* [SAP Community](/)
* [Products and Technology](/t5/products-and-technology/ct-p/products)
* [Technology](/t5/technology/ct-p/technology)
* [Technology Blog Posts by Members](/t5/technology-blog-posts-by-members/bg-p/technology-blog-members)
* Inbound Email integration from O365 to SAP S4 via ...

Technology Blog Posts by Members

All communityThis categoryBlogKnowledge baseUsersManaged tags

cancel

[Turn on suggestions](https://community.sap.com/t5/blogs/v2/blogarticlepage.enableautocomplete%3Aenableautocomplete?t:ac=blog-id/technology-blog-members/article-id/161319&t:cp=action/contributions/searchactions)

Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type.

Showing results for

Search instead for

Did you mean:

We have just launched our new Developer forums! Check out more in
[this What's New post](https://community.sap.com/t5/what-s-new/new-developer-forums/ba-p/14230147) (This banner is now dismissible.)

Read only

## [Inbound Email integration from O365 to SAP S4 via SAP CPI](/t5/technology-blog-posts-by-members/inbound-email-integration-from-o365-to-sap-s4-via-sap-cpi/ba-p/13557628)

![sowmya_dutta_burra](https://avatars.profile.sap.com/5/2/id52c8d3a29e171a4305d14a62c03e0afd17ccd4f5c2e810d07fabde9c235c48d5_small.jpeg "sowmya_dutta_burra")

[sowmya\_dutta\_burra](https://community.sap.com/t5/user/viewprofilepage/user-id/714690)

Explorer

Options

* [Subscribe to RSS Feed](/khhcw49343/rss/message?board.id=technology-blog-members&message.id=161319)
* Mark as New
* Mark as Read
* Bookmark
* Subscribe
* [Printer Friendly Page](/t5/blogs/blogarticleprintpage/blog-id/technology-blog-members/article-id/161319)
* [Report Inappropriate Content](/t5/notifications/notifymoderatorpage/message-uid/13557628)

‎2023 Feb 26
10:25 PM

[3
Kudos](/t5/kudos/messagepage/board-id/technology-blog-members/message-id/161319/tab/all-users "Click here to see who gave kudos to this post.")

21,527

* SAP Managed Tags
* [Cloud Connector](https://community.sap.com/t5/c-khhcw49343/Cloud%2520Connector/pd-p/0f95abc4-29f3-477d-874c-7c758b81f779)

* [Cloud Connector

  Additional Software Product](/t5/c-khhcw49343/Cloud%2BConnector/pd-p/0f95abc4-29f3-477d-874c-7c758b81f779)

View products (1)

This blog is an overview on flow and the high-level setup involved in Inbound Email integration from O365 to SAP via SAP CPI.

**High-level flow –**

The email ids on which incoming mails reach SAP system are to be identified and setup in O365 in customer’s domain. SAP CPI polls these mailboxes at set polling interval for new mails and whenever there is one, it is picked and forwarded to the configured backend system. SAP S4 has to be configured to receive mails.

For this flow to function, SAP CPI has to be

* integrated with Outlook to be able to read content of these mailboxes when authenticated via OAuth2 on IMAPS protocol

* integrated with backend SAP S4 system via Cloud Connector on SMTP protocol to forward the mails fetched from O365 on nominated mailboxes

![](/legacyfs/online/storage/blog_attachments/2023/02/Inbound-email-flow.png)

Design - Inbound email integration

**Setup in O365 –**

The mailboxes for incoming mails to SAP S4 have to be setup in O365.  This can also be one or more shared mailboxes. Mails from external mail servers are sent to these mailboxes.

**Setup in Azure AD –**

Setup a user with subscription to O365. If you have shared mailboxes, assign them to this user. The user as well as the shared mailboxes must be IMAP enabled.

In simple terms, OAuth 2.0 is a type of authorization flow with different grant types; and grant type is the way in which an application gets access. You are allowed to connect to O365 via OAuth2 with authorization code grant type.

Register a new application in Azure AD with the Redirect URI of your CPI tenant. The authorization token generated by this app must be configured to be consumed by the user created in the prior step.

The application should be granted permissions either of these ways -

* Admin consents permissions to the application or

* A user grants consent to the application or

* Add delegated permissions between the account and the Azure application via Graph API - *offline\_access, SMTP.Send, IMAP.AccessAsUser.All*

**Configuration in SAP CPI –**

In SAP CPI,

* Create OAuth2 Authorization code credential

* An iflow has to be configured with –

  + Sender Mail Adapter to pickup mails from O365 – outlook.office365.com on IMAPS with OAuth2 Authorization Code; select Outlook folder from where mails have to be picked & polling interval

  + Receiver Mail Adapter to send mails to SAP S4 – with address of virtual host & port as defined on SAP Cloud Connector on SMTP protocol

**Configuration in SAP Cloud connector (SCC) –**

In the SAP Integration Suite sub-account, create a destination for the backend system of type TCP on SMTP port. If you have multiple application servers, you can use a load balancer between SCC & SAP S4 that is capable of balancing SMTP traffic based on health and load of the application server. Note that Web dispatcher is not an option for SMTP load balancing.

**Configuration on SAP S4 –**

Setup profile parameters.

Enable the SICF node SAPConnect & provide a system user credentials in Access & Control.

**Conclusion –**

Overall, this method of integration for inbound emails is more transparent to SAP consultants with routing rules and flow defined in SAP CPI & SAP Cloud Connector. I have referenced pages & blogs that have screenshots and detailed configuration steps. You can post any questions in the comments section.

**References –**

<https://launchpad.support.sap.com/#/notes/455140>

[https://help.sap.com/docs/CLOUD\_INTEGRATION/368c481cd6954bdfa5d0435479fd4eaf/f1145cc852ff476db659dc5...](https://help.sap.com/docs/CLOUD_INTEGRATION/368c481cd6954bdfa5d0435479fd4eaf/f1145cc852ff476db659dc527372fe41.html?locale=en-US)

[https://blogs.sap.com/2022/03/04/cloud-integration-sending-email-from-microsoft-365-to-sap-backend-i...](https://blogs.sap.com/2022/03/04/cloud-integration-sending-email-from-microsoft-365-to-sap-backend-in-private-network-using-sap-cloud-connector/)

<https://blogs.sap.com/2020/08/20/cloud-intgration-connect-to-microsoft-365-mail-with-oauth2/>

* [email integration](/t5/tag/email%20integration/tg-p/board-id/technology-blog-members)
* [Inbound Email integration](/t5/tag/Inbound%20Email%20integration/tg-p/board-id/technology-blog-members)
* [O365 to SAP](/t5/tag/O365%20to%20SAP/tg-p/board-id/technology-blog-members)

13 Comments

You must be a registered user to add a comment. If you've already registered, sign in. Otherwise, register and sign in.

* [Comment](/plugins/common/feature/oidcss/sso_login_redirect/providerid/sap_ids_prompt?redirectreason=permissiondenied&referer=https%3A%2F%2Fcommunity.sap.com%2Ft5%2Ftechnology-blog-posts-by-members%2Finbound-email-integration-from-o365-to-sap-s4-via-sap-cpi%2Fba-p%2F13557628%23comment-on-this)

Copy Link
![](https://community.sap.com/html/@EE5D5986E9F4E5657DCEACB7532B5C39/assets/bluesky-dark.svg)Bluesky
Linkedin

Related Content

* [A Smarter Move from Boomi and MuleSoft to SAP Integration Suite - Assessed, Automated, Validated](/t5/technology-blog-posts-by-members/a-smarter-move-from-boomi-and-mulesoft-to-sap-integration-suite-assessed/ba-p/14233647)
  in [Technology Blog Posts by Members](/t5/technology-blog-posts-by-members/bg-p/technology-blog-members)  Thursday
* [Using Joule’s Async Feature to Communicate with a Custom BTP App](/t5/technology-blog-posts-by-sap/using-joule-s-async-feature-to-communicate-with-a-custom-btp-app/ba-p/14231021)
  in [Technology Blog Posts by SAP](/t5/technology-blog-posts-by-sap/bg-p/technology-blog-sap)  Tuesday
* [Use BTP destination service to call SAC multi-actions API](/t5/technology-blog-posts-by-sap/use-btp-destination-service-to-call-sac-multi-actions-api/ba-p/14230819)
  in [Technology Blog Posts by SAP](/t5/technology-blog-posts-by...