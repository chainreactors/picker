---
title: Shiro CVE-2023-34478 路径规范化不一致
url: https://www.freebuf.com/vuls/421037.html
source: FreeBuf网络安全行业门户
date: 2025-02-04
fetch_date: 2025-10-06T20:38:50.366701
---

# Shiro CVE-2023-34478 路径规范化不一致

[![freeBuf](/images/logoMax.png)](/)

主站

分类

云安全

AI安全

开发安全

终端安全

数据安全

Web安全

基础安全

企业安全

关基安全

移动安全

系统安全

其他安全

特色

热点

工具

漏洞

人物志

活动

安全招聘

攻防演练

政策法规

[报告](https://www.freebuf.com/report)[专辑](/column)

* ···
* [公开课](https://live.freebuf.com)
* ···
* [商城](https://shop.freebuf.com)
* ···
* 用户服务
* ···

行业服务

政 府

CNCERT
CNNVD

会员体系（甲方）
会员体系（厂商）
产品名录
企业空间

[知识大陆](https://wiki.freebuf.com/page)

搜索

![](/freebuf/img/7aa3bf7.svg) ![](/freebuf/img/181d733.svg)

创作中心

[登录](https://www.freebuf.com/oauth)[注册](https://www.freebuf.com/oauth)

官方公众号企业安全新浪微博

![](/images/gzh_code.jpg)

FreeBuf.COM网络安全行业门户，每日发布专业的安全资讯、技术剖析。

![FreeBuf+小程序](/images/xcx-code.jpg)

FreeBuf+小程序把安全装进口袋

[![](https://image.3001.net/images/20231020/1697804527_653270ef7570cc7356ba8.png)](https://wiki.freebuf.com)

Shiro CVE-2023-34478 路径规范化不一致

* ![]()
* 关注

* [漏洞](https://www.freebuf.com/articles/vuls)

Shiro CVE-2023-34478 路径规范化不一致

2025-02-03 17:36:06

所属地 广东省

# 漏洞描述

pache Shiro, before 1.12.0 or 2.0.0-alpha-3, may be susceptible to a path traversal attack that results in an authentication bypass when used together with APIs or other web frameworks that route requests based on non-normalized requests.

**Mitigation:**Update to Apache Shiro 1.12.0+ or 2.0.0-alpha-3+.

**Credit:**Apache Shiro would like to thank **swifty tk**for reporting this issue.

# 漏洞条件

| shiro | 其他API或框架 |
| --- | --- |
| <1.12.0 or 2.0.0-alpha-3 | 路径匹配时不对路径进行规范化 |

> 所谓路径规范化是指对带有”/.."或“/."这样的路劲进行规范化，比如 ”/admin/page/.." 会被规范化为“/admin"

由漏洞描述可知，导致该漏洞出现的原因是shiro在匹配路径时会对路径进行规范化（normalize）,但是当使用路径匹配不基于规范化的API或框架时，会导致路径绕过攻击。

通过这个漏洞描述，可以联想到[CVE-2020-17510 分析](https://www.freebuf.com/vuls/420408.html)以及[CVE-2023-22602 分析](https://www.freebuf.com/vuls/421023.html)的漏洞原因都是如此，但这两个漏洞都是基于Spring框架的，且补丁都是争对spring这个框架进行的修复（spring的路径匹配不基于规范化）。当使用**其他**API或者框架（路径匹配不基于规范化）时，这些补丁就失效了，故会产生新的漏洞。

# 漏洞修复

由于该漏洞并不是争对某一框架或API,而是覆盖全部，所以漏洞复现，漏洞分析可以参考CVE-2020-17510和CVE-2023-22602这两个基于Spring框架的漏洞。

本次漏洞补丁： [commit](https://github.com/apache/shiro/commit/c3ede3f94efb442acb0795714a022c2c121d1da0?diff=unified&w=1)

由补丁可知，如果当请求路径中包含路径穿越相关符号，则无法被访问，因此这个补丁可以覆盖所有路径匹配不基于规范化的APIs或组件。

> 补充：
>
> InvalidRequestFilter会被作为“Global Filter”在初始化时被添加到所有pattern对应的过滤链中。

**Reference**

---

[1] [CVE-2020-17510 分析](https://www.freebuf.com/vuls/420408.html)

[2] [CVE-2023-22602 分析](https://www.freebuf.com/vuls/421023.html)

[3] [commit](https://github.com/apache/shiro/commit/c3ede3f94efb442acb0795714a022c2c121d1da0?diff=unified&w=1)

# 漏洞分析 # Shiro # Java代码审计

本文为 独立观点，未经授权禁止转载。
如需授权、对文章有疑问或需删除稿件，请联系 FreeBuf
客服小蜜蜂（微信：freebee1024）

被以下专辑收录，发现更多精彩内容

+ 收入我的专辑

+ 加入我的收藏

展开更多

相关推荐

![]()

关 注

* 0 文章数
* 0 关注者

![](/images/logo_b.png)

本站由阿里云 提供计算与安全服务

### 用户服务

* [有奖投稿](https://www.freebuf.com/write)
* [提交漏洞](https://www.vulbox.com/bounties/detail-72)
* [参与众测](https://www.vulbox.com/projects/list)
* [商城](https://shop.freebuf.com)

### 企业服务

* [安全咨询](https://company.freebuf.com)
* [产业全景图](https://www.freebuf.com/news/307349.html)
* [企业SRC](https://www.vulbox.com/service/src)
* [安全众测](https://www.vulbox.com/)

### 合作信息

* [斗象官网](https://www.tophant.com/)
* [广告投放](https://www.freebuf.com/articles/444331.html)
* [联系我们](https://www.freebuf.com/articles/444332.html)

### 关于我们

* [关于我们](https://www.freebuf.com/news/others/864.html)
* 微信公众号
* [新浪微博](http://weibo.com/freebuf)

### 战略伙伴

* [![](https://image.3001.net/images/20191017/1571306518_5da83c1686dd9.png)](http://www.aliyun.com/?freebuf)

### FreeBuf知识大陆

![](https://image.3001.net/images/20250703/1751535036_68664dbcae34ac40bb9e7.png)

扫码把安全装进口袋

* [斗象科技](https://www.tophant.com/)
* [FreeBuf](https://www.freebuf.com)
* [漏洞盒子](https://www.vulbox.com/)
* [斗象智能安全](https://ai.tophant.com/)
* [免责条款](https://www.freebuf.com/dis)
* [协议条款](https://my.freebuf.com/AgreeProtocol/duty)

Copyright © 2025 WWW.FREEBUF.COM All Rights Reserved
[沪ICP备2024099014号](https://beian.miit.gov.cn/#/Integrated/index) | [沪公安网备
![](https://image.3001.net/images/20200106/1578291342_5e12d08ec2379.png)](http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011502009321)