---
title: 记一次网络诈骗者站点的全过程与套路分析 - 渗透测试中心
url: https://www.cnblogs.com/backlion/p/18184290
source: 博客园 - 渗透测试中心
date: 2024-05-11
fetch_date: 2025-10-06T17:17:07.427535
---

# 记一次网络诈骗者站点的全过程与套路分析 - 渗透测试中心

[![](https://img2024.cnblogs.com/blog/35695/202509/35695-20250929100304557-587378723.jpg)](https://qoder.com/)

* [![博客园logo](//assets.cnblogs.com/logo.svg)](https://www.cnblogs.com/ "开发者的网上家园")
* [会员](https://cnblogs.vip/)
* [众包](https://www.cnblogs.com/cmt/p/18500368)
* [新闻](https://news.cnblogs.com/)
* [博问](https://q.cnblogs.com/)
* [闪存](https://ing.cnblogs.com/)
* [赞助商](https://www.cnblogs.com/cmt/p/19081960)
* [HarmonyOS](https://harmonyos.cnblogs.com/)
* [Chat2DB](https://chat2db-ai.com/)

* ![搜索](//assets.cnblogs.com/icons/search.svg)
  ![搜索](//assets.cnblogs.com/icons/enter.svg)
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    所有博客
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    当前博客
* [![写随笔](//assets.cnblogs.com/icons/newpost.svg)](https://i.cnblogs.com/EditPosts.aspx?opt=1 "写随笔")
  [![我的博客](//assets.cnblogs.com/icons/myblog.svg)](https://passport.cnblogs.com/GetBlogApplyStatus.aspx "我的博客")
  [![短消息](//assets.cnblogs.com/icons/message.svg)](https://msg.cnblogs.com/ "短消息")
  ![简洁模式](//assets.cnblogs.com/icons/lite-mode-on.svg)

  [![用户头像](//assets.cnblogs.com/icons/avatar-default.svg)](https://home.cnblogs.com/)

  [我的博客](https://passport.cnblogs.com/GetBlogApplyStatus.aspx)
  [我的园子](https://home.cnblogs.com/)
  [账号设置](https://account.cnblogs.com/settings/account)
  [会员中心](https://vip.cnblogs.com/my)
  简洁模式 ...
  退出登录

  [注册](https://account.cnblogs.com/signup)
  登录

[![返回主页](/skins/custom/images/logo.gif)](https://www.cnblogs.com/backlion/)

# [渗透测试中心](https://www.cnblogs.com/backlion)

##

* [博客园](https://www.cnblogs.com/)
* [首页](https://www.cnblogs.com/backlion/)
* [新随笔](https://i.cnblogs.com/EditPosts.aspx?opt=1)
* [联系](https://msg.cnblogs.com/send/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83)
* [管理](https://i.cnblogs.com/)
* 订阅
  [![订阅](/skins/coffee/images/xml.gif)](https://www.cnblogs.com/backlion/rss/)

# [记一次网络诈骗者站点的全过程与套路分析](https://www.cnblogs.com/backlion/p/18184290 "发布于 2024-05-10 14:40")

这是一则漫长又跌宕起伏的故事，小伙伴们请随意就坐，自备茶点；全文包含信息收集与攻克的详细全过程，以及对该类型诈骗思路的分析拆解，以提高防范意识；

## 0x00 梦的开始

那是一个阳光明媚的晌午，日常的搬砖过程中收到一封公司邮件，

![email-send](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143729151-835253458.png)

看到这熟悉的措辞，又瞄了一眼下面的附件内容，熟悉的气息扑面而来，就顺手保存了下来；

![email-qrcode](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143730315-155805369.png)

随即管理员立马发现了不对劲，追发邮件说员工账号被盗用，不要轻信邮件内容，原始邮件也被标为垃圾邮件（上次的类似邮件删的太突然，事情还没开始就结束了，这次总跑不掉了(￣\_,￣ )，作为当代好青年，五星好市民，是时候发扬一下活雷锋精神了）；

而这张图片，就成了一切梦开始的地方……

## 0x01 信息收集

### 0x001 审查域名

起始信息非常有限，开局一张图，剧情全靠猜，不过这个入口也足够了，先拿出家伙解析下二维码中的信息：

![email-qrcode-analyze-url](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143731345-420491845.png)

没有额外的数据，只有一串网页链接，看着这域名名称，嘴角微微上扬；先去解析一下域名：

![cmd-nslookup](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143732153-116398944.png)

到写文为止已经不能解析该域名了，整顿的倒挺快，不过好在之前有解析备份，域名万变不离其 IP，并且也没有发现使用 CDN，流量全部通往源站；顺手查了一下，是香港的服务器：

![front-query-ip](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143732895-381242991.png)

然后 whois 一下，搜集相关信息：

![cmd-whois](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143734209-982788253.png)

不出意外，又是用的三方注册机构，没有额外的有用信息，不过这个注册时间挺有意思，本月的，骗子同志动作还蛮快的；接下来只能去对方网站瞅瞅；

![front-west-whois](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143735912-1541041987.png)

又是西部数码，看来有些备受青睐，网站提供隐私保护机制，注册信息不对外公开，暂时也获取不到有用信息；

### 0x002 审查 IP

现在唯一的线索就是之前解析的那个 IP 了，一步一步来，先 nmap 扫一波端口服务先，收集更多信息：

![cmd-nmap-port-services](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143736795-1923594533.png)

嗯还行，看见了几个熟悉的身影，继续走流程，分别跑下默认脚本分析下端口服务信息：

![cmd-nmap-default-script](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143737388-1709067908.png)

没有探测倒匿名 ftp，http 支持 TRACE，没有设 httponly，有执行 XSS 的机会，小本本先记下；然后老规矩，默认字典定向爆破一轮先，尝试还是要有的，万一那啥了呢：

![cmd-nmap-ftp-brute](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143738035-1221249657.png)

剩余端口也都试了，意料之中，没啥收获，看来基本的密码强度意识还是有的；另外之前的扫描扫描中有出现 8888 这个端口，记得这个是服务器管理工具宝塔面板的默认后台入口，访问一下试试：

![front-baota-login-pre](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143738810-7707873.png)

有入口校验，起码证明确实是用的宝塔面板，不过这个爆破应该是不可能去爆破的，记得入口 url 后缀默认大概是 8 位任意大小写字母与数字的组合，就是 62 的 8 次方，大约两百万亿，就挺秃然的，先放在后面再说吧，接下来，继续转战其他方向；

### 0x003 审查页面

来都来了，既然扫码是跳转页面链接，并且端口也开放了 80 和 443，当然要打开网页访问一下康康，同时开启开发者工具，看看有啥小动作：

![front-home-mobile](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143739867-1306843246.png)

哎呀，还识别机型，这靶向用户还挺明确，那就切成移动端看看：

![front-home-index](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143742226-1028674942.png)

emm……怎么说呢，有那味儿了，咋一看还真看不出来，模仿的还挺全（不过胆也确实大，政府网站都搞），然后看了下接口返回的头信息，发现使用的 Windows IIS 7.5 + ASP.NET 的服务：

![front-home-headers](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143744239-1462442293.png)

这个先记着，后面漏洞挖掘用得着，后面试了一圈发现页面都是空壳，只有那个办理入口的弹窗能跳转，跳转页面是：

![front-apply-btn](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143745177-940311491.png)

描述的还挺全，好让大家都能对号入座，这里点下立即申请：

![front-input-name-id](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143745929-1599322522.png)

然后就开始了个人信息收集的一条龙服务，先是姓名和身份证号，另外，注意看旁边显示加载的 PNG 头图的名称，额难道这是开发者的疯狂暗示？？这里随便输入条信息进去看看：

![front-input-name-error](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143746653-1289938253.png)

居然还有校验，打个断点看看源码逻辑：

![front-input-name-breakpoint](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143747438-660022677.png)

一个号码校验都整的这么齐全，还真是费心了，不过前端的校验都是纸老虎，这里也不用什么偏方了，直接用开发者工具的源码编辑覆盖功能，直接给校验函数返回 true：

![front-input-name-override](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143748308-1197575595.png)

然后校验通过，进入下一个步骤：

![front-input-bank](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143749155-599920545.png)

这里是要收集银行卡号和密码以及绑定的手机号，唉，意图很明显，哪有打款转账还要对方密码的操作，这里也准备随便填下，银行卡校验用同样的方法绕过一下，不过在其中一个加载的脚本文件中发现了有意思的东西：

![front-input-bank-js-source](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143750083-234239597.png)

开发者连源码中的调试数据都不删除，调的阿里支付的接口，正好借对方调试账号用一下下（再次证明了作为开发者，生产环境中代码移除注释的重要性=\_=）：

![front-input-bank-amount](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143750806-59633663.png)

然后进入了下一个页面，再次收集姓名和证件号，以及银行卡余额（这里应该是对用户真实情况进行摸底以及其他未知操作），下意识查了自己的余额，唉果然这里连撒谎的勇气都没有 T\_T，马上填完进入下一步吧：

![front-input-bank-amount-value](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143751552-189815116.png)

![front-submit-loading](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143752269-1603016999.png)

然后页面会一直加载不断刷新，再无其他跳转，应该是给诈骗者提供操作的时间，那么网页的相关操作就暂时告一段落，大致了解了一些操作步骤，接下来探索一下其他方向；

## 0x02 漏洞挖掘

### 0x001 SQL 注入

信息收集差不多了，现在来逐个击破，先从最熟悉的网页端入手，前面审查页面时有不少提交表单和输入框，这些都是潜在的攻破点；挖掘技术哪家强，先祭出神器 Burp，拦截一下之前提交银行卡号密码的表单数据：

![burp-form-field](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143753069-1187845324.png)

然后对字段值进行简单注入尝试，检查报错信息：

![burp-sql-inject-simple](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143753844-377718129.png)

没反应，应该是有基础校验，再换个：

![burp-sql-inject-union-select](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143754587-1058184354.png)

有反应，似乎看到了希望，虽然返回乱码了，应该是对方程序处理问题，不过看句式像是 SQL 报错，又接连试了几个，也是同样的返回，那么剩下的冗杂工作，就交给工具进行吧，掏出 sqlmap 跑一波：

![cmd-sqlmap](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143755291-1208537793.png)

后面换了几轮参数也没成功，应该是过滤机制比较周到，然后在测试另一个页面时，才发现了那段报错信息的原本含义：

![burp-sql-inject-err-res](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143756082-2060479011.png)

嗯还是太年轻，会错意了，应该是程序识别到了字段值中的 SQL 关键字；另外回想起之前扫描到服务可能隐含 TRACE 相关漏洞，测试了下，应该是服务端暂未支持：

![burp-trace-method](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143756821-824053639.png)

然后又想了想，针对密码字段进行数据库表字段设计时，应该会考虑其字符位数低的特点，减少空间占用，因为这是银行卡密码，都知道是 6 位数字，这里传个大数看看有没有惊喜：

![burp-post-mass-data](https://img2023.cnblogs.com/blog/1049983/202405/1049983-20240510143757489-669353379.png)

尴尬，是有惊无喜，应该是没有特别处理，直接反馈为服务端错误；后面又陆续换了几个页面，测试下来都没太大收获，场面又一度陷入僵局，只能又暂时转移战场；

### 0x002 Metasploit 渗透

终于到...