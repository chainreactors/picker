---
title: Analysing Command Detected in Request Body
url: https://infosecwriteups.com/analysing-command-detected-in-request-body-1524b2744449?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2023-01-07
fetch_date: 2025-10-04T03:15:26.768410
---

# Analysing Command Detected in Request Body

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1524b2744449&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fanalysing-command-detected-in-request-body-1524b2744449&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fanalysing-command-detected-in-request-body-1524b2744449&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-1524b2744449---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-1524b2744449---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# **Command Injection in Request Body**

## **SOC168 — Whoami Command Detected in Request Body**

[![Mag Manoj](https://miro.medium.com/v2/resize:fill:64:64/1*8JeaBOtY7XlayeoRPHiFYw.jpeg)](https://medium.com/%40magmanoj?source=post_page---byline--1524b2744449---------------------------------------)

[Mag Manoj](https://medium.com/%40magmanoj?source=post_page---byline--1524b2744449---------------------------------------)

3 min read

·

Jan 6, 2023

--

Listen

Share

In this article, we going to analysis the Command injection Alert generated by LetsDefend.io

**What is Command Injection?**

Press enter or click to view image in full size

![]()

Command Injection

* Command injection is a type of vulnerability that allows an attacker to execute arbitrary commands on the host operating system via a vulnerable application.
* This can occur when an application passes unsafe user supplied data (e.g. form input) to a system shell without proper validation or sanitization.
* An attacker can use command injection to gain unauthorised access to sensitive data, execute malicious code or disrupt the intended functionality of the application.

Example:

**ls command injection** that lists directory contents of files and directories

Press enter or click to view image in full size

![]()

ls command Injection attack

**How to detect command injection ?**

* One way to detect command injection vulnerabilities in a web application is to search the source code for keywords that may indicate the use of system commands with unsanitized user input
* Some keywords to look for include:
* “Whois” , “dir”, “ls”, “cp”, “cat”, “type”
* “System”, “etc”, “exec”, “shell\_exec”
* “Whoami”

Press enter or click to view image in full size

![]()

Detect Command Injection by using snort

**SOC168 — Whoami Command Detected in Request Body**

Here is the generated alert,

Press enter or click to view image in full size

![]()

Alert given by <https://letsdefend.io/>

* Source IP address (61.177.172.87) attempted “Whoami” command injection attack on Web server 1004 (172.16.17.16).
* Request URL : <https://172.16.17.16/video/>

Let’s check about Source IP address:

Press enter or click to view image in full size

![]()

VirusTotal

This IP address was flagged as malicious. Also attackers make lots of attacks by using this IP address.

Press enter or click to view image in full size

![]()

AbuseIPDB

Lets, look into the Log Management

Press enter or click to view image in full size

![]()

log management

* There are several command injection ware made by this attacker(61.177.172.87).
* All attempts are responded with 200 HTTP Status with different HTTP response sizes.
* We are able to see that all the command injections made by the attacker were executed. By checking the command line History on web server 1004

![]()

command Line History on Webserver1004

**Playbook Answers:**

Press enter or click to view image in full size

![]()

playbook

* Yes, we need Tier 2 Escalation
* The Attack was successful
* The Direction of Traffic : Internet to company network
* There is NO Mail about Attack , this is not a Planned Test
* This is Command injection attack
* It is a Malicious Traffic

**Reference :**

[## LetsDefend - Blue Team Training Platform

### Online soc analyst and incident response training platform for blue team members

letsdefend.io](https://letsdefend.io/?source=post_page-----1524b2744449---------------------------------------)

[## What is OS command injection, and how to prevent it? | Web Security Academy

### In this section, we'll explain what OS command injection is, describe how vulnerabilities can be detected and…

portswigger.net](https://portswigger.net/web-security/os-command-injection?source=post_page-----1524b2744449---------------------------------------)

[Infosec](https://medium.com/tag/infosec?source=post_page-----1524b2744449---------------------------------------)

[Command Injection](https://medium.com/tag/command-injection?source=post_page-----1524b2744449---------------------------------------)

[Bug Bounty](https://medium.com/tag/bug-bounty?source=post_page-----1524b2744449---------------------------------------)

[Cybersecurity](https://medium.com/tag/cybersecurity?source=post_page-----1524b2744449---------------------------------------)

[Hacking](https://medium.com/tag/hacking?source=post_page-----1524b2744449---------------------------------------)

--

--

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:96:96/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--1524b2744449---------------------------------------)

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:128:128/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--1524b2744449---------------------------------------)

Follow

[## Published in InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---post_publication_info--1524b2744449---------------------------------------)

[71K followers](/followers?source=post_page---post_publication_info--1524b2744449---------------------------------------)

·[Last published 5 days ago](/how-to-find-p1-bugs-using-google-in-your-target-part-1-e37455324dc1?source=post_page---post_publication_info--1524b2744449---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow

[![Mag Manoj](https://miro.medium.com/v2/resize:fill:96:96/1*8JeaBOtY7XlayeoRPHiFYw.jpeg)](https://medium.com/%40magmanoj?source=post_page---post_author_info--1524b2744449---------------------------------------)

[![Mag Manoj](https://miro.medium.com/v2/resize:fill:128:128/1*8JeaBOtY7XlayeoRPHiFYw.jpeg)](https:/...