---
title: CS Xss2Rce CVE-2022-39197分析与复现
url: https://lorexxar.cn/2022/11/02/cs-xss2rce/
source: LoRexxar's Blog
date: 2022-11-03
fetch_date: 2025-10-03T21:36:45.308708
---

# CS Xss2Rce CVE-2022-39197分析与复现



[LoRexxar's Blog | 盲驴隆忙聛炉忙聤聙忙聹炉氓聢聠盲潞芦](/)

[LoRexxar's Blog | 盲驴隆忙聛炉忙聤聙忙聹炉氓聢聠盲潞芦](/)

CS Xss2Rce CVE-2022-39197氓聢聠忙聻聬盲赂聨氓陇聧莽聨掳



# CS Xss2Rce CVE-2022-39197氓聢聠忙聻聬盲赂聨氓陇聧莽聨掳

java
cs
CVE-2022-39197


2022/11/02




Share

* 
* 
* 
* 
* 

![](/assets/loading.svg)

氓聣聧忙庐碌忙聴露茅聴麓猫驴聶盲赂陋忙录聫忙麓聻猫垄芦忙聦聳忙聨聵氓聡潞忙聺楼盲鹿聥氓聬聨莽職聞忙聴露氓聙聶猫驴聵忙聵炉氓录聲氓聫聭盲潞聠氓戮聢氓陇職氓聟鲁忙鲁篓莽職聞茂录聦盲陆聠忙聵炉忙聹聙氓聢聺盲赂聙莽聸麓茅聝陆忙虏隆忙聹聣盲禄聙盲鹿聢氓聝聫忙聽路莽職聞氓聢聠忙聻聬忙聳聡莽芦聽氓聡潞忙聺楼茂录聦忙聹聙忙聴漏莽聹聥@忙录聜盲潞庐茅录聽莽職聞忙聳聡莽芦聽盲鹿聥氓聬聨忙聣聧氓陇搂盲陆聯盲赂聤氓炉鹿猫驴聶盲赂陋忙录聫忙麓聻忙聹聣盲潞聠盲赂聙盲赂陋氓聼潞忙聹卢莽職聞猫庐陇猫炉聠茫聙聜

<https://mp.weixin.qq.com/s/l5e2p_WtYSCYYhYE0lzRdQ>

盲陆聠忙聵炉盲赂聧莽聼楼茅聛聯忙聵炉忙聢聭莽職聞java忙掳麓氓鹿鲁莽聹聼莽職聞盲赂聧氓陇聼茂录聦氓聫聢忙聢聳猫聙聟猫炉麓猫驴聶莽炉聡忙聳聡莽芦聽盲赂颅茅職聬氓聨禄莽職聞茅聝篓氓聢聠氓陇陋氓陇職盲潞聠茂录聦忙聢聭茅隆潞莽聺聙忙聳聡莽芦聽莽聽聰莽漏露盲潞聠盲赂聙忙庐碌忙聴露茅聴麓盲陆聠忙聵炉氓聡聽盲赂陋莽聜鹿茅聝陆盲赂虏盲赂聧猫碌路忙聺楼茫聙聜氓聬聨忙聺楼氓聫聢忙聨楼盲潞聦猫驴聻盲赂聣莽職聞莽聹聥盲潞聠氓聡聽莽炉聡忙聳聡莽芦聽茂录聦莽聸麓氓聢掳莽聹聥氓庐聦@pang0lin忙聣聧莽庐聴忙聵炉忙聤聤茅聙禄猫戮聭盲赂虏猫聛聰猫碌路忙聺楼猫庐赂氓陇職

<https://mp.weixin.qq.com/s?__biz=MzkzNjMxNDM0Mg==&mid=2247485450&idx=1&sn=5662a9f2c081fc8521eee651b357323f&chksm=c2a1dc83f5d655957cf2a1c88adf45cd0d028316f536e0a8a18c9e7cb0440869ed4077822ce8&mpshare=1&scene=1&srcid=1017PFOrquxivFM2ck4Prl9m&sharer_sharetime=1665993698480&sharer_shareid=8c0858e06fee9d607c68521b3949c3e9#rd>

猫驴聶莽炉聡忙聳聡莽芦聽盲赂聧莽聼楼茅聛聯盲禄聙盲鹿聢忙聴露氓聙聶氓聫聭氓聡潞忙聺楼茂录聦盲赂禄猫娄聛忙聵炉猫庐掳氓陆聲盲赂聙盲赂聥忙聲麓盲赂陋氓陇聧莽聨掳氓聢聠忙聻聬莽職聞氓驴聝猫路炉氓聨聠莽篓聥茂录聦盲禄楼盲戮驴盲禄楼氓聬聨茅聹聙猫娄聛莽職聞忙聴露氓聙聶忙虏隆氓陇聞莽聹聥茫聙聜

# 忙录聫忙麓聻氓聨聼忙聳聡

<https://www.cobaltstrike.com/blog/out-of-band-update-cobalt-strike-4-7-1/>

CVE-2022-39197

An independent researcher identified as 芒聙聹Beichendream芒聙聺 reached out to inform us about an XSS vulnerability that they discovered in the teamserver. This would allow an attacker to set a malformed username in the Beacon configuration, allowing them to remotely execute code. We created a CVE for this issue which has been fixed.

猫驴聶盲赂陋忙录聫忙麓聻氓聹篓cs莽職聞 4.7.1莽聣聢忙聹卢盲赂颅猫垄芦盲驴庐氓陇聧茂录聦盲禄聳氓聟聛猫庐赂忙聰禄氓聡禄猫聙聟氓聫炉盲禄楼盲录陋茅聙聽莽聰篓忙聢路氓聬聧忙聺楼忙聻聞茅聙聽xss茂录聦茅聙職猫驴聡xss氓聢漏莽聰篓氓聫炉盲禄楼茅聙聽忙聢聬RCE茫聙聜

盲驴庐氓陇聧莽職聞忙聣聥忙庐碌盲鹿聼氓戮聢莽庐聙氓聧聲茂录聦氓掳卤忙聵炉忙聤聤猫驴聶盲赂陋xss莽禄聶盲驴庐盲潞聠茂录聦忙颅拢忙聣聙猫掳聯氓聫陋猫娄聛氓聟楼氓聫拢莽聜鹿忙虏隆盲潞聠茂录聦盲陆聽氓聬聨茅聺垄盲鹿聼氓聢漏莽聰篓盲赂聧猫碌路忙聺楼茫聙聜

![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022225152.png)

# Cobalt Strike盲赂聨swing

氓聹篓莽聬聠猫搂拢猫驴聶盲赂陋忙录聫忙麓聻盲鹿聥氓聣聧茂录聦忙聢聭盲禄卢茅娄聳氓聟聢茅聹聙猫娄聛莽聬聠猫搂拢cs氓聮聦swing猫驴聶盲赂陋忙隆聠忙聻露莽職聞氓聟鲁莽鲁禄茫聙聜

盲录聴忙聣聙氓聭篓莽聼楼茂录聦Cobalt Strike忙聵炉盲赂聳莽聲聦盲赂聤忙聹聙忙碌聛猫隆聦莽職聞莽陆聭莽芦聶莽庐隆莽聬聠氓路楼氓聟路茂录聦cs忙聫聬盲戮聸盲潞聠氓聟聛猫庐赂氓陇職盲赂陋莽聸庐忙聽聡茅聙職猫驴聡茅聺聻氓炉鹿莽搂掳莽職聞氓聤聽氓炉聠忙聳鹿氓录聫茅聯戮忙聨楼teamserver茂录聦氓聹篓猫驴聶盲赂陋猫驴聡莽篓聥盲赂颅茂录聦氓聫陋猫娄聛盲录聽猫戮聯莽職聞忙聲掳忙聧庐氓聫炉盲禄楼猫垄芦teamserver猫搂拢氓录聙茂录聦茅聜拢盲鹿聢猫驴聶盲赂陋猫驴聻忙聨楼氓掳卤盲录職盲赂聤莽潞驴茂录聦猫驴聶忙聹卢猫麓篓盲赂聤氓掳卤忙聵炉盲赂聙盲赂陋莽庐聙氓聧聲莽職聞忙聹聧氓聤隆茅聙職盲驴隆茅聙禄猫戮聭茂录聦猫驴聶忙虏隆盲禄聙盲鹿聢茅聴庐茅垄聵茫聙聜

![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022225479.png)

猫聙聦猫驴聶盲赂陋氓聟卢茅聮楼氓聭垄氓聫炉盲禄楼盲禄聨Beacon stage莽職聞bin忙聳聡盲禄露盲赂颅猫聨路氓聫聳茂录聦莽聸赂氓聟鲁莽職聞猫聞職忙聹卢氓聟露氓庐聻盲鹿聼氓聫炉盲禄楼氓陇職茂录聦忙炉聰氓娄聜

<https://github.com/LiAoRJ/CS_fakesubmit>

忙聹卢氓聹掳忙碌聥猫炉聲莽職聞猫炉聺茂录聦氓聫炉盲禄楼莽聰篓忙聸麓莽庐聙氓聧聲猫驴聶盲赂陋猫搂拢氓炉聠猫聞職忙聹卢猫聨路氓戮聴猫驴聶盲赂陋氓聟卢莽搂聛茅聮楼茫聙聜

|  |  |
| --- | --- |
| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 ``` | ``` import java.io.File; import java.util.Base64; import common.CommonUtils; import java.security.KeyPair;  class DumpKeys {        public static void main(String[] args)     {         try {             File file = new File(".cobaltstrike.beacon_keys");             if (file.exists()) {                 KeyPair keyPair = (KeyPair)CommonUtils.readObject(file, null);                 System.out.printf("Private Key: %s\n\n", new String(Base64.getEncoder().encode(keyPair.getPrivate().getEncoded())));                 System.out.printf("Public Key: %s\n\n", new String(Base64.getEncoder().encode(keyPair.getPublic().getEncoded())));             }             else {                 System.out.println("Could not find .cobaltstrike.beacon_keys file");             }         }         catch (Exception exception) {            System.out.println("Could not read asymmetric keys");         }     } } ``` |

氓聫陋猫娄聛猫聨路氓戮聴盲潞聠氓聟卢茅聮楼茂录聦茅聜拢盲鹿聢忙聢聭盲禄卢氓掳卤氓聫炉盲禄楼氓聬聭teamserver盲录聽氓聟楼盲赂聙盲赂陋猫聶職氓聛聡莽職聞盲录職猫炉聺盲赂聤莽潞驴茂录聦茅聙職猫驴聡氓庐垄忙聢路莽芦炉茅聯戮忙聨楼忙聹聧氓聤隆莽芦炉盲鹿聥氓聬聨氓掳卤氓聫炉盲禄楼莽聹聥氓聢掳猫驴聶忙聺隆茅聯戮忙聨楼茫聙聜

![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022225231.png)

氓聹篓猫驴聶盲赂陋茅隆碌茅聺垄氓陆聯盲赂颅猫聶陆莽聞露猫炉麓莽聹聥盲赂聤氓聨禄盲驴隆忙聛炉氓戮聢氓陇職茂录聦氓庐聻茅聶聟盲赂聤氓聫炉忙聨搂莽職聞茅聝篓氓聢聠氓鹿露盲赂聧氓陇職茂录聦猫驴聶盲赂聙莽聜鹿氓聹篓忙录聜盲潞庐茅录聽莽職聞忙聳聡莽芦聽盲赂颅忙聹聣猫炉娄莽禄聠莽職聞猫搂拢茅聡聤茂录聦盲赂禄猫娄聛忙聵炉忙聲掳忙聧庐莽禄聯忙聻聞盲赂颅莽職聞氓聫炉忙聨搂莽聜鹿茅聴庐茅垄聵

<https://mp.weixin.qq.com/s/l5e2p_WtYSCYYhYE0lzRdQ>

![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022225371.png)

猫驴聶茅聡聦忙聢聭盲禄卢氓聟聢盲赂聧忙路卤莽漏露cs莽職聞盲录聽猫戮聯氓聧聫猫庐庐茂录聦忙聢聭盲禄卢氓聫陋茅聹聙猫娄聛氓聟鲁忙鲁篓茂录聦氓聹篓猫驴聶盲赂陋茅隆碌茅聺垄盲赂颅氓聫炉盲禄楼忙聨搂氓聢露莽職聞氓聟露氓庐聻氓掳卤忙聵炉盲赂颅茅聴麓莽職聞盲录職猫炉聺盲驴隆忙聛炉茅聝篓氓聢聠茂录聦氓聟露盲赂颅氓聦聟忙聥卢忙聙禄氓聟卤117氓颅聴猫聤聜莽職聞user茫聙聛computer茫聙聛process盲赂聙氓聟卤3盲赂陋茅聝篓氓聢聠

![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022225753.png)

猫聙聦盲赂聰莽聬聠猫庐潞盲赂聤忙聺楼猫炉麓茂录聦氓娄聜忙聻聹盲录陋茅聙聽猫聞職忙聹卢猫露鲁氓陇聼氓聬聢莽聬聠茂录聦茅聜拢盲鹿聢莽聰卤猫驴聶盲赂陋莽聲聦茅聺垄猫隆聧莽聰聼氓聡潞忙聺楼莽職聞氓聬聞莽搂聧莽聲聦茅聺垄茅聝陆忙聵炉氓聫炉盲禄楼忙聨搂氓聢露莽職聞茂录聦忙聹聙莽庐聙氓聧聲莽職聞氓掳卤忙炉聰氓娄聜氓聨聼忙聳聡忙聫聬氓聢掳莽職聞忙聼楼莽聹聥猫驴聸莽篓聥氓聢聴猫隆篓茂录聦盲陆聠氓聟露氓庐聻氓聟露盲禄聳莽職聞忙炉聰氓娄聜忙聼楼莽聹聥忙聳聡盲禄露莽庐隆莽聬聠莽颅聣氓聤聼猫聝陆氓聟露氓庐聻茅聝陆氓路庐盲赂聧氓陇職茫聙聜

![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022225060.png)

猫聙聦氓聣聧茅聺垄猫炉麓盲潞聠猫驴聶盲鹿聢氓陇職茂录聦氓聮聦swing忙聹聣盲禄聙盲鹿聢氓聟鲁莽鲁禄氓聭垄茂录聼**氓聣聧茅聺垄莽聹聥氓聢掳莽職聞忙聣聙忙聹聣莽聰禄茅聺垄茅聝陆忙聵炉莽聰篓swing猫驴聶盲赂陋氓潞聯莽聰禄莽職聞茂录聦忙聣聙猫掳聯莽職聞XSS盲鹿聼忙聺楼忙潞聬盲潞聨猫驴聶茅聡聦茫聙聜**

# Swing氓潞聯盲赂聨Xss

<https://docs.oracle.com/javase/tutorial/uiswing/components/html.html>

盲禄聨莽聸赂氓聟鲁莽職聞氓庐聵忙聳鹿忙聳聡忙隆拢氓聫炉盲禄楼莽聼楼茅聛聯茂录聦Swing忙聹卢猫潞芦忙聵炉**忙聰炉忙聦聛HTML莽職聞忙聽聡莽颅戮**莽職聞茫聙聜

![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022225327.png)

氓聫陋猫娄聛氓聹篓忙聳聡忙聹卢莽職聞氓录聙氓搂聥氓聤聽氓聟楼html忙聽聡莽颅戮氓掳卤盲录職猫搂拢忙聻聬html忙聽聡莽颅戮茂录聦猫聙聦忙炉聰猫戮聝忙聹聣猫露拢莽職聞盲潞聥忙聝聟忙聵炉茂录聦猫驴聶氓楼聴html莽職聞猫搂拢忙聻聬氓录聲忙聯聨忙聵炉盲禄聳猫聡陋氓路卤氓庐聻莽聨掳莽職聞茂录聦氓鹿露盲赂聧忙聵炉氓录聲盲潞聠盲赂聙盲赂陋莽卢卢盲赂聣忙聳鹿氓录聲忙聯聨茫聙聜盲禄聨swing莽職聞盲禄拢莽聽聛盲赂颅氓聫炉盲禄楼莽聹聥氓聢掳猫驴聶盲赂聙莽聜鹿茫聙聜

path: swing.text.html

![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022225448.png))![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022225253.png)

猫聙聦忙聸麓忙聹聣猫露拢莽職聞忙聵炉茂录聦莽卤禄盲录录script猫驴聶莽搂聧忙聽聡莽颅戮猫聶陆莽聞露猫搂拢忙聻聬茂录聦盲陆聠忙聵炉氓鹿露忙虏隆忙聹聣莽聰篓茂录聦猫聙聦忙聵炉氓楼聴盲潞聠盲赂聙盲赂陋氓篓聝莽聸麓忙聨楼氓聟鲁盲潞聠

![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022225834.png)

猫聙聦猫驴聶盲赂陋忙录聫忙麓聻莽職聞氓聟楼氓聫拢莽聜鹿XSS盲鹿聼忙颅拢忙聵炉莽聰卤盲潞聨猫驴聶盲赂陋氓聨聼氓聸聽茂录聦莽陆聭盲赂聤莽職聞氓戮聢氓陇職氓聢聠忙聻聬忙聳聡莽芦聽盲鹿聼茅聝陆忙聵炉氓聢掳猫驴聶茅聡聦盲赂潞忙颅垄茂录聦莽庐聴忙聵炉猫驴聸盲潞聠盲赂陋茅聴篓氓聫拢

![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022226978.png)

# 盲禄聨Swing XSS 氓聢掳 RCE

## 盲禄聨XSS氓聢掳氓庐聻盲戮聥氓聦聳盲禄禄忙聞聫莽卤禄茂录聼

茅聙禄猫戮聭猫碌掳氓聢掳猫驴聶茅聡聦忙聨楼盲赂聥忙聺楼忙聹聙氓陇搂莽職聞茅聴庐茅垄聵氓掳卤忙聵炉**氓娄聜盲陆聲盲禄聨XSS猫碌掳氓聢掳RCE**茂录聦猫驴聶盲鹿聼忙聵炉猫驴聶盲赂陋忙录聫忙麓聻忙聹聙忙聹聣忙聞聫忙聙聺莽職聞氓聹掳忙聳鹿茫聙聜

忙聙禄忙聣聙氓聭篓莽聼楼氓聲聤茂录聦盲赂聙猫聢卢忙聺楼猫炉麓忙聢聭盲禄卢氓赂赂猫搂聞忙聞聫盲鹿聣盲赂聤莽職聞XSS氓聢漏莽聰篓盲赂禄猫娄聛忙聵炉氓聸麓莽禄聲JS忙聺楼氓聛職忙聳聡莽芦聽茂录聦氓聧鲁盲戮驴忙聵炉茅聜拢莽搂聧氓庐垄忙聢路莽芦炉莽職聞xss2rce茂录聦氓陇搂氓陇職忙聲掳盲鹿聼茅聝陆忙聵炉氓禄潞莽芦聥氓聹篓Electron莽職聞氓聼潞莽隆聙盲赂聤茂录聦猫炉麓莽聶陆盲潞聠忙聵炉氓聹篓Node莽職聞莽聨炉氓垄聝盲赂聥忙聣搂猫隆聦JS茂录聦莽聰卤Node忙聣聧盲禄聨氓庐垄忙聢路莽芦炉猫碌掳氓聢掳忙聹聧氓聤隆莽芦炉茂录聦忙聣聧忙聻聞忙聢聬RCE茫聙聜

猫聙聦Swing盲赂聧盲赂聙忙聽路茂录聦氓庐聝忙聹卢猫麓篓盲赂聤忙聵炉盲赂聙盲赂陋Java莽職聞莽禄聞盲禄露茂录聦氓聹篓Java莽聨炉氓垄聝盲赂聤忙聝鲁猫娄聛茅聺聽Xss忙聺楼忙聣搂猫隆聦氓聭陆盲禄陇忙聵戮莽聞露忙聵炉氓陇漏忙聳鹿氓陇聹猫掳聢茂录聦忙聸麓氓聟鲁茅聰庐莽職聞忙聵炉茂录聦忙聢聭盲禄卢莽聰職猫聡鲁忙虏隆氓聤聻忙鲁聲忙聣搂猫隆聦JS盲禄拢莽聽聛茫聙聜

![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022226363.png)

猫聙聦忙聹聣忙聞聫忙聙聺莽職聞莽聜鹿氓掳卤氓聹篓猫驴聶茅聡聦茂录聦氓聸聽盲赂潞猫驴聶忙聵炉盲赂聙氓楼聴Swing猫聡陋氓路卤氓庐聻莽聨掳莽職聞猫搂拢忙聻聬氓录聲忙聯聨茂录聦忙聣聙盲禄楼氓庐聝茅聙聣忙聥漏盲赂聧猫搂拢忙聻聬script茅聜拢忙聢聭盲禄卢氓聫聢盲赂聧猫聝陆氓聡颅莽漏潞氓聫聵氓聡潞忙聺楼忙聣搂猫隆聦js莽職聞忙聳鹿忙鲁聲茫聙聜猫聙聦忙聛掳忙聛掳忙聵炉氓聸聽盲赂潞猫聡陋氓路卤氓庐聻莽聨掳盲潞聠猫驴聶氓楼聴氓录聲忙聯聨茂录聦Swing猫聡陋氓路卤盲鹿聼忙聲麓盲潞聠盲赂聙盲潞聸猫聤卤忙麓禄茫聙聜

![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022226632.png)

茅聶陇盲潞聠object氓聟露氓庐聻盲鹿聼忙聹聣盲赂聙盲潞聸氓楼聡氓楼聡忙聙陋忙聙陋莽職聞忙聽聡莽颅戮茂录聦盲陆聠忙聵炉氓陇搂氓陇職忙聲掳忙聽聡莽颅戮茅聝陆猫垄芦莽聸麓忙聨楼氓录聲氓聢掳HiddenTagView盲潞聠茂录聦氓聫陋忙聹聣氓掳聭忙聲掳莽職聞盲赂聙盲潞聸忙聽聡莽颅戮忙聹聣盲赂聯茅聴篓莽職聞氓陇聞莽聬聠茅聙禄猫戮聭茂录聦object猫驴聶盲赂陋忙聽聡莽颅戮氓聹篓猫驴聶盲赂陋茅聙禄猫戮聭茅聡聦茅聺垄忙聵戮氓戮聴忙聹聣莽聜鹿氓聞驴莽聣鹿莽芦聥莽聥卢猫隆聦茂录聦忙聣聙盲禄楼茅隆潞莽聺聙猫驴聶盲赂陋茅聙禄猫戮聭莽聸麓忙聨楼氓戮聙茅聡聦猫碌掳茫聙聜

Path: swing.text.html.ObjectView.java

![img](https://lorexxar-blog.oss-cn-shanghai.aliyuncs.com/blog/202211022226970.png)

盲禄聨猫驴聶忙庐碌盲禄拢莽聽聛莽聹聥氓聢掳茂录聦猫聨路氓聫聳氓聢掳classid莽職聞莽卤禄盲录職莽聸麓忙聨楼氓庐聻盲戮聥氓聦聳氓鹿露盲赂聰莽聸赂氓潞聰盲录聽氓聫聜茂录聦忙聢聳猫庐赂莽聹聥盲禄拢莽聽聛氓聫炉猫聝陆猫驴聵忙虏隆莽聹聥忙聵聨莽聶陆茂录聦猫驴聶忙庐碌盲禄拢莽聽聛盲赂聤茅聺垄猫驴聵忙聹聣盲赂聙忙庐碌猫聦聝盲戮聥茫聙聜

![img](https://lorexxa...