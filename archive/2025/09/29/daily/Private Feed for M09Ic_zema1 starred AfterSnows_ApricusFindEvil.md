---
title: zema1 starred AfterSnows/ApricusFindEvil
url: https://github.com/AfterSnows/ApricusFindEvil
source: Private Feed for M09Ic
date: 2025-09-29
fetch_date: 2025-10-02T20:49:57.906701
---

# zema1 starred AfterSnows/ApricusFindEvil

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FAfterSnows%2FApricusFindEvil)

Appearance settings

* Platform

  + [GitHub Copilot

    Write better code with AI](https://github.com/features/copilot)
  + [GitHub Spark
    New

    Build and deploy intelligent apps](https://github.com/features/spark)
  + [GitHub Models
    New

    Manage and compare prompts](https://github.com/features/models)
  + [GitHub Advanced Security

    Find and fix vulnerabilities](https://github.com/security/advanced-security)
  + [Actions

    Automate any workflow](https://github.com/features/actions)

  + [Codespaces

    Instant dev environments](https://github.com/features/codespaces)
  + [Issues

    Plan and track work](https://github.com/features/issues)
  + [Code Review

    Manage code changes](https://github.com/features/code-review)
  + [Discussions

    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search

    Find more, search less](https://github.com/features/code-search)

  Explore
  + [Why GitHub](https://github.com/why-github)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)

  Integrations
  + [GitHub Marketplace](https://github.com/marketplace)
  + [MCP Registry](https://github.com/mcp)

  [View all features](https://github.com/features)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)

  By use case
  + [App Modernization](/solutions/use-case/app-modernization)
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [Events & Webinars](https://github.com/resources/events)
  + [Ebooks & Whitepapers](https://github.com/resources/whitepapers)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://github.com/partners)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors

    Fund open source developers](/sponsors)

  + [The ReadME Project

    GitHub community articles](https://github.com/readme)

  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform

    AI-powered developer platform](/enterprise)

  Available add-ons
  + [GitHub Advanced Security

    Enterprise-grade security features](https://github.com/security/advanced-security)
  + [Copilot for business

    Enterprise-grade AI features](/features/copilot/copilot-business)
  + [Premium Support

    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

[ ]
Include my email address so I can be contacted

Cancel
 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Cancel
 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FAfterSnows%2FApricusFindEvil)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=AfterSnows%2FApricusFindEvil)

Appearance settings

Resetting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[AfterSnows](/AfterSnows)
/
**[ApricusFindEvil](/AfterSnows/ApricusFindEvil)**
Public

* [Notifications](/login?return_to=%2FAfterSnows%2FApricusFindEvil) You must be signed in to change notification settings
* [Fork
  9](/login?return_to=%2FAfterSnows%2FApricusFindEvil)
* [Star
   107](/login?return_to=%2FAfterSnows%2FApricusFindEvil)

检测查杀java内存马

[107
stars](/AfterSnows/ApricusFindEvil/stargazers) [9
forks](/AfterSnows/ApricusFindEvil/forks) [Branches](/AfterSnows/ApricusFindEvil/branches) [Tags](/AfterSnows/ApricusFindEvil/tags) [Activity](/AfterSnows/ApricusFindEvil/activity)

[Star](/login?return_to=%2FAfterSnows%2FApricusFindEvil)

[Notifications](/login?return_to=%2FAfterSnows%2FApricusFindEvil) You must be signed in to change notification settings

* [Code](/AfterSnows/ApricusFindEvil)
* [Issues
  1](/AfterSnows/ApricusFindEvil/issues)
* [Pull requests
  0](/AfterSnows/ApricusFindEvil/pulls)
* [Actions](/AfterSnows/ApricusFindEvil/actions)
* [Projects
  0](/AfterSnows/ApricusFindEvil/projects)
* [Security

  ### Uh oh!

  There was an error while loading. Please reload this page.](/AfterSnows/ApricusFindEvil/security)
* [Insights](/AfterSnows/ApricusFindEvil/pulse)

Additional navigation options

* [Code](/AfterSnows/ApricusFindEvil)
* [Issues](/AfterSnows/ApricusFindEvil/issues)
* [Pull requests](/AfterSnows/ApricusFindEvil/pulls)
* [Actions](/AfterSnows/ApricusFindEvil/actions)
* [Projects](/AfterSnows/ApricusFindEvil/projects)
* [Security](/AfterSnows/ApricusFindEvil/security)
* [Insights](/AfterSnows/ApricusFindEvil/pulse)

# AfterSnows/ApricusFindEvil

main

[Branches](/AfterSnows/ApricusFindEvil/branches)[Tags](/AfterSnows/ApricusFindEvil/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit   History[8 Commits](/AfterSnows/ApricusFindEvil/commits/main/) | | |
| [asset](/AfterSnows/ApricusFindEvil/tree/main/asset "asset") | | [asset](/AfterSnows/ApricusFindEvil/tree/main/asset "asset") |  |  |
| [src](/AfterSnows/ApricusFindEvil/tree/main/src "src") | | [src](/AfterSnows/ApricusFindEvil/tree/main/src "src") |  |  |
| [README.md](/AfterSnows/ApricusFindEvil/blob/main/README.md "README.md") | | [README.md](/AfterSnows/ApricusFindEvil/blob/main/README.md "README.md") |  |  |
| [pom.xml](/AfterSnows/ApricusFindEvil/blob/main/pom.xml "pom.xml") | | [pom.xml](/AfterSnows/ApricusFindEvil/blob/main/pom.xml "pom.xml") |  |  |
| View all files | | |

## Repository files navigation

* README

记录对于恶意代码查杀

小记：第一套程序

用java，采用rasp同样的方式，hook住jvm后查杀内存马，之后可能还会对无文件的agent进行操作

测试用文件放在asset文件夹

# 序言

java内存马技术十分成熟，基于组件的，特性的内存马类型层出不穷，基于java agent内存马的攻防逐渐成为在jvm上攻防。

# 内存马检测查杀思路

万变不离其宗：找内存马就是找可以利用的Request 和Response

由于内存马它环境不同导致其多变的原因，应该把查杀改为修改内存马原有逻辑更恰当

**内存马类型检测是检测不完的，最好的就是行为检测**

其实一开始有把所有class在本地无文件的类给删除的想法，但是实际上有很多的内部类等等正常运行的类会获取不到其classloader或者得到了却拿不到其urlpath的问题，有两种方法

1.要么是改良其中对于无文件检测，将其进行排除干扰选项，然后遍历查找所有恶意的无文件的类进行删除，这里有许多不稳定的因素，对于干扰项可能是排除不完的，对于内存马写入我们定义的干扰选项中也是束手无策。

2.对于特定类型进行特征检测，这样能基本筛选干扰选项，但是对于新类型的内存马就束手无策。

#### 常见四大类型：filter,listener,value,servlet

这里以filter为典型说一下

> **public void doFilter (ServletRequest, ServletResponse, FilterChain)**
> 该方法完成实际的过滤操作，当客户端请求方法与过滤器设置匹配的URL时，Servlet容器将先调用过滤器的doFilter方法。FilterChain用户访问后续过滤器。

######...