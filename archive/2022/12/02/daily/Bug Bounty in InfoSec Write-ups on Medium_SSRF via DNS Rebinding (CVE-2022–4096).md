---
title: SSRF via DNS Rebinding (CVE-2022–4096)
url: https://infosecwriteups.com/ssrf-via-dns-rebinding-cve-2022-4096-b7bf75928bb2?source=rss----7b722bfd1b8d--bug_bounty
source: Bug Bounty in InfoSec Write-ups on Medium
date: 2022-12-02
fetch_date: 2025-10-04T00:17:14.691173
---

# SSRF via DNS Rebinding (CVE-2022–4096)

[Sitemap](/sitemap/sitemap.xml)

[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb7bf75928bb2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fssrf-via-dns-rebinding-cve-2022-4096-b7bf75928bb2&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

[Medium Logo](https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav------------------)

[Search](https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fssrf-via-dns-rebinding-cve-2022-4096-b7bf75928bb2&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

[## InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---publication_nav-7b722bfd1b8d-b7bf75928bb2---------------------------------------)

·

Follow publication

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:76:76/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_sidebar-7b722bfd1b8d-b7bf75928bb2---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow publication

# SSRF via DNS Rebinding (CVE-2022–4096)

[![Basavaraj Banakar](https://miro.medium.com/v2/resize:fill:64:64/0*1QIfk5BpjK00wyJI.jpg)](https://basu-banakar.medium.com/?source=post_page---byline--b7bf75928bb2---------------------------------------)

[Basavaraj Banakar](https://basu-banakar.medium.com/?source=post_page---byline--b7bf75928bb2---------------------------------------)

3 min read

·

Nov 22, 2022

--

1

Listen

Share

Hello everyone myself [**Basavaraj**](http://twitter.com/basu_banakar) , Today in this writeup I will explain about my 2nd CVE i.e [**CVE-2022–4096**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4096)

Let’s get started

Press enter or click to view image in full size

![]()

SSRF Overview

> **SSRF using DNS rebinding found in** [**Appsmith**](https://github.com/appsmithorg/appsmith) **.**
>
> FYI : [Appsmith](https://github.com/appsmithorg/appsmith) is used to Build, ship, and maintain internal tools.

Initially I discovered the 2 SSRF’s in appsmith by using server side redirection method.

And this is Bypass for those 2 Initial SSRF’s.

**DNS Rebinding Overview:**

> DNS rebinding is a method of manipulating resolution of domain names that is commonly used as a form of computer attack. In this attack, a malicious web page causes visitors to run a client-side script that attacks machines elsewhere on the network. In theory, the same-origin policy prevents this from happening: client-side scripts are only allowed to access content on the same host that served the script. Comparing domain names is an essential part of enforcing this policy, so DNS rebinding circumvents this protection by abusing the Domain Name System (DNS).

Let’s generate the an hostname via DNS rebinding to bypass SSRF restrictions! <https://lock.cmpxchg8b.com/rebinder.html>

Press enter or click to view image in full size

![]()

DNS Rebinding

We can see that our generated hostname got assigned with two different IP’s

Press enter or click to view image in full size

![]()

Dig command

Now the vulnerable function is Create new API and Elasticsearch

Press enter or click to view image in full size

![]()

Vulnerable Functions

Now add the generated hostname in url function and click on run and I got response as **host not allowed**

Press enter or click to view image in full size

![]()

Host not allowed response

Now after hitting run again, Successfully got some response with AWS cloud metadata path

Press enter or click to view image in full size

![]()

aws metadata path

Now appended the “latest” path to the url and again clicked on run and I got **404** (Because this time the server hitted my IP which I used in DNS rebinding).

Press enter or click to view image in full size

![]()

404 Response

Now after continuous Hit and trial(Clicking “Run” again until I get some response) methods and appending the paths(Which I got in response) to url I successfully retrieved AWS Keys

Press enter or click to view image in full size

![]()

AWS Keys Retrieved Successfully

Vulnerable Versions : Appsmith < v1.8.1

Now reported this to Appsmith and got acknowledgement and Reported the same to huntr.dev to get CVE for this issue and got assigned with this [CVE-2022–4096](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4096)

Please ignore grammatical and verbal mitsakes :)

Follow me on:

Twitter: <https://twitter.com/basu_banakar>

Instagram : <https://instagram.com/basu_banakar>

Linkedin: [https://www.linkedin.com/basubanakar](https://www.linkedin.com/in/basubanakar/)

### From Infosec Writeups: A lot is coming up in the Infosec every day that it’s hard to keep up with. [Join our weekly newsletter](https://weekly.infosecwriteups.com/) to get all the latest Infosec trends in the form of 5 articles, 4 Threads, 3 videos, 2 GitHub Repos and tools, and 1 job alert for FREE!

[Ssrf](https://medium.com/tag/ssrf?source=post_page-----b7bf75928bb2---------------------------------------)

[DNS](https://medium.com/tag/dns?source=post_page-----b7bf75928bb2---------------------------------------)

[AWS](https://medium.com/tag/aws?source=post_page-----b7bf75928bb2---------------------------------------)

[Hacking](https://medium.com/tag/hacking?source=post_page-----b7bf75928bb2---------------------------------------)

[Bug Bounty](https://medium.com/tag/bug-bounty?source=post_page-----b7bf75928bb2---------------------------------------)

--

--

1

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:96:96/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--b7bf75928bb2---------------------------------------)

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:128:128/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--b7bf75928bb2---------------------------------------)

Follow

[## Published in InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---post_publication_info--b7bf75928bb2---------------------------------------)

[71K followers](/followers?source=post_page---post_publication_info--b7bf75928bb2---------------------------------------)

·[Last published 5 days ago](/how-to-find-p1-bugs-using-google-in-your-target-part-1-e37455324dc1?source=post_page---post_publication_info--b7bf75928bb2---------------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

Follow

[![Basavaraj Banakar](https://miro.medium.com/v2/resize:fill:96:96/0*1QIfk5BpjK00wyJI.jpg)](https://basu-banakar.medium.com/?source=post_page---post_author_info--b7bf75928bb2---------------------------------------)

[![Basavaraj Banakar](https://miro.medium.com/v2/resize:fill:128:128/0*1QIfk5BpjK00wyJI.jpg)](https://basu-banakar.medium.com...