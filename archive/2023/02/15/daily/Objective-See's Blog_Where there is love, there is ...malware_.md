---
title: Where there is love, there is ...malware?
url: https://objective-see.org/blog/blog_0x72.html
source: Objective-See's Blog
date: 2023-02-15
fetch_date: 2025-10-04T06:36:22.421638
---

# Where there is love, there is ...malware?

* [![](/images/logoApple.png)

  Objective-See

  a non-profit 501(c)(3) foundation.](/index.html)
* [ ]

  + [![](/images/newsIcon.png)
    News](/news.html)
  + [![](/images/storeIcon.png)
    Swag](https://objective-see.myshopify.com/)
  + [![](/images/bookIcon.png)
    Books](https://taomm.org/)
  + [![](/images/conferenceIcon.png)
    Conference](https://objectivebythesea.com/)
  + [![](/images/malwareIcon.png)
    Malware Collection](/malware.html)
  + [![](/images/aboutIcon.png)
    About Objective-See](/about.html)
* Support Us!
* [![](/images/blogIcon.png)](/blog.html)
* [![](/images/productsIcon.png)

  tools](/tools.html)

---

Where there is love, there is ...malware?

Analyzing an undetected persistent macOS updater

by: Patrick Wardle / February 14, 2023

Objective-See's research, tools, and writing, are supported by the "Friends of Objective-See" such as:

[![](/images/friends/textless/jamf.png)

Jamf](https://www.jamf.com/?utm_source=objective-see&utm_medium=sponsored-link&utm_campaign=next-gen-security&utm_content=2021-02-05_protect)

[![](/images/friends/textless/mosyle.png)

Mosyle](https://l.linklyhq.com/l/18wF2)

[![](/images/friends/textless/kandji.png)

Kandji](https://www.kandji.io)

[![](/images/friends/textless/cmm.png)

CleanMyMac X](https://macpaw.com/cleanmymac)

[![](/images/friends/textless/kolide.png)

Kolide](https://l.kolide.co/Objective-See)

[![](/images/friends/textless/fleetdm.png)

Fleet](https://fleetdm.com)

[![](/images/friends/textless/panw.png)

Palo Alto Networks](https://www.paloaltonetworks.com)

[![](/images/friends/textless/sophos.png)

Sophos](https://www.sophos.com)

📝 👾 Want to play along?

As “Sharing is Caring” I’ve uploaded the binary [iWebUpdate](https://github.com/objective-see/Malware/raw/main/iWebUpdate.zip) to our macOS malware collection. The password is: infect3d

...please though, don’t infect yourself!

### Background

Today, Valentine’s day, is a day to celebrate love, and for better or worse one my main loves is malware! 😅

Over the last few months, I’ve been pulled in a few different directions such as planning #OBTS v6.0, working on my new book, and expanding the Objective-See Foundation’s non-profit and community-focused efforts.

As while I’m super stoked on all these efforts, today was a day to get back to some dedicated malware research and analysis.

Also, I’m often asked about the prevalence of Mac malware …to which my answer is often along the lines of, “there is likely far more (Mac) malware out there than we’re seeing” And I figured, what better way to back up this claim than finding new malware? …and as we’ll see, contrary to Apple’s marketing claims - finding undetected Mac malware is a rather trivial endeavor!

### Discovery

As an independent security researcher, unfortunately I don’t have access to large corpuses of propriety threat intelligence or client data. (Objective-See’s tools, by design collect no detection metrics, or user information). What I do have access to is VirusTotal - who very graciously offer free researcher accounts! 🙏🏽

So today, that’s where I began… and after a few minutes (~8 or so?) I stumbled across [an interesting file](https://www.virustotal.com/gui/file/3e66e664b05b695b0b018d3539412e6643d036c6d1000e03b399986252bddbfb/detection):

![](../images/blog/blog_0x72/vt.png)
VirusTotal Submission

Looking at additional metadata provide by VirusTotal, we can see it was originally see in the wild/submitted in September of 2018 …almost 5 years ago.

However, a submission from just this month, (specifically on February 10th), seems to indicate its still active, or at least in the wild:

![](../images/blog/blog_0x72/history.png)
VirusTotal History

VirusTotal also gives us some (basic) insight into it prevalence, showing us that at least a dozen users have this file installed on their systems:

![](../images/blog/blog_0x72/users.png)
Infected Users

…this also shows us the path (and name) the file is installed on macOS systems: **`~/Library/Services/iWebUpdate`**. (As we’ll see, this is hardcoded in the binary).

Let’s now download and triage the file, seeking to answer two main questions:

* Is this binary malicious?
* What are the binary’s capabilities?

### Triaging `iWebUpdate`

The binary has a SHA-1 hash of `f33373701e5e2fc5451b05f935cd465662679a2b`. If we run macOS’s `file` command it tells us its a 64bit Mach-O binary:

```
% shasum -a1 /Users/patrick/Downloads/iWebUpdate
f33373701e5e2fc5451b05f935cd465662679a2b  iWebUpdate

% file iWebUpdate
iWebUpdate: Mach-O 64-bit executable x86_64
```

In terms of its whether or not its code-signed, the answer is no:

![](../images/blog/blog_0x72/wys.png)
iWebUpdate is unsigned

Next, let’s run `otool` (with the `-L` flag) to extract the binary’s dependencies - which can shed insight into its capabilities.

```
% otool -L iWebUpdate
iWebUpdate:
    /usr/lib/libcurl.4.dylib (compatibility version 7.0.0, current version 9.0.0)
    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1238.60.2)
```

Besides the standard `libSystem.B.dylib` library, the binary links against `libcurl` …likely indicating it contains networking functionality, realized thru curl’s APIs.

Let’s also look at the binary’s symbols, which can show which system APIs it imports …which again, can provide clues about its capabilities. Here, we use macOS’s `nm` tool:

```
% nm iWebUpdate
     ...
     U _curl_easy_cleanup
     U _curl_easy_escape
     U _curl_easy_init
     U _curl_easy_perform
     U _curl_easy_setopt
     U _curl_free

     U _execvp

     U _fclose
     U _fopen

     U _fork

     U _fread
     U _fwrite

     U _getifaddrs
     U _getpid
     U _if_nametoindex
     U _localtime

     U _popen
     U _qsort

     U _system
     U _waitpid
```

Interesting…references to the curl APIs, but also those related to file, survey, and execution (e.g. `system`/`execvp`).

To complete our triage, let’s run the `strings` command to extract any embedded strings. For non-obfuscated binaries, this can often provide a host of valuable information about functionality and capabilities.

```
% strings - iWebUpdate

/tmp/iwup.tmp

echo $(system_profiler SPSoftwareDataType | grep 'System Version:' | cut -d: -f2)
echo $(defaults read ~/Library/Preferences/com.apple.SystemProfiler.plist 'CPU Names') | cut -d'"' -f4
%s%s?v=%d&c=%s&u=%s&os=%s&hw=%s
https://iwebservicescloud.com/api/v0

/install.php
/update.php

mkdir -p ~/Library/Services
~/Library/Services/iWebUpdate
launchctl unload %s >/dev/null 2>&1
launchctl load %s >/dev/null 2>&1
launchctl start iWebUpdate >/dev/null 2>&1

Downloading: %s
Unzipping: %s
unzip
system
Running: %s
Failed to fork

~/Library/LaunchAgents/iwebupdate.plist
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
  <key>Label</key>
  <string>iWebUpdate</string>
  <key>ProgramArguments</key>
  <array>
    <string>%s/Library/Services/iWebUpdate</string>
    <string>update</string>
    <string>C=%s</string>
  </array>
  <key>StartInterval</key>
  <integer>3600</integer>
</dict>
</plist>
...
```

Wow, lucky us! With no apparent obfuscations, a myriad of details emerge, including what appear to be:

* File paths:

  `/tmp/iwup.tmp`, `~/Library/Services/iWebUpdate` (this matches the ‘in the wild’ paths reported by VirusTotal).
* Survey commands:

  `echo $(system_profiler SPSoftwareDataType | grep 'System Version:' | cut -d: -f2)`
  `echo $(defaults read ~/Library/Preferences/com.apple.SystemProfiler.plist 'CPU Names') | cut -d'"' -f4`
* Command and control:

  `https://iwebservicescloud.com/api/v0`

  `/install.php`, `/update.php`
* Tasking commands:

  Download (`Downloading: %s`) and execution (`Running: %s`, `Failed to fork`)?
* Persistence:

  `~/Library/LaunchAgents/iwebupdate.plist` …and it’s contents (`<?xml version="1.0" encoding="UTF-8"?>...`).

This wraps up our triage, from w...