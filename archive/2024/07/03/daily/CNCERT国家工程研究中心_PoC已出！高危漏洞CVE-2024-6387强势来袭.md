---
title: PoC已出！高危漏洞CVE-2024-6387强势来袭
url: https://mp.weixin.qq.com/s?__biz=MzUzNDYxOTA1NA==&mid=2247545642&idx=3&sn=03bae878bdc7eb64e62f2a406ece64d0&chksm=fa9385ebcde40cfd1d206f91fe2d6619b52fab3d85a3bd68b19a24295bb86a216fe7ed3cb25b&scene=58&subscene=0#rd
source: CNCERT国家工程研究中心
date: 2024-07-03
fetch_date: 2025-10-06T17:44:00.844272
---

# PoC已出！高危漏洞CVE-2024-6387强势来袭

![cover_image](https://mmbiz.qpic.cn/mmbiz_jpg/GoUrACT176n1kibgVCPkF9FmGzFDiayRker0mvFNEnfibK19HtL7w5YAtSBE2rpqoHkYLiaaFVjrbMxxQMJZlOMORg/0?wx_fmt=jpeg)

# PoC已出！高危漏洞CVE-2024-6387强势来袭

网络安全应急技术国家工程中心

Qualys公司发现的RegreSSHion(CVE-2024-6387)漏洞搅动了安全界的神经。这是OpenSSH(regreSSHion)中的一个严重漏洞允许攻击者完全访问服务器！数百万人面临风险。OpenSSH服务器中发现了一个名为“regreSSHion”的高危漏洞，对全球数百万个系统构成重大威胁。此漏洞允许远程未经身份验证的代码执行(RCE)，这意味着攻击者无需任何登录凭据即可完全控制易受攻击的服务器。Qualys 研究人员发现了超过1400万个暴露在互联网上的潜在易受攻击的 OpenSSH 实例。如果漏洞被成功利用，意味着这些基于LINUX的设备则将以ROOT权限被控制和接管。

![](https://mmbiz.qpic.cn/mmbiz_jpg/0KRmt3K30icWMUczHpszBgIs9VOwEpVSqeC5RzAWThu6zP35G8TiaZBia1PW6V2bOia0qRtaicZcQZWMjnC69U1Fp6w/640?wx_fmt=jpeg&from=appmsg&wxfrom=13&tp=wxpic)

技术细节

Qualys的网络安全研究人员将其称为RegreSSHion(CVE-2024-6387)；这是OpenSSH服务器守护程序(SSHD)信号处理程序中的一个缺陷。信号处理程序是程序中的一项功能，旨在处理操作系统发送的特定信号。该漏洞被Qualys 威胁研究部门 (TRU) 的研究人员称为“RegreSSHion”，CVSS 评分为 8.1。它会影响以默认配置运行 sshd 的基于glibc 的Linux系统；它也可能存在于Mac 和Windows 环境中（尽管尚未证明这些环境中的可利用性）。

在这种情况下，漏洞是由于信号处理程序中的竞争条件而产生的。当程序的结果取决于不可预测的事件时间时，就会发生竞争条件。在regreSSHion中，恶意行为者可以利用此竞争条件在SSH客户端身份验证过程中在服务器上注入并执行任意代码。

影响分析

根据Qualys的博客文章，regreSSHion的潜在影响非常严重。由于其未经身份验证的性质，任何攻击者都可以利用此漏洞完全控制易受攻击的服务器。这可能导致各种恶意活动，包括：

安装恶意软件：攻击者可能会安装恶意软件来窃取敏感数据、破坏操作或发起进一步的攻击。

数据泄露：攻击者可以从受感染的服务器窃取敏感数据，包括用户凭据、财务信息或知识产权。

横向移动：攻击者可以利用受感染的服务器作为访问其他网络系统的立足点。

受影响的系统

数百万台运行易受regreSSHion影响的OpenSSH版本的服务器可能面临风险。这些易受攻击的版本包括几年前的版本，尤其是使用GNUC库(glibc)的Linux系统。

Synopsys软件完整性小组的研究员RayKelly对最新进展发表评论称：“这个漏洞非常严重。远程代码执行、根访问和在Linux服务器上的广泛传播使其成为威胁行为者的热门目标。虽然OpenSSH补丁已经可用，但将其部署到所有受影响的系统（可能影响1400万个OpenSSH实例）是一项重大挑战。此漏洞可能会持续很长时间，让人想起2014年OpenSSL中的Heartbleed漏洞。”

当前状态

该漏洞于2024年7月1日由Qualys公开披露。不过，好消息是OpenSSH开发人员已经发布了解决regreSSHion问题的修补版本。因此，所有用户尽快将其OpenSSH服务器更新到最新的修补版本至关重要。

坏消息是该漏洞的POC似乎已公开。

![](https://mmbiz.qpic.cn/mmbiz_png/0KRmt3K30icWMUczHpszBgIs9VOwEpVSqWSQlQp7hIczMyLJDVzjuictFsNzIrrrSDfvLdD3kkL4BFiasia755TKjw/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1)

据称，研究人员针对使用glibc C库和32位版本的Linux系统演示了此漏洞，因为内存空间减少导致ASLR较弱。然而，在64位系统上利用此漏洞也是可行的，但可能更困难。针对Debian Linux i386稳定版的OpenSSH 9.2p1，研究人员需要大约10,000次尝试才能赢得竞争条件并利用该漏洞。这意味着在100个并发连接和默认 LoginGraceTime 为 120 秒的情况下，需要3-4个小时。但是，由于ASLR glibc的地址只有一半的时间可以被猜对，因此使用root shell 现远程代码执行的时间增加到 -8 小时。

还不知道这个POC的成功率能达到何种程度。

缓解措施

regreSSHion的主要缓解策略是将OpenSSH更新到最新修补版本。以下是解决此漏洞的方法：

识别您的OpenSSH版本：使用命令ssh-V检查您当前的OpenSSH版本。

下载最新修补版本：访问此处的官方OpenSSH网站，下载与您的操作系统兼容的最新修补版本。

更新OpenSSH：更新过程因操作系统而异。请参阅系统文档以获取具体说明。

缓解建议

虽然更新OpenSSH至关重要，但也建议实施额外的安全措施来加强服务器的防御能力：

启用强身份验证：利用双因素身份验证(2FA)等方法在用户名和密码之外添加额外的安全层。

限制访问：仅限授权用户访问SSH，并尽可能限制对关键系统的远程访问。

监控日志：定期监控您的服务器日志，查找可能表明试图进行攻击的可疑活动。

专家点评

网络安全专家评论时指出，尽管该漏洞利用条件复杂苛刻，这是防御者的机会。但修复工作却是一项更加艰巨的任务。

Jeff Williams，Contrast Security的联合创始人兼CTO，强调了这一事件凸显了回归测试的重要性，指出OpenSSH团队意外地重新引入了一个他们在2006年已经修复的缺陷。他提到，每个团队都需要完全自动化的测试套件，以防止安全修复中的回归问题。Williams对检测和阻止这种攻击持乐观态度，因为与Log4Shell攻击相比，这种攻击更嘈杂，需要大约10,000次尝试才能成功，这为安全提供商提供了机会在攻击成功前进行干预。然而，由于修复是重大更新的一部分，使得向后移植变得困难，用户需要升级到最新版本或应用旧版本的修复。

Ray Kelly，来自Synopsys软件完整性小组的专家表示：“这个漏洞非常严重，它结合了远程代码执行、root访问和在Linux服务器上的广泛分布，使其成为攻击者的理想目标。尽管已有补丁，但在所有受影响的系统上部署补丁是一个巨大的挑战，可能需要很长时间才能普及。”

结论

RegreSSHion是一个严重漏洞，它凸显了及时更新软件和强大的服务器安全实践的重要性。通过修补OpenSSH并实施额外的安全措施，用户可以显著降低被利用的风险。随时了解安全漏洞并实施适当的缓解策略对于维护安全的服务器环境至关重要。

**参考资源：**

1.https://blog.qualys.com/vulnerabilities-threat-research/2024/07/01/regresshion-remote-unauthenticated-code-execution-vulnerability-in-openssh-server

2.https://hackread.com/regresshion-vulnerability-openssh-exposes-servers/

3.https://www.csoonline.com/article/2511351/openssh-vulnerability-regresshion-puts-millions-of-servers-at-risk.html

4.https://www.darkreading.com/cloud-security/regresshion-bug-threatens-takeover-of-millions-of-linux-systems

原文来源：网空闲话plus

“投稿联系方式：010-82992251   sunzhonghao@cert.org.cn”

![](https://mmbiz.qpic.cn/mmbiz_jpg/GoUrACT176n1NvL0JsVSB8lNDX2FCGZjW0HGfDVnFao65ic4fx6Rv4qylYEAbia4AU3V2Zz801UlicBcLeZ6gS6tg/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

预览时标签不可点

阅读原文

![]()

微信扫一扫
关注该公众号

继续滑动看下一个

轻触阅读原文

![](http://mmbiz.qpic.cn/mmbiz_png/GoUrACT176mrRug7icLIhX4EvNQjNgGRibia7K9qOLTR5PDfQiaUesU9xge7pnF8iciaxVC3JVkNqHA2pvQDnrM0hDVQ/0?wx_fmt=png)

网络安全应急技术国家工程中心

向上滑动看下一个

知道了

![]()
微信扫一扫
使用小程序

取消
允许

取消
允许

取消
允许

×
分析

![跳转二维码]()

![作者头像](http://mmbiz.qpic.cn/mmbiz_png/GoUrACT176mrRug7icLIhX4EvNQjNgGRibia7K9qOLTR5PDfQiaUesU9xge7pnF8iciaxVC3JVkNqHA2pvQDnrM0hDVQ/0?wx_fmt=png)

微信扫一扫可打开此内容，
使用完整服务

：
，
，
，
，
，
，
，
，
，
，
，
，
。

视频
小程序
赞
，轻点两下取消赞
在看
，轻点两下取消在看
分享
留言
收藏
听过