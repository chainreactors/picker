---
title: Critical Microsoft Code-Execution Vulnerability
url: https://www.schneier.com/blog/archives/2022/12/critical-microsoft-code-execution-vulnerability.html
source: Schneier on Security
date: 2022-12-23
fetch_date: 2025-10-04T02:22:11.005748
---

# Critical Microsoft Code-Execution Vulnerability

# [Schneier on Security](https://www.schneier.com/)

Menu

* [Blog](https://www.schneier.com)
* [Newsletter](https://www.schneier.com/crypto-gram/)
* [Books](https://www.schneier.com/books/)
* [Essays](https://www.schneier.com/essays/)
* [News](https://www.schneier.com/news/)
* [Talks](https://www.schneier.com/talks/)
* [Academic](https://www.schneier.com/academic/)
* [About Me](https://www.schneier.com/blog/about/)

### Search

*Powered by [DuckDuckGo](https://duckduckgo.com/)*

Blog

Essays

Whole site

### Subscribe

[![Atom](https://www.schneier.com/wp-content/uploads/2019/10/rss-32px.png)](https://www.schneier.com/feed/atom/)[![Facebook](https://www.schneier.com/wp-content/uploads/2019/10/facebook-32px.png)](https://www.facebook.com/bruce.schneier)[![Twitter](https://www.schneier.com/wp-content/uploads/2019/10/twitter-32px.png)](https://twitter.com/schneierblog)[![Email](https://www.schneier.com/wp-content/uploads/2019/10/email-32px.png)](https://www.schneier.com/crypto-gram)

[Home](https://www.schneier.com)[Blog](https://www.schneier.com/blog/archives/)

## Critical Microsoft Code-Execution Vulnerability

A critical code-execution vulnerability in Microsoft Windows was patched in September. It seems that researchers [just realized](https://arstechnica.com/information-technology/2022/12/critical-windows-code-execution-vulnerability-went-undetected-until-now/) how serious it was (and is):

> Like EternalBlue, CVE-2022-37958, as the latest vulnerability is tracked, allows attackers to execute malicious code with no authentication required. Also, like EternalBlue, it‚Äôs wormable, meaning that a single exploit can trigger a chain reaction of self-replicating follow-on exploits on other vulnerable systems. The wormability of EternalBlue allowed WannaCry and several other attacks to spread across the world in a matter of minutes with no user interaction required.
>
> But unlike EternalBlue, which could be exploited when using only the SMB, or server message block, a protocol for file and printer sharing and similar network activities, this latest vulnerability is present in a much broader range of network protocols, giving attackers more flexibility than they had when exploiting the older vulnerability.
>
> [‚Ä¶]
>
> Microsoft fixed CVE-2022-37958 in September during its monthly Patch Tuesday rollout of security fixes. At the time, however, Microsoft researchers believed the vulnerability allowed only the disclosure of potentially sensitive information. As such, Microsoft gave the vulnerability a designation of ‚Äúimportant.‚Äù In the routine course of analyzing vulnerabilities after they‚Äôre patched, Palmiotti discovered it allowed for remote code execution in much the way EternalBlue did. Last week, Microsoft revised the designation to critical and gave it a severity rating of 8.1, the same given to EternalBlue.

Tags: [Microsoft](https://www.schneier.com/tag/microsoft/), [patching](https://www.schneier.com/tag/patching/), [vulnerabilities](https://www.schneier.com/tag/vulnerabilities/), [Windows](https://www.schneier.com/tag/windows/)

[Posted on December 22, 2022 at 7:01 AM](https://www.schneier.com/blog/archives/2022/12/critical-microsoft-code-execution-vulnerability.html) ‚Ä¢
[3 Comments](https://www.schneier.com/blog/archives/2022/12/critical-microsoft-code-execution-vulnerability.html#comments)

### Comments

Clive Robinson ‚Ä¢
[December 22, 2022 10:11 AM](https://www.schneier.com/blog/archives/2022/12/critical-microsoft-code-execution-vulnerability.html/#comment-414386)

@ ALL,

Whilst I can understand this,

> *‚ÄúAt the time, however, Microsoft researchers believed the vulnerability allowed only the disclosure of potentially sensitive information.‚Äù*

As you focus on what is infront of you when ‚Äúunder the gun‚Äù, it can lead to two major effects that people need to keep in their head,

1, Severity estimation is just that an estimation.

2, Vulnarabilites are seldom singltons or not built towards.

In this case we see the first effect, but it happens.

It‚Äôs the second effect we realy need to keep in mind like the old joke about how quickly a ‚Äúmouse problem‚Äù becomes a ‚Äúmice problem‚Äù.

These sorts of vulnerabilities are not ‚Äúone bad line of code‚Äù they actually come about from the way people think about meeting requirments.

People tend to ‚Äúfall into groves‚Äù we get told a problem, and rather than treat it as unique we mentally see it through our experience of previously problems. That is we almost work by analogy.

It‚Äôs why in part we have ‚Äúclasses of vulnerabilities‚Äù that contain several ‚Äúinstances of vulnerabilities‚Äù.

But such thinking is not constrained to a single piece of code‚Ä¶ It happens in many pieces of code.

Thus expect to see another ‚Äúinstance‚Äù of vulnerability in this ‚Äúclass‚Äù in the not to distant future‚Ä¶

Clive Robinson ‚Ä¢
[December 22, 2022 10:48 AM](https://www.schneier.com/blog/archives/2022/12/critical-microsoft-code-execution-vulnerability.html/#comment-414388)

@ ALL,

I had a hunt around to see if I could find anything more usefull than,

> *‚ÄúCVE-2022-37958 resides in the SPNEGO Extended Negotiation, a security mechanism abbreviated as NEGOEX that allows a client and server to negotiate the means of authentication. When two machines connect using Remote Desktop, for instance, SPNEGO allows them to negotiate the use of authentication protocols such as NTLM or Kerberos.‚Äù*

Which suggests that it might be a ‚Äúfall back‚Äù vulnarability where either end negotiates down to ‚Äúinsecure‚Äù (the sort of thing that makes Meet-in-The-Middle-Attacks so easy).

However I have not had success as there is no POC or similar around.

And‚Ä¶

IBM are not going to release further details until Q2-2023 so more than 100days away and could be closer to 200.

Oh and I would assume it is all versions of MS OS‚Äôs supported or otherwise going back as far as SPNEGO has been around which is RFC4178 of 2005 and came out of Sun.

Due to where it sits in the computing stack, RFC4178 effects many OS‚Äôs other than MS OS‚Äôs‚Ä¶

If, and we don‚Äôt know because they are not saying, this vulnerability is due to the protocol used in RFC4178 or the RFC4178 standard it‚Äôs self‚Ä¶ Then we may find this vulnerability might be more wide spread as an issue‚Ä¶

Ted ‚Ä¢
[December 22, 2022 11:21 AM](https://www.schneier.com/blog/archives/2022/12/critical-microsoft-code-execution-vulnerability.html/#comment-414389)

In the run up to the holiday, it‚Äôs a wonderful reminder to apply patches throughout the year, and most judiciously upon their release.

IBM says they will refrain from releasing the vulnerability‚Äôs gory technical details until Q2 2023, so that everyone has time to apply the patches. (Purportedly there are no reports of it having been exploited in the wild, as of now.)

Tenable provides some additional links to SPNEGO NEGOEX for the preternaturally protocol-curious. Could be a worthwhile dog-ear for the holiday reading stack. üòÑ

<https://www.tenable.com/blog/cve-2022-37958-faq-for-critical-microsoft-spnego-negoex-vulnerability>

[![Atom Feed](https://www.schneier.com/wp-content/themes/schneier/assets/images/rss.png)
Subscribe to comments on this entry](https://www.schneier.com/blog/archives/2022/12/critical-microsoft-code-execution-vulnerability.html/feed/)

## Leave a comment [Cancel reply](/blog/archives/2022/12/critical-microsoft-code-execution-vulnerability.html#respond)

[Blog moderation policy](https://www.schneier.com/blog/archives/2024/06/new-blog-moderation-policy.html)

[Login](https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2022%2F12%2Fcritical-microsoft-code-execution-vulnerability.html "Login")

Name

Email

URL:

[ ]  Remember personal info?

Fill in the blank: the name of this blog is Schneier on \_\_\_\_\_\_\_\_\_\_\_ (required):

Comments:
![](https://www.schneier.com/wp-content/themes/schneier/assets/images/loader.gif)

**Allowed HTML**
<a href="URL"> ‚Ä¢ <em> <cite> <i> ‚Ä¢ <strong> <b> ‚Ä¢ <sub> <sup> ‚Ä¢ <ul> <ol> <li> ‚Ä¢ <blockquot...