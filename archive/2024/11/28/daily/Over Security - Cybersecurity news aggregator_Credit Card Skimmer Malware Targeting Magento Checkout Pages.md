---
title: Credit Card Skimmer Malware Targeting Magento Checkout Pages
url: https://blog.sucuri.net/2024/11/credit-card-skimmer-malware-targeting-magento-checkout-pages.html
source: Over Security - Cybersecurity news aggregator
date: 2024-11-28
fetch_date: 2025-10-06T19:31:55.529291
---

# Credit Card Skimmer Malware Targeting Magento Checkout Pages

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

[![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)

[Login](https://dashboard.sucuri.net/login/)

[Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)

Search for:

Search

* [Ecommerce Security](https://blog.sucuri.net/category/ecommerce-security)
* [Magento Security](https://blog.sucuri.net/category/magento-security)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)

# Credit Card Skimmer Malware Targeting Magento Checkout Pages

[![](https://secure.gravatar.com/avatar/3bb7fb42c6bf04c758d570c2f6bb217266c127e77766dc9d8e6754f15cdd5867?s=60&d=mm&r=g)](https://blog.sucuri.net/author/puja-srivastava)

[Puja Srivastava](https://blog.sucuri.net/author/puja-srivastava)

* November 26, 2024

![Credit Card Skimmer Malware Targeting Magento Checkout Pages](https://blog.sucuri.net/wp-content/uploads/2024/11/Blog-Featuring-Image-Credit-Card-Skimmer-Malware-Targeting-Magento-Checkout-Pages-820x385.png)

Magento websites are a frequent target for cybercriminals due to their widespread usage in eCommerce and the valuable customer data they handle. During a routine investigation, we discovered a malicious JavaScript injection targeting Magento websites. This malware dynamically creates a fake credit card form or extracts payment fields directly depending on the variant of the malware, activating only on checkout pages. The stolen data is then encrypted and exfiltrated to a remote server.

### Overview of the infection:

Initially discovered by Weston Henry, a colleague on our team, the malware is designed to target Magento-powered eCommerce websites, specifically their checkout processes. The infection is a blend of filesystem and database malware, with the skimmer leveraging advanced obfuscation techniques to avoid detection.

![example](https://blog.sucuri.net/wp-content/uploads/2024/11/example.png)

### Domains Involved:

* dynamicopenfonts[.]app
* staticfonts[.]com
* static-fonts[.]com

Two of the domains are currently on VirusTotal’s blocklist.

* <https://www.virustotal.com/gui/url/7c909060732cc35b47b7521d05502f093a190dce84874e6691d95f91dfae07a7?nocache=1>
* <https://www.virustotal.com/gui/url/77a3f4d51e5a964bf0309568c5f89d08d073c6d9aaebfb539948f28419d8414a?nocache=1>

As of writing this article, 8 [websites](https://publicwww.com/websites/%22dynamicopenfonts.app%22/) are infected with this malware according to publicwww.com.

### How it was detected

The malicious script was flagged during a routine inspection with Sucuri’s SiteCheck. The tool identified a resource originating from the blacklisted domain dynamicopenfonts.app. Further investigation revealed its presence in two locations:

**File:** ./app/design/frontend/Magento/[Redacted]/Magento\_Theme/layout/default.xml.

**Database:** The table core\_config\_data contained references to the malicious script.

![SiteCheck](https://blog.sucuri.net/wp-content/uploads/2024/11/sitecheck.png)

### Infection Details

The malicious script was found within the <referenceContainer> directive of the XML file, designed to load a JavaScript resource just before the closing <body> tag. The infected code snippet is as follows:

![infected code snippet](https://blog.sucuri.net/wp-content/uploads/2024/11/infected-code-snippet.png)

The contents of the external script are obfuscated to avoid detection, making it challenging to identify at first glance.

Here’s the external script:

![external script sample](https://blog.sucuri.net/wp-content/uploads/2024/11/external-script-sample.png)

Once executed, the script activates only on pages containing the word “checkout” but excluding “cart” in the URL.

```
window.location.href.includes('checkout') && !window.location.href.includes('cart')
```

Fake Credit Card Form Example:

![Fake credit card form example](https://blog.sucuri.net/wp-content/uploads/2024/11/fake-credit-card-form-example.png)

### Collecting User Data, Encryption and Obfuscation:

The script is designed to extract sensitive credit card information from specific fields on the checkout page. Then the malware collects additional user data through Magento’s APIs, including the user’s name, address, email, phone number, and other billing information. This data is retrieved via Magento’s customer-data and quote models.

![data collection](https://blog.sucuri.net/wp-content/uploads/2024/11/data-collection.png)

To protect the data and make it difficult to detect, the information is first encoded as JSON. Then, it is XOR-encrypted with the key ‘script’ to add an extra layer of obfuscation. Finally, the encrypted data is Base64-encoded to ensure safe transmission, using the following code:

![base64 encoded](https://blog.sucuri.net/wp-content/uploads/2024/11/base64-encoded.png)

### Data Exfiltration Process: Sending Stolen Information to Remote Servers:

Once a user submits their payment details through the compromised form or hijacked fields, the malware extrac...